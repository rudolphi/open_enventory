var ab="Sciformation VectorMol (c) 2012-2022 Felix Rudolphi",W=window,D=document,M=Math,ac=unescape,ad=90,ae=120,af=180,ag=M.PI/af,ah=1/ag,ai=2*M.atan(M.SQRT2),aj=ai*ah,ak=360,al=21600,T=true,F=false,am,S=" ",ao="\n",ap="  0",aq="px",ar=Number.MAX_VALUE,as="obj",C="C",H="H",at="\nM  ",au="SUP",av="MUL",aw="SRU",ax=".menuPopup",ay=".menuWithPopup",az=[0,2,1,3],aA="font-size",aB="stroke",aC="stroke-opacity",aD="stroke-width",aE="stroke-dasharray",aF="--",aG="text-anchor",aH="fill",aI="<sub>",aJ="</sub>",aK="atom",aL="draw",aM="drawChain",aN="drawHotspot",aO="selRect",aP="selLasso",aQ="rotate",aR="3d_rotate",aS="bond_rotate",aT="delete",aU="insertTemplate",aV="paste",aW="drawPlus",aX="drawArrow",aY="zoomIn",aZ,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9=0,a_=new RegExp("^(\\d*)([A-Z%*][a-z#]{0,2})(H\\d*)?\\s*(\\d*[\\+\\-]+)?\\s*$"),ba={8:0,4:1.5},bb={3:6,6:1,11:4},bc=["text/xml","chemical/x-mdl-molfile","text/plain","Text"],bd=0,be=1,bf=2,bg=3,bh=4,bi=!D.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),bj={Element:1,Unspecified:0},bk={Singlet:1,Doublet:2,Triplet:3},bl={Solid:0,Dash:1,WedgedHashBegin:3,WedgedHashEnd:4,WedgeBegin:6,WedgeEnd:7,WavyWedgeBegin:11,WavyWedgeEnd:12};
bm=parseInt;
bn=parseFloat;
function bo(a){if(bi){if(!a){a=W.event}a.returnValue=F;
a.cancelBubble=T}else{a.preventDefault();
a.stopPropagation()}return F}function stopPropagation(a){if(bi){if(!a){a=W.event}a.cancelBubble=T}else{a.stopPropagation()}}function bp(a){return a.length}function bq(){for(var c=0,b=0,a=bp(arguments);
b<a;
b++){c+=arguments[b]}return c/a}function br(b){var e=[],f=[],d,c,a;
for(d in b){f.push(d)}f.sort();
for(c=0,a=bp(f);
c<a;
c++){d=f[c];
e[d]=b[d];
delete b[d]}for(c=0;
c<a;
c++){d=f[c];
b[d]=e[d]}}function bs(a,c){for(var b in a){if(a[b]==c){return b}}}function bt(b){if(!b){return b}var a=/^[\s\n\r\t]*(.*?)[\s\n\r\t]*$/;
if(a.exec(b)){return RegExp.$1}}function bu(e,h,j){if(!$.isArray(h)){return e}var a=[],f=0,b,g,d,c;
if(e!=am){for(d=0,c=bp(h);
d<c;
d++){b=h[d];
g=e.substr(f,b);
if(!j){g=bt(g)}a.push(g);
f+=b}if(bp(e)>b){g=e.substr(f);
if(!j){g=bt(g)}a.push(g)}}return a}function bv(d){for(var c=[],b,e=0,a=(d?bp(d):0);
e<a;
e++){if(d.charAt(e)==S){continue}b=d.indexOf(S,e+1);
if(b==-1){c.push(d.substr(e));
break}c.push(d.substring(e,b));
e=b}return c}function bw(b,c,a){var d=b.substr(0,bp(c));
if(a!=T){d=d.toLowerCase();
c=c.toLowerCase()}return(d==c)}function bx(c,d,b){var e=bp(c)-bp(d),a;
if(e<0){return F}a=c.substr(e);
if(b!=T){a=a.toLowerCase();
d=d.toLowerCase()}return(a==d)}function by(a){if(a==am||a==""){return""}return String(a).replace(/:/g,".").replace(/\r\n/g,ao).replace(/\r/g,ao).replace(/\|/g,ao)}function bz(e,c){c=bm(c);
if(isNaN(c)||c<1){return""}e=String(e);
for(var d="",b=0;
b<c;
b++){d+=e}return d}function bA(a,b){return bB(a,b,S)}function bB(c,d,b){c=String(c);
if(bp(c)>d){return c.substr(0,d)}var a=bp(c);
while(a<d){a++;
c=b+c}return c}function bC(c,d,b){c=String(c);
if(bp(c)>d){return c.substr(0,d)}var a=bp(c);
while(a<d){a++;
c+=b}return c}function bD(a){a=String(a);
return a.replace(/(["\\])/g,"\\$1")}function bE(a){return'"'+bD(a)+'"'}function bF(a,b){if(a==am||a==null||(isNaN(a)&&typeof a=="number")){return b}return a}function bG(a){return bF(a,0)}function bH(a){return bF(a,"")}function bI(b){b=String(b);
var a=b.match(/\-?\d+[\.,]?\d*/);
if(a!=null&&bp(a)>0){return bH(a[0])}return""}function bJ(c,b,a){return M.max(b,M.min(a,c))}function round(c,e,f){var g=1,d,b,a;

c=bn(c);
e=bm(e);
if(isNaN(c)||c==am){return""}if(f!=3){if(c==0){return 0}if(c<0){g=-1;
c*=-1}}b=M.pow(10,e);
switch(f){case 1:d=M.floor(M.log(c)/M.LN10);
break;
case 2:d=M.floor(M.log(c)/3/M.LN10)*3;
break;
case 3:return c.toFixed(bJ(e,0,20));
break;
case 4:e-=M.ceil(M.log(c)/M.LN10);
return g*c.toFixed(bJ(e,0,20));
break;
default:return(g*M.round(c*b)/b)}switch(f){case 1:case 2:a=String(g*M.round(c/M.pow(10,d)*b)/b);
if(d==0){return a}return a+"&sdot;10<sup>"+d+"</sup>"}}function bK(c){var b=location.search,d,a;
if(b&&c){d=new RegExp("[&?]"+c+"=([^&$]*)");
if(a=d.exec(b)){return a[1]}}}function bL(){return a9++}function s(a){return bH(langDef[a])}function bM(){if($.inArray(lang,bN)>=0){document.write('<script type="text/javascript" src="lang_'+lang+'.js"><\/script>')}}function bO(){$(".button, .wTooltip").attr("title",function(){return s(this.id)}).on("dragstart",bo)}function bP(){this.bQ=bL();
this.bR=this.bQ;
this.bS=bS}function bT(b,a,c){if(b.bU){c.bR=a.bR}b.bV[a.bQ]=c}function bS(a){return a!=am&&this.bR==a.bR}function bW(a){return a!=am&&this.bQ==a.bQ}function bX(a,b){return bY(a,b)>=0}function bY(b,d){for(var c=0,a=bp(b);
c<a;
c++){if(b[c].bS(d)){return c}}return -1}function bZ(b,a){b.push.apply(b,a)}function b0(a,b){if(b!=am){a.push(b)}}function b1(a,c){for(var b=bp(a)-1;
b>=0;
b--){if(!bX(c,a[b])){a.splice(b,1)}}}function b2(b,a){for(var c,d=bp(b)-1;
d>=0;
d--){for(c=bp(a)-1;
c>=0;
c--){if(b[d].bS(a[c])){b.splice(d,1);
break}}}}function b3(b,e,c){for(var d=0,a=bp(b);
d<a;
d++){if(b[d].bS(e)){b[d]=c;
return T}}return F}function b4(d,b){if(b){for(var c=0,a=bp(b);
c<a;
c++){if(b[c].bS(d)){b.splice(c,1);
return T}}}return F}function b5(a,b){if(b==am){b=1}if(b!=0){a.unshift.apply(a,a.splice(b,bp(a)))}}function b6(b,d){for(var c=0,a=bp(d);
c<a;
c++){if(!bX(b,d[c])){return F}}return T}function b7(e,d){var b=Array.apply(am,arguments),c=[],f,a;
if(bp(b)>2){e=b.pop();
d=b7.apply(am,b)}for(f=0,a=bp(e);
f<a;
f++){if(bX(d,e[f])){c.push(e[f])}}return c}function b8(e,b){for(var c=[],d=0,a=bp(e);
d<a;
d++){if(!bX(b,e[d])){c.push(e[d])}}return c}function b9(c,b){for(var d=0,a=bp(b);
d<a;
d++){b_(c,b[d])}}function b_(a,b){if(b!=am&&!bX(a,b)){a.push(b);
return T}return F}function ca(a){if(a==am){return am}return this.bV[a.bQ]}function cb(b){if(b==am){return am}var c=this.bV[b.bQ],a;
if(!c){for(a in this.bV){if(b.bS(this.bV[a])){return b}}c=b.cc(this);
this.bV[b.bQ]=c}return c}function cd(a){this.bV={};
this.bU=a;
this.ca=ca;
this.cb=cb}function ce(a){return(720+a)%ak}function cf(a){var b=this.cc();
b.x+=a.x;
b.y+=a.y;
b.z+=a.z;
return b}function cg(b,a){var c=this.cc();
c.x-=b.x;
c.y-=b.y;
c.z=(a?0:c.z-b.z);
return c}function ch(b){var c=this,a=c.bp();
return(a>0?c.ci((b||1)/a):new cj())}function ck(b,a,d){var c=this;
if(b instanceof cj){c.x+=b.x;
c.y+=b.y;
c.z+=b.z}else{c.x+=b;
c.y+=a;
c.z+=bG(d)}}function cl(a){return(this.x==a.x&&this.y==a.y&&this.z==a.z)}function cm(g,e,c){var f=this,a,b,d;
if(f.bp()==0||f.cn(g)<0){return F}a=f.co(g,e);
if(!a){return isNaN(a)}b=f.co(e,c);
if(!b){return isNaN(b)}return(d=f.co(c,g)?(a*b>0&&a*d>0):isNaN(d))}function cp(b,a){var d=this.cn(b.cq(a));
if(d==0&&this.cr(a)<b.cr(a)){return NaN}return d}function cs(a){var b=this;
return new cj(b.x*a,b.y*a,b.z*a)}function ct(b,a){if(b!=1){var c=this;
if(a){c.cu(-a.x,-a.y,-a.z)}c.x*=b;
c.y*=b;
c.z*=b;
if(a){c.cu(a)}}}function cv(b,a){var c=this;
if(b&1){c.x=2*a.x-c.x
}if(b&2){c.y=2*a.y-c.y}}function cw(c,b){if(b){this.cu(-b.x,-b.y,-b.z)}var f=this,d=M.cos(c),e=M.sin(c),a=f.x*d-f.y*e;
f.y=f.x*e+f.y*d;
f.x=a;
if(b){f.cu(b)}}function cx(d,c,a){if(a){this.cu(-a.x,-a.y,-a.z)}var g=this,b=M.cos(c),f=M.sin(c),e=g.z*b-g.x*f;
g.x=g.x*b+g.z*f;
b=M.cos(d);
f=M.sin(d);
g.z=g.y*f+e*b;
g.y=g.y*b-e*f;
if(a){g.cu(a)}}function cy(i,h,g,f){var e=this,c=e.cz(i),b=e.cz(h),d=cA(c,b),a;
if(f){a=c.cq(b);
a=a.cq(d).cB();
if(a){d.cC(f*ag,a)}}if(g){d=d.cB(g)}d.cu(e);
return d}function cD(a){var b=this.cz(a);
return M.abs(b.x)+M.abs(b.y)-M.abs(b.z)}function cE(g,e,d){var f=this,c=g.cz(f),b=e.cz(f),a=c.cq(b);
if(d){a=a.cq(d.cz(f))}return a.cB()}function cF(m,g,a){if(m){if(a){this.cu(-a.x,-a.y,-a.z)}var e=this,i=M.cos(m),h=1-i,f=M.sin(m),l=e.x,k=e.y,j=e.z,d=g.x,c=g.y,b=g.z;
e.x=l*(i+d*d*h)+k*(d*c*h-b*f)+j*(d*b*h+c*f);
e.y=l*(c*d*h+b*f)+k*(i+c*c*h)+j*(c*b*h-d*f);
e.z=l*(b*d*h-c*f)+k*(b*c*h+d*f)+j*(i+b*b*h);
if(a){e.cu(a)}}}function cG(){return M.sqrt(this.cn(this))}function cH(b,a){var c=this.cz(b);
if(a){c.z=0}return c.bp()}function cI(a){var b=this;
return b.x*a.x+b.y*a.y+b.z*a.z}function cJ(b,a){var c=this;
if(a){c=c.cz(a);
b=b.cz(a)}return new cj(c.y*b.z-c.z*b.y,c.z*b.x-c.x*b.z,c.x*b.y-c.y*b.x)}function cK(g,d,b){var f=this,e=f.cz(g),c=f.cz(d),a=f.cz(b);
return e.cq(c).cn(a)}function cL(h,f,c){var a=this,i=h.cz(a),g=f.cz(a),d=c.cz(a),e=i.cM(g).cM(d),b=[];
b.push(e.cq(i).cB());
b.push(e.cq(g).cB());
b.push(e.cq(d).cB());
return b}function cN(b,c){if(c){return ce(this.cO(c)-this.cO(b))}else{var a=b.x-this.x,d=b.y-this.y;
if(!a&&!d){return 0}return ce(M.atan2(d,a)*ah)}}function cP(d,c){var e=this,b,a;
if(c){d=d.cz(e);
c=c.cz(e)}else{c=e}if((b=d.bp())&&(a=c.bp())){return ce(M.acos(d.cn(c)/b/a)*ah)}}function cQ(b,a){return this.cR(b,a)>0}function cS(b,a){var c=b.cT(a,T);
if(c>0){return M.abs(this.cR(b,a))/c}}function cU(b,a){return((a.x-b.x)*(this.y-b.y)-(a.y-b.y)*(this.x-b.x))}function cA(b,a){return new cj(0.5*(b.x+a.x),0.5*(b.y+a.y),0.5*(b.z+a.z))}function cV(c,b,a){return this.x>=M.min(c.x,b.x)-a&&this.x<=M.max(c.x,b.x)+a&&this.y>=M.min(c.y,b.y)-a&&this.y<=M.max(c.y,b.y)+a}function cW(f,e,c){for(var b=F,d=1,a=bp(f);
d<a;
d++){if((((f[d].y<=c)&&(c<f[d-1].y))||((f[d-1].y<=c)&&(c<f[d].y)))&&(e<(f[d-1].x-f[d].x)*(c-f[d].y)/(f[d-1].y-f[d].y)+f[d].x)){b=!b}}return b}function cX(c,b){var a=this;
if(b&&(b.x>a.x||b.x2<a.x||b.y>a.y||b.y2<a.y)){return F}return cW(c,a.x,a.y)}function cY(){return this.x+","+this.y}function cZ(b,a){return(this.x+b)+","+(this.y+a)}function c0(){var a=this;
return new cj(a.x,a.y,a.z)}function c1(f,e,b,a){var d=e*ag,c=b*ag;
return new cj(f.x+a*M.cos(c)*M.cos(d),f.y+a*M.cos(c)*M.sin(d),f.z+a*M.sin(c))}function c2(c,b,a){return c1(c,b,0,a)}function c3(e,d,c){var a=e.cT(d),b;
if(!a){return new cj()}b=c/a;
return new cj(b*(d.y-e.y),b*(d.x-e.x),0.5*(e.z+d.z))}function c4(e,d,a,c){var b,f;
if(c){b=1-c;
e.x=b*e.x+d.x*c;
e.y=b*e.y+d.y*c;
d.x=b*d.x+e.x*c;
d.y=b*d.y+e.y*c}if(a){f=c3(e,d,a);
e.x+=f.x;
d.x+=f.x;
e.y-=f.y;
d.y-=f.y}}function c5(d,c,b){var a=1;
if(d>c){a+=0.3*(d-c)/(b-c)}if(a<1.02){a=1}return a*a}function c6(n,b,q,l,g,o){var r=this,i=r.c7(),c=r.c8.c9.cc(),a=r.c_.c9.cc(),f=r.da(),e,k,p,j,h,m,d;

g=(g||1);
if(f){e=M.max(f.db.z,0.5*dc);
k=bq(e,M.min(f.dd.z,-0.5*dc));
g=M.min(g*c5(a.z,k,e),3.5)*b;
b*=c5(c.z,k,e)}else{g*=b}if(!n[aE]&&(p=(c.cT(a,T)/de))){l=bG(l)+df;
c4(c,a,q,l);
j=dg*(a.y-c.y)/p;
h=dg*(a.x-c.x)/p;
d=i.path("M"+c.dh(-j*b,h*b)+"L"+c.dh(j*b,-h*b)+"L"+a.dh(j*g,-h*g)+"L"+a.dh(-j*g,h*g)+"Z");
if(!o){l-=df+di;
c=r.c8.c9.cc();
a=r.c_.c9.cc();
c4(c,a,q,l);
j/=dg;
h/=dg;
n[aD]=0;
m=i.path("M"+c.dh(-j*b,h*b)+"L"+c.dh(j*b,-h*b)+"L"+a.dh(j*g,-h*g)+"L"+a.dh(-j*g,h*g)+"Z").attr(aH,n[aB])}}else{c4(c,a,q,l);
d=i.path("M"+c+"L"+a);
n[aD]=de*M.min(b,g);
if(!o){m=i.path("M"+c+"L"+a)}}r.dj.push(d.attr({fill:dk,stroke:dk,"stroke-width":dl*n[aD]}));
if(m){r.dj.push(m.attr(n))}}function dm(d,c){if(c||st.dn||d.dp||d.dq||d.dr||d.ds!=C||d.dt!=am||!bp(d.du)){return T}if(bp(d.du)!=2){return F}for(var b=0,a=bp(d.du);
b<a;
b++){if(d.du[b].dv!=2){return F}}return T}function dw(a){var c=this,b;
if(c.dj){if(a&&dx(c.dj)){a.insertAfter(c.dj)}c.dj.remove()}else{if(a&&(b=c.dy())){a.insertBefore(b)}}c.dj=a}function dz(b){for(var e,d,c=0,a=bp(b);
c<a;
c++){d=b[c].dj;
if(dx(d)){if(e){d.insertAfter(e)}e=d}}}function dA(b){var a;
if(b){if(!(a=b.node)&&bp(b)){a=b[0].node}}return(a&&a.parentNode)}function dx(a){var b;
if(a){if(!(b=a.node)&&bp(a)){b=a[bp(a)-1].node}}return(b&&b.parentNode)}function dy(){for(var g=this,c=st.dB(),e=g.dC(),b=c.dD(F),f,d=0,a=bp(b);
d<a;
d++){f=b[d];
if(f.dC()>=e&&dA(f.dj)){return f.dj}}}function dE(){this.dj=am}function dF(){var d=this,c=d.c7(),a=0.5*dG,b=c.path("M-"+a+",0H"+a+"M0,-"+a+"V"+a).attr(aB,d.dH?dI:dJ).attr(aD,dK).transform("t"+d.c9).data(as,d).mouseover(dL).mouseout(dM);
d.dw(b)}function dN(){var a=this,b=a.c7(),d,e=0.5*dO,i=0.5*(1-dP),h=a.dQ.cc(),g=a.dQ.cc(),c=a.dR.cc(),j=a.dR.cc(),f=dJ;
if(a.dS){f=dT}else{if(a.dH){f=dI}}c4(c,h,e,i);
c4(j,g,-e,i);
d=b.path("M"+a.dR+"L"+a.dQ+"L"+h+"M"+a.dQ+"L,"+g).attr(aB,f).attr(aD,dK).data(as,a).mouseover(dU).mouseout(dV);
a.dw(d);
dW(a)}function dX(a){a.remove()}function dY(b){var a=this;
if(a.dj){a.dj.forEach(dX);
a.dj.clear()}else{a.dj=b.set()}return a.dj}function dZ(){if(!this.d0&&!this.d1&&!this.d2){var O=this,o=O.da(),j,u,G,B,k,f,K,g,m,b,E,J,l,t,r,I,z,n,N,A,h,a,w,p,v,q=O.c7(),y={},e=O.c8.c9,d=O.c_.c9,L=bq(e.z,d.z),x=dJ,c=(O.dp?1.3:1);
if(o){o.d3();
j=o.dd.z;
u=bq(o.db.z,j)}if(O.dS){x=dT}else{if(O.dH){x=dI}}if(O.dp){x=tinycolor.mix(x,"#00f",50)}if(L<u&&j<u){x=tinycolor(x);
y[aB]=x.brighten(0.13*(255-x.getBrightness())*(u-L)/(u-j)).toString()}else{y[aB]=x}O.dY(q);
switch(O.dv){case 1.5:case 2:h=0;
a=bp(O.c8.du);
w=bp(O.c_.du);
if((a==1||w==1)&&(a>=3||w>=3||a==w)){}else{p=O.d4();
if(bp(p)){f=0;
for(G=0,B=bp(p);
G<B;
G++){A=bp(p[G].d5);
if(!k||A<f){f=A;
k=p[G]}}K=k.d6()}else{K=new cj();
g=0;
for(G=0,B=bp(O.c8.du);
G<B;
G++){m=O.c8.du[G];
b=(O.c8.bS(m.c8)?m.c_:m.c8);
if(b.bS(O.c_)){continue}K.x+=b.c9.x;
K.y+=b.c9.y;
g++}for(G=0,B=bp(O.c_.du);
G<B;
G++){m=O.c_.du[G];
b=(O.c_.bS(m.c8)?m.c_:m.c8);
if(b.bS(O.c8)){continue}K.x+=b.c9.x;
K.y+=b.c9.y;
g++}if(g){K.x/=g;
K.y/=g}}h=(e.cO(d)-K.cO(d))*ag;

if(M.abs(h)>M.PI){h*=-1}}if((h+2*M.PI)%M.PI>0.01||(a==2&&w==2)||(p&&bp(p))){O.d7(y,c);
if(O.dv==1.5){y[aE]=[aF]}O.d7(y,c,2*(h>0?-1:1),0.15)}else{O.d7(y,c,-1,-0.05);
if(O.dv==1.5){y[aE]=[aF]}O.d7(y,c,1,-0.05)}break;
case 3:O.d7(y,c,-1.5,0.15),O.d7(y,c),O.d7(y,c,1.5,0.15);
break;
default:if(O.d8!=0){K=(O.d8!=1);
O.d7(y,c,0,0,(K?2:4),K)}switch(O.d8){case 1:break;
case 4:y[aD]=de*c;
E=e.cT(d);
l=1.5;
J=2;
if(E){I=0;
J/=E;
t=J*(d.y-e.y);
r=J*(d.x-e.x);
n=0;
v="M"+e;
for(G=0;
G<=E;
G+=l){I++;
n=G/E;
z=(I%2?1:-1);
v+="L"+(e.x*(1-n)+(d.x+t*z)*n)+","+(e.y*(1-n)+(d.y-r*z)*n)}O.dj.push(q.path(v).attr(y))}break;
case 6:y[aD]=de*c;
E=e.cT(d);
l=2;
J=2;
if(E){J/=E;
t=J*(d.y-e.y);
r=J*(d.x-e.x);
v="";
for(G=0;
G<=E;
G+=l){n=G/E;
N=1-n;
v+="M"+(e.x*N+n*(d.x+t))+","+(e.y*N+n*(d.y-r))+"L"+(e.x*N+n*(d.x-t))+","+(e.y*N+n*(d.y+r))}O.dj.push(q.path(v).attr(y))}break;
default:if(O.dv==0){y[aE]=[aF]}O.d7(y,c)}}}else{this.dw()}dW(this)}function d9(a,c){var b=this;
a.d_.attr(aA,16*c).attr(aD,de);
a.bbox=a.d_.getBBox(T);
a.ea=b.eb.rect(a.bbox.x-a.ec,a.bbox.y-a.ec,a.bbox.width+2*a.ec,a.bbox.height+2*a.ec,1.5).attr(aH,a.dk).attr(aD,0).insertBefore(a.d_);
b.ed.push(a.ea,a.d_);
b.ee.push(a)}function ef(b,a){var e=this,d,c;
if(eg){if(b){e.x+=b;
e.d_.node.setAttribute("x",e.x);
e.ea.node.setAttribute("x",e.x-e.ec)}if(a){e.y+=a;
e.d_.node.setAttribute("y",e.y);
e.ea.node.setAttribute("y",e.y-e.ec)}}else{e.x+=bG(b);
e.y+=bG(a);
d=M.round(e.x*al);
c=M.round(e.y*al);
e.d_.shape.path=" m"+d+","+c+" l"+(d+1)+","+c+" e"}}function eh(b,h,f,i,e,g,c,d){var a=this;
a.eb=b;
a.x=h;
a.y=f;
a.dk=g;
a.ec=bG(c);
a.d_=a.eb.text(h,f,i).attr(aB,e).attr(aH,e).attr(aG,"start");
if(d){a.d_.attr("font-weight","bold")}a.bbox=a.d_.getBBox(T);
a.ei=ef}function ej(){for(var c=this,b=0,a=bp(c.ee);
b<a;
b++){c.ee[b].d_.insertAfter(c.ed)}return this.ed}function ek(c,a){var b=this;
b.eb=c;
b.ed=a;
b.ee=[];
b.el=d9;
b.ej=ej}function em(){if(!this.d1&&!this.d0&&!this.d2){var J=this,v=J.c7(),x=J.c9,z=J.en(),l,a,j,K=dk,d=J.eo(),t=d.ep,e,b,q,G,f,u,g,r,k,n,y,c,h=0,I=0,E=0,o,w=0.8,B,A,m=J.dp;
if(!v){return}if(t&&eq=="tmpl"&&d.bS(t.er)){K=es}if(J.dS){j=dT}else{j=dJ}if(m||d.bS(et)){a=(J.eu?ev:ew)}else{if(J.dH){a=dI}}J.dY(v);
if(!dm(J,z)){if(a||K!=dk){l=v.rect(x.x-ex*ey,x.y-ex*ey,2*ex*ey,2*ex*ey);
if(a){l.attr(aB,a).attr(aD,de)}else{l.attr(aD,0)}if(K!=dk){l.attr(aH,(ez?"red":K))}J.dj.push(l)}}else{e=new ek(v,J.dj);
b=!!(A=bp(J.du));
for(B=0;
B<A;
B++){q=J.du[B];
o=eA(q.c8,q.c_)+90;
if(J.bS(q.c_)){o+=af}o%=ak;
if(o>af){b=F;
break}}G=new eh(v,0,0,J.ds+(st.dn&&!J.dS?J.getIndex()+1:""),j,K,ey,m);
G.d_.attr(aG,"middle");
f=eB*eC/G.bbox.height;
e.el(G,f);
u=G.bbox.width*0.5;
I-=u;
h-=u;
E+=u;
g=J.eD();
if(g&&!b){r=new eh(v,E,0,H,j,dk,ey,m);
e.el(r,f);
E+=r.bbox.width;
if(g>1){k=new eh(v,E,0.4*G.bbox.height,g,j,dk,ey,m);
e.el(k,f*w)}}if(z||J.dq){n="";
if(z&&M.abs(z)!=1){n+=M.abs(z)}if(z){n+=(z>0?"+":"\u2013")}if(J.dq==1){n+=":"}else{if(J.dq==2){n+="."}else{if(J.dq==3){n+=".."}}}y=new eh(v,E,-0.5*G.bbox.height,n,j,dk,ey,m);
e.el(y,f*w)}if(J.dr){c=new eh(v,0,-0.5*G.bbox.height,M.round(J.dr),j,dk,ey,m);

e.el(c,f*w);
I-=c.bbox.width;
c.ei(I)}if(g&&b){if(g>1){k=new eh(v,0,0.4*G.bbox.height,g,j,dk,ey,m);
e.el(k,f*w);
h=M.min(I,h-k.bbox.width);
k.ei(h)}r=new eh(v,0,0,H,j,dk,ey,m);
e.el(r,f);
h-=r.bbox.width;
r.ei(h)}J.dj.transform("t"+x);
if(a){J.dj.push(v.rect(x.x+h-ey,x.y-G.bbox.height*0.5,E-h+2*ey,G.bbox.height).attr(aB,a).attr(aD,de))}}}else{this.dw()}dW(this)}function eE(){if(!this.d2){var b=this,f,d,e,n,k,l={},c=b.c7(),p=new ek(c,b.dY(c)),a,j,h,o,m,g;
if(b==eF||(et&&b==et.eu)){g=(eg?1:1/eG);
b.d3();
o=c.set();
o.push(c.text(2,2,"Ph").attr(aA,2).attr("fill-opacity",0.8),c.path("M2,2L4,2L5,3.5L4,5L2,5L1,3.5Z M2.5,2.5L4,2.5 M4.5,3.5L3.5,4.75 M2.5,4.75L1.5,3.5").attr(aB,"#f00").attr(aD,de).attr(aC,0.85),c.path("M1,0L2,2").attr(aB,eH).attr(aD,de));
o.transform("t"+(b.db.x)+","+(b.dd.y)).data(as,b).mousedown(bo).mouseup(eI).click(eJ);
m=o.getBBox();
b.dj.push(c.rect(b.dd.x,b.dd.y,b.db.x+m.width*1.8*g-b.dd.x,b.db.y-b.dd.y).attr(eK).attr(aC,0.85).data(as,b).mouseout(eL));
b.dj.push(o);
if(b.type==au){b.dj.push(c.path(b.eM?"M0,4H4L2,2.5Z M0,0H4L2,1.5Z":"M0,1.5H4L2,0Z M0,2.5H4L2,4Z").transform("t"+(b.db.x+g)+","+(b.dd.y+m.height*1.3*g)).attr(aB,eH).attr(aD,de).attr(aH,"silver").data(as,b).mousedown(bo).mouseup(eI).click(eN))}}if(!b.eM){if(b.type==au){a=b.d6();
j=new eh(c,a.x,a.y,b.ds,dJ,dk,ey,(b.dH?dI:am));
j.d_.attr(aG,"middle");
h=eB*eC/j.bbox.height;
p.el(j,h)}else{a=b.eO();
l[aB]=(b.dH?dI:dJ);
l[aD]=de;
for(f=0,d=bp(b.eP);
f<d;
f++){e=b.eP[f];
n=e.dR.cc();
k=e.dQ.cc();
c4(n,k,eC*0.4*(a.eQ(n,k)?-1:1));
b.dj.push(c.path("M"+n+"L"+e.dR+"L"+e.dQ+"L"+k).attr(l))}if(b.ds){k=b.eR(3);
j=new eh(c,k.x+eC*0.3,k.y+eC*0.3,b.ds,dJ,dk,ey);
h=eB*eC/j.bbox.height;
p.el(j,h);
b.dj=p.ej()}}if(c==aZ){j.d_.click(function(i){b.eS(i);
return bo(i)}).mousedown(bo).mouseup(eI)}}}else{this.dw()}dW(this)}function cj(a,d,c){var b=this;
b.x=bG(a);
b.y=bG(d);
b.z=bG(c);
b.cM=cf;
b.cz=cg;
b.cB=ch;
b.cu=ck;
b.eT=ct;
b.eU=cw;
b.eV=cx;
b.cC=cF;
b.eW=cE;
b.eX=cy;
b.eY=cD;
b.eZ=cv;
b.bS=cl;
b.bp=cG;
b.cT=cH;
b.ci=cs;
b.cn=cI;
b.cq=cJ;
b.e0=cK;
b.e1=cL;
b.cO=cN;
b.cr=cP;
b.eQ=cQ;
b.co=cp;
b.e2=cS;
b.cR=cU;
b.e3=cm;
b.cV=cV;
b.cX=cX;
b.cc=c0;
b.toString=cY;
b.dh=cZ}function e4(){var a=this;
bP.apply(a);
a.moveBy=a.cu=e5;
a.rotateBy=a.eU=e6;
a.rotate3D=a.eV=e7;
a.rotateAround=a.e8=e9;
a.rotateAroundUnit=a.cC=e_;
a.flip=a.eZ=fa;
a.getCenter=a.d6=fb;
a.fc=fd;
a.dw=fe;

a.dE=ff}function fg(){var a=this;
bP.apply(a);
a.eo=fh;
a.dw=dw;
a.dY=dY;
a.dE=dE;
a.dy=dy}function fi(b,a){if(a){b4(b,a)}b.d2=T;
b.dw();
dW(b)}function fj(b){for(var c=0,a=bp(b);
c<a;
c++){fi(b[c])}b.length=0}function fk(d,c){var e=d.dC(),f=c.dC();
if(e<f){return -1}if(e>f){return 1}return 0}function fl(c){for(var d=[],b=0,a=bp(c);
b<a;
b++){b_(d,fm(c[b]))}return d}function fm(a){if(!a||a.fn||a.d2){return}var b=a.c7();
if(b){b_(b.fn,a);
a.fn=T}return b}function dW(a){if(!a||!a.fn){return}var b=a.c7();
if(b){b4(a,b.fn);
a.fn=am}}function fo(){dz(st.dB().dD(F))}function fp(d){var b,a,c;
if($.isArray(d)){for(b=0,a=bp(d);
b<a;
b++){fp(d[b])}}else{while(bp(d.fn)){c=d.fn.pop();
if(c.d2){c.dw()}else{c.fn=am;
c.fc()}}if(c){fo();
d.renderfix()}}}function resetDirty(b){while(bp(b.fn)){var a=b.fn.pop();
a.fn=am}}function fq(){var d=this,c,e,b,a;
if(!d.dd||!d.db){d.dd=new cj(ar,ar,ar);
d.db=new cj(-ar,-ar,-ar);
c=d.fr(T);
if(!bp(c)){c=d.fr()}for(b=0,a=bp(c);
b<a;
b++){e=c[b];
fs(d,e)}}}function fs(a,b){ft(a,b.x);
fu(a,b.y);
fv(a,b.z)}function ft(b,a){if(a>b.db.x){b.db.x=a}if(a<b.dd.x){b.dd.x=a}}function fu(b,a){if(a>b.db.y){b.db.y=a}if(a<b.dd.y){b.dd.y=a}}function fv(b,a){if(a>b.db.z){b.db.z=a}if(a<b.dd.z){b.dd.z=a}}function fb(){if(!this.fw){var e=this,b=new cj(),d=e.fr(T),c,a;
if(!bp(d)){d=e.fr()}for(c=0,a=bp(d);
c<a;
c++){b.cu(d[c])}if(a>1){b.x/=a;
b.y/=a;
b.z/=a}e.fw=b}return this.fw}function fe(){if(this.dj){dw.apply(this)}for(var c=this.dD(T),b=0,a=bp(c);
b<a;
b++){c[b].dw()}}function ff(){if(this.dj){dE.apply(this)}for(var c=this.dD(T),b=0,a=bp(c);
b<a;
b++){c[b].dE()}}function fd(){var a=fl(this.dD(F));
fp(a)}function e5(c,b,f){for(var e=this.fr(),d=0,a=bp(e);
d<a;
d++){e[d].cu(c,b,f)}this.fx(bd);
fl(this.dD(F))}function e6(f,b){var e,d,a,c,g=this;
if(!b){b=g.d6().cc();
c=T}e=g.fr();
for(d=0,a=bp(e);
d<a;
d++){e[d].eU(f,b)}g.fx((c?be:bg));
fl(g.dD(F))}function e7(e,d,b){var f,c,a,g=this;
if(!b){b=g.d6().cc()}f=g.fr();
for(c=0,a=bp(f);
c<a;
c++){f[c].eV(e,d,b)}g.fx(bg);
fl(g.dD(F))}function e_(f,c,b){for(var g=this,e=g.fr(),d=0,a=bp(e);
d<a;
d++){e[d].cC(f,c,b)}g.fx(bg);
fl(g.dD(F))}function e9(e,b,d){var a,c;
if(a=b.cT(d)){c=d.cz(b);
c.eT(1/a);
this.cC(e,c,b)}}function fy(d,b){var e,c,a,f=this;
if(!b){b=f.d6().cc()}e=f.fr();
for(c=0,a=bp(e);
c<a;
c++){e[c].eT(d,b)}f.fx(bg);
fl(f.dD(F))}function fa(c,b){if(!b){b=this.d6()}for(var e=this.fr(),d=0,a=bp(e);
d<a;
d++){e[d].eZ(c,b)}this.fx(bd);
fl(this.dD(F))}function fz(){return 0}function fA(){return ar}function fB(){return this.c9.z}function fC(a){b4(a,this.fD)}function fE(){var b=this,a;
if(b.ep){for(a=bp(b.ep.du)-1;
a>=0;
a--){b.fF(b.ep.du[a])
}for(a=bp(b.ep.d5)-1;
a>=0;
a--){b.fG(b.ep.d5[a])}}else{b.ep=new fH()}b.fI=new fJ(aZ);
b.fI.fK(b.ep);
b.fL=new cd();
b.fL.fM=T}function fN(){var a=this;
return !a.fI||!a.ep||(!a.fI.fO&&!bp(a.ep.d5)&&!bp(a.ep.du))}function fP(){for(var c=this.fI.dD(F),b=0,a=bp(c);
b<a;
b++){c[b].fc();
aZ.fQ.push(c[b].dj)}}function fR(c,a){var b=this;
b.fO=new fS(c,a);
b.fO.dS=T;
b.fI.fT(b.fO);
return b.fO}function fU(a){var b=this.fL.cb(a);
fV(b,a);
bZ(b.du,a.du);
this.ep.fW(b);
return b}function fX(b){var c=b.d0,a=b;
if(!c){c=b;
a=b.fY}fi(c,this.ep.d5);
delete c.d0;
if(a){delete a.fn;
fm(a);
delete a.d0}}function fZ(a){var b=this.fL.cb(a);
fV(b,a);
this.ep.f0(b);
return b}function f1(c,b){for(var a=bp(c)-1;
a>=0;
a--){c[a].dS=b}}function fV(c,a){c.dS=T;
c.fY=a;
var b;
if((b=c.ep)&&a.ep){b.dS=T;
b.fY=a.ep;
if(b=b.f2){b.dS=T;
b.fY=a.ep.f2}}a.d0=c}function f3(b){var c=b.d0,a=b;
if(!c){c=b;
a=b.fY}fi(c,this.ep.du);
delete c.d0;
if(a){delete a.fn;
fm(a);
delete a.d0}}function f4(b){for(var d,c=0,a=bp(b.d5);
c<a;
c++){d=this.fW(b.d5[c]);
d.du=[]}for(c=0,a=bp(b.du);
c<a;
c++){this.f0(b.du[c])}}function f5(c){for(var b=0,a=bp(c.f6);
b<a;
b++){this.fK(c.f6[b])}}function f7(){var a=this;
a.fW=fU;
a.fG=fX;
a.f0=fZ;
a.fF=f3;
a.fK=f4;
a.f8=f5;
a.f9=fR;
a.fc=fP;
a.f_=fE;
a.ga=fN;
a.f_()}function fh(){return(this.fY?this.fY:this)}var gb={H:{an:1,m:1.00794,v:1,gc:T,gd:1.007825,ge:{1:1.007825,2:2.01410177811,3:3.01604928}},D:{an:1,m:2.01410177811,v:1,gd:2.01410177811,iso:T},T:{an:1,m:3.01604928,v:1,gd:3.01604928,iso:T},He:{an:2,m:4.002602,gd:4.002603,ge:{3:3.0160293,4:4.0026032}},Li:{an:3,gf:T,m:6.941,gg:7,gd:7.016005,ge:{5:5.0125378,6:6.0151223,7:7.016004}},Be:{an:4,gf:T,m:9.012182,gg:6,gd:9.012183,ge:{7:7.0169292,9:9.0121821,10:10.0135337}},B:{an:5,m:10.811,v:3,gg:5,gd:11.009305,ge:{10:10.012937,11:11.0093055}},C:{an:6,m:12.011,v:4,gc:T,gd:12,ge:{11:11.0114338,12:12,13:13.0033548,14:14.003242}},N:{an:7,m:14.00674,v:5,gd:14.003074,ge:{13:13.0057386,14:14.003074,15:15.0001089,17:17.0084497}},O:{an:8,m:15.9994,v:6,gd:15.994915,ge:{14:14.0085953,15:15.0030654,16:15.9949146,17:16.9991315,18:17.9991604,19:19.0035787,20:20.0040761,21:21.0086546}},F:{an:9,m:18.9984032,v:7,gd:18.998403,ge:{17:17.0020952,18:18.0009377,19:18.9984032,20:19.9999813,21:20.9999489}},Ne:{an:10,m:20.1797,gd:19.992439,ge:{19:19.0018798,20:19.9924402,21:20.9938467,22:21.9913855,23:22.9944673,24:23.9936151}},Na:{an:11,gf:T,m:22.989768,gg:7,gd:22.98977,ge:{21:20.9976551,22:21.9944368,23:22.9897697,24:23.9909633,25:24.9899544}},Mg:{an:12,gf:T,m:24.305,gg:6,gd:23.985045,ge:{22:21.9995741,23:22.9941248,24:23.9850419,25:24.985837,26:25.982593,27:26.9843407,28:27.9838767}},Al:{an:13,gf:T,m:26.9811539,gg:5,gd:26.981541,ge:{25:24.9904286,26:25.9868917,27:26.9815384,28:27.9819102,29:28.9804448}},Si:{an:14,m:28.0855,v:4,gd:27.976928,ge:{27:26.9867048,28:27.9769265,29:28.9764947,30:29.9737702,31:30.9753633,32:31.9741481}},P:{an:15,m:30.973762,v:5,gd:30.973763,ge:{29:28.9818014,30:29.9783138,31:30.9737615,32:31.9739072,33:32.9717253,34:33.9736364}},S:{an:16,m:32.066,v:6,gd:31.972072,ge:{31:30.9795544,32:31.9720707,33:32.9714585,34:33.9678668,35:34.9690321,36:35.9670809,37:36.9711257,38:37.9711634,39:38.9751353}},Cl:{an:17,m:35.4527,v:7,gd:34.968853,ge:{33:32.9774518,34:33.973762,35:34.9688527,36:35.9683069,37:36.9659026,38:37.9680106,39:38.9680077,40:39.9704156,41:40.9706502}},Ar:{an:18,m:39.948,gd:39.962383,ge:{36:35.9675463,37:36.9667759,38:37.9627322,39:38.9643134,40:39.9623831,41:40.9645008,42:41.9630464,43:42.9656707,44:43.9653653,45:44.968095}},K:{an:19,gf:T,m:39.0983,gg:17,gd:38.963708,ge:{38:37.9690801,39:38.9637069,40:39.9639987,41:40.961826,42:41.9624031,43:42.9607157,44:43.9615561,45:44.9606997,46:45.9619762}},Ca:{an:20,gf:T,m:40.078,gg:16,gd:39.962591,ge:{40:39.9625912,41:40.9622783,42:41.9586183,43:42.9587668,44:43.9554811,45:44.9561859,46:45.9536928,47:46.9545465,48:47.9525335,49:48.9556733}},Sc:{an:21,gf:T,m:44.95591,gg:15,gd:44.955914,ge:{43:42.961151,44:43.959403,45:44.9559102,46:45.9551703,47:46.952408,48:47.952235,49:48.9500241}},Ti:{an:22,gf:T,m:47.867,gg:14,gd:47.947947,ge:{44:43.9596902,45:44.9581243,46:45.9526295,47:46.9517638,48:47.9479471,49:48.9478708,50:49.9447921,51:50.946616,52:51.9468982}},V:{an:23,gf:T,m:50.9415,gg:13,gd:50.943963,ge:{47:46.9549069,48:47.9522545,49:48.9485169,50:49.9471628,51:50.9439637,52:51.9447797,53:52.9443425}},Cr:{an:24,gf:T,m:51.9961,gg:12,gd:51.94051,ge:{48:47.9540359,49:48.9513411,50:49.9460496,51:50.9447718,52:51.9405119,53:52.9406538,54:53.9388849,55:54.9408442,56:55.9406452}},Mn:{an:25,gf:T,m:54.93805,gg:11,gd:54.938046,ge:{51:50.9482155,52:51.9455701,53:52.9412947,54:53.9403632,55:54.9380496,56:55.9389094,57:56.9382875}},Fe:{an:26,gf:T,m:55.845,gg:10,gd:55.934939,ge:{52:51.9481165,53:52.9453123,54:53.9396148,55:54.938298,56:55.9349421,57:56.9353987,58:57.9332805,59:58.9348805,60:59.9340769,61:60.9367495}},Co:{an:27,gf:T,m:58.9332,gg:9,gd:58.933198,ge:{55:54.9420031,56:55.9398439,57:56.9362962,58:57.9357576,59:58.9332002,60:59.9338222,61:60.9324794,62:61.9340542}},Ni:{an:28,gf:T,m:58.6934,gg:10,gd:57.935347,ge:{56:55.9421363,57:56.9398005,58:57.9353479,59:58.9343516,60:59.9307906,61:60.9310604,62:61.9283488,63:62.9296729,64:63.9279696,65:64.930088,66:65.9291152}},Cu:{an:29,gf:T,m:63.546,gg:7,gd:62.929599},Zn:{an:30,gf:T,m:65.39,gg:6,gd:63.929145},Ga:{an:31,m:69.723,gg:5,gd:68.925581},Ge:{an:32,m:72.61,gd:73.921179},As:{an:33,m:74.92159,gd:74.921596},Se:{an:34,m:78.96,gd:79.916521},Br:{an:35,m:79.904,v:7,gd:78.918336},Kr:{an:36,m:83.8,gd:83.911506},Rb:{an:37,gf:T,m:85.4678,gg:17,gd:84.9118},Sr:{an:38,gf:T,m:87.62,gg:16,gd:87.905625},Y:{an:39,gf:T,m:88.90585,gg:15,gd:88.905856},Zr:{an:40,gf:T,m:91.224,gg:14,gd:89.904708},Nb:{an:41,gf:T,m:92.90638,gg:13,gd:92.906378},Mo:{an:42,gf:T,m:95.94,gg:12,gd:97.905405},Tc:{an:43,gf:T,m:97.9072,gg:11},Ru:{an:44,gf:T,m:101.07,gg:10,gd:101.904348},Rh:{an:45,gf:T,m:102.9055,gg:9,gd:102.905503},Pd:{an:46,gf:T,m:106.42,gg:8,gd:105.903475},Ag:{an:47,gf:T,m:107.8682,gg:7,gd:106.905095},Cd:{an:48,gf:T,m:112.411,gg:6,gd:113.903361},In:{an:49,gf:T,m:114.818,gg:5,gd:114.903875},Sn:{an:50,gf:T,m:118.71,gd:119.902199},Sb:{an:51,m:121.76,gd:120.903824},Te:{an:52,m:127.6,gd:129.906229},I:{an:53,m:126.90447,v:7,gd:126.904477},Xe:{an:54,m:131.29,gd:131.904148},Cs:{an:55,gf:T,m:132.90543,gg:17,gd:132.905433},Ba:{an:56,gf:T,m:137.327,gg:16,gd:137.905236},La:{an:57,gf:T,m:138.9055,gg:15,gd:138.906355},Ce:{an:58,gf:T,m:140.115,gg:15,gd:139.905442},Pr:{an:59,gf:T,m:140.90765,gg:15,gd:140.907657},Nd:{an:60,gf:T,m:144.24,gg:15,gd:141.907731},Pm:{an:61,gf:T,m:144.9127,gg:15},Sm:{an:62,gf:T,m:150.36,gg:15,gd:151.919741},Eu:{an:63,gf:T,m:151.965,gg:15,gd:152.921243},Gd:{an:64,gf:T,m:157.25,gg:15,gd:157.924111},Tb:{an:65,gf:T,m:158.92534,gg:15,gd:158.92535},Dy:{an:66,gf:T,m:162.5,gg:15,gd:163.929183},Ho:{an:67,gf:T,m:164.93032,gg:15,gd:164.930332},Er:{an:68,gf:T,m:167.26,gg:15,gd:165.930305},Tm:{an:69,gf:T,m:168.9342,gg:15,gd:168.934225},Yb:{an:70,gf:T,m:173.04,gg:15,gd:173.938873},Lu:{an:71,gf:T,m:174.967,gg:15,gd:174.940785},Hf:{an:72,gf:T,m:178.49,gg:14,gd:179.946561},Ta:{an:73,gf:T,m:180.9479,gg:13,gd:180.948014},W:{an:74,gf:T,m:183.84,gg:12,gd:183.950953},Re:{an:75,gf:T,m:186.207,gg:11,gd:186.955765},Os:{an:76,gf:T,m:190.23,gg:10,gd:191.961487},Ir:{an:77,gf:T,m:192.217,gg:9,gd:192.962942},Pt:{an:78,gf:T,m:195.08,gg:8,gd:194.964785},Au:{an:79,gf:T,m:196.96654,gg:7,gd:196.96656},Hg:{an:80,gf:T,m:200.59,gg:6,gd:201.970632},Tl:{an:81,gf:T,m:204.3833,gg:5,gd:204.97441},Pb:{an:82,gf:T,m:207.2,gg:4,gd:207.976641},Bi:{an:83,gf:T,m:208.98037,gg:3,gd:208.980388},Po:{an:84,gf:T,m:208.9824},At:{an:85,m:209.9871},Rn:{an:86,m:222.0176},Fr:{an:87,gf:T,m:223.0197},Ra:{an:88,gf:T,m:226.0254},Ac:{an:89,gf:T,m:227.0278},Th:{an:90,gf:T,m:232.0381,gd:232.038054},Pa:{an:91,gf:T,m:231.03588},U:{an:92,gf:T,m:238.0289,gd:238.050786},Np:{an:93,gf:T,m:237.0482},Pu:{an:94,gf:T,m:244.0642},Am:{an:95,gf:T,m:243.0614},Cm:{an:96,gf:T,m:247.0703},Bk:{an:97,gf:T,m:247.0703},Cf:{an:98,gf:T,m:251.0796},Es:{an:99,gf:T,m:252.083},Fm:{an:100,gf:T,m:257.0915},Md:{an:101,gf:T,m:256.094},No:{an:102,gf:T,m:259.1009},Lr:{an:103,gf:T,m:262.11},Rf:{an:104,gf:T,m:261.11},Db:{an:105,gf:T,m:268},Sg:{an:106,gf:T,m:271},Bh:{an:107,gf:T,m:270},Hs:{an:108,gf:T,m:277},Mt:{an:109,gf:T,m:276},Ds:{an:110,gf:T,m:281},Rg:{an:111,gf:T,m:272},Cn:{an:112,gf:T},"%":{gh:T},M:{gh:T},X:{gh:T},Ln:{gh:T}},gi=[2,10,18,36,54,86],gj={};

function gk(){if(!this.ep){return -1}return bY(this.ep.d5,this)}function gl(a){return bA(round(a/eC,4,3),10)}function gm(){var e=0,g=this,d=bA("0",3),f=(g.dt!=am?g.dt+1:0),a=g.gn(),b=M.round(bG(g.go)),c=g.gp;
if(g.dr&&c){e=M.round(g.dr-c.m);
if(e<-3||e>4){e=0}}if(!c||a==c.v){a=0}else{if(a==0){a=15}}if(b!=0&&M.abs(b)<4){b=4-b}else{if(b!=4){b=0}}return ao+gl(g.c9.x)+gl(-g.c9.y)+gl(g.c9.z)+S+bC(g.ds,3,S)+bA(e,2)+bA(b,3)+d+bA(f,3)+d+bA(a,3)+bz(d,6)}function gq(a){if(a){a=a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}this.ds=a;
this.gr=am;
this.gp=gb[a]}function gs(b){if(!b){return}var e=0,d,a,g,f;
for(d=0,a=bp(b);
d<a;
d++){g=b.charAt(d);
if(g=="+"){e++}else{if(g=="-"){e--}}}f=bI(b);
if(f===""){return e}return f*e}function gt(b){if(b==H){return 1}if(b){if(b.charAt(0)==H){var a=bm(b.substr(1));
if(!isNaN(a)){return a}}}return am}function gu(j,d){var c=this,f=c.ep,b=f.er,a=j.ep,h=c,e=1,i,g;
if(j.ds=="*"&&bp(j.du)==1&&((i=j.du[0]).dv!=1||i.d8!=0)){e=-1}else{if(bp(c.du)>1||c.ds!=C){h=new gv(gw(c.eo(),1,d));
if(c.dS){h=gx.fW(h)}i=new gy(c,h,1,0);
if(c.dS){i=gx.f0(i)}else{f.fW(h);
f.f0(i)}}else{i=c.du[0]}}a.cu(h.c9.cz(j.c9));
if(i){g=e*eA(i.c8,i.c_)+(i.c_.bS(h)||i.c_.bS(h.fY)||i.c_.bS(j)||i.c_.bS(j.fY)?af:0)-e*(e==1?j:c).gz(1);
a.eU(g*ag,h.c9);
g=f.gA(a.d5,T);
a.e8(M.PI,i.c8.c9.cc(),i.c_.c9);
if(g<f.gA(a.d5,T)){a.e8(M.PI,i.c8.c9.cc(),i.c_.c9)}}if(c.dS){a.er=am;
gx.fK(a);
j=j.d0}else{f.f2.gB(f,a);
if(c.dH){st.gC().fK(a)}}if(e==-1){f.gD(j,h)}else{if(!c.dS){f.gD(h,j)}}f.er=b}function gE(n,a){var b=this,l,g,e,d,k=0,j=0,h,f,m=b.eu;
if(m&&m.type==av){return}if(!a&&(l=gF(n))){if(m){return}b.attachTemplate(l.gG())}else{b.dq=0;
g="";
for(e=0,d=bp(n);
e<d;
e++){h=n.charAt(e);
if(h=="."){k++}else{if(h==":"){j++}else{g+=h}}}if(j==1){b.dq=1}else{if(k>0){b.dq=k+1}}if(f=a_.exec(g)){b.dr=bF(bm(f[1]),0);
b.gH(f[2]);
b.dt=gt(f[3]);
b.go=gs(f[4])}else{if(!!bK("wildcards")){b.gH(g)}}b.fx(bh)}}function gI(b){var c,f,d,a,e;
if(c=this.gp){if(a=this.dr){if((f=c.ge)&&(f=f[a])){return f}e=c.an;
f=a-e;
d=15.67*a-17.23*M.pow(a,2/3)-0.714*e*(e-1)*M.pow(a,-1/3)-23.2875*M.pow(f-e,2)/a;
if(!(a%2)){d+=11.2*M.pow(a,-0.5)*(e%2?-1:1)}return(939.553*f+938.259*e-d)/931.494061}else{return(b?c.gd:c.m)}}}function gJ(b,a){this.gK=a;
this.cO=eA(b,a)}function gL(d,c){if(d.cO<c.cO){return -1}if(d.cO>c.cO){return 1}return 0}function gM(l,o){var k=(o?o.concat():[]),m,f=this.eo(),a=bp(f.du),p,q,c,e,b,d,n,h=0,g;
for(c=0;
c<a;
c++){p=f.du[c];
q=(p.c8.bS(f)?p.c_:p.c8);
k.push(new gJ(f,q))}a=bp(k);
k.sort(gL);
if(l){m=f.c9.cO(l);
for(c=0;
c<a;
c++){b=(c+1)%a;
e=k[c].cO;
d=(k[b].cO+ak)%ak;
if(b==0&&(m<d||e<m)){m=0.5*(e+d+ak);
break}else{if(e<m&&m<d){m=0.5*(e+d);
break}}}}else{for(c=0;
c<a;
c++){b=(c+1)%a;
n=(720+k[b].cO-k[c].cO)%ak;
if(n>h){h=n;
g=c}}m=k[g].cO+0.5*h}return m}function gN(){var c=this.eo(),e,a,b,d=c.c9,f=d.z;
for(b=bp(c.du)-1;
b>=0;
b--){e=c.du[b];
a=(e.c8.bS(c)?e.c_:e.c8);
if(M.abs(a.c9.z-f)>0.05*d.cT(a.c9)){return F}}return T}function gO(b){var e=this,d=bp(e.du),a,c;
if(b){if(d==2){for(c=0;
c<d;
c++){a=e.du[c].gP(e);
if(!a.bS(b)){return a
}}}}else{if(d==1){return e.du[0].gP(e)}}return am}function gQ(g,e){var f,d=this.eo(),c=bp(d.du),h,i,b,a;
if(!c){if(e){f=d.c9.cO(e)}else{f=-30}}else{if(c==1){h=d.du[0];
i=d.gR();
if(g+h.dv==4){f=eA(d,i)+af}else{if(e){f=eA(d,i);
f+=M.round((d.c9.cO(e)-f+720)/60)*60}else{b=i.get1stNeighbour(d);
if(b){a=(eA(i,d,b)+af)%ak}f=eA(d,i)+ae*(a<af?1:-1)}}}else{f=d.gS(e)}}return f}function gT(){for(var b=0,c=0,a=bp(this.du);
c<a;
c++){b+=this.du[c].dv}return b}function gU(b){var c=this,a=(c.ds=="O"&&b.gn()>3);
if(a){if(c.eD()>0){c.gV(-1)}else{if(c.en()<0){c.gV(1)}}if(b.en()<1){b.gV(1)}else{if(b.eD()>0){b.gV(-1)}}}return a}function gW(b){if(b){var c=this,a=c.en();
c.go=a+b;
c.fx(bh);
fm(c)}}function gX(){var b=this,a=$.inArray(b.dq,az);
a++;
a%=bp(az);
b.dq=az[a];
b.fx(bh);
fm(b)}function gY(c,a){var b=this;
if(!a){a=[]}else{if(bX(a,b)){return}}a.push(b);
b.z=am;
if(c>bg){b.gZ=am;
b.g0=am}a.pop()}function g1(){return(this.gr==am&&this.gp?this.gp.v:this.gr)}function g2(a){if(a==am){return ar}var d=this,c=d.gT(),b=bG(d.go);
if(d.dq==1||d.dq==3){c+=2}else{if(d.dq==2){c++}}return(a-b<4?a-c-M.abs(b):8-a-c+b)}function g3(c){for(var b=gi.length-1,a;
b>=0;
b--){if((a=c-gi[b])>0){return a}}}function g4(c){var b=this,a=b.gp;
return(a?(a.v?(a.an>13?2:b.g5(b.gn())+c+(a.an==7?1:0)):M.min(g3(a.an),a.an>13?3:2)):3)}function g6(){var d=this,b=d.gn(),c,a;
if(b==am){d.g0=0;
d.gZ=0}else{a=d.dt;
if(a==am){a=d.gZ=d.g5(b)}if(a<0&&d.gp){d.gZ=0;
c=d.gp.an;
if(c==5){d.g0=a}else{if(c>10){if(a<8-2*b){a=8-2*b-a}else{a%=2}}d.g0=-a}}else{d.g0=0}if(d.gZ>4||d.gZ>b+1){d.gZ=0}}}function g7(){var a=this;
if(a.dt!=am){return a.dt}if(a.gZ==am){a.g8()}return a.gZ}function g9(){var a=this;
if(a.go!=am){return a.go}if(a.g0==am){a.g8()}return a.g0}function g_(b){if(this.fY){return this.fY.cc(b)}if(!b){b=new cd()}var c=this,a=new gv(c.c9.cc());
bT(b,c,a);
a.gH(c.ds);
a.dt=c.dt;
a.d1=c.d1;
a.go=c.go;
a.dq=c.dq;
a.dr=c.dr;
a.gr=c.gr;
a.eu=b.cb(c.eu);
a.dH=c.dH;
a.dS=c.dS;
return a}function ha(){var b=this,a=0;
if(b.ds!=C){a+=2}if(b.dr){a+=3}if(b.dq){a+=3}if(b.go){a+=2}return a}function hb(){if(st.hc||st.hd()){return}var c=this,b,a,d;
gx.f_();
switch(he){case aK:b=gx.fW(c);
b.gE(hf());
gx.fc();
break;
case aL:case aM:if(!hg&&!hh){d=gw(c,hi);
b=gx.fW(c);
a=gx.fW(new gv(d));
gx.f0(new gy(b,a,hi,hj));
a.gE(hf());
gx.fc()}break;
case aT:if(hg){c.ep.fG(c)}break}}function hk(){gx.f_()}function c7(){if(this.eb){return this.eb}if(this.ep){return this.ep.c7()}}function hl(d){if(d){for(var e,b=this.ep,c=0,a=bp(this.du);
c<a;
c++){e=this.du[c];
if((e.c8.bS(d)||e.c_.bS(d))&&(!b||bX(b.du,e))){return e}}}}function hm(){return this.c9}function hn(a){if(!a||!this.d1){return[this.c9]}return[]}function ho(d,c){if(this.bS(d)){return
}if(c){if(bX(c.d5,this)){return c}}else{c=new hp(T)}c.fW(this);
for(var b=0,a=bp(this.du);
b<a;
b++){this.du[b].hq(d,c)}return c}function hr(){if(!this.hs){this.hs=[];
var b=this.ep.d4(),c,a;
for(c=0,a=bp(b);
c<a;
c++){if(bX(b[c].d5,this)){this.hs.push(b[c])}}}return this.hs}function ht(){if(this.z==am){for(var d=this,b=d.c9.z,c=0,a=bp(d.du);
c<a;
c++){b=M.max(d.du[c].dC(),b)}d.z=b+0.000001}return this.z}function gv(b){var a=this;
fg.apply(a);
a.ds=C;
a.du=[];
a.d1=F;
a.dq=0;
a.dr=0;
a.c9=b;
a.dH=F;
a.getCenter=a.d6=hm;
a.fr=hn;
a.hu=hl;
a.d4=hr;
a.attachTemplate=gu;
a.gE=gE;
a.gH=gq;
a.getIndex=gk;
a.gS=gM;
a.hv=gN;
a.get1stNeighbour=gO;
a.gR=gO;
a.gz=gQ;
a.gn=g1;
a.g5=g2;
a.gT=gT;
a.hw=g4;
a.gV=gW;
a.hx=gU;
a.hy=gX;
a.fx=gY;
a.g8=g6;
a.eD=g7;
a.en=g9;
a.hz=gI;
a.hA=ha;
a.hq=ho;
a.getMolecule=hB;
a.hC=gm;
a.fc=em;
a.dC=ht;
a.cc=g_;
a.c7=c7;
a.hD=hb;
a.hE=hk}function hF(d){if(!d){d=new cd()}var e=this,b=new e.constructor(),c,a;
bT(d,e,b);
for(c=0,a=bp(e.du);
c<a;
c++){e.du[c].cc(d)}for(c=0,a=bp(e.hG);
c<a;
c++){e.hG[c].cc(d)}for(c=0,a=bp(e.d5);
c<a;
c++){b.fW(d.cb(e.d5[c]),T)}for(c=0,a=bp(e.hH);
c<a;
c++){b.hI(d.cb(e.hH[c]),T)}for(c=0,a=bp(e.du);
c<a;
c++){b.f0(d.cb(e.du[c]),T)}for(c=0,a=bp(e.hG);
c<a;
c++){b.hJ(d.cb(e.hG[c]),T)}b.ds=e.ds;
b.hK=e.hK;
if(e.eP){for(c=0,a=bp(e.eP);
c<a;
c++){b.eP.push(e.eP[c].cc())}}b.hL=e.hL;
b.eM=e.eM;
return b}function hM(d){for(var c=this,b=0,a=bp(c.d5);
b<a;
b++){c.d5[b].d1=d}for(b=0,a=bp(c.du);
b<a;
b++){c.du[b].d1=d}for(b=0,a=bp(c.hG);
b<a;
b++){c.hG[b].d1=am}c.eM=!d;
fl(c.d5);
fl(c.du);
fl(c.hG)}function hN(){for(var d=this,c,b=0,a=bp(d.d5);
b<a;
b++){d.d5[b].d1=T}for(b=0,a=bp(d.hH);
b<a;
b++){d.hH[b].d1=am}for(b=0,a=bp(d.du);
b<a;
b++){c=d.du[b];
c.d1=(c.c8.d1||c.c_.d1)&&!d.hO(c)}d.eM=F;
fl(d.d5);
fl(d.du);
fl(d.hG)}function hP(){for(var c=this,b=0,a=bp(c.d5);
b<a;
b++){c.d5[b].d1=am}for(b=0,a=bp(c.du);
b<a;
b++){c.du[b].d1=am}c.eM=am;
fl(c.d5);
fl(c.du);
fl(c.hG)}function hQ(b){var a=b_(this.d5,b);
if(a){b.eu=this}return a}function hR(a){if(this.type!=aw){return b_(this.hH,a)}return F}function hS(a){return bX(this.hG,a)}function hT(b){if(bX(this.hG,b)){return F}var a=b_(this.du,b);
if(a){b.eu=this}return a}function hU(c,b,a,d){if(bX(a,c[b].c8)){d[2*b]=c[b].c8;
d[2*b+1]=c[b].c_}else{d[2*b]=c[b].c_;
d[2*b+1]=c[b].c8}}function createGroup(){var d=st.gC(),b,c,a;
if(!d.hV){return}a=d.d5[0].ep;
hW(T);
if(bp(d.hG)<=1){c=prompt(s("supaQ"),"")
}else{c=prompt(s("multQ"),"")}hW(F);
if(c==null){return}hX();
b=a.hY(c,d.d5,d.du,d.hG);
d.hZ(b);
b.fc();
h0();
return b}function h1(c){for(var e,f,g,b,d=0,a=bp(this.eP);
d<a;
d++){g=this.eP[d].dR;
b=g.x+c*g.y;
if(e==am||b>f){e=g;
f=b}g=this.eP[d].dQ;
b=g.x+c*g.y;
if(b>f){e=g;
f=b}}return e}function h2(a){var d=a.d6(),h=d.cc(),g=d.cc(),f=a.c8.c9,e=a.c_.c9,c=h3*(e.x-f.x),b=h3*(e.y-f.y);
h.cu(b,-c);
g.cu(-b,c);
this.eP.push(new h4(h,g))}function h5(){this.eP=[];
for(var b=0,a=bp(this.hG);
b<a;
b++){this.h6(this.hG[b])}}function h7(b){if($.isArray(b)){for(var c=0,a=bp(b);
c<a;
c++){this.hJ(b[c])}}else{if(this.type!=av){if(bX(this.d5,b.c8)){this.hI(b.c8)}else{if(bX(this.d5,b.c_)){this.hI(b.c_)}}}b4(b,this.du);
b_(this.hG,b)}}function h8(d){var e=this,b=[],c=0,a=bp(e.hH);
if(d&&!e.eM&&a){for(;
c<a;
c++){b.push(e.hH[c].c9)}}else{for(a=bp(e.d5);
c<a;
c++){b.push(e.d5[c].c9)}}if(e.eP){for(c=0,a=bp(e.eP);
c<a;
c++){b.push(e.eP[c].dR,e.eP[c].dQ)}}b0(b,e.fw);
return b}function h9(){var a=this;
if(!a.dd||!a.db){fq.apply(a);
a.dd.x-=h_;
a.dd.y-=h_;
a.db.x+=h_;
a.db.y+=h_}}function ia(){if(st.hd()){return}switch(he){case aT:if(hg){this.ep.ib(this);
break}}}function eN(c,a,d,b){if(!b){b=this.data(as)}hX();
b.ic(b.eM);
b.ep.fx(bg);
eF=am;
ie(aZ);
ig(T);
b.fc();
h0();
return bo(c)}function ih(h){var c=this,g=c.ep,b=bH(c.ds),f,i,l,j,d=st.gC(),a,k;
hW(T);
if(c.type==au){b=prompt(s("supaQ"),b)}else{b=prompt(s("multQ"),b)}hW(F);
if(b==null){return}k=bm(b);
hX();
if(c.type==av||(c.type==aw&&k<ii&&k>1)){if(c.type==av){f=c.hH.concat()}else{f=c.d5.concat()}i=c.du.concat();
l=c.hG.concat();
if(j=c.dH){d.ib(c)}c.ij(l,i);
a=g.hY(b,f,i,l);
if(j){d.hZ(a)}a.fc()}else{c.ds=b;
c.hK=k;
c.fc()}h0()}function eJ(c,a,d,b){if(!b){b=this.data(as)}hX();
b.ij();
h0();
return bo(c)}function eL(){}function ik(j,b,g){var e=j[bp(j)-1],d=0,c=bp(e.du),h,f,a;
for(;
d<c;
d++){h=e.du[d];
f=(h.c8.bS(e)?h.c_:h.c8);
if(bX(j,f)){continue}if(h.bS(b)){return h}if(bX(g,f)){j.push(f);
a=ik(j,b,g);
if(a){return a}j.pop()}}}function il(p,m){var c=this,k=c.ep,o,n,h,f,e,b,g,a,d=st.gC(),l;
if(c.type==av){o=c.hH;
n=b8(c.d5,o);
if(!p){p=c.hG.concat()}if((b=bp(p))==2){for(e=0;
e<b;
e++){for(h=0,f=bp(o);
h<f;
h++){a=o[h];
g=ik([a],p[e],n);
if(!g){continue}l=g.dH;
k.fF(g,T);
if(bX(n,g.c8)){g.c8=a}else{g.c_=a}a.du.push(g);
g.eu=am;
k.f0(g);
if(m){m.push(g)}if(l){d.f0(g)}}}for(h=0,f=bp(n);
h<f;
h++){k.fG(n[h],T)}}}if(c.bS(eF)){eF=am;
ie(aZ)}c.dw();
while(bp(c.d5)){g=c.d5.pop();
g.eu=am;
g.d1=am;
fm(g)}while(bp(c.du)){g=c.du.pop();
g.eu=am;
g.d1=am;
fm(g)}c.hH=[];
fi(c,c.im.io);
fi(c,k.io);
d.ib(c);
if(m){b1(m,k.du);
b2(m,p)}}function ip(){if(!this.ep){return -1}return bY(this.ep.io,this)}function iq(b){for(var a=bp(b)-1;
a>=0;
a--){b[a]=bn(b[a])}this.eP.push(new h4(new cj(b[0],-b[1]),new cj(b[2],-b[3])))
}function ir(){if(!this.it){var b=new cj(),d,c,a=bp(this.eP);
if(a>1){for(c=0;
c<a;
c++){d=this.eP[c];
b.cu(d.dR);
b.cu(d.dQ)}b.x/=a*2;
b.y/=a*2}this.it=b}return this.it}function iu(){return new h4(this.dR.cc(),this.dQ.cc())}function h4(b,a){this.dR=b;
this.dQ=a;
this.cc=iu}function iv(e,b){if(!b){b=[]}else{if(bX(b,this)){return}}b.push(this);
var d=this,c,a;
if(e==bg){d.fw=am;
d.it=am}if(e>bd&&e<bh){d.dd=am;
d.db=am;
for(c=0,a=bp(d.hG);
c<a;
c++){d.hG[c].fx(bg,b)}d.iw()}if(e!=bd){e=bg}for(c=0,a=bp(d.d5);
c<a;
c++){d.d5[c].fx(e,b)}for(c=0,a=bp(d.du);
c<a;
c++){d.du[c].fx(e,b)}b.pop()}function ix(){var a=this;
fg.apply(a);
a.d5=[];
a.hH=[];
a.du=[];
a.hG=[];
a.iy=0;
a.getIndex=ip;
a.fx=iv;
a.ij=il;
a.fW=hQ;
a.hI=hR;
a.hO=hS;
a.f0=hT;
a.hJ=h7;
a.d6=fb;
a.d3=h9;
a.fr=h8;
a.cc=hF;
a.c7=c7;
a.hD=ia;
a.hE=eL;
a.eS=ih;
a.fc=eE;
a.dC=fA}function iz(){ix.apply(this);
this.type=au;
this.iw=iA;
this.ic=hM}function iB(){var a=this;
ix.apply(a);
a.type=av;
a.eP=[];
a.eR=h1;
a.iC=iq;
a.h6=h2;
a.iw=h5;
a.eO=ir;
a.ic=hN}function iD(){iB.apply(this);
this.type=aw;
this.ic=hP}function iE(e){if(this.fY){return this.fY.cc(e)}if(!e){e=new cd()}var f=this,d,c,a,b;
if(e.fM){if(d=f.c8.d0){c=d}if(d=f.c_.d0){a=d}}if(!c){c=e.cb(f.c8)}if(!a){a=e.cb(f.c_)}b=new gy(c,a,f.dv,f.d8);
bT(e,f,b);
b.d1=f.d1;
b.eu=e.cb(f.eu);
b.dH=f.dH;
return b}function iF(){if(!this.fw){this.fw=cA(this.c8.c9,this.c_.c9)}return this.fw}function iG(f,c){if(!c){c=[]}else{if(bX(c,this)){return}}c.push(this);
if(f==bg){this.fw=am}if(f<bh){var b=this.ep,d,a,e;
if(b){for(d=0,a=bp(b.io);
d<a;
d++){e=b.io[d];
if(bX(e.hG,this)){e.fx(bg,c)}}}}c.pop()}function iH(){var b=this,a=b.dv;
a=(bs(ba,a)||a);
if(!b.c8||!b.c_||b.c8.bS(b.c_)){return""}return ao+bA(b.c8.getIndex()+1,3)+bA(b.c_.getIndex()+1,3)+bA(a,3)+bA(b.d8,3)+bz(bA("0",3),3)}function iI(){if(!this.hs){var d=this,c,b,a;
if(!d.c8.im){d.ep.iJ(T)}c=d.c8.im.d4();
d.hs=[];
for(b=0,a=bp(c);
b<a;
b++){if(bX(c[b].du,d)){d.hs.push(c[b])}}}return this.hs}function iK(){var a=0;
if(this.d8){a+=4}switch(this.dv){case 2:a+=2;
break;
case 3:a--;
break}return a}function iL(b){for(var d,c=0,a=bp(b.du);
c<a;
c++){d=b.du[c];
if(d.dv==1){d.dv=2}else{d.dv=1}fm(d)}}function iM(){if(this.dv>2){return}var k=this.d4(),l,h=[],d,a,g,f,e,c,b;
for(g=0,f=bp(k);
g<f;
g++){d=k[g];
a=bp(d.du);
if(a%4==2){l=F;
for(e=1;
e<a;
e++){b=d.du[e].dv;
c=d.du[e-1].dv;
if(c+b!=3||c<1||c>2||b<1||b>2){l=T;
break}}if(!l){h.push(d)}}}if(!bp(h)){return}d=h[0];
a=bp(d.du);
for(g=1,f=bp(h);
g<f;
g++){if(bp(h[g].du)<a){d=h[g];
a=bp(d.du)}}return d}function iN(e,d){if(d){var a=3*ey,c=e.cT(d.c8.c9,T),b=e.cT(d.c_.c9,T);

if(c<a&&c<b){return d.c8}else{if(b<a){return d.c_}}}return am}function iO(d){var e=this,c=e.c8,a=e.c_,b;
if(e.eu&&e.eu.type==av){return}if(hj!=0&&hj==e.d8){e.c8=a;
e.c_=c}else{if(hj!=0||hi!=1){e.dv=hi;
e.d8=hj}else{if(e.d8!=0){e.d8=0}else{b=e.dv;
e.dv=bG(M.floor(b)%M.min(3,c.hw(b),a.hw(b)))+1;
if(b==1&&e.dv==1){c.hx(a)||a.hx(c)}}}}c.fx(bh);
a.fx(bh);
if(!d){fm(e);
fm(c);
fm(a)}}function iP(){if(!this.ep){return -1}return bY(this.ep.du,this)}function iQ(a){if(!a||!this.d1){return[this.c8.c9,this.c_.c9]}return[]}function iR(b,a){if(a){if(bX(a.du,this)){return a}}else{a=new hp(T)}a.f0(this);
this.c8.hq(b,a);
this.c_.hq(b,a);
return a}function iS(){var b=this,a=b.ep;
if(b.c8.fY){a=b.c8.fY.ep}else{if(b.fY){a=b.fY.ep}}return a}function iT(){return bq(this.c8.c9.z,this.c_.c9.z)}function iU(a){var b=this;
return(b.c8.bS(a)?b.c_:b.c8)}function iV(){return this.c_.c9.cz(this.c8.c9)}function iW(a){return this.c8.bS(a)||this.c_.bS(a)}function gy(c,b,a,d){var e=this;
fg.apply(e);
e.c8=c;
e.c_=b;
e.dv=a;
e.d8=d;
e.dH=F;
e.getIndex=iP;
e.fx=iG;
e.iX=iO;
e.d6=iF;
e.fr=iQ;
e.d4=iI;
e.iY=iM;
e.iZ=iL;
e.i0=iW;
e.hA=iK;
e.hq=iR;
e.getMolecule=hB;
e.hC=iH;
e.fc=dZ;
e.dC=iT;
e.cc=iE;
e.gP=iU;
e.i1=iV;
e.c7=c7;
e.eo=fh;
e.da=iS;
e.d7=c6}function i2(g){g.sort(i3);
for(var b=[],d,c=[],e,f=0,a=bp(g);
f<a;
f++){e=g[f];
d=e.d5;
if(!i4(d)&&!b6(c,d)){b.push(e);
b9(c,d)}}return b}function i4(b){for(var d,c=0,a=bp(b);
c<a;
c++){d=b[c];
if(d.gp&&d.gp.gf){return T}}return F}function i3(e,c){var f=(e.d5?bp(e.d5):0),d=(c.d5?bp(c.d5):0);
if(f<d){return -1}if(f>d){return 1}return 0}function i5(e,c){var d=bp(e.d4()),f=bp(c.d4()),g,h;
if(d<f){return 1}if(d>f){return -1}g=bp(e.du),h=bp(c.du);
if(g<h){return 1}if(g>h){return -1}return 0}function i6(c){var e=this.d5,b=[],d,a,f;
if(c){bZ(b,this.du);
bZ(b,e)}else{for(d=0,a=bp(e);
d<a;
d++){f=e[d];
b.push(f);
b9(b,f.du);
b_(b,f.eu)}}return b}function i7(){if(!this.i8){for(var e=this,c=e.d6(),d=e.d5,b=bp(d)-1,a=d[0].c9.cz(c).cq(d[b].c9.cz(c));
b>0;
b--){a.cu(d[b].c9.cz(c).cq(d[b-1].c9.cz(c)))}if(c.e0(a.cM(c),d[0].c9,d[1].c9)>0){a.eT(-1)}e.i9=(e.i8=a.cB()).cc();
e.i9.cu(c)}}function i_(a){var b=this;
b.ja();
return ad-b.fw.cr(a.c9,b.i9)}function jb(){for(var d=0,e=this.du,b=bp(e),a,c=e[b-1].dv;
d<b;
d++){a=e[d].dv;
if(a==3||(a==2&&c==2)){return T}c=a}}function jc(){for(var b=0,c=this.du,a=bp(c);
b<a;
b++){if(c[b].dv!=1){return F}}return T}function jd(){if(!this.fw){var b=new cj(),e=this.d5,d=0,c,a;
for(c=0,a=bp(e);
c<a;
c++){b.cu(e[c].c9);
d++}if(d>1){b.x/=d;
b.y/=d;
b.z/=d}this.fw=b}return this.fw}function je(e){var c=this,b=[],d=[],h,k,g,f,a;
for(k=0,g=bp(c.d5);
k<g;
k++){h=c.d5[k];

if(!e||!h.d1){b.push(h.c9)}b_(d,h.eu)}for(k=0,g=bp(d);
k<g;
k++){h=d[k];
if(h.eP){for(f=0,a=bp(h.eP);
f<a;
f++){b.push(h.eP[f].dR,h.eP[f].dQ)}}if(!e){b0(b,h.fw);
b0(b,h.dd);
b0(b,h.db)}}if(!e){b0(b,c.fw);
b0(b,c.dd);
b0(b,c.db)}return b}function jf(f){if(!(f instanceof jg)){return F}var k=this.d5,a=bp(k),g,e,h,d,c,b;
if(a!=bp(f.d5)){return F}g=bY(f.d5,k[0]);
if(g==-1){return F}e=bY(f.d5,k[1]);
if(e==-1){return F}h=e-g;
if(M.abs(h)==a-1){h=-1}if(M.abs(h)!=1){return F}for(d=2,c=a;
d<c;
d++){b=(c+d*h+g)%c;
if(!k[d].bS(f.d5[b])){return F}}return T}function jh(d,b){if(!b){b=[]}else{if(bX(b,this)){return}}if(d!=bf){b.push(this);
this.i8=am;
if(d==bg){this.fw=am}if(d!=bd){d=bg}for(var c=0,a=bp(this.d5);
c<a;
c++){this.d5[c].fx(d,b)}for(c=0,a=bp(this.du);
c<a;
c++){this.du[c].fx(d,b)}b.pop()}}function ji(){var a=this.d5,b=a.concat(),c;
b.sort(i5);
c=bY(a,b[0]);
b5(a,c);
if(bY(b,a[1])>bY(b,a[bp(b)-1])){a.reverse();
b5(a,-1)}}function jg(a,c){var b=this;
b.bQ=bL();
b.d5=a;
b.du=c;
b.jj=ji;
b.dD=i6;
b.fx=jh;
b.d6=jd;
b.ja=i7;
b.jk=i_;
b.jl=jb;
b.jm=jc;
b.fr=je;
b.bS=jf}function jn(b){var a=b_(this.d5,b);
if(a){b.im=this}return a}function jo(a){return b_(this.du,a)}function jp(){for(var b=[],c=0,a=bp(this.d5);
c<a;
c++){b.push(this.d5[c].c9.cc())}return b}function jq(c){var b=0,a=bp(this.d5);
if(bp(c)!=a){alert("Error")}for(;
b<a;
b++){this.d5[b].c9=c[b].cc()}}function jr(g,e,j){var a=bp(e),c=e[a-1],l,f,k,d,b,h;
if(a<=js){for(d=0,b=bp(c.du);
d<b;
d++){l=c.du[d];
f=(c.bS(l.c8)?l.c_:l.c8);
if(a>=2&&f.bS(e[a-2])){continue}h=-1;
j[a-1]=l;
if(a>=2){h=bY(e,f)}if(h==-1){e[a]=f;
jr(g,e,j);
e.length=a}else{k=new jg(e.slice(h),j.slice(h));
b_(g,k)}}}j.length=a-1;
return g}function jt(){var c=this;
if(!c.hs){c.hs=[];
for(var c=this,b=0,a=bp(c.du);
b<a;
b++){c.du[b].hs=am}if(bp(c.d5)){jr(c.hs,[c.d5[0]],[])}}return c.hs}function ju(){var a=this;
e4.apply(a);
a.d5=[];
a.io=[];
a.du=[];
a.fx=jv;
a.d4=jt;
a.dD=jw;
a.fr=jx;
a.eT=jy;
a.d3=fq;
a.gA=jz;
a.cB=jA;
a.jB=jC;
a.fW=jn;
a.f0=jo;
a.jD=jp;
a.jE=jq}function jF(t,n,b,h,f,k){if(f){n=f.c9}if(k){b=k.c9}if(!n||!b){return F}var a=eC*1.4,u=b.cT(n),o=M.min(M.round(u/a/M.cos(jG*ag)),jH),d,g=jG,l=[],j=[],r,q,c,m,p;
if(o<=0){return F}d=n.cO(b);
if(k){if(o>1){g=M.acos(bJ(u/o/a,-0.9,0.9))/ag}}gx.f_();
if(o==1){if(f&&(c=f.hu(k))){if(!h){c=gx.f0(c)}c.iX();
gx.fc();
return T}else{d+=g}}else{if(o%2){d+=g/(o-1)}}l[0]=M.cos((d-g)*ag);
l[1]=M.cos((d+g)*ag);
j[0]=M.sin((d-g)*ag);
j[1]=M.sin((d+g)*ag);
if(k){o--}if(h){m=st.gC();
if(!t.ctrlKey){m.jI()}if(f){r=f;
h=f.ep}else{r=new gv(n.cc());
h.fW(r);
m.fW(r)}}else{if(f){r=gx.fW(f)}else{r=gx.fW(new gv(n.cc()))}aZ.jJ.push(aZ.text(b.x,b.y+30/eG,o+(f?0:1)).attr(aA,2+20/eG))}if(!f){r.gE(hf(),T)}for(p=0;
p<o;
p++){q=r.cc();
if(p==0){q.gE(hf(),T)
}q.c9.x+=a*l[p%2];
q.c9.y+=a*j[p%2];
if(!h){q=gx.fW(q)}c=new gy(r,q,1,0);
if(h){h.fW(q);
h.f0(c);
m.f0(c);
m.fW(q)}else{c=gx.f0(c)}r=q}if(k){if(h){c=h.f2.jK(r,k,1,0);
m.f0(c)}else{q=gx.fW(k);
c=gx.f0(new gy(r,q,1,0))}}gx.fc();
return T}function jL(d){if(!d){d=new cd()}var e=this,b=new fH(),c,a;
bT(d,e,b);
b.jM=2;
for(c=0,a=bp(e.io);
c<a;
c++){b.hZ(d.cb(e.io[c]),T)}for(c=0,a=bp(e.du);
c<a;
c++){b.f0(d.cb(e.du[c]),T)}for(c=0,a=bp(e.d5);
c<a;
c++){b.fW(d.cb(e.d5[c]),T)}b.er=d.cb(e.er);
b.jM=1;
b.iJ();
return b}function jv(e,b){if(!b){b=[]}else{if(bX(b,this)){return}}var d=this,c,a;
b.push(d);
if(e>be){d.fw=am;
d.fD=am}if(e>bd&&e<bh){d.dd=am;
d.db=am}if(e!=bf){if(e!=bd){e=bg}for(c=0,a=bp(d.d5);
c<a;
c++){d.d5[c].fx(e,b)}for(c=0,a=bp(d.du);
c<a;
c++){d.du[c].fx(e,b)}if(d.io){for(c=0,a=bp(d.io);
c<a;
c++){d.io[c].fx(e,b)}}if(d.jN){for(c=0,a=bp(d.jN);
c<a;
c++){d.jN[c].fx(e,b)}}if(d.hs){for(c=0,a=bp(d.hs);
c<a;
c++){d.hs[c].fx(e,b)}}}if(d.f2){d.f2.fx(e,b)}else{if(d.ep){d.ep.fx(e,b)}}b.pop()}function jO(f){if(!bp(this.d5)){return}this.d3();
if(f.x>this.dd.x&&f.x<this.db.x){var e=this,c=new jP(e),d,a,b;
if(!e.jN){e.iJ()}if(bp(e.d5)<2){return}for(d=0,a=bp(e.jN);
d<a;
d++){b=e.jN[d];
b.d3();
if(0.5*(b.dd.x+b.db.x)>f.x){c.jQ.push(b)}else{c.jR.push(b)}}return c}}function jy(d,b){if(b){b=this.d6()}for(var e=this.fr(),c=0,a=bp(e);
c<a;
c++){e[c].eT(d,b)}}function jA(){if(bp(this.d5)>1){var h=this,e=0,g=0,d,a,c,f,b;
if(a=bp(h.du)){for(d=0;
d<a;
d++){f=h.du[d];
e+=f.c8.c9.cT(f.c_.c9);
g++}}else{for(d=0,a=bp(h.d5);
d<a;
d++){b=h.d5[d];
for(c=0;
c<d;
c++){e+=b.c9.cT(h.d5[c].c9);
g++}}}if(e>0){h.eT(dc*g/e)}}this.d3()}function jS(c,d){var b=c-this.dd.x,a=bG(d)-0.5*(this.dd.y+this.db.y);
this.cu(b,a)}function jT(d,b){var e=this,c,a;
if(e.bS(d)){return}for(c=0,a=bp(d.d5);
c<a;
c++){e.fW(d.d5[c])}for(c=0,a=bp(d.du);
c<a;
c++){e.f0(d.du[c])}for(c=0,a=bp(d.io);
c<a;
c++){e.hZ(d.io[c])}if(e.hs&&d.hs){bZ(e.hs,d.hs)}else{e.jU()}e.iJ();
if(b||eq=="tmpl"){e.er=d.er}e.fx(bg)}function jV(c,b){var d=this,a;
if(b_(d.d5,c)){c.ep=d;
c.d2=am;
c.fn=am;
if(!b){fm(c);
a=d.jW();
a.fx(bf);
if(a.fY){a.fY.fx(bf)}}return T}return F}function jX(h,c,g,m){var u=this,l,p,n,o,t,d,f,e=[],k=[],a=[],q=[],b,r=bp(m);
if(r<=1){l=new iz();
if(r){l.hI(m[0].c8.dH?m[0].c8:m[0].c_)}}else{if((n=bm(h))<ii&&n>1){l=new iB();
u.fF(m[0],T);
u.fF(m[1],T);
bZ(e,c);
bZ(k,g);
b2(k,m);
hU(m,0,e,a);
hU(m,1,e,a);
for(p=0;
p<n;
p++){if(p>0){b=new cd();
q[p]=b}for(o=0,t=bp(k);
o<t;
o++){d=k[o];
if(p==0){l.f0(d);
b_(e,d.c8);
b_(e,d.c_)}else{f=b.cb(d);
l.f0(f);
u.f0(f,T)}}for(o=0,t=bp(e);
o<t;
o++){d=e[o];
if(p==0){l.fW(d);
l.hI(d)}else{f=b.cb(d);
l.fW(f);
u.fW(f,T)}}}for(p=0;
p<=n;
p++){if(p==0){f=new gy(a[1],a[0],m[0].dv,m[0].d8);
m[0]=f}else{if(p==n){f=new gy(q[p-1].cb(a[2]),a[3],m[1].dv,m[1].d8);
m[1]=f}else{if(p==1){f=new gy(a[2],q[p].cb(a[0]),m[1].dv,0)}else{f=new gy(q[p-1].cb(a[2]),q[p].cb(a[0]),m[1].dv,0)
}}}l.f0(f);
u.f0(f,T)}}else{l=new iD();
if(n){l.hL=""}else{l.hL="HT"}}}l.hJ(m);
if(l.type!=av){for(o=0,t=bp(g);
o<t;
o++){l.f0(g[o])}for(o=0,t=bp(c);
o<t;
o++){l.fW(c[o])}}l.ds=h;
l.hK=n;
l.iw();
u.hZ(l);
l.ic(T);
return l}function jY(c,b){if(b_(this.io,c)){c.ep=this;
var a;
if(c.d5[0]&&(a=c.d5[0].im)){c.im=a;
b_(a.io,c)}c.d2=am;
c.fn=am;
if(!b){fm(c)}return T}return F}function jZ(d,c){if(d.bS(c)){return}fm(c);
this.fx(bh);
if(bX(this.d5,c)){fi(d,this.d5)}else{b3(this.d5,d,c);
fi(d)}var f=this,a,e,b;
for(a=bp(d.du)-1;
a>=0;
a--){e=d.du[a];
fm(e);
if(e.c8.bS(d)){e.c8=c;
fm(e.c_)}else{if(e.c_.bS(d)){e.c_=c;
fm(e.c8)}}b_(c.du,e)}c.fx(bh);
if(!d.dS){b=st.gC();
b3(b.d5,d,c);
c.dH=d.dH}if(d.bS(f.er)){f.er=c}f.jU();
f.iJ();
if(d.bS(et)||c.bS(et)){ig()}}function j0(d,h){var g=this,b,f,c=st.gC(),e,a=d.im;
g.fx(bg);
fi(d,g.d5);
for(b=bp(d.du)-1;
b>=0;
b--){f=d.du[b];
if(f){g.fF(f,h)}}g.j1(d);
b4(d,c.d5);
if(d.bS(g.er)){g.er=am}if(g){if(a){b4(d,a.d5);
if(!bp(a.d5)){fi(a,g.jN)}}if(!bp(g.d5)&&(e=g.f2)){e.j2(g)}}if(d.bS(et)){et=am;
ig()}}function j3(d){var e=this;
e.fx(bg);
d.dw();
fi(d,e.io);
var a,c,b=st.gC();
for(a=bp(d.du)-1;
a>=0;
a--){c=d.du[a];
if(c){e.fF(c)}}for(a=bp(d.d5)-1;
a>=0;
a--){c=d.d5[a];
if(c){e.fG(c)}}e.j1(d);
b4(d,b.io);
if(d.bS(eF)){eF=am;
ig()}}function j4(e,d){var f=this,b=e.c8,a=e.c_,c;
if(!b||!a){return F}if(b_(f.du,e)){e.ep=f;
e.d2=am;
e.fn=am;
b_(e.c8.du,e);
b_(e.c_.du,e);
if(f.jM==1){c=e.c8.im;
if(!c){if(!e.c_.im){f.iJ()}else{c=e.c_.im;
e.im=c;
e.c8.im=c;
b_(c.du,e);
b_(c.d5,e.c8)}}else{if(!e.c_.im){e.im=c;
e.c_.im=c;
b_(c.du,e);
b_(c.d5,e.c_)}else{if(!c.bS(e.c_.im)){f.iJ()}else{f.jU();
b_(c.du,e)}}}}e.c8.fx(bh);
e.c_.fx(bh);
if(!d){fl(e.c8.du);
fl(e.c_.du);
fm(e.c8);
fm(e.c_)}return T}return F}function j5(c,b){if(bX(this.du,b)){fi(c,this.du)}else{b3(this.du,c,b);
fi(c)}if(bX(c.c8.du,b)){b4(c,c.c8.du)}else{b3(c.c8.du,c,b)}if(bX(c.c_.du,b)){b4(c,c.c_.du)}else{b3(c.c_.du,c,b)}fm(b);
c.c8.fx(bh);
c.c_.fx(bh);
fm(c.c8);
fm(c.c_);
fl(c.c8.du);
fl(c.c_.du);
this.fx(bh);
var a=st.gC();
b3(a.du,c,b);
b.dH=c.dH;
this.jU();
this.iJ()}function j6(){for(var c=this,b=0,a=bp(c.du);
b<a;
b++){c.du[b].hs=am}for(b=0,a=bp(c.d5);
b<a;
b++){c.d5[b].hs=am}if(c.jN){for(b=0,a=bp(c.jN);
b<a;
b++){c.jN[b].hs=am}}c.hs=am}function j7(f,h){var g=this,d=st.gC(),c,a,e,b=f.c8.im;
if(!b){b=f.c_.im}fi(f,g.du);
b4(f,f.c8.du);
b4(f,f.c_.du);
f.c8.fx(bh);
f.c_.fx(bh);
fm(f.c8);
fm(f.c_);
fl(f.c8.du);
fl(f.c_.du);
g.fx(bg);
if(h){if(b){b4(f,b.du)}}else{g.iJ();
g.jU()}g.j1(f);
d.fF(f);
for(c=0,a=bp(g.io);
c<a;
c++){e=g.io[c];
if(bX(e.hG,f)){if(e.type!=au){b4(f,e.hG)
}else{e.ij()}}}}function j8(e,b){e.im=b;
b.d5.push(e);
if(b_(b.io,e.eu)){e.eu.im=b}var c,a,d;
for(c=0,a=bp(e.du);
c<a;
c++){d=e.du[c];
b_(b.du,d);
if(!d.c8.im){j8(d.c8,b)}else{if(!d.c_.im){j8(d.c_,b)}}}}function j9(d){if(d||gx.ga()){var e=this;
e.jN=[];
for(var b,c=0,a=bp(e.d5);
c<a;
c++){e.d5[c].im=am}for(c=0,a=bp(e.d5);
c<a;
c++){if(!e.d5[c].im){b=new ju();
e.jN.push(b);
b.ep=e;
j8(e.d5[c],b)}}}}function eA(b,a,c){if(c){return b.c9.cO(a.c9,c.c9)}else{return b.c9.cO(a.c9)}}function j_(b,a,c){if(c){return b.c9.cr(a.c9,c.c9)}else{return b.c9.cr(a.c9)}}function gw(l,q,n,m){var o,b=eC*1.4,c,d,r,p=[],h,g,f,a=3*ka,k=l.c9;
if(n){n.z=k.z}if(n&&m&&m.ctrlKey){if(m.shiftKey){return n}o=k.cO(n);
c=c2(k,o,b)}else{if(n&&m&&m.shiftKey){b=k.cT(n)}if(n!==F&&!hj&&(f=bp(l.du))>1&&f<4&&q==1){for(h=0;
h<f;
h++){g=l.du[h];
if(g.dv>1){h=f+1;
break}r=g.gP(l);
for(g=h+1;
g<f;
g++){if(M.abs(aj-k.cr(r.c9,l.du[g].gP(l).c9))>6){h=f+1;
break}}}if(h==f){h=l.du[0].gP(l).c9;
g=l.du[1].gP(l).c9;
c=k.eX(h,g,b,0.5*aj);
r=k.eX(h,g,b,-0.5*aj);
f=l.ep;
if(n){h=n.cT(c);
g=n.cT(r)}else{h=f.gA(c);
g=f.gA(r)}if(g<h||(g==h&&k.eY(r)>k.eY(c))){c=r}f.kb(l,c)}}if(!c){o=l.gz(q,n);
do{c=c2(k,o,b);
d=l.ep.f2.kc(c,a,a);
if(!d||!bp(d)){break}for(h=0;
h<bp(d);
h++){p.push(new gJ(l,d[h]))}o=l.gS(n,p)}while(bp(p)<10);
if(f>2||!l.hv()){a=0;
for(h=f-1;
h>=0;
h--){d=l.du[h].gP(l);
a+=(d.c9.z-k.z)/(M.abs(o-eA(l,d))+1)}c=c1(k,o,(a>0?-30:30),b)}}}return c}function kd(c,a,b){if(bG(b)!=0){return at+c+bA("1",3)+S+bA(a+1,3)+S+bA(M.round(b),3)}else{return""}}function ke(){var c=this,f,e,d,b,k,g,h=[],a=ab+ao+Number(new Date())+ao+navigator.userAgent+ao+bA(bp(c.d5),3)+bA(bp(c.du),3)+bz(ap,8)+(eq=="rxn"?ap:"999")+" V2000";
for(f=0,e=bp(c.d5);
f<e;
f++){a+=c.d5[f].hC()}for(f=0,e=bp(c.du);
f<e;
f++){a+=c.du[f].hC()}for(f=0,e=bp(c.d5);
f<e;
f++){a+=kd("CHG",f,c.d5[f].en());
a+=kd("RAD",f,c.d5[f].dq);
a+=kd("ISO",f,c.d5[f].dr)}if(eq=="tmpl"&&c.er){a+=at+"ATT"+bA("1",3)+S+bA(c.er.getIndex(),3)+S+a3.val()+S+a4.val()}for(f=0,e=bp(c.io);
f<e;
f++){k=c.io[f];
if(!(b=bp(k.d5))){continue}a+=at+"STY"+bA("1",3)+S+bA(f+1,3)+S+k.type;
if(k.type==aw&&k.hL){a+=at+"SCN"+bA("1",3)+S+bA(f+1,3)+S+k.hL}for(d=0;
d<b;
d++){a+=(d%15?"":at+"SAL "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.d5[d].getIndex()+1),4)}if(k.type==av){for(d=0,b=bp(k.hH);
d<b;
d++){a+=(d%15?"":at+"SPA "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.hH[d].getIndex()+1),4)}}if(k.eP){for(d=0,b=bp(k.eP);
d<b;
d++){g=k.eP[d];
a+=at+"SDI "+bA(f+1,3)+bA(4,3)+gl(g.dR.x)+gl(-g.dR.y)+gl(g.dQ.x)+gl(-g.dQ.y)}}for(d=0,b=bp(k.hG);
d<b;
d++){a+=(d%15?"":at+"SBL "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.hG[d].getIndex()+1),4)}a+=at+"SMT "+bA(f+1,3)+S+bH(k.ds);
if(k.eM){h.push(k)}}for(d=0,b=bp(h);
d<b;
d++){a+=(d%15?"":at+"SDS EXP"+bA(M.min(b-d,15),3)+S)+bA(h[d].getIndex()+1,3)}for(f=0,e=bp(c.kf);
f<e;
f++){a+=ao+c.kf[f]}a+=at+"END\n";
return a}function kg(b,a,d){var c=b.attributes[a];
if(c){c=c.value;
if(d){a=d[c];
if(a!=am){c=a}}return c}}function kh(b,a,c){var d=bm(kg(b,a));
if(c){if(d in c){d=c[d];
if(d in c){d=c[d]}}}return d
}function ki(q,p){for(var d=new fH(),m=p.find("n"),l,k=0,h=bp(m),g,c,b,a,e,o={},f={},n;
k<h;
k++){e=m[k];
if((b=kg(e,"NodeType"))==am||bj[b]!=am){a=kg(e,"p");
c=bv(a);
n=new gv(new cj(bn(c[0]),-bn(c[1]),bn(kg(e,"Z"))));
n.go=bG(kh(e,"Charge"));
n.gH(gj[bF(kh(e,"Element"),6)]);
n.kj=kh(e,"id");
n.dq=bG(kh(e,"Radical",bk));
n.dr=bF(kh(e,"Isotope"),am);
n.dt=bF(kh(e,"NumHydrogens"),am);
m[k]=n;
d.fW(n);
o[n.kj]=n}else{if(b=="ExternalConnectionPoint"){c=$(e).parents("n:first");
if(bp(c)){b=kh(e,"id");
a=kh(c[0],"id");
f[b]=a;
f[a]=b}}}}l=p.find("b");
c=$.extend({},f);
for(k=0,h=bp(l);
k<h;
k++){e=l[k];
b=kh(e,"B");
a=kh(e,"E");
if(b in c){f[c[b]]=a}if(a in c){f[c[a]]=b}}for(k=0,h=bp(l);
k<h;
k++){e=l[k];
b=o[kh(e,"B",f)];
a=o[kh(e,"E",f)];
c=bm(kg(e,"Display",bl));
if(c==4||c==7||c==12){n=a;
a=b;
b=n;
c--}n=new gy(b,a,bF(bn(kg(e,"Order")),(c==1?0:1)),bG(bb[c]));
n.kj=kh(e,"id");
o[n.kj]=n;
d.f0(n)}for(k=0,h=bp(m);
k<h;
k++){e=m[k];
if(e.attributes){if(kg(e,"NodeType")=="Fragment"){e=$(e);
b=[];
a=[];
c=e.find("n");
for(g=bp(c)-1;
g>=0;
g--){n=o[kh(c[g],"id")];
if(n){b.push(n)}}l=[];
c=e.find("b");
for(g=bp(c)-1;
g>=0;
g--){a.push(n=o[kh(c[g],"id")]);
if(n.c8&&n.c_&&(!bX(b,n.c8)||!bX(b,n.c_))){l.push(n)}}c=e.find("s").text();
if(bp(b)){b[0].ep.hY(c,b,a,l)}}}}l=q.find("page:first > bracketedgroup");
for(k=0,h=bp(l);
k<h;
k++){e=l[k];
if(kg(e,"BracketUsage")=="MultipleGroup"){c=bv(kg(e,"BracketedObjectIDs"));
b=[];
a=[];
for(g=bp(c)-1;
g>=0;
g--){n=o[bm(c[g])];
if(n){if(n.c8){a.push(n)}else{b.push(n)}}}n=[];
c=$(e).find("crossingbond");
for(g=bp(c)-1;
g>=0;
g--){n.push(o[kh(c[g],"BondID")])}c=bG(kh(e,"RepeatCount"));
if(c<=1){c=bF(kg(e,"SRULabel"),"n")}if(bp(b)){b[0].ep.hY(c,b,a,n)}}}return d}function kk(t){var h=new fH(),a=t.split(ao),p=0,m=bp(a),o,u,n,y,q={},c,d,b,x,w,f,g,l,v;
h.jM=0;
do{if(p<m){p++}else{return am}}while(a[p]!=am&&!bx(a[p],"V2000"));
c=bu(a[p],[3,3]);
for(o=0,u=bm(c[0]);
o<u;
o++){p++;
d=bu(a[p],[10,10,10,1,3,2,3,3,3,3,3,3,3,3,3,3]);
b=new gv(new cj(bn(d[0]),-bn(d[1]),bn(d[2])));
l=bm(d[6]);
if(l!=0){b.go=4-l}b.gH(d[4]);
b.dt=bm(d[8])-1;
if(b.dt<0){b.dt=am}b.gr=bm(d[10]);
if(b.gr>=15){b.gr=0}else{if(b.gr==0){b.gr=am}}if(d[5]!="0"&&b.gp){b.dr=M.round(b.gp.m)+bm(d[5])}h.fW(b)}for(o=0,u=bm(c[1]);
o<u;
o++){p++;
d=bu(a[p],[3,3,3,3,3,3,3]);
x=h.d5[bm(d[0])-1];
w=h.d5[bm(d[1])-1];
if(!x||!w||x.bS(w)){continue}l=bm(d[2]);
if(ba[l]!=am){l=ba[l]}f=new gy(x,w,l,bm(d[3]));
h.f0(f)}while(p<m){p++;
d=bv(a[p]);
switch(d[1]){case"CHG":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d5[bm(d[2*o+3])-1];
b.go=l}}}catch(r){}break;
case"ISO":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d5[bm(d[2*o+3])-1];
b.dr=l}}}catch(r){}break;
case"RAD":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d5[bm(d[2*o+3])-1];
b.dq=l}}}catch(r){}break;
case"ATT":try{h.er=h.d5[bm(d[3])];
h.a3=bH(d[4]).split(",");
h.a4=bH(d[5])}catch(r){}break;
case"STY":u=3+2*bG(bm(d[2]));
try{for(o=3;
o<u;
o+=2){l=d[o+1].toUpperCase();
v=bm(d[o]);
if(l=="GEN"){l=aw
}if(l==au){g=new iz()}else{if(l==av){g=new iB()}else{if(l==aw){g=new iD()}else{continue}}}h.hZ(g);
q[v]=g}}catch(r){}break;
case"SCN":u=3+2*bG(bm(d[2]));
try{for(o=3;
o<u;
o+=2){v=bm(d[o]);
g=q[v];
if(g.type==aw){g.hL=d[o+1].toUpperCase()}}}catch(r){}break;
case"SDI":v=bm(d[2]);
try{g=q[v];
if(g&&g.iC){g.iC(d.slice(4))}}catch(r){}break;
case"SAL":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){g.fW(h.d5[bm(d[o])-1])}}}catch(r){}break;
case"SPA":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){g.hI(h.d5[bm(d[o])-1])}}}catch(r){}break;
case"SBL":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){f=h.du[bm(d[o])-1];
g.hJ(f)}}}catch(r){}break;
case"SDS":l=a[p].substr(13);
try{for(o=0,u=bp(l);
o<u;
o+=3){v=bm(bt(l.substr(o,3)));
g=q[v];
if(g){g.ic(F)}}}catch(r){}break;
case"SMT":v=bm(d[2]);
try{g=q[v];
if(g){g.ds=d[3].replace(/^[\s\^]+|[\s\^]+$/g,"");
g.hK=bm(d[3]);
if(g.hK){g.hL=""}}}catch(r){}break;
case"END":p=m;
break;
default:h.kf.push(a[p])}}for(p=0,m=bp(h.d5);
p<m;
p++){b=h.d5[p];
b.g8();
if(b.go==b.g0){b.go=am}if((b.ds=="N"&&b.gT()==5)||(b.ds=="S"&&b.gT()==4)){for(o=0,u=bp(b.du);
o<u;
o++){f=b.du[o];
if(f.dv==2&&(x=f.gP(b))&&x.ds=="O"&&x.en()==0){b.gV((b.g0==2&&x.en()==0)?-1:1);
f.dv--;
x.gV(-1);
break}}}}for(p=0,m=bp(h.io);
p<m;
p++){g=h.io[p];
for(o=0,u=bp(g.d5);
o<u;
o++){b=g.d5[o];
for(n=0,y=bp(b.du);
n<y;
n++){g.f0(b.du[n])}}if(g.type==au&&!bp(g.hG)){b9(g.hH,g.d5)}if(g.type!=av){for(o=0,u=bp(g.hH);
o<u;
o++){b=g.hH[o];
for(n=0,y=bp(b.du);
n<y;
n++){f=b.du[n];
if(!bX(g.d5,(f.c8.bS(b)?f.c_:f.c8))){b4(f,g.du)}}}}if(g.eM==am){g.ic(T)}}h.jM=1;
h.iJ();
return h}function kl(){if(!this.hs){if(!this.jN){this.iJ()}this.hs=[];
for(var b=0,a=bp(this.jN);
b<a;
b++){bZ(this.hs,this.jN[b].d4())}}return this.hs}function km(){var a=this;
if(a.eb){return a.eb}if(a.f2){return a.f2.c7()}}function jw(b){var c=this,a;
if(!c.fD){a=[];
bZ(a,c.du);
bZ(a,c.d5);
bZ(a,c.io);
c.fD=a}return c.fD}function jz(e,a){var c=0,d,b;
if($.isArray(e)){for(b=bp(e)-1;
b>=0;
b--){c+=this.gA(e[b].c9,a)}}else{for(b=bp(this.d5)-1;
b>=0;
b--){d=kn-this.d5[b].c9.cT(e,a);
if(d>0){c+=ko*d*d}}}return c}function kp(c,h){var e,b,g,d=h,a=this.gA(h,T),f=0;
if(a>0){e=h.cc();
b=h.cc();
while(f++<10){e.eU(ag,c.c9);
if((g=this.gA(e,T))<a){a=g;
d=e.cc()}b.eU(-ag,c.c9);
if((g=this.gA(b,T))<a){a=g;
d=b.cc()}if(a==0){break}}f=h.cT(d);
h.x=d.x;
h.y=d.y}return f}function kq(){var d=this,c,b,a,e;
if(!d.dd||!d.db){fq.apply(d);
for(b=0,a=bp(d.io);
b<a;
b++){c=d.io[b];
if(c.type==au){e=0.4*kr*bp(c.ds);
fu(d,c.fw.y-e);
fu(d,c.fw.y+e)}}}}function jx(e){var h=this,b=[],g,d,a,c,f;
for(d=0,a=bp(h.d5);
d<a;
d++){g=h.d5[d];
if(!e||!g.d1){b.push(g.c9)}}if(!e){if(h.jN){for(d=0,a=bp(h.jN);
d<a;
d++){b0(b,h.jN[d].fw)}}if(h.hs){for(d=0,a=bp(h.hs);
d<a;
d++){b0(b,h.hs[d].fw)}}}for(d=0,a=bp(h.io);
d<a;
d++){g=h.io[d];
if(g.eP){for(c=0,f=bp(g.eP);
c<f;
c++){b.push(g.eP[c].dR,g.eP[c].dQ)}}if(!e){b0(b,g.fw);
b0(b,g.dd);
b0(b,g.db)}else{if(g.type==au){b0(b,g.d6())}}}if(!e){b0(b,h.fw);

b0(b,h.dd);
b0(b,h.db)}return b}function ks(b,a){this.gK=b;
this.kt=a}function ku(){for(var b=[],e,d,f,c=0,a=bp(this.d5);
c<a;
c++){e=this.d5[c];
if((d=e.gp)&&d.gg){f=d.gg+e.en()-e.gT();
if(f>0){b.push(new ks(e,f))}}}return b}function kv(){if(!this.f2){return -1}return bY(this.f2.f6,this)}function hB(){return this.ep}function kw(){return(this.f2?this.f2:this)}function jP(a){this.ep=a;
this.jR=[];
this.jQ=[]}function fH(){var a=this;
e4.apply(a);
a.d5=[];
a.io=[];
a.du=[];
a.kf=[];
a.jM=1;
a.iJ=j9;
a.d4=kl;
a.fx=jv;
a.jU=j6;
a.ke=ke;
a.kx=ku;
a.eT=jy;
a.d3=kq;
a.gA=jz;
a.kb=kp;
a.cB=jA;
a.jS=jS;
a.fW=jV;
a.hZ=jY;
a.hY=jX;
a.gD=jZ;
a.removeAtom=j0;
a.fG=j0;
a.ib=j3;
a.f0=j4;
a.ky=j5;
a.fF=j7;
a.fK=jT;
a.kz=jO;
a.jB=kA;
a.dD=jw;
a.j1=fC;
a.fr=jx;
a.getIndex=kv;
a.cc=jL;
a.jW=kw;
a.eo=fh;
a.c7=km}function kB(d){if(!d){d=new cd()}var e=this,b=new fJ(e.eb),c,a;
bT(d,e,b);
for(c=0,a=bp(e.f6);
c<a;
c++){b.fK(e.f6[c].cc(d))}for(c=0,a=bp(e.kC);
c<a;
c++){b.kD(e.kC[c].cc(d),T)}b.kE=e.kE;
if(e.fO){b.fO=e.fO.cc(d);
b.fO.f2=b}b.kF=e.kF.cc(d);
return b}function kG(b){if(!b){b=new cd()}var c=this,a=new kH(c.c9.x,c.c9.y);
bT(b,c,a);
a.dH=c.dH;
return a}function kI(b){if(!b){b=new cd()}var c=this,a=new fS(c.dR.cc(),c.dQ.cc());
bT(b,c,a);
a.dH=c.dH;
a.f2=b.cb(c.f2);
return a}function kJ(){return cA(this.dR,this.dQ)}function kK(a){a.dw();
return b4(a,this.f6)}function kL(a,c,b){var d=this;
if(eq=="rxn"||!bp(d.f6)){if(b_(d.f6,a)){a.f2=d;
if(c){d.kM()}}}else{d.f6[0].fK(a,b)}}function kN(){this.kO();
this.kP();
this.kQ()}function kR(){if(eq!="rxn"){return}var c=this,f,e,g,a=c.f6,b,d,h,k,j;
for(f=bp(a)-1;
f>=0;
f--){b=a[f];
if(!bp(b.d5)){this.j2(b)}}a.sort(kS);
if(c.fO){g=c.fO.d6()}for(f=0,e=bp(a)-1;
f<e;
f++){b=a[f];
k=a[f+1];
d=b.d6();
j=k.d6();
if(g&&g.x>d.x&&g.x<j.x){c.kE=f+1}else{h=c.kT(d);
if(!h||h.c9.x>=j.x){b.d3();
k.d3();
c.kU(0.5*(b.db.x+k.dd.x),0.5*(j.y+d.y))}}}}function kV(l,k,d){if(l&&k){if(d){var c=this,b=l.d6(),j=k.d6(),e=M.min(b.x,j.x),a=M.max(b.x,j.x),g,f,h;
for(g=bp(c.kC)-1;
g>=0;
g--){f=c.kC[g].c9;
if(e<f.x&&f.x<a){c.kW(c.kC[g])}}if(c.fO){h=c.fO.d6();
if(e<h.x&&h.x<a){c.kX()}}}l.fK(k);
b4(k,this.f6);
this.kP()}}function kY(){var a=this,j=a.kC.concat(),e,g,c,f,b={},d={},h;
if(a.fO){j.push(a.fO)}j.sort(kZ);

for(e=bp(j)-1;
e>=0;
e--){g=j[e];
f=g.d6();
h=this.k0(f);
if(!(h=this.k0(f))&&g instanceof kH){a.kW(g,T)}else{b[g.bQ]=h;
if(!(h=this.k1(f))&&g instanceof kH){a.kW(g,T)}d[g.bQ]=h}}for(e=bp(j)-2;
e>=0;
e--){g=j[e];
c=j[e+1];
h=b[g.bQ];
if(h&&h.bS(b[c.bQ])&&d[g.bQ]&&d[g.bQ].bS(d[c.bQ])){if(c instanceof kH){a.kW(c,T)}else{a.kW(g,T)}}}}function k2(f,j,g){for(var a,h=ar,b,c,e=0,d=bp(this.f6);
e<d;
e++){b=this.f6[e].d6();
if((b.x-f.x)*j>0||(b.y-f.y)*g>0){c=f.cT(b,T);
if(c<h){a=this.f6[e];
h=c}}}return a}function k3(a){return this.k4(a,-1,0)}function k5(a){return this.k4(a,1,0)}function k6(f,j,g){for(var a,h=ar,b,c,e=0,d=bp(this.kC);
e<d;
e++){b=this.kC[e].c9;
if((b.x-f.x)*j>0||(b.y-f.y)*g>0){c=f.cT(b,T);
if(c<h){a=this.kC[e];
h=c}}}return a}function k7(a){return this.k8(a,-1,0)}function k9(a){return this.k8(a,1,0)}function k_(c){var k=c.ep,l=new fH(),b,h,m,g,f,e,a,d=st.gC();
this.f6.splice(bY(this.f6,k)+1,0,l);
l.f2=this;
l.jN=[];
this.kP();
for(g=0,f=bp(c.jQ);
g<f;
g++){b=c.jQ[g];
for(e=0,a=bp(b.d5);
e<a;
e++){h=b.d5[e];
b4(h,k.d5);
if(!bX(l.d5,h)){l.fW(h)}}for(e=0,a=bp(b.du);
e<a;
e++){m=b.du[e];
b4(m,k.du);
if(!bX(l.du,m)){l.f0(m)}}b4(b,k.jN);
b_(l.jN,b);
delete k.hs;
k.fx(bg);
d.fx(bh)}}function la(e,b){var c=this,d,a;
if(!b){d=c.k0(e.c9),a=c.k1(e.c9);
c.gB(d,a,F)}e.dw();
fi(e,c.kC);
c.j1(e);
if(!b){c.kP()}}function lb(c,a){if(eq!="rxn"){return}var b=this;
b.kC.push(c);
c.f2=b;
if(!a){fm(c);
b.fx(bf)}return T}function lc(b,a,d){var c;
if(b instanceof cj){c=new kH(b.x,b.y)}else{c=new kH(b,a)}this.kD(c,d);
if(!d){this.ld(c.c9)}return c}function dL(b,a,d,c){if(!c){c=this.data(as)}le=c;
switch(he){case aO:case aP:case aK:case aL:c.dj.attr("cursor","move");
break;
case aT:if(hg){c.f2.kW(c);
le=am;
lf=T}break}}function dM(b,a,d,c){le=am}function dU(c,a,d,b){if(!b){b=this.data(as)}lg=b;
switch(he){case aO:case aP:case aK:case aL:b.dj.attr("cursor","move");
break;
case aT:if(hg){b.f2.kX(b);
lg=am}break}}function dV(c,a,d,b){lg=am}function lh(h){for(var f=this,e,b,g=ar,d,c=0,a=bp(f.f6);
c<a;
c++){b=f.f6[c].kz(h);
if(b){d=h.cT(f.f6[c].d6(),T);
if(d<g){e=b;
g=d}}}if(e){f.li(e)}f.kP()}function lj(b){var c=this,a=c.fO;
if(!a){return F}if(b){c.kU(a.d6(),T)}c.j1(a);
a.dw();
delete c.fO}function lk(b,a,c){if(eq!="rxn"){return}if(!(b instanceof cj)){b=new cj(b,0)}if(!a){a=b.cc();
a.x+=ll}this.fT(new fS(b,a));
if(!c){this.ld(cA(b,a))}}function lm(a){if(eq!="rxn"){return}var b=this;
if(b.fO){b.kX(T)}b.fO=a;
b.fO.f2=this;
b.fx(bf)}function ln(e,d,c,g){if(c==am){c=hi}if(g==am){g=hj}var b=e.ep,h,f,a;
if(!this.bS(b.f2)){return}if(b.bS(d.ep)){for(f=0,a=bp(b.du);
f<a;
f++){h=b.du[f];
if((h.c8.bS(e)&&h.c_.bS(d))||(h.c8.bS(d)&&h.c_.bS(e))){h.iX();
return h}}}else{this.gB(b,d.ep,T)}h=new gy(e,d,c,g);
b.f0(h);
return h}function lo(m,g){var e=m.lp,a=m.lq,h=e.ep,b=m.lr,d,c,f,k,j,l,i;

if(!this.bS(h.f2)){return}d=(m.eZ?a.c_:a.c8);
c=(m.eZ?a.c8:a.c_);
if(e.dv!=2||a.dv!=2){k=e.iY();
if(k||e.dv!=a.dv){j=a.iY();
if(e.dv!=2&&k){e.iZ(k)}if(a.dv!=2&&j){a.iZ(j)}}}if(!e.c8.im.bS(a.c8.im)){b.eU((eA(e.c8,e.c_)-eA(d,c))*ag,a.d6());
b.cu(e.c8.c9.cz(d.c9));
l=e.c8.c9.cT(e.c_.c9);
i=d.c9.cT(c.c9);
if(l>0&&i>0&&l!=i){b.eT(l/i,e.c8.c9)}}if(!h.bS(a.ep)){if(b){b4(a.ep,b.f6)}this.gB(h,a.ep,T)}f=(g[e.c8]||g[e.c_]||g[d]||g[c]);
if(f==2||(!f&&e.hA()+e.c8.hA()+e.c_.hA()>a.hA()+d.hA()+c.hA())){h.gD(d,e.c8);
g[e.c8]=2;
h.gD(c,e.c_);
g[e.c_]=2;
h.ky(a,e)}else{h.gD(e.c8,d);
g[d]=1;
h.gD(e.c_,c);
g[c]=1;
h.ky(e,a)}if(b){b.fF(a);
b.fG(d);
b.fG(c)}}function ls(d,a,h){var i=d.lp,e=d.lq,j=i.ep,f=d.lr,c,l;
if(!this.bS(j.f2)){return}if(a){if(!i.im){j.iJ()}if(!i.im.bS(e.im)){f.cu(i.c9.cz(e.c9));
var b=i.g5(i.gn()),g=i.gT(),m=e.g5(e.gn()),k=e.gT();
if(b<k&&m<g&&(g>1||k>1)){f1(f.d5,T);
c=new gv(gw(i,1));
l=new gy(i,c,1,0);
j.fW(c);
j.f0(l);
h=1;
i=c;
f1(f.d5,F);
f.cu(c.c9.cz(e.c9))}else{if(m<g){h=2}else{if(b<k){h=1}}}}}if(!j.bS(e.ep)){if(f){b4(e.ep,f.f6)}this.gB(j,e.ep,T)}if(h==2||(!h&&i.hA()>e.hA())){j.gD(e,i)}else{j.gD(i,e)}if(f){f.fG(e)}}function kS(d,c){d.d3();
c.d3();
if(d.dd.x<c.dd.x){return -1}if(d.dd.x>c.dd.x){return 1}if(d.dd.y<c.dd.y){return -1}if(d.dd.y>c.dd.y){return 1}return 0}function kZ(d,c){var e=d.d6(),f=c.d6();
if(e.x<f.x){return -1}if(e.x>f.x){return 1}if(e.y<f.y){return -1}if(e.y>f.y){return 1}return 0}function lt(){if(eq!="rxn"){return}this.kE=0;
var d=this,c,b,a;
if(d.fO){c=d.fO.d6()}for(b=0,a=bp(d.f6);
b<a;
b++){if(c&&d.f6[b].d6().x>=c.x){break}d.kE++}}function lu(){if(!this.f6||bp(this.f6)==0){return""}if(eq=="rxn"){for(var d=this,a,b,c=bp(d.f6)-1;
c>=0;
c--){if(!bp(d.f6[c].d5)){d.f6.splice(c,1)}}d.f6.sort(kS);
d.kP();
b="$RXN\n\n"+ab+S+Number(new Date())+ao+ao+bA(d.kE,3)+bA(bp(d.f6)-d.kE,3)+ao;
for(c=0,a=bp(d.f6);
c<a;
c++){b+="$MOL\n";
b+=d.f6[c].ke()}return b}else{return this.f6[0].ke()}}function lv(a){this.lw(a);
this.fc()}function lx(c){var b=kg(c,"BoundingBox"),a;
if(b){a=b.indexOf(S);
if(a>0){b=b.substr(0,a)}}return bG(bn(b))}function ly(b,a){return lx(b)-lx(a)}function lz(m){m=by(m);
var c=this,k,h,g,f,o,d,a,l,n,j,b=0,e=0;
if(bw(m,"<!DOCTYPE CDXML")){m='<?xml version="1.0"  ?>'+m}if(bw(m,"<?xml")||bw(m,"<CDXML")){k=$($.parseXML(m));
h=k.find("page:first > fragment,page:first > group");
d=k.find("step");
if(bp(d)){c.kE=0;
h.sort(ly);
l=S+bH(d.attr("ReactionStepReactants"))+S+bH(d.attr("ReactionStepObjectsAboveArrow"));
for(g=0,f=bp(h);
g<f;
g++){j=ki(k,$(h[g]));
j.kj=bm(kg(h[g],"id"));
if(l.indexOf(S+j.kj)>-1){c.kE++}if(o=lA(c,j,b,e)){b=o;
e++}}if(g==c.kE){c.lB(b)}}else{c.kE=1;
j=ki(k,h);
j.cB();
c.fK(j)}}else{if(bw(m,"$RXN")){k=m.split("$MOL\n");
h=k.shift();
for(g=0,f=bp(k);
g<f;
g++){k[g]=ac(k[g])
}o=h.split(ao);
d=ac(o[bp(o)-2]);
c.kE=bm(d.substr(0,3));
a=bm(d.substr(3,3));
l=bm(d.substr(6,3));
if(l>0){n=k.splice(c.kE+a);
k.splice(c.kE,0,n);
c.kE+=l}for(g=0,f=bp(k);
g<f;
g++){j=kk(k[g]);
if(o=lA(c,j,b,e)){b=o;
e++}}if(g==c.kE){c.lB(b)}}else{if(m){c.kE=1;
j=kk(m);
j.cB();
c.fK(j);
if(eq=="tmpl"&&c.eb==aZ){if($.isArray(j.a3)){a3.val(j.a3.join(","))}if(j.a4!=am){a4.val(j.a4)}}}}}}function lA(d,a,c,b){if(!bp(a.d5)){if(b<d.kE){d.kE--}return am}if(b==d.kE){d.lB(c,am,T);
c+=ll+ec}else{if(b>0){d.kU(c,0,T);
c+=dG+ec}}a.cB();
a.jS(c);
d.fK(a);
c+=(a.db.x-a.dd.x)+ec;
return c}function lC(){var d=this;
if(!d.dd||!d.db){d.dd=new cj(ar,ar);
d.db=new cj(-ar,-ar);
for(var c=0,b=bp(d.f6);
c<b;
c++){var a=d.f6[c];
a.d3();
fs(d,a.db);
fs(d,a.dd)}}}function lD(d,a){if(!a){a=[]}else{if(bX(a,this)){return}}a.push(this);
if(d>bd&&d<bh&&d!=bf){var c=this,b;
if(c.dR.x>c.dQ.x){b=c.dR;
c.dR=c.dQ;
c.dQ=b}}a.pop()}function lE(e,b){if(!b){b=[]}else{if(bX(b,this)){return}}var d=this,c,a;
b.push(d);
if(e>be){delete d.fD}if(e>bd&&e<bh){d.lF()}d.f6.sort(kS);
if(e!=bd&&e!=bf){e=bg}for(c=0,a=bp(d.f6);
c<a;
c++){d.f6[c].fx(e,b)}d.kP();
b.pop()}function lG(){delete this.dd;
delete this.db}function lH(){return this.eb}function lI(a){this.eb=a;
this.dE()}function lJ(c){var e=this,b,d,a;
if(!e.fD){b=[];
for(d=0,a=bp(e.f6);
d<a;
d++){bZ(b,e.f6[d].dD(c))}bZ(b,e.kC);
if(e.fO){b.push(e.fO)}b.sort(fk);
e.fD=b}return e.fD}function lK(d){for(var e=this,b=[],c=0,a=bp(e.f6);
c<a;
c++){bZ(b,e.f6[c].fr(d))}for(c=0,a=bp(e.kC);
c<a;
c++){b.push(e.kC[c].c9)}if(e.fO){b.push(e.fO.dR);
b.push(e.fO.dQ)}return b}function lL(){for(var b=[],c=0,a=bp(this.f6);
c<a;
c++){bZ(b,this.f6[c].d5)}return b}function lM(){for(var b=[],c=0,a=bp(this.f6);
c<a;
c++){bZ(b,this.f6[c].du)}return b}function lN(r,q,b){if(!r){return}if(q==am){q=ka}var h=r.x-q,c=r.x+q,g=r.y-q,a=r.y+q,f=r.z-b,t=r.z+b,e=[],m,l,k,d,p,o,n;
for(k=0,d=bp(this.f6);
k<d;
k++){p=this.f6[k];
for(m=0,l=bp(p.d5);
m<l;
m++){o=p.d5[m];
n=o.d6();
if(!o.dS&&!o.d1&&h<n.x&&n.x<c&&g<n.y&&n.y<a&&(b==am||(f<n.z&&n.z<t))){e.push(o)}}}return e}function lO(o,n){if(!o){return}if(n==am){n=lP}var f=o.x-n,b=o.x+n,e=o.y-n,a=o.y+n,d,k,h,g,c,l,p,m;
for(g=0,c=bp(this.f6);
g<c;
g++){l=this.f6[g];
for(k=0,h=bp(l.du);
k<h;
k++){p=l.du[k];
if(!p.dS&&!p.d1&&f<M.max(p.c8.c9.x,p.c_.c9.x)&&M.min(p.c8.c9.x,p.c_.c9.x)<b&&e<M.max(p.c8.c9.y,p.c_.c9.y)&&M.min(p.c8.c9.y,p.c_.c9.y)<a){m=o.e2(p.c8.c9,p.c_.c9);
if(m<n){d=p;
n=m}}}}return d}function lQ(n,m){if(!n){return}if(m==am){m=ka}var f=n.x-m,b=n.x+m,e=n.y-m,a=n.y+m,d=[],k,h,g,c,l,o;
for(g=0,c=bp(this.f6);
g<c;
g++){l=this.f6[g];
for(k=0,h=bp(l.io);
k<h;
k++){o=l.io[k];
o.d3();
if(f<o.db.x+o.iy&&o.dd.x<b&&e<o.db.y&&o.dd.y<a){d.push(o)}}}return d}function lR(b,a){return lS(b,this.kc(b,a))}function lT(b,a){return lS(b,this.lU(b,a))
}function lS(g,b){if(!b||!bp(b)){return}var d=b[0],f=d.d6().cT(g,T),e,c,a;
for(c=1,a=bp(b);
c<a;
c++){e=b[c].d6().cT(g,T);
if(e<f){d=b[c];
f=e}}return d}function lV(c){for(var b=[],e=0,a=bp(this.f6),d,g,f;
e<a;
e++){f=this.f6[e].d5;
for(d=0,g=bp(f);
d<g;
d++){if(f[d].ds==c){b.push(f[d])}}}return b}function lW(){return this.c9}function lX(a){return[this.c9]}function lY(a){return[this.dR,this.dQ]}function lZ(d){for(var e=this,b=d.kC,c=0,a=bp(b);
c<a;
c++){e.kD(b[c])}for(b=d.l0(),c=0,a=bp(b);
c<a;
c++){e.fK(b[c])}}function Reaction(a){fJ.apply(this,[aZ,a])}function fJ(b,c){var a=this;
e4.apply(a);
a.eb=b;
a.f6=[];
a.kC=[];
a.kE=0;
a.kF=new hp();
a.getAtoms=lL;
a.findAtoms=lV;
a.l1=lR;
a.l2=lO;
a.l3=lT;
a.kc=lN;
a.lU=lQ;
a.l4=lM;
a.fx=lE;
a.d3=lC;
a.lF=lG;
a.l5=kN;
a.kO=kR;
a.kP=lt;
a.kQ=kY;
a.l6=lu;
a.l7=lv;
a.lw=lz;
a.jK=ln;
a.l8=ls;
a.l9=lo;
a.kD=lb;
a.kU=lc;
a.kW=la;
a.fT=lm;
a.lB=lk;
a.kX=lj;
a.fK=kL;
a.j2=kK;
a.gB=kV;
a.l_=lZ;
a.ld=lh;
a.li=k_;
a.k4=k2;
a.k0=k3;
a.k1=k5;
a.k8=k6;
a.ma=k7;
a.kT=k9;
a.getAttAtom=function(){for(var e=0,d=bp(a.f6);
e<d;
e++){if(a.f6[e].er){return a.f6[e].er}}};
a.jB=mb;
a.dD=lJ;
a.j1=fC;
a.fr=lK;
a.cu=e5;
a.cc=kB;
a.eo=fh;
a.c7=lH;
a.mc=lI;
if(c){a.lw(c)}}function fS(c,a){var b=this;
fg.apply(b);
if(c.x>a.x){b.dR=a;
b.dQ=c}else{b.dR=c;
b.dQ=a}b.dH=F;
b.fx=lD;
b.d6=kJ;
b.fr=lY;
b.fc=dN;
b.dC=fz;
b.cc=kI;
b.c7=km}function kH(a,c){var b=this;
fg.apply(b);
b.c9=new cj(a,c);
b.dH=F;
b.fx=iA;
b.d6=lW;
b.fr=lX;
b.fc=dF;
b.dC=fz;
b.cc=kG;
b.c7=km}function md(h,l){h=(h||st.dB());
var c=this,a=h.f6,g,e,b,f,d,k;
for(e=0,b=bp(a);
e<b;
e++){g=a[e];
for(f=0,d=bp(g.d5);
f<d;
f++){k=g.d5[f];
if(!l||!bX(l.d5,k)){c.fW(k)}}for(f=0,d=bp(g.du);
f<d;
f++){k=g.du[f];
if(!l||!bX(l.du,k)){c.f0(k)}}for(f=0,d=bp(g.io);
f<d;
f++){k=g.io[f];
if(!l||!bX(l.io,k)){c.hZ(k)}}}k=h.fO;
if(k&&(!l||!l.fO)){c.fT(k)}for(e=0,b=bp(h.kC);
e<b;
e++){k=h.kC[e];
if(!l||!bX(l.kC,k)){c.kD(k)}}}function me(){for(var d=this,a=d.d5,c,b=bp(d.du)-1;
b>=0;
b--){c=d.du[b];
if(!bX(d.d5,c.c8)||!bX(d.d5,c.c_)){d.fF(c)}}for(b=bp(d.hG)-1;
b>=0;
b--){d.fF(d.hG[b])}return d}function mf(d){for(var c,b=0,a=bp(this.d5);

b<a;
b++){c=this.d5[b];
c.gE(d);
fm(c)}}function mg(){for(var c,b=0,a=bp(this.io);
b<a;
b++){c=this.io[b];
c.ij();
this.ib(c)}}function mh(){var c=this,a=st.dB(),b;
while(bp(c.io)){b=c.io.pop();
b.ep.ib(b)}while(bp(c.du)){b=c.du.pop();
b.ep.fF(b)}while(bp(c.d5)){b=c.d5.pop();
b.ep.fG(b)}if(c.fO){a.kX();
c.kX()}while(bp(c.kC)){a.kW(c.kC.pop())}}function mi(){var a=this;
return !bp(a.d5)&&!bp(a.io)&&!bp(a.du)&&!bp(a.kC)&&!a.fO}function mj(){var a=this;
while(bp(a.io)){a.ib(a.io[0])}while(bp(a.du)){a.fF(a.du[0])}while(bp(a.d5)){a.fG(a.d5[0])}a.kX();
while(bp(a.kC)){a.kW(a.kC[0])}}function mk(){var a=new hp(T);
a.bZ(am,this);
return a}function ml(m){var c=this,n=new cd(),h,g,d,b,f,o,l,k=[],a=[];
mm=c.cc(n,T);
for(h=0,g=bp(c.du);
h<g;
h++){b=c.du[h];
b_(k,b.c8);
b_(k,b.c_)}for(h=0,g=bp(c.hG);
h<g;
h++){b=c.hG[h];
b_(k,b.c8);
b_(k,b.c_)}for(h=0,g=bp(k);
h<g;
h++){b=k[h];
f=n.cb(b);
mm.fW(f,T);
o=b.ep;
l=n.bV[o.bQ];
if(!l){l=new fH();
n.bV[o.bQ]=l;
a.push(l)}l.fW(f,T)}if(mm.f6){bZ(mm.f6,a)}else{mm.f6=a}for(h=0,g=bp(c.d5);
h<g;
h++){b=c.d5[h];
f=n.cb(b);
for(d=bp(b.du)-1;
d>=0;
d--){if(!bX(c.du,b.du[d])){f=n.cb(b);
b4(n.cb(b.du[d]),f.du);
f.fx(bg)}}}for(h=0,g=bp(mm.d5);
h<g;
h++){mm.d5[h].dH=am}for(h=0,g=bp(mm.du);
h<g;
h++){mm.du[h].dH=am}for(h=0,g=bp(mm.hG);
h<g;
h++){mm.hG[h].dH=am}for(h=0,g=bp(mm.io);
h<g;
h++){mm.io[h].dH=am}mm.dE();
if(m){if(bp(mm.f6)==1){f=mm.f6[0].ke()}else{l=new fJ();
l.l_(mm);
f=l.l6()}o=$(D.activeElement);
$("#copyHelper").val(f).focus().select();
D.execCommand("copy");
o.focus()}}function mn(b){var a,c;
if(bp(b.f6)==1){a=b.f6[0].ke()}else{c=new fJ();
c.l_(b);
a=c.l6()}return a}function mo(){var d=this.l0(),b,c,a;
for(c=0,a=bp(d);
c<a;
c++){if(b=d[c].er){return b}}}function mp(){var c=this,b,a;
if(!c.f6){c.f6=[];
for(b=0,a=bp(c.du);
b<a;
b++){b_(c.f6,c.du[b].ep)}for(b=0,a=bp(c.d5);
b<a;
b++){b_(c.f6,c.d5[b].ep)}for(b=0,a=bp(c.io);
b<a;
b++){b_(c.f6,c.io[b].ep)}}return c.f6}function mq(){var c=this,b,a;
if(!c.jN){c.jN=[];
for(b=0,a=bp(c.du);
b<a;
b++){b_(c.jN,c.du[b].c8.im);
b_(c.jN,c.du[b].c_.im)}for(b=0,a=bp(c.d5);
b<a;
b++){b_(c.jN,c.d5[b].im)}for(b=0,a=bp(c.io);
b<a;
b++){b_(c.jN,c.io[b].im)}}return c.jN}function mr(a){this.copy(a);
this.ms()}function mt(b,a){var d=this,c=b.eu;
if(c&&!bX(d.io,c)){return d.hZ(c,a)}else{b_(d.d5,b);
if(!d.mu){d.fx(bg);
b.dH=T;
if(!a){fm(b)}}return T}}function mv(a){var b=this;
if(b4(a,b.d5)&&!b.mu){b.fx(bg);
a.dH=F;
b.j1(a);
fm(a)}}function mw(d,c){b_(this.io,d);
for(var e=this,b=0,a=bp(d.d5);
b<a;
b++){e.fW(d.d5[b],c)}for(b=0,a=bp(d.du);
b<a;
b++){e.f0(d.du[b],c)}for(b=0,a=bp(d.hG);
b<a;
b++){e.f0(d.hG[b],c)}if(!e.mu){e.fx(bg);
d.dH=T;
if(!c){fm(d)
}}return T}function mx(c){var d=this,b,a;
if(b4(c,d.io)&&!d.mu){d.fx(bg);
c.dH=F;
d.j1(c);
fm(c)}for(b=0,a=bp(c.d5);
b<a;
b++){d.fG(c.d5[b])}for(b=0,a=bp(c.du);
b<a;
b++){d.fF(c.du[b])}for(b=0,a=bp(c.hG);
b<a;
b++){d.fF(c.hG[b])}}function my(c,a){var d=this,b=c.eu;
if(b&&!bX(d.io,b)){return d.hZ(b)}else{if(b_(d.du,c)){if(!d.mu){d.fx(bg);
c.dH=T;
if(!a){fm(c)}}return T}return F}}function mz(a){var b=this;
if(b4(a,b.du)&&!b.mu){b.fx(bg);
a.dH=F;
b.j1(a);
fm(a)}}function mA(b){for(var c=0,a=bp(b.d5);
c<a;
c++){this.fW(b.d5[c])}for(c=0,a=bp(b.du);
c<a;
c++){this.f0(b.du[c])}}function mB(b,a){this.fO=b;
if(!this.mu){this.fx(bg);
b.dH=T;
if(!a){fm(b)}}return T}function mC(){var a=this;
if(a.fO){if(!a.mu){a.fx(bg);
a.fO.dH=F;
fm(a.fO)}a.fO=am}}function mD(b,a){if(b_(this.kC,b)){if(!this.mu){this.fx(bg);
b.dH=T;
if(!a){fm(b)}}return T}return F}function mE(a){if(b4(a,this.kC)&&!this.mu){this.fx(bg);
a.dH=F;
fm(a)}}function mF(o,n,l){l=bG(l);
var c=this,k=st.dB(),a=k.f6,h,e,b,g,d,m,f;
for(e=0,b=bp(a);
e<b;
e++){h=a[e];
for(g=0,d=bp(h.d5);
g<d;
g++){f=h.d5[g];
if(!f.d1&&f.c9.cV(o,n,l)){c.fW(f)}}for(g=0,d=bp(h.du);
g<d;
g++){f=h.du[g];
if(!f.d1&&f.d6().cV(o,n,l)){c.f0(f)}}for(g=0,d=bp(h.io);
g<d;
g++){f=h.io[g];
if(!f.eM&&f.d6().cV(o,n,l)){c.hZ(f)}}}m=k.fO;
if(m){if(m.dR.cV(o,n,l)||m.dQ.cV(o,n,l)){c.fT(m)}}for(e=0,b=bp(k.kC);
e<b;
e++){f=k.kC[e];
if(f.c9.cV(o,n,l)){c.kD(f)}}}function mG(n,m){var c=this,k=st.dB(),a=k.f6,h,e,b,g,d,l,f;
for(e=0,b=bp(a);
e<b;
e++){h=a[e];
for(g=0,d=bp(h.d5);
g<d;
g++){f=h.d5[g];
if(!f.d1&&f.c9.cX(n,m)){c.fW(f)}}for(g=0,d=bp(h.du);
g<d;
g++){f=h.du[g];
if(!f.d1&&f.d6().cX(n,m)){c.f0(f)}}for(g=0,d=bp(h.io);
g<d;
g++){f=h.io[g];
if(!f.eM&&f.d6().cX(n,m)){c.hZ(f)}}}l=k.fO;
if(l){if(l.dR.cX(n,m)||l.dQ.cX(n,m)){c.fT(l)}}for(e=0,b=bp(k.kC);
e<b;
e++){f=k.kC[e];
if(f.c9.cX(n,m)){c.kD(f)}}}function mH(c){var f=this,b,e,d,a;
if(!f.fD){b=[];
for(d=0,a=bp(f.d5);
d<a;
d++){e=f.d5[d];
b.push(e);
if(!c){b9(b,e.du)}}for(d=0,a=bp(f.du);
d<a;
d++){e=f.du[d];
b_(b,e);
if(!c){if(b_(b,e.c8)){b9(b,e.c8.du)}if(b_(b,e.c_)){b9(b,e.c_.du)}}}for(d=0,a=bp(f.io);
d<a;
d++){e=f.io[d];
b.push(e)}b0(b,f.fO);
bZ(b,f.kC);
f.fD=b}return f.fD}function mI(d){var c=this,b=[],k=[],g,l,m,h,f,e,a;
for(h=0,f=bp(c.d5);
h<f;
h++){g=c.d5[h];
if(!d||!g.d1){k.push(g);
b.push(g.c9)}}for(h=0,f=bp(c.du);
h<f;
h++){g=c.du[h];
if((!d||!g.d1)&&!bX(c.d5,g.c8)&&!bX(c.d5,g.c_)){k.push(g.c8);
k.push(g.c_);
b.push(g.c8.c9,g.c_.c9)}}for(h=0,f=bp(c.io);
h<f;
h++){g=c.io[h];
if(g.eP){for(e=0,a=bp(g.eP);
e<a;
e++){b.push(g.eP[e].dR,g.eP[e].dQ)}}if(!d){b0(b,g.fw);
b0(b,g.dd);
b0(b,g.db)}if(d&&!g.eM&&bp(g.hH)){for(e=0,a=bp(g.hH);
e<a;
e++){l=g.hH[e];
if(!bX(k,l)){b.push(l.c9)}}}else{for(e=0,a=bp(g.d5);
e<a;
e++){l=g.d5[e];
if(!bX(k,l)){b.push(l.c9)}}}}m=c.fO;
if(m){b.push(m.dR,m.dQ)
}for(h=0,f=bp(c.kC);
h<f;
h++){b.push(c.kC[h].c9)}if(!d){b0(b,c.fw)}return b}function mJ(k,h){if(!k){k=new cd()}h=(h==am?this.mu:h);
var d=this,c=new hp(h),b,f,a=[],g,e,l,j;
bT(k,d,c);
for(g=0,e=bp(d.io);
g<e;
g++){b=d.io[g];
f=k.cb(b);
c.hZ(f,T);
l=b.ep;
j=k.bV[l.bQ];
if(!j){j=new fH();
k.bV[l.bQ]=j;
a.push(j)}j.hZ(f,T)}for(g=0,e=bp(d.du);
g<e;
g++){b=d.du[g];
f=k.cb(b);
c.f0(f,T);
l=b.ep;
j=k.bV[l.bQ];
if(!j){j=new fH();
k.bV[l.bQ]=j;
a.push(j)}j.f0(f,T)}for(g=0,e=bp(d.hG);
g<e;
g++){b=d.hG[g];
f=k.cb(b);
b_(c.hG,f);
l=b.ep;
j=k.bV[l.bQ];
if(!j){j=new fH();
k.bV[l.bQ]=j;
a.push(j)}j.f0(f,T)}for(g=0,e=bp(d.d5);
g<e;
g++){b=d.d5[g];
f=k.cb(b);
c.fW(f,T);
l=b.ep;
j=k.bV[l.bQ];
if(!j){j=new fH();
k.bV[l.bQ]=j;
a.push(j)}j.fW(f,T)}if(d.fO){c.fT(k.cb(d.fO),T)}for(g=0,e=bp(d.kC);
g<e;
g++){c.kD(k.cb(d.kC[g]),T)}if(c.f6){bZ(c.f6,a)}else{c.f6=a}for(g=0,e=bp(c.f6);
g<e;
g++){j=c.f6[g];
j.hs=am;
j.iJ()}if(d.fw){c.fw=d.fw.cc()}c.hV=d.hV;
c.dE();
return c}function mK(h,b){var g=this,f,e=st.dB(),d,c,a;
if(!b){b=[]}else{if(bX(b,g)){return}}b.push(g);
if(h>be){if(h!=bf){g.f6=am;
g.jN=am}g.fw=am;
g.fD=am}if(h!=bf){f=g.l0();
for(c=0,a=bp(f);
c<a;
c++){f[c].fx(bg,b)}if(d=g.fO){d.fx(h,b)}}e.fx(h,b);
b.pop()}function mL(d,a,b,c){this.lr=b;
this.lp=d;
this.lq=a;
this.cT=c}function mM(h,k){var b=[],l=h.getAtoms(),m,g,f,d,e,a,c;
b2(l,this.d5);
for(e=0,a=bp(l);
e<a;
e++){c=l[e];
if(!c.eu){for(g=0,f=bp(this.d5);
g<f;
g++){d=this.d5[g];
if(!d.eu){m=c.c9.cT(d.c9,T);
if(m<=k){b.push(new mL(c,d,this,m));
break}}}}}return b}function mN(m,n){var e=this,d=[],p=m.l4(),b,a,o,l,k,g,h,c,f;
b2(p,e.du);
for(h=0,c=bp(p);
h<c;
h++){f=p[h];
if(f.c8.eu||f.c_.eu){continue}for(l=0,k=bp(e.du);
l<k;
l++){g=e.du[l];
if(g.c8.eu||g.c_.eu){continue}if((b=f.c8.c9.cT(g.c8.c9,T))<=n&&(a=f.c_.c9.cT(g.c_.c9,T))<=n){d.push(new mL(f,g,e,0.5*(b+a)));
break}if((b=f.c8.c9.cT(g.c_.c9,T))<=n&&(a=f.c_.c9.cT(g.c8.c9,T))<=n){o=new mL(f,g,e,0.5*(b+a));
o.eZ=T;
d.push(o);
break}}}return d}function mO(b,a){if(!a){a=this.d6().cc()}fy.apply(this,arguments)}function hp(a){var b=this;
e4.apply(b);
b.mu=a;
b.d5=[];
b.io=[];
b.du=[];
b.hG=[];
b.kC=[];
b.fx=mK;
b.ga=mi;
b.ms=mh;
b.jI=mj;
b.mk=mk;
b.cut=mr;
b.copy=ml;
b.l0=mp;
b.mP=mq;
b.mQ=mo;
b.mR=mf;
b.ungroupGroups=mg;
b.dD=mH;
b.j1=fC;
b.fr=mI;
b.eT=mO;
b.mS=mM;
b.mT=mN;
b.addAll=b.bZ=md;
b.addRectSelection=mF;
b.mU=mG;
b.fW=mt;
b.fG=mv;
b.hZ=mw;
b.ib=mx;
b.f0=my;
b.fF=mz;
b.mV=me;
b.kD=mD;
b.kW=mE;
b.fT=mB;
b.kX=mC;
b.fK=mA;
b.cc=mJ}function mW(){var b="",A=gb[H].m,f=gb[H].gd,n=st.gC(),a=bp(n.d5),c={},o="",l=0,r=0,y={},u="",k=0,v=0,z,m,w,h,t,p,q,x,e=st.dB().getAtoms(),d,g;

n.hG=[];
n.hV=T;
for(t=0,p=bp(e);
t<p;
t++){d=e[t];
if(!d.dH){z=d.eu;
m=(z&&z.type==aw&&z.hK)||1;
if(y){k+=m*d.hz(F);
v+=m*d.hz(T);
y[d.ds]=bG(y[d.ds])+m;
h=d.eD();
y[H]=bG(y[H])+(m*h);
k+=m*A*h;
v+=m*f*h}if(z){if(z.type==aw&&!z.hK){k=am;
v=am;
y=am;
u=s("poly");
break}}}}for(t=0,p=a;
t<p;
t++){d=n.d5[t];
z=d.eu;
m=(z&&z.type==aw&&z.hK)||1;
if(c){l+=m*d.hz(F);
r+=m*d.hz(T);
c[d.ds]=bG(c[d.ds])+m;
h=d.eD();
c[H]=bG(c[H])+(m*h);
l+=m*A*h;
r+=m*f*h}if(w){if(!w.bS(d.im)){n.hV=F}}else{w=d.im}if(z){n.hV=F;
if(z.type==aw&&!z.hK){l=am;
r=am;
c=am;
o=s("poly")}}for(q=0,x=bp(d.du);
q<x;
q++){if(!d.du[q].dH){n.hG.push(d.du[q])}}}for(t=0,p=bp(n.du);
t<p;
t++){g=n.du[t];
if(w){if(!w.bS(g.c8.im)){n.hV=F}}else{w=g.c8.im}if(g.eu){n.hV=F}if(!g.c8.dH||!g.c_.dH){n.hG.push(g)}}n.hV=(n.hV&&a>0&&bp(n.hG)<=2);
if(c){o=mX(c)}if(y){u=mX(y)}mY($("#bondRotate"),bp(n.hG)==1);
mY($("#groupSelection"),n.hV);
mY($("#ungroupSelection"),bp(n.io));
if(a){b+=s("sele")+":&nbsp;"+o+mZ(l,r);
if(u){b+=S+s("rem")+":&nbsp;"+u+mZ(k,v)}}$("#info").html(b);
m0("change")}function mZ(b,a){if(b>0){return"&nbsp;("+round(b,2,3)+"/"+round(a,4,3)+")"}return""}function mX(h){var f,b,a=[C,H],d,e,g,c="";
br(h);
for(f=0,b=bp(a);
f<b;
f++){d=a[f];
e=h[d];
if(e>0){c+=d;
if(e>1){c+=aI+e+aJ}}}for(d in h){e=h[d];
g=gb[d];
if((!g||!g.gc)&&e>0){c+=d;
if(e>1){c+=aI+e+aJ}}}return c}function dB(){var a=this;
if(a.m1){return a.m1}a.m2=bJ(a.m2,0,bp(a.m3)-1);
return a.m3[a.m2]}function gC(){return this.dB().kF}function hd(){return this.m4}function m5(a){this.m4=a}function m6(){if(this.m4){this.m4.m7=am;
this.m4.m8=am;
this.m4=am}}function m9(){if(this.m_()){this.na(-1)}}function nb(){return this.m2>0}function nc(){if(this.nd()){this.na(1)}}function na(a){this.ne();
resetDirty(aZ);
this.m2+=a;
nf(aZ);
ng(this.dB()).fc();
mW()}function ng(a){a.d3();
$("#threed").fadeTo(500,(a.db.z-a.dd.z)>0?1:0).css("color",hj?"red":"black");
return a}function nh(){return this.m2<bp(this.m3)-1}function ni(){var a=bp(this.m3)-nj;
if(a>0){this.m3.splice(0,a);
this.m2-=a}}function nk(){var a=this;
a.ni();
a.m3.splice(a.m2,0,st.dB().cc(new cd(T)));
a.m2++;
a.m3.length=a.m2+1}function nl(a){var b=this;
b.ni();
b.m2++;
b.m3[b.m2]=ng(a);
b.m3.length=b.m2+1}function nm(){var b=this,a=b.m3[b.m2];
b.m3[b.m2]=a.cc(new cd(T));
b.m1=a}function nn(){return !!this.m1}function ne(){var a=this;
if(a.m1){a.m1.dw();
a.m1=am;
a.m6();
a.dB().fc()}}function no(){var a=this;
if(a.m1){a.nl(a.m1);
a.m1=am;
a.m6();
mW()}}function np(){var a=this;
a.m3=[];
a.m3[0]=new fJ(aZ);
a.m2=0;
a.hc=F;
a.nm=nm;
a.nn=nn;
a.ne=ne;
a.no=no;
a.getCurrentReaction=dB;
a.dB=dB;
a.gC=gC;

a.hd=hd;
a.m5=m5;
a.m6=m6;
a.ni=ni;
a.nk=nk;
a.nl=nl;
a.undo=m9;
a.m_=nb;
a.redo=nc;
a.nd=nh;
a.na=na}function nq(a){$("#"+a).click()}function activateTool(d,b){nr();
ns(he,b);
if(he!=b){nt=F;
var a=F;
switch(b){case aU:case aV:nu();
a=T;
break;
case aX:case aY:a=T;
break;
case aP:nt=T;
break}if(!a){$(nv).css({border:"",ec:""});
$(d).css({border:"1.5px solid black",ec:"0.5px"});
nv=d}he=b}else{if(hh&&b==aT){var c=st.gC();
if(!c.ga()){nx()}}}ig()}function useAtom(a){ny(a);
$("#atom").click()}function ns(b,a){switch(b){case aU:case aV:hg=F;
st.ne();
break}}function nz(){nA(nv)}function nA(a){if(a){$(a).trigger("click",{nB:T})}}function nC(a){nD=a.ctrlKey;
return bo(a)}function nE(b){if(!st.hc){var a=b.dataTransfer;
if(!a&&b.originalEvent){a=b.originalEvent.dataTransfer}if(a){a=a.files}else{if(b.target){a=b.target.files}}nF(a,aU,F)}return bo(b)}function nF(c,b,d){if(c&&bp(c)){var a=new FileReader();
a.onload=function(f){var e=f.target.result;
if(d||nD){activateTool(am,b);
pasteMolFile(e)}else{l7(e)}};
a.readAsText(c[0],"iso-8859-1")}}function nG(b,a){if(b&&(!a||!a.nB)){nH=b.target}}function nI(a){nH=am}function nJ(d){if(!d||!d.data||!d.data.nB){nG(d);
var c=$(nH).parent().children(ax),a=aZ.height,b=c.height();
c.fadeIn(50).css("z-index",10000);
c.css(c.offset().top+b>a?{position:"absolute",top:(a-b-25)+"px"}:{position:am,top:am})}}function nK(a){setTimeout(function(){if(!a){nI()}var b=$(ax).filter(":visible");
if(bp(b)){if(nH){b=b.not($(nH).parent().children())}if(bp(b)){if(nL){b.hide()}else{b.fadeOut(100)}}}if(hh&&!bp(b)){nJ()}},100)}function nM(a){if(a.target.tagName.toLowerCase()=="img"){a7.prop("src",a.target.src);
a8=T;
nN()}}function nu(){a8=F;
nO()}function nN(){if(a8){a7.show()}}function nO(){if(a8){a7.hide()}}function nP(){var b=navigator.userAgent.toLowerCase(),a="";
if(/android|blackberry|kindle|mobile|phone/.test(b)){a="mobile"}else{if(/windows|macintosh|linux/.test(b)){a="desktop"}else{if(/Pad|Tablet/.test(navigator.userAgent)){a="mobile"}else{if(/CrOS|Mac/.test(navigator.userAgent)){a="desktop"}else{a=(nQ()?"mobile":"desktop")}}}}return a}function nQ(){return"ontouchstart" in document.documentElement}function setBond(a,b){hi=a;
hj=b;
ng(st.dB())}function hX(){ie(aZ);
st.nk()}function h0(a){ig(T);
ng(st.dB());
fp(a||aZ);
mW()}function nR(h){for(var b=a2.val(),g,d,c="",f=0,a=bp(b);
f<a;
f++){g=b.charCodeAt(f);
if((!d&&g>96&&g<123)||(g==104&&b!="Ph"&&b!="Rh"&&b!="Th")){g-=32}d|=(g>64&&g<91);
c+=String.fromCharCode(g)}if(b!=c){ny(c)}}function nS(g){if(nT||g.timeStamp<nU){hW(F);
return}if(nV(g)){return T}nW=T;
var f=g.which,d,b,c=g.ctrlKey,a=g.shiftKey;
if(nX(a2,g)&&f!=13){if(!a&&((((b=a2.val())==""||!isNaN(bm(b)))&&f>64&&f<91)||(f==72&&b!="P"&&b!="R"&&b!="T"))){ny(b+String.fromCharCode(f));
return F}return T}d=(g.altKey?0.2:1);
switch(f){case 37:nY(-d,0);

break;
case 38:nY(0,-d);
break;
case 39:nY(d,0);
break;
case 40:nY(0,d);
break;
case 74:if(c&&bp(b=st.gC().d5)==2){hX();
fm(st.dB().jK(b[0],b[1]));
h0();
break}case 36:nY(0,0,d);
break;
case 75:case 35:nY(0,0,-d);
break;
case 33:nZ();
n0();
break;
case 34:n1();
n0();
break;
case 67:case 86:case 88:if(c){return T}break}nK();
return bo(g)}function nX(a,b){return a&&b&&a.is(b.target)}function nV(a){return nX(a3,a)||nX(a4,a)||getSelection().toString()}function n2(a){return(nX(a2,a)||nV(a)?T:bo(a))}function hW(a){if(a){nT=T}else{clearTimeout(n3);
n3=setTimeout(function(){nT=F},500)}}function n4(h){if(st.hc||nT||h.timeStamp<nU){nT=F;
return}if(nV(h)){return T}if(nX(a2,h)){if(h.which==27||h.which==113){a2.blur()}if(h.which!=13){return T}}var f=h.which,a,d=h.ctrlKey,b=h.altKey,g=(!d&&!h.shiftKey&&!b),c=st.gC();
if(f>15&&f<19){nU=h.timeStamp+200}switch(f){case 13:if(et){hX();
et.gE(hf());
fm(et);
h0()}else{if(!c.ga()){hX();
c.mR(hf());
h0()}}break;
case 27:et=am;
eF=am;
if(hg){n5=T;
hg=F;
st.ne();
ie(aZ)}else{st.m6();
clearSelection()}nz();
break;
case 46:if(c.ga()){nq("deleteButton")}else{nx()}break;
case 49:case 97:nq("single");
break;
case 50:case 98:nq(d?"clean2D":"double");
break;
case 51:case 99:nq(d?"clean3D":"triple");
break;
case 65:if(d){hX();
c.bZ();
h0()}else{nq(aK)}break;
case 67:if(d){copy(h)}else{if(g){a=T}}break;
case 68:nq("singleDown");
break;
case 69:nq(aO);
break;
case 71:if(d){if(h.shiftKey){doUngroup()}else{createGroup()}}break;
case 76:if(g){a="Cl"}break;
case 77:nq("singleEither");
break;
case 66:case 70:case 72:case 73:case 78:case 80:if(g){a=T}break;
case 79:if(d&&b){$("#fileUpload").click()}else{if(g){a=T}}break;
case 81:nq(aP);
break;
case 82:if(g){a="Br"}break;
case 83:if(d&&b){saveFile()}else{if(g){a=T}}break;
case 84:nq("3d_rotate");
break;
case 85:if(d){doUngroup()}else{nq("singleUp")}break;
case 86:if(d){return}else{nq(aQ)}break;
case 87:nq(aM);
break;
case 88:if(d){cut(h)}break;
case 89:if(d){st.redo()}break;
case 90:if(d){st.undo()}break;
case 107:case 171:case 187:if(et){hX();
et.gV(1);
fm(et);
h0()}break;
case 109:case 173:case 189:if(et){hX();
et.gV(-1);
fm(et);
h0()}break;
case 110:case 190:if(et){hX();
et.hy();
fm(et);
h0()}break;
case 113:a2.focus().select();
break}if(a){if(a===T){a=String.fromCharCode(f)}if(et){hX();
et.gE(a);
fm(et);
h0()}else{ny(a)}}return bo(h)}function n6(b){var a=1/eG;
return new cj((b.x-0.5*n7.x)*a+n8.x,(b.y-0.5*n7.y)*a+n8.y)}function n9(a){var b=a0.offset();
return n6(new cj(a.pageX-b.left,a.pageY-b.top))}function n_(b,a){if(a){oa=[];
ob="M"+b;
oc={x:b.x,y:b.y,x2:b.x,y2:b.y}}else{ob+="L"+b;
oc.x=M.min(oc.x,b.x);
oc.x2=M.max(oc.x2,b.x);
oc.y=M.min(oc.y,b.y);
oc.y2=M.max(oc.y2,b.y)}oa.push(b)
}function od(){return(et?et.ep:(oe?oe.ep:(eF?eF.ep:am)))}function nr(){et=oe=eF=le=lg=am}function of(b){if(parent){parent.postMessage("focused","*")}if(hg||b.which!=1||st.hd()){return}if(eF){if([aT,aO,aP].indexOf(he)<0){n5=T;
return}}nK();
og(b);
hg=T;
n5=F;
oh=et;
oi=oe;
oj=eF;
ok=lg;
ol=le;
om=F;
var d=n9(b),a,c;
n_(d,T);
if(!st.hc){switch(he){case aO:case aP:case aX:case aM:case aK:case aL:case aT:case aN:st.nm();
break;
case aQ:case aR:case aS:a=st.gC();
st.nm();
if(a.ga()){a=new hp(T);
if(c=od()){a.fK(c)}else{a.bZ()}}nr();
st.m5(a);
break}}if(!st.hc){return bo(b)}}function oo(c,d,b,a){if(eg){op(c,d,b,a)}else{oq+=b;
or+=a;
if(os){clearTimeout(os)}os=setTimeout(function(){op(c,d,oq,or);
oq=0;
or=0},500)}return bo(c)}function op(d,h,c,a){var g=n9(d),f,j,k,b,i;
if(st.hc||d.ctrlKey){if(a<0){zoomOut()}else{zoomIn(cA(g,n8))}}else{if(d.shiftKey){f=(d.altKey?0.5:2.5);
if(d.ctrlKey){nY(-a*f,c*f)}else{nY(c*f,-a*f)}}else{if(!(j=st.hd())){hX();
j=st.gC();
if(j.ga()){j=new hp(T);
j.bZ()}}f=-M.PI*a/(d.altKey?af:12);
if(he==aS){i=j.hG[0];
k=(i.c8.dH?i.c8:i.c_);
b=(i.c8.dH?i.c_:i.c8);
j.e8(f,k.c9.cc(),b.c9)}else{k=j.mQ();
j.eU(f,(k?k.c9.cc():am))}}}nr();
ie(aZ);
ig();
ot()}function ou(y){nK();
if(st.hc&&y.which!=1){ov()}else{if(y.which==1&&!n5){og(y);
var f=ow,q=oa[0]||f,b=st.dB(),z,n,t,c,w,u,l,o,x,d,j,r,h,k,g,p,m,v={},a=(st.hc?aY:he);
if((om||!y.ctrlKey)&&(z=st.hd())){t=z.mT(b,ox);
for(w=0,u=bp(t);
w<u;
w++){b.l9(t[w],v)}c=z.mS(b,ox);
for(w=0,u=bp(c);
w<u;
w++){b.l8(c[w],u==1)}n=z.l0();
oy(n);
for(w=0,u=bp(n);
w<u;
w++){b.fK(n[w])}b.l5();
z.fx(bd);
st.no()}else{if(!om&&y.ctrlKey&&(l=(et||oe))){switch(a){case aT:b.j2(l.ep);
st.no();
break;
default:o=st.gC();
if(!y.shiftKey){o.jI()}o.fK(l.ep);
st.no()}}else{switch(a){case aY:if(om){zoomBox(q,f)}else{zoomIn(f)}break;
case aQ:case aR:case aS:st.no();
break;
case aO:case aP:if(!z){o=st.gC();
if(!y.shiftKey){o.jI()}x=0;
if(!om){x=3;
if(oe){o.f0(oe)}if(lg){o.fT(lg)}if(le){o.kD(le)}}if(a==aO){o.addRectSelection(q,f,x)}else{n_(f);
n_(q);
o.mU(oa,oc)}}st.no();
break;
case aW:hX();
d=b.kU(f);
fm(d);
h0();
break;
case aX:if(!om){f.x+=ll}b.lB(q,f);
fm(b);
st.no();
nz();
break;
case aM:if(oe&&!et&&!om){oe.iX();
st.no()}else{r=F;
if(oh){j=oh.ep;
if(!oh.eu&&oh.bS(et)){k=new gv(gw(oh,1));
g=new gy(oh,k,1,0);
j.fW(k);
j.f0(g);

k.gE(hf());
fm(oh);
ie(aZ);
st.no();
break}}else{if(eq=="rxn"||!bp(b.f6)){j=new fH();
b.fK(j);
r=T}else{j=b.f6[0]}}if((!oh||!oh.eu)&&(!et||!et.eu)&&jF(y,q,f,j,oh,et)){if(r){b.kO();
b.kP()}st.no()}else{st.ne()}}break;
case aK:if(et){et.gE(hf());
fm(et);
st.no();
break}case aL:if(oe&&!et&&!om){oe.iX();
st.no()}else{if((oi&&!oh)||(oh&&oh.eu)||(et&&et.eu)){st.ne()}else{p=hf();
gx.f_();
h=oh;
k=et;
if(h&&k&&!k.bS(h)){if(g=h.hu(k)){g.iX()}else{h.ep.f2.jK(h,k)}}else{if(k&&k.bS(h)){om=F;
k=am}if(!om){f=am}r=F;
m=[];
if(eq!="rxn"){j=b.f6[0]}else{if(h){j=h.ep}else{if(k){j=k.ep}}}if(!j){j=new fH();
b.fK(j);
r=T}if(!h){h=new gv(q.cc());
j.fW(h);
m.push(h)}if(!k&&(om||oh||(a==aL&&p==C))){k=new gv(gw(h,hi,f,y));
j.fW(k);
m.push(k)}j.f0(new gy(h,k,hi,hj));
for(w=0,u=bp(m);
w<u;
w++){m[w].gE(p)}if(r){b.kO();
b.kP()}}st.no();
hg=F;
ie(aZ);
ig(T)}}break;
case aT:if(eF){eF.ep.ib(eF);
eF=am}else{if(et){et.ep.fG(et);
et=am}if(oe){oe.ep.fF(oe);
oe=am}if(lg){lg.f2.kX(lg);
lg=am}if(le){le.f2.kW(le);
le=am}}st.no();
break;
case aN:if(et){j=et.ep;
if(j&&!et.bS(j.er)){fm(j.er);
j.er=et;
fm(et);
st.no()}else{st.ne()}}break}}}hg=F;
if(a==aU){if(oz){oA(y,y.pageX,y.pageY)}else{nz()}}ot()}}}function oB(g,i){var a={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"},d=g.originalEvent,f=d.changedTouches,b=a[d.type],h,c;
if(b){if(i||bp(f)==1){h=f[0];
c=D.createEvent("MouseEvent");
c.initMouseEvent(b,true,true,W,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);
h.target.dispatchEvent(c);
d.preventDefault();
if(b=="mouseup"&&!om){c=D.createEvent("MouseEvent");
c.initMouseEvent("click",true,true,W,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);
h.target.dispatchEvent(c)}return T}return F}}function oC(a){if(a){a.remove();
a.clear()}}function ie(a){if(!a){return}oC(a.jJ);
if(!eF){oC(a.oD)}if(!et){oC(a.fQ)}}function ig(e){var d=st.dB(),a=d.l1(ow),c=d.l3(ow),b;
if(et&&(e||!et.bS(a))){et.hE();
fm(et);
m0("outAtom",et)}if(eF&&(e||!eF.bS(c))){eF.hE()}if(!a){et=am;
b=d.l2(ow);
if(oe&&(e||!oe.bS(b))){m0("outBond",oe)}if(b&&(e||!b.bS(oe))){m0("overBond",b)}oe=b;
if(b){fm(b)}}else{if(e||!a.bS(et)){et=a;
if(oe){fm(oe);
m0("outBond",oe);
oe=am}et.hD();
fm(et);
m0("overAtom",et)}}if(!c){setTimeout(function(){fm(eF);
eF=am},400)}else{if(e||(!c.bS(eF)&&(!eF||!eF.eM))){eF=c;
eF.hD();
fm(eF)}}}function m0(a,b){$(W).trigger(a,{obj:b})}function og(b){nD=b.ctrlKey;
var a=b.clientX,c=b.clientY;
if(hh){a6.css({left:a-4,top:c-4})
}a7.css({left:a+30,top:c+30});
ow=n9(b);
ie(aZ);
if(!et){gx.f_()}ig()}function oE(b,a,c){if(eg){oF(b,a,c)}else{clearTimeout(oG);
oG=setTimeout(function(){oF(b,a,c)},250)}}function oF(h,p,n){og(h);
a0.css("cursor","");
var o,c,j,l,b,q,t,m,d,a,r,g,f,k=(st.hc?aY:he);
if(hg){o=ow;
c=oa[0];
j=st.dB();
if(nt){n_(o)}if(!om){om=(o.cT(c)>oH);
if(om){switch(k){case aO:case aP:if((oh&&oh.dH)||(oi&&oi.dH)||(ok&&ok.dH)||(ol&&ol.dH)){l=st.gC()}else{l=new hp(T);
if(oh){l.fW(oh)}else{if(oi){l.f0(oi)}else{if(oj){l.hZ(oj);
eF=am;
ie(aZ)}else{if(ok){l.fT(ok)}else{if(ol){l.kD(ol)}}}}}}if(!l.ga()){st.m5(l)}break}}}if(l=st.hd()){switch(k){case aQ:case aS:if(om){b=bG(l.m8);
q=M.atan2(o.y-c.y,o.x-c.x);
if(k==aS){r=l.hG[0];
t=(r.c8.dH?r.c8:r.c_);
m=(r.c8.dH?r.c_:r.c8);
l.e8(q-b,t.c9.cc(),m.c9)}else{l.eU(q-b,c)}l.m8=q;
l.fc();
aZ.jJ.push(aZ.path("M"+c+"L"+o).attr(aB,"#f00").attr(aD,de),aZ.text(o.x,o.y+30/eG,round(q*ah,1)+"").attr(aA,2+20/eG))}break;
case aR:if(om){b=(l.m7||c);
l.m7=o;
q=(h.altKey?0.01:0.1);
l.eV(q*(b.y-o.y),q*(o.x-b.x),l.d6())}break;
default:oI(c,o,j,aZ)}}else{switch(k){case aY:case aO:oJ(aZ,c,o);
break;
case aP:aZ.jJ.push(aZ.path(ob+"Z").attr(oK));
break;
case aM:if((!oh||!oh.eu)&&(!et||(!et.eu&&!et.bS(oh)))){jF(h,c,o,am,oh,et)}break;
case aK:case aL:if(om&&!oi&&(!oh||!oh.eu)&&(!et||(!et.eu&&!et.bS(oh)))){gx.f_();
t=oh;
m=et;
d=[];
if(t&&(r=t.hu(m))){r=gx.f0(r);
r.iX()}else{a=hf();
if(!t){t=gx.fW(new gv(c.cc()));
d.push(t)}if(!m){m=gx.fW(new gv(gw(t,hi,o,h)));
d.push(m)}gx.f0(new gy(t,m,hi,hj));
for(g=0,f=bp(d);
g<f;
g++){d[g].gE(a)}}gx.fc()}break;
case aX:if(om){gx.f9(c,o);
gx.fc()}break;
case aT:if(et){et.ep.fG(et);
et=am}if(oe){oe.ep.fF(oe);
oe=am}break}}}else{if(oe){switch(k){case aK:a0.css("cursor","move");
break;
case aL:fm(oe);
var r=gx.f0(oe);
r.iX();
gx.fc();
break}}}switch(k){case aO:case aP:if(et||oe){a0.css("cursor","move")}break}ot()}function oJ(d,c,e){var b=M.min(c.x,e.x),a=M.min(c.y,e.y);
d.jJ.push(d.rect(b,a,M.abs(e.x-c.x),M.abs(e.y-c.y)).attr(oK))}function oI(b,j,g,c){var h=st.hd(),m,l,d,a,n,k,f,e;
if(!h||st.hc){return}m=(h.m7||b);
l=j.cz(m);
h.cu(l.x,l.y);
h.m7=j;
if(g){d=h.mS(g,1.5*ox);
for(f=0,e=bp(d);
f<e;
f++){a=d[f];
n=a.lq.c9;
k=a.lp.c9;
c.jJ.push(c.ellipse(n.x,n.y,ox,ox).attr(oL).attr(aH,a.cT<ox?oM:oN));
c.jJ.push(c.ellipse(k.x,k.y,ox,ox).attr(oL).attr(aH,a.cT<ox?oM:oN))}}}function oO(c,d,b){var a="templates/"+b+".mol";

jQuery.get(a,{},function(e){d.push(new oP(a,e,c));
oO(c,d,b+1)},"text")}function oQ(){var a=$("#builtinTemplates").remove(".template");
if(!bK("noTemplates")){oO(a[0],oR.server,0)}}function addTemplate(b,e){var d,a,c=$(e?"#tmpl"+e:"#serverTemplates"),f=oR.server;
if(!c.length){$("<tr>").append($("<td>").addClass("menuWithPopup").mouseleave(nK).click(nK).append(c=$("<div id="+bE("tmpl"+e)+' class="menuPopup templatesMenu">'+getImgSt("del")+' class="button" style="float:right" onClick="hideMenu();"/></div>').css({opacity:0.85}).mouseleave({obj:this},oS).click(nI)).append($(getImgSt(e)+' class="button"/>').mouseenter(nJ).click(nG))).insertBefore("#groupSelection")}if($.isArray(b)){for(d=0,a=bp(b);
d<a;
d++){f.push(oT(b[d],c))}}else{f.push(d=oT(b,c));
return d}}function oT(a,b){try{a=pako.ungzip(atob(a),{to:"string"})}catch(c){}return new oP(am,a,b)}function gF(b){if(!b){return}b=b.charAt(0).toUpperCase()+b.substr(1);
for(var d,c=0,a=bp(oR.server);
c<a;
c++){d=oR.server[c];
if(d.er&&$.inArray(b,d.oU)!=-1){return d}}}function oV(){if(this.url){jQuery.get(this.url,{},function(a){this.f2=new fJ(this.dj,a);
this.fc()},"text")}}function oW(){var a=this,f=a.f2,c,b,e,g,j=kr,h=kr,d=a.oX.parent(".templatesMenu");
for(c=0,b=bp(f.f6);
c<b;
c++){e=f.f6[c];
if(!a.er){a.er=e.er}if(!a.tooltip){a.tooltip=e.a4}if(!$.isArray(a.oU)){a.oU=e.a3}}g=bH(a.tooltip);
if(a.oU&&bp(a.oU)){g+=" ("+a.oU.join(",")+")"}a.oX.attr("title",g);
f.d3();
j+=M.max(oY-f.db.x+f.dd.x,0);
h+=M.max(oY-f.db.y+f.dd.y,0);
a.dj.setViewBox(f.dd.x-j,f.dd.y-h,f.db.x-f.dd.x+2*j,f.db.y-f.dd.y+2*h);
d.show();
f.fc();
d.hide()}function oy(c){for(var b=0,a=bp(c);
b<a;
b++){fm(c[b].er);
c[b].er=am}}function oZ(b,a,c){oz=F;
o0=b.data.obj;
oA(b,a,c);
oS();
setTimeout(nK,700)}function o1(b,a,c){oz=T}function oA(b,a,c){o2();
oE(b,a,c)}function o2(){activateTool(am,aU);
o3(o0.f2.cc(),o0.er)}function o3(c,b){st.nm();
var e=c.f6,g=st.dB(),d,a,f=new hp(T);
c.mc(aZ);
for(d=0,a=bp(e);
d<a;
d++){g.fK(e[d],F,T);
f.fK(e[d])}hg=T;
oa[0]=(b?b.c9:f.d6());
st.m5(f)}function o4(c){var b=c.data.obj,a=$(b.oX[0].firstChild).clone().attr("width",o5).attr("height",o5);
$("#overlay").empty().append(a).show().mouseenter(function(){$(".templatesMenu").hide()})}function oS(){var a=$("#overlay");
if(bi){a.hide()}else{a.fadeOut()}}function gG(){var a=new cd();
this.f2.cc(a);
return a.cb(this.er)}function oP(b,a,c){var f=this,e,d=(hh?33:50);
f.url=b;
f.oX=$("<div>").css({display:"inline-block"}).addClass("button template").appendTo(c).click({obj:f},oZ).dblclick({obj:f},o1).mouseenter({obj:f},o4);
f.dj=new Raphael(f.oX[0],o6,o7);
bP.apply(f.dj);
nf(f.dj);
f.f2=new fJ(f.dj,a);
if(e=f.f2.f6[0]){e=bH(e.a4).substr(0,12);
f.oX.append($("<div>").css({position:"absolute",top:0,height:"100%",padding:"25% 3px","background-color":"white",opacity:0.3,"font-size":(bp(e)>6?d:d*2)+"%"}).text(e))}f.gG=gG;

f.reload=oV;
f.fc=oW;
f.fc()}var isReady=F,lang=bF(bK("lang"),"en"),bN=["en","de"],langDef={},o8=(typeof nw!="undefined"),o9=!!bK("embedded"),eg=Raphael.svg,hh=(nP()=="mobile"),iconSize=(hh?35:20),nL=bi,n8=new cj(),eG,o_=1000,pa=0.001,pb=0.25,ii=16,n7,st,mm,gx,he,hi=1,hj=0,eq=bF(bK("mode"),"mol"),ez=!!bK("debug"),n5=F,nD,ow,nH,et,eF,oe,le,lg,hg=F,nT=F,nU=0,n3,oG,os,oq=0,or=0,om,nt=F,oa=[],ob="",oc={},oh,oj,oi,ol,ok,pc=4,oH=3,nv,o0,oz=F;
bM();
var nj=30,js=12,jH=30,o6=50,o7=50,eC=10,dc=eC*1.4,dl=2,dg=1.5,df=0.06,di=0.01,ec=1.5*eC,dG=7,ll=55,dO=7,dP=0.2,h3=0.5,ox=0.25*eC,pd=0.1,eB=0.38,de=(eg?0.333333333:1),dK=1,ey=0.02*eC,ex=6,h_=eC*0.5,ka=eC*0.25,lP=2,jG=30,o5,eH="#000",dJ=eH,dk=(ez?"gray":"#fff"),es="#f00",dI="#0f0",dT="#666",ew="#00f",ev="#f00",oM="#0f0",oN="#f00",oL={"stroke-width":0,"fill-opacity":0.4},oK={stroke:dI,fill:dI,"fill-opacity":0.2},eK={stroke:"deepskyblue",fill:"deepskyblue","fill-opacity":0.2,"stroke-width":de},oR={server:[]},kr=0.45*eC,oY=3.5*kr,pe=dc/720,pf=0.2,ko=0.3,kn=0.6*dc,pg=0.3*dc,ph=400,pi=80,pj=0.6,pk=0.1;
function hf(){var a=a2.val();
if(!a){a=C}return a}function ny(a){a2.val(a)}function n0(){var a=1/eG;
if(aZ){aZ.setViewBox(n8.x-0.5*a*n7.x,n8.y-0.5*a*n7.y,n7.x*a,n7.y*a)}if(!eg){st.dB().fc()}}function pl(a){n8=a;
n0()}function pm(a){if(!a){return pc}return M.max(M.min(a,o_),pa)}function ov(f){var c=st.dB(),b,e,a,d;
if(bp(c.getAtoms())>0){c.d3();
b=c.dd.x-ec;
e=c.dd.y-ec;
a=c.db.x+ec;
d=c.db.y+ec;
eG=pm(M.min(n7.x/(a-b),n7.y/(d-e)));
if(f&&eG>f){eG=f}}else{eG=pc}pl(new cj(0.5*(b+a),0.5*(e+d)))}function zoomBox(a,b){eG=M.min(o_,n7.x/M.abs(b.x-a.x),n7.y/M.abs(b.y-a.y));
pl(cA(a,b))}function zoomIn(a){nZ();
if(a){pl(a)}else{n0()}if(!st.hc){nz()}}function nZ(){if(eG<o_){eG/=1-pb}}function zoomOut(){if(he==aY){nz()}n1();
n0()}function n1(){if(eG>pa){eG*=1-pb}}function nY(b,a,f){var e=b*eC/eG,d=a*eC/eG,c=st.gC();
if(st.hc||c.ga()){n8.x+=e;
n8.y+=d;
if(f&&!st.hc){hX();
st.dB().cu(0,0,f);
h0()}n0()}else{hX();
c.cu(e,d,f);
h0()}ig()}function eI(a){if(!hg){return bo(a)}}function iA(){}function pn(){if(!a0){a0=$("#svgParent")
}if(aZ){aZ.canvas.style.display="none"}n7=new cj(a0.width(),a0.height());
if(aZ){aZ.canvas.style.display="";
aZ.setSize((eg?"100%":n7.x),n7.y)}else{aZ=new Raphael("svgParent",(eg?"100%":n7.x),n7.y);
bP.apply(aZ);
aZ.po=T;
st=new np();
nf(aZ);
gx=new f7();
aZ.canvas.onselectstart=bo;
a0.mousedown(of).mousemove(oE).mouseup(ou).mousewheel(oo).mouseover(nN).mouseout(nO).bind("touchstart",oB).bind("touchmove",oB).bind("touchend",oB)}n0()}function clearSelection(){hX();
st.gC().jI();
h0()}function nx(){hX();
st.gC().ms();
h0()}function cut(a){hX();
st.gC().cut(a);
h0()}function copy(a){st.gC().copy(a)}function getSelectionAsMolfile(){return mn(st.gC().cc().mV())}function getNonselectionAsMolfile(){return mn(st.gC().mk().cc().mV())}function pp(e,d){var c,a;
if(d){var b=e.getData(d),c=new fJ(aZ,b);
if(bp(c.getAtoms())){if(c.kE==0||c.kE==bp(c.f6)){c.kX()}else{if(st.dB().fO){c.kX(T)}}d=c.kF;
d.mu=T;
d.bZ(c);
return d}}else{for(a=0,d=bp(bc);
a<d;
a++){c=pp(e,bc[a]);
if(c){return c}}nF(e.files,aV,T)}}function pasteMolFile(a){o3(new fJ(aZ,a))}function paste(b){var c=(b?(b.originalEvent||b):W).clipboardData,a;
activateTool(am,aV);
st.nm();
if(c){a=pp(c)}if(!a&&mm){a=mm.cc(am,T)}if(a){st.dB().l_(a);
hg=T;
oa[0]=a.d6();
st.m5(a);
ig();
return bo(b)}else{st.ne()}}function flip(a){hX();
var b=st.gC();
if(b.ga()){b.bZ();
b.eZ(a,n8);
b.jI()}else{b.eZ(a)}h0()}function doUngroup(){var a=st.gC();
if(eF){hX();
eF.ij();
h0()}else{if(!a.ga()){hX();
a.ungroupGroups();
h0()}}}function clearReaction(){l7("")}function nf(a){a.clear();
a.jJ=a.set();
a.oD=a.set();
a.fQ=a.set();
a.fn=[]}function saveContent(b,a){var c=D.createElement("a");
c.download=a;
c.href="data:,"+encodeURIComponent(b);
c.click()}function saveFile(a){saveContent(l6(),eq=="rxn"?(a||"reaction")+".rxn":(a||"molecule")+".mol")}function getSVG(b,d){if(aZ&&aZ.canvas){var e=st.dB(),c,a;
e.d3();
c=e.db.x-e.dd.x+2*ec;
a=e.db.y-e.dd.y+2*ec;
aZ.setSize(c,a);
aZ.setViewBox(e.dd.x-ec,e.dd.y-ec,c,a);
$(aZ.canvas).prepend($("<title>").text(b)).children("desc").text(d);
c=aZ.canvas.outerHTML;
pn();
return c}}function saveSVG(a){var b=getSVG();
if(b){saveContent(b,(a||"structure")+".svg")}}function ot(){fp(aZ)}function l6(){st.ne();
return st.dB().l6()}function l7(b){if(!aZ){pn()}nf(aZ);
var a=new fJ(aZ,b);
st.nl(a);
if(eg){a.fc()}h0();
ov(3)}function getReadOnly(){return st.hc}function setReadOnly(b){if(st.hc!=b){st.hc=b;
var a=$("#leftCol");
if(b){a.attr("data-width",a.attr("width"));
a.attr("width",1);
$(".toolbar").hide();
gx.f_();
st.ne();
nr();
ie(aZ);
ot();
nu()
}else{a.attr("width",a.attr("data-width"));
$(".toolbar").show();
a8=T}}}function getDisplayAtomNumbers(){return st.dn}function setDisplayAtomNumbers(a){if(st.dn!=a){st.dn=a;
st.dB().fc()}}function highlightAtom(e,b,a){if(a==am){a=T}var d=st.dB().f6[bG(b)],c;
if(d){c=d.d5[e];
if(c){c.dp=a;
c.fc()}}}function unhighlightAtoms(b){var a=st.dB(),e,d,c;
if(b!=am){e=a.f6[bG(b)];
for(c=bp(e.d5)-1;
c>=0;
c--){d=e.d5[c];
if(d.dp){d.dp=F;
d.fc()}}}else{for(c=bp(a.f6)-1;
c>=0;
c--){unhighlightAtoms(c)}}}function highlightBond(c,b,a){if(a==am){a=T}var d=st.dB().f6[bG(b)],e;
if(d){e=d.du[c];
if(e){e.dp=a;
e.fc()}}}function unhighlightBonds(b){var a=st.dB(),d,e,c;
if(b!=am){d=a.f6[bG(b)];
for(c=bp(d.du)-1;
c>=0;
c--){e=d.du[c];
if(e.dp){e.dp=F;
e.fc()}}}else{for(c=bp(a.f6)-1;
c>=0;
c--){unhighlightBonds(c)}}}function unhighlightAll(a){unhighlightAtoms(a);
unhighlightBonds(a)}function showURL(a){var c=$("#infoArea"),b=(hh?1.8:1);
if(!a){c.hide();
pn()}else{if(a.indexOf("/")<0&&(c.firstChild||(n7.x>600*b&&n7.y>400*b)||!open(a))){c.show().height("50%");
$("#infoContent").html("<iframe src="+bE(a)+' width="99%" height="'+(bi?0.5*n7.y:"95%")+'"/>');
pn()}}}function getMode(){return eq}function getParams(){return"?lang="+lang+"&mode="+eq+"&embedded="+(o9||"")}function mY(b,a){bi?(a?b.show():b.hide()):(a?b.slideDown():b.slideUp())}function getImgSt(a){return'<img src="icons/'+a+(eg?'.svg" width="'+iconSize+'" height="'+iconSize+'"':'.png"')}$(D).ready(function(){a1=$("html");
a2=$("#newAtomSym");
a3=$("#templateShortcuts");
a4=$("#templateName");
a5=$(".templatesMenu").css({opacity:0.85}).mouseleave({obj:this},oS);
a7=$("#editIcon");
$("#fileUpload").change(nE);
a1.bind("paste",paste).bind("drop",nE).bind("dragover",nC).bind("dragend",bo).keydown(nS).keyup(n4);
$("#info").bind("contextmenu",stopPropagation);
if(o8){a1.bind("contextmenu",bo)}if(!ez){$("body").bind("contextmenu",bo)}a1.onscroll=bo;
if(hh){a1.bind("input",nR)}W.onresize=pn;
var a=M.min(a1.width(),a1.height()),b;
for(b in gb){if(!gb[b]["iso"]){gj[gb[b]["an"]]=b}}eG=pm(0.01*a);
o5=M.min(600,a)+aq;
pn();
b=a0.offset();
$("#overlay").css({left:b.left+aq,top:b.top+aq});
if(eq=="rxn"){$(".modeRxn").show()}else{if(eq=="tmpl"){$(".modeTmpl").show()}else{$(".modeMol").show()}}if(!bi&&!o9){$(".modeFile").show()}if(o9){$("#copyright").hide();
$("#info").css("font-size","7pt")}if(bK("readonly")){setReadOnly(T)}else{$(ay+" > img").mouseenter(nJ).click(nG);
$(ay).mouseleave(nK).click(nK);
$(ax).click(nI);
$(".tool").click(nM);
$("td.separator + td").addClass("afterSeparator");
setTimeout(function(){oQ()},50);
bO();
nA(".defaultTool");
if(!bK("nofocus")){a2.focus().blur()}}$.rule(ax).css("left",(iconSize+6)+"px");
if(hh){a6=$("#touchCursor").show();
$.rule("input,.button").css("font-size","20pt");
a2.click(function(){this.select()})}isReady=T});
function cleanStructure(d){st.ne();
var e,c=st.gC(),f=[],b,a;
hX();
if(c.ga()){f.push(st.dB())}else{f=c.mP()}for(b=0,a=bp(f);
b<a;
b++){e=f[b];
e.jB(d);
e.fc()}h0();
ov(3);
if(o0&&he==aU){o2()
}}function mb(e){var g=this,f=g.f6,b,d,a,c=0,h;
g.kX(F);
for(d=bp(g.kC)-1;
d>=0;
d--){g.kW(g.kC[d],T)}for(d=bp(f)-1;
d>=0;
d--){b=f[d];
if(!bp(b.d5)){b4(b,g.f6);
if(d<g.kE){g.kE--}}}h=g.kE;
for(d=0,a=bp(f);
d<a;
d++){b=f[d];
b.jB(e);
if(d==h){g.lB(c,am,T);
c+=ll+ec}else{if(d>0){g.kU(c,0,T);
c+=dG+ec}}b.d3();
b.jS(c);
c+=(b.db.x-b.dd.x)+ec}if(d==h){g.lB(c)}g.kE=h;
ov(3);
nr()}function kA(d){if(!this.jN){this.iJ()}for(var e=this,c=e.kx(),b=0,a=bp(e.jN);
b<a;
b++){e.jN[b].jB(d,c)}}function jC(c,b){var d=this,a=d.d6().cc();
new pq(d,c,b);
d.cu(a.cz(d.d6()))}function pr(){var e=this,c=e.im,g,h,f=e.ps(),l=e.pt(),b=e.pu(),j,d,a,i=pj,k=c.jD();
while((e.pv=f+l+b)>pk){if(g==1||(!g&&b>f)){e.pw(i);
h=1}else{e.px(i);
h=2}j=e.ps();
d=e.pt();
a=e.pu();
if(j+d+a<e.pv){f=j;
l=d;
b=a;
k=c.jD();
i*=0.98}else{c.jE(k);
if(M.abs(i)<0.05){break}if(g){i*=0.5;
g=0}else{i*=-0.8;
if(h==1){g=2}else{g=1}}}}}function py(){var d=this,b=!d.pz,c=d.im,l,g,f,k,e,a,n,m,h,o=0;
d.pA=[];
for(l=0,g=bp(c.d5);
l<g;
l++){k=c.d5[l];
for(f=0;
f<l;
f++){e=c.d5[f];
a=k.c9.cT(e.c9,b);
if((n=kn*(b?1:2)-a)>0){m=ko*n*n;
d.pA.push(new pB(k,e,a,n,m));
o+=m}}if(b){o+=M.abs(k.c9.z)}}for(l=0,g=bp(c.du);
l<g;
l++){k=c.du[l];
h=dc;
if(k.dv==0){h*=1.3}a=k.c8.c9.cT(k.c_.c9,b);
if(a!=h){d.pA.push(k)}k.pC=h;
k.bp=a;
n=M.abs(h-a);
m=(a>pg?n:n*ph);
k.pD=m;
o+=m}return o}function pE(){var r=this,f=!r.pz,k=r.im,n,l,m,p,b,c,u,t,a,v,e,h,g,q,o=0;
for(n=0,l=bp(k.du);
n<l;
n++){c=k.du[n];
u=c.c8;
t=c.c_;
a=t.c9.cz(u.c9,f);
if(!a.x&&!a.y&&!a.z){o+=pi;
continue}e=a.cB();
g=am;
for(m=0,p=bp(k.d5);
m<p;
m++){b=k.d5[m];
if(!b.bS(u)&&!b.bS(t)){v=b.c9.cz(u.c9,f);
if((q=pg-e.cq(v).bp())>0){if((h=a.cn(v))>=0&&h<=(g||(g=a.cn(a)))){o+=pi*q*q}}}}}return o}function pF(){var e=this,b,a,d,f,c=0;
for(b=0,a=bp(e.pG);
b<a;
b++){d=e.pG[b];
d.pH();
f=pe*(pf*d.cT*d.cT+M.abs(d.cT));
d.pD=f;
c+=f}return c}function pI(){for(var f=this,d=0,c,a,e=[],b;
d<3;
d++){f.pJ[d].pH()}f.cT=0;
if(a=f.pK){for(d=0;
d<3;
d++){e[d]=[];
for(c=0;
c<3;
c++){e[d][c]=(f.pJ[d].pL?M.abs(a[c]-f.pJ[d].pK):0)}}b=pM(e);
for(d=0;
d<3;
d++){for(c=0;
c<3;
c++){if(f.pJ[d].pL){if(c!=b[d]){e[d][c]=ar}}else{e[d][c]=M.abs(a[c]-f.pJ[d].pK)}}}b=pM(e);
for(d=0;
d<3;
d++){f.cT+=(f.pJ[d].pK=e[d][b[d]])}}}function pM(e){for(var g=0,b=bp(e),j=[],h=[],f,a,l,d;
g<b;
g++){h[g]=0;
j[g]=g}d=pN(e,j);
l=j.slice();
g=1;
while(d>0&&g<b){if(h[g]<g){f=g%2&&h[g];
a=j[g];
j[g]=j[f];
j[f]=a;
++h[g];
g=1;
if(pN(e,j)<d){l=j.slice()}}else{h[g]=0;
++g}}return l}function pN(e,d){for(var b=0,c=0,a=bp(d);
b<a;
b++){c+=e[b][d[b]]}return c}function pO(){var d=this,b=d.pP,c=d.pQ,a=d.gK;
d.pR=(d.pS.pz?j_(a,c,b):eA(a,c,b));
d.cT=d.pR-d.pK}function pT(){var c=this,b=c.gK,a=bp(b.du);
if(a>3||a==b.gT()){if(a<5){c.pK=[aj,aj,aj]}else{if(a==5){c.pK=[ad,ad,ae]}else{if(a==6){c.pK=[ad,ad,ad]}else{if(a==7){c.pK=[72,ad,ad]}else{if(a==8){c.pK=[0.5*aj,ad,ad]}}}}}}else{c.pK=[ae,ae,ae]}}function pU(b){var h=this,a=h.pS,f=h.gK,d=bp(f.du),e=f.gT(),c=f.ds,g;

if(e==4&&d==2){h.pK=af}else{if((a.pz?d==e:d==4)&&(c=="P"||c=="S")){h.pK=ad}else{if(a.pz&&(c=="P"||c=="S"||d==e)){h.pK=aj}else{if(d==6||(d>3&&h.pR<90)){h.pK=60}else{if((g=a.pV)&&bp(g)&&d==3&&(c=="N"||c=="P")){h.pK=(b?210:(a.pz?90:75))}else{if(d==2&&h.pR>af){h.pK=240}else{h.pK=ae}}}}}}}function pW(d,c){if(d.pD==c.pD){return 0}if(d.pD==undefined||d.pD<c.pD){return 1}return -1}function pX(l){var n=this.pA,k=this.pz,j,g,h,f,e,a,c,b,r,q,p=0,d,o,m;
if(g=bp(n)){l=M.abs(l);
n.sort(pW);
for(j=0;
j<g;
j++){h=n[j];
if(h.pD<0.1){break}if(j/g<M.random()){a=h.bp;
c=h.c8;
b=h.c_;
r=l*(b.c9.x-c.c9.x)*(h.pC-a)/a;
q=l*(b.c9.y-c.c9.y)*(h.pC-a)/a;
if(k){p=l*(b.c9.z-c.c9.z)*(h.pC-a)/a}o=bp(c.du);
m=bp(b.du);
d=o+m;
o/=d;
m/=d;
if(!(h instanceof gy)||bp(h.d4())==0){f=c.hq(b);
f.fF(h);
e=b.hq(c);
e.fF(h)}else{f=c.c9;
e=b.c9}f.cu(-r*m,-q*m,-p*m);
e.cu(r*o,q*o,p*o)}}if(!k){l=0.9-l;
for(n=this.im.fr(),j=g-1;
j>=0;
j--){n[j].z*=l}}this.im.cB()}}function pY(b,a){return(M.abs(b.cT)<31-M.abs(a)*50?0:(b.cT>0?-1:1))}function pZ(w){var A=this.pG,x=this.p0,G,z,E,L,B,r,a,b,l,K,g=[],I,v,e,o,n,h,f,m=[],q=(w>0?1:0),t,J,u,N,d,p,y,O,c;
x.sort(pW);
for(G=0,z=bp(x);
G<z;
G++){f=F;
r=x[G];
b=r.gK;
a=b.c9;
u=d=p=0;
N=a.e0(r.p1[0].c9,r.p1[1].c9,r.p1[2].c9);
for(E=0;
E<3;
E++){l=r.du[E];
N/=l.c8.c9.cT(l.c_.c9)+Number.p2}if(t=(M.abs(N)<0.0001)){e=0;
for(E=0;
E<3;
E++){O=r.pJ[E].pR;
e+=O;
if(O>u){u=r.pJ[E].pR;
N=E}}e=(e<358);
u=pY(r.pJ[N],w)}for(E=0;
E<3;
E++){d+=(K=pY(r.pJ[E],w));
if(K==0){p++;
if(!t){N=E}}}if(p<3){y=[];
for(E=0;
E<3;
E++){l=r.du[E];
if(bp(l.d4())){O=new hp(T);
O.f0(l);
O.fW(l.gP(b));
f=T}else{O=l.hq(b)}y.push(O)}if(t){c=r.pJ[N];
if(M.abs(d)>1&&e){o=a.eW(c.pQ.c9,c.pP.c9);
n=a.cM(o);
l=0;
for(E=0;
E<3;
E++){l+=(E==N?1:-1)*r.pJ[E].cT;
g[E]=0}for(E=0;
E<3;
E++){if(E!=N){J=r.pJ[E].cT+0.3*l;
for(B=0;
B<3;
B++){if(E!=B){g[B]+=(a.e0(r.du[B].gP(b).c9,r.du[E].gP(b).c9,n)>0?1:-1)*J}}}}for(E=0;
E<3;
E++){y[E].cC(g[E]*ag,o,a)}}if(d<0||(e&&u<d-u)||(r.pJ[N].pR>175&&r.pJ[N].cT>0)){J=0;
for(B=0;
B<3;
B++){if(!e||N!=B){J-=r.pJ[B].cT}}c=a.eW(c.pQ.c9,c.pP.c9,r.p1[N].c9);
for(B=0;
B<3;
B++){y[B].cC(bJ((B==N?0.5:-0.25)*J*w,-30,30)*ag,c,a)}}}if(M.abs(d)>(t?2:1)){J=0;
c=a.e1(r.p1[0].c9,r.p1[1].c9,r.p1[2].c9);
for(E=0;
E<3;
E++){for(B=0;
B<3;
B++){if(E!=B){J-=r.pJ[B].cT}}y[E].cC(bJ(J*M.abs(w),-30,30)*ag,c[E],a)}}else{if(p==1&&(!t||u==0)){for(B=0;
B<3;
B++){if(N!=B){if((h=r.pJ[B].cT)>0){o=B}else{n=B}J+=M.abs(h)}}if(o+n){c=a.eW(r.p1[n].c9,r.p1[o].c9);
y[N].cC(bJ(0.5*J*M.abs(w),-30,30)*ag,c,a)}}}}if(f){for(B=0;
B<3;
B++){c=this.p3[r.p1[B].bQ];
for(E=0,L=bp(c);
E<L;
E++){c[E].pH()}}}else{for(B=0;
B<3;
B++){r.pJ[B].pH()}}}if(bp(A)){A.sort(pW);
w=M.abs(w);
m=[];
for(G=0,z=bp(A);
G<z;
G++){r=A[G];
if(r.pD<1){break}if(G/z<M.random()&&(G+q)%2){b=r.gK;
a=b.c9;
o=r.pQ;
n=r.pP;
h=bp(o.du);
f=bp(n.du);
e=h+f;
c=a.eW(n.c9,o.c9);
if(L=bp(r.p4)){for(E=0;
E<L;
E++){I=r.p4[E];
v=I.hq(b);
v.cC(w/pj/L*r.cT*ag*(I.i0(n)?1:-1),c,a)}}else{if(!bX(m,b)&&!bX(m,o)&&!bX(m,n)){m.push(b,o,n);

o.c9.cC(r.cT*w*f/e*ag,c,a);
n.c9.cC(r.cT*-w*h/e*ag,c,a)}}}this.im.cB()}}}function p5(p){var o=this.pG,h,f,e,c,g,k,b,t,d,r,q,m,l,a=[],n=(p>0?1:0);
p=M.abs(p);
if(f=bp(o)){o.sort(pW);
for(h=0;
h<f;
h++){g=o[h];
if(g.pD<1){break}if(h/f<M.random()&&(h+n)%2){k=g.gK.c9;
m=g.pQ;
l=g.pP;
r=bp(m.du);
q=bp(l.du);
d=r+q;
if(c=bp(g.p4)){for(e=0;
e<c;
e++){b=g.p4[e];
t=b.hq(g.gK);
t.eU(p/pj/c*g.cT*ag*(b.bS(g.du[0])?1:-1),k)}}else{if(!bX(a,g.gK)&&!bX(a,m)&&!bX(a,l)){a.push(g.gK,m,l);
m.c9.eU(g.cT*p*q/d*ag,k);
l.c9.eU(g.cT*-p*r/d*ag,k)}}}}this.im.cB()}}function pB(b,a,c,e,d){this.c8=b;
this.c_=a;
this.pC=kn;
this.bp=c;
this.cT=e;
this.pD=d}function p6(a,d,c,b){var e=this;
bP.apply(e);
e.pS=a;
e.gK=d;
e.pQ=c;
e.pP=b;
e.du=[d.hu(c),d.hu(b)];
e.p7=p8;
e.pH=pO;
e.p9=pU;
e.pH()}function p_(a,e,d,c,b){var f=this;
bP.apply(f);
f.gK=e;
f.p1=[d,c,b];
f.du=[e.hu(d),e.hu(c),e.hu(b)];
f.pJ=[a.qa(e,c,b),a.qa(e,d,b),a.qa(e,d,c)];
f.p7=qb;
f.pH=pI;
f.p9=pT}function qc(g,f,d){for(var h=this,c=h.p3[g.bQ],b,e=0,a=bp(c);
e<a;
e++){b=c[e];
if((f.bS(b.pQ)&&d.bS(b.pP))||(f.bS(b.pP)&&d.bS(b.pQ))){break}}if(e==a){b=new p6(h,g,f,d)}return b}function qd(h,b,a,j){var e=this,c=e.qe[h.bQ],g,f,d;
if(c){for(g=0,f=bp(c);
g<f;
g++){d=c[g];
if(bX(d.p1,b)&&bX(d.p1,a)&&bX(d.p1,j)){break}}}else{c=[];
e.qe[h.bQ]=c}if(g==f){d=new p_(e,h,b,a,j);
c.push(d);
e.p0.push(d);
d.p7()}return d}function qb(){for(var a=0;
a<3;
a++){this.pJ[a].p7()}this.p9()}function p8(k){var b=this,f=b.pS,g=b.du,e=bp(g)-1,d,c,h,j,a=(b.pR<af||bp(b.gK.du)>2);
if(!b.p4){if(a){b.p4=[];
for(;
e>=0;
e--){if(!bp(g[e].d4())){b.p4.push(g[e])}}f.p3[b.gK.bQ].push(b)}j=b7(f.hs,g[0].d4(),g[1].d4());
if(d=bp(j)){for(e=0;
e<d;
e++){c=j[e];
h=f.qf[c.bQ];
if(!h){h=[];
f.qf[c.bQ]=h}if(a){h.push(b)}if(!c.pK){k=bp(c.d5);
c.pK=(f.pz&&!c.jl()&&(k==8||(k==6&&c.jm()))?aj:qg(k))}}b.pK=(a?j[0].pK:ak-j[0].pK);
b.pL=T}else{b.p9(k)}}return !!d}function qg(a){return af-ak/a}function qh(d,c){if(d.pR<c.pR){return 1}if(d.pR>c.pR){return -1}return 0}function qi(){var p,l,h,b,g,f,d,e=this,c=e.im,t,u,r,q,o,a,w,v;
for(p=0,l=bp(c.d5);
p<l;
p++){t=c.d5[p];
u=t.du;
a=[];
e.p3[t.bQ]=[];
b=bp(u);
if(e.pz&&b>2){for(h=0;
h<b;
h++){r=u[h];
for(g=h+1;
g<b;
g++){q=u[g];
for(f=g+1;
f<b;
f++){o=u[f];
for(d=f+1;
d<b;
d++){if(u[d].i1().e3(r.i1(),q.i1(),o.i1())){d=-1;
break}}if(d>0){e.qj(t,r.gP(t),q.gP(t),o.gP(t))}}}}}else{if(b>1){for(h=0;
h<b;
h++){a.push(new gJ(t,u[h].gP(t)))}a.sort(gL);
v=T;
for(h=0;
h<b;
h++){g=(h+1)%b;
w=e.qa(t,a[h].gK,a[g].gK);
if(!w.p7(v)){v=F}}}}b9(e.pG,e.p3[t.bQ])}}function qk(){for(var d,a,g=this.im.d5,h,f,n,k,m,b,l,e=0,c=bp(g);
e<c;
e++){h=g[e];
n=this.p3[h.bQ];
if((a=bp(n))>2){m=0;
k=0;

if(!this.pz||a<4){b=ak}else{if(a<7){b=aj}else{if(a<11){b=96}else{if(a<16||a>21){b=ad}else{b=82.29}}}b*=a}for(d=0;
d<a;
d++){f=n[d];
if(f.pL){m+=f.pK}else{k+=f.pK}}k+=m;
if(this.pz?k>b:k!=b){if(m<b){l=(b-m)/(k-m);
for(d=0;
d<a;
d++){f=n[d];
if(!f.pL){f.pK*=l}}}else{l=b/k;
for(d=0;
d<a;
d++){f=n[d];
f.pK*=l}}}}}}function ql(){for(var d=this.im.du,c,b=0,a=bp(d);
b<a;
b++){c=d[b];
c.pC=am;
c.bp=am;
c.pD=am}d=this.hs;
a=bp(d);
for(b=0;
b<a;
b++){d[b].pK=am}}function qm(d){if(bp(d.d5)<10){var b=this,h=d.d5,k,f,a=d.pK,m=b.qf[d.bQ],g,e=bp(m),p,n=0,o=0,j,c,l;
for(g=0;
g<e;
g++){p=m[g];
if(M.abs(p.pK-a)<pd){n++}else{o+=a-p.pK}}if(o){j=o/n;
for(g=0;
g<e;
g++){p=m[g];
if(M.abs(p.pK-a)<pd){p.pK+=j}}}d.jj();
e=bp(h);
if(b.pz){d.ja();
if(a==aj){a=qg(e);
if(e==8){k=[[p=15,p,-p,-p,p,p,-p,-p,3]]}else{k=[[p=(aj-ad)*0.5,p,-p,p,p,-p,2],[p,-p,p,-p,p,-p,1]]}}if(k){f=ar;
while(j=k.pop()){o=j.pop();
for(;
o>=0;
o--){c=0;
for(g=0;
g<e;
g++){c+=M.abs(d.jk(h[g])-j[g])}if(c<f){f=c;
n=j.slice()}if(f==0){break}if(o>0){b5(j)}}}j=n}a=af-a;
k=h[0];
n=k.c9;
n.cu(d.i8.ci(-d.i8.cn(n.cz(d.fw))));
n.eT(0.5*dc/M.sin(0.5*a*ag)/n.cT(d.fw),d.fw);
for(g=1;
g<e;
g++){k=h[g];
k.c9=n.cc();
k.c9.cC(a*g*ag,d.i8,d.fw)}if(j){for(g=0;
g<e;
g++){k=h[g].c9;
k.cC(-j[g]*ag,d.i8.cq(k.cz(d.fw)).cB(),d.fw)}}}else{for(g=1;
g<e;
g++){k=h[g];
f=h[g-1];
if(g==1){c=eA(f,k);
k.c9=c2(f.c9,c,dc)}else{p=b7(m,b.p3[k.bQ]);
if(bp(p)==1){p=p[0];
if(!l){l=(h[2].c9.eQ(h[0].c9,h[1].c9)?1:-1)}c+=(af-p.pK)*l;
k.c9=c2(f.c9,c,dc)}}}}}}function qn(){for(var c=this,b=0,a=bp(c.hs);
b<a;
b++){c.qo(c.hs[b])}}function pq(a,j,e){var b=this,g=[],f,h,l,d,c,k=1;
b.im=a;
b.pz=j;
b.pG=[];
b.p0=[];
b.p3={};
b.qe={};
b.qf={};
b.pV=e;
b.qp=qi;
b.ps=py;
b.pt=pE;
b.pu=pF;
b.px=pX;
b.pw=(j?pZ:p5);
b.qq=qn;
b.qo=qm;
b.qr=qk;
b.jB=pr;
b.qs=ql;
b.qa=qc;
b.qj=qd;
for(d=bp(a.io)-1;
d>=0;
d--){c=a.io[d];
if(c.type==av){f=c.hH.slice();
h=c.du.slice();
l=c.hG.slice();
c.ij(l,h);
g.push({ds:c.ds,d5:f,du:h,hG:l})}}b.hs=i2(a.d4());
b.qp();
do{b.qq();
b.qr();
b.jB();
k--}while(k>0&&b.pv>pk);
b.qs();
for(d=bp(g)-1;
d>=0;
d--){c=g[d];
a.ep.hY(c.ds,c.d5,c.du,c.hG)}a.fx(bg)}hideMenu=nK;
getMolRxnfile=l6;
setMolRxnfile=l7;
beforeChange=hX;
afterChange=h0;
centerView=pl;
zoomFit=ov;
redrawChanged=ot;
delSelection=nx;
Point3D=cj;
Molecule=fH;
Atom=gv;
Bond=gy;
Selection=hp;
