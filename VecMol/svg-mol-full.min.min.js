var ab="Sciformation VectorMol (c) 2012-2022 Felix Rudolphi",W=window,D=document,M=Math,ac=unescape,ad=90,ae=120,af=180,ag=M.PI/af,ah=1/ag,ai=2*M.atan(M.SQRT2),aj=ai*ah,ak=360,al=21600,T=true,F=false,am,S=" ",ao="\n",ap="  0",aq="px",ar=Number.MAX_VALUE,as="obj",C="C",H="H",at="\nM  ",au="SUP",av="MUL",aw="SRU",ax=".menuPopup",ay=".menuWithPopup",az=[0,2,1,3],aA="font-size",aB="stroke",aC="stroke-opacity",aD="stroke-width",aE="stroke-dasharray",aF="--",aG="text-anchor",aH="fill",aI="<sub>",aJ="</sub>",aK="atom",aL="draw",aM="drawChain",aN="drawHotspot",aO="selRect",aP="selLasso",aQ="rotate",aR="3d_rotate",aS="bond_rotate",aT="delete",aU="insertTemplate",aV="paste",aW="drawPlus",aX="drawArrow",aY="zoomIn",aZ,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9=0,a_=new RegExp("^(\\d*)([A-Z%*][a-z#]{0,2})(H\\d*)?\\s*(\\d*[\\+\\-]+)?\\s*$"),ba={8:0,4:1.5},bb={3:6,6:1,11:4},bc=["text/xml","chemical/x-mdl-molfile","text/plain","Text"],bd=0,be=1,bf=2,bg=3,bh=4,bi=!D.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),bj={Element:1,Unspecified:0},bk={Singlet:1,Doublet:2,Triplet:3},bl={Solid:0,Dash:1,WedgedHashBegin:3,WedgedHashEnd:4,WedgeBegin:6,WedgeEnd:7,WavyWedgeBegin:11,WavyWedgeEnd:12};
bm=parseInt;
bn=parseFloat;
function bo(a){if(bi){if(!a){a=W.event}a.returnValue=F;
a.cancelBubble=T}else{a.preventDefault();
a.stopPropagation()}return F}function stopPropagation(a){if(bi){if(!a){a=W.event}a.cancelBubble=T}else{a.stopPropagation()}}function bp(a){return a.length}function bq(){for(var c=0,b=0,a=bp(arguments);
b<a;
b++){c+=arguments[b]}return c/a}function br(b){var e=[],f=[],d,c,a;
for(d in b){f.push(d)}f.sort();
for(c=0,a=bp(f);
c<a;
c++){d=f[c];
e[d]=b[d];
delete b[d]}for(c=0;
c<a;
c++){d=f[c];
b[d]=e[d]}}function bs(a,c){for(var b in a){if(a[b]==c){return b}}}function bt(b){if(!b){return b}var a=/^[\s\n\r\t]*(.*?)[\s\n\r\t]*$/;
if(a.exec(b)){return RegExp.$1}}function bu(e,h,j){if(!$.isArray(h)){return e}var a=[],f=0,b,g,d,c;
if(e!=am){for(d=0,c=bp(h);
d<c;
d++){b=h[d];
g=e.substr(f,b);
if(!j){g=bt(g)}a.push(g);
f+=b}if(bp(e)>b){g=e.substr(f);
if(!j){g=bt(g)}a.push(g)}}return a}function bv(d){for(var c=[],b,e=0,a=(d?bp(d):0);
e<a;
e++){if(d.charAt(e)==S){continue}b=d.indexOf(S,e+1);
if(b==-1){c.push(d.substr(e));
break}c.push(d.substring(e,b));
e=b}return c}function bw(b,c,a){var d=b.substr(0,bp(c));
if(a!=T){d=d.toLowerCase();
c=c.toLowerCase()}return(d==c)}function bx(c,d,b){var e=bp(c)-bp(d),a;
if(e<0){return F}a=c.substr(e);
if(b!=T){a=a.toLowerCase();
d=d.toLowerCase()}return(a==d)}function by(a){if(a==am||a==""){return""}return String(a).replace(/:/g,".").replace(/\r\n/g,ao).replace(/\r/g,ao).replace(/\|/g,ao)}function bz(e,c){c=bm(c);
if(isNaN(c)||c<1){return""}e=String(e);
for(var d="",b=0;
b<c;
b++){d+=e}return d}function bA(a,b){return bB(a,b,S)}function bB(c,d,b){c=String(c);
if(bp(c)>d){return c.substr(0,d)}var a=bp(c);
while(a<d){a++;
c=b+c}return c}function bC(c,d,b){c=String(c);
if(bp(c)>d){return c.substr(0,d)}var a=bp(c);
while(a<d){a++;
c+=b}return c}function bD(a){a=String(a);
return a.replace(/(["\\])/g,"\\$1")}function bE(a){return'"'+bD(a)+'"'}function bF(a,b){if(a==am||a==null||(isNaN(a)&&typeof a=="number")){return b}return a}function bG(a){return bF(a,0)}function bH(a){return bF(a,"")}function bI(b){b=String(b);
var a=b.match(/\-?\d+[\.,]?\d*/);
if(a!=null&&bp(a)>0){return bH(a[0])}return""}function bJ(c,b,a){return M.max(b,M.min(a,c))}function round(c,e,f){var g=1,d,b,a;

c=bn(c);
e=bm(e);
if(isNaN(c)||c==am){return""}if(f!=3){if(c==0){return 0}if(c<0){g=-1;
c*=-1}}b=M.pow(10,e);
switch(f){case 1:d=M.floor(M.log(c)/M.LN10);
break;
case 2:d=M.floor(M.log(c)/3/M.LN10)*3;
break;
case 3:return c.toFixed(bJ(e,0,20));
break;
case 4:e-=M.ceil(M.log(c)/M.LN10);
return g*c.toFixed(bJ(e,0,20));
break;
default:return(g*M.round(c*b)/b)}switch(f){case 1:case 2:a=String(g*M.round(c/M.pow(10,d)*b)/b);
if(d==0){return a}return a+"&sdot;10<sup>"+d+"</sup>"}}function bK(c){var b=location.search,d,a;
if(b&&c){d=new RegExp("[&?]"+c+"=([^&$]*)");
if(a=d.exec(b)){return a[1]}}}function bL(){return a9++}function s(a){return bH(langDef[a])}function bM(){if($.inArray(lang,bN)>=0){document.write('<script type="text/javascript" src="lang_'+lang+'.js"><\/script>')}}function bO(){$(".button, .wTooltip").attr("title",function(){return s(this.id)}).on("dragstart",bo)}function bP(){this.bQ=bL();
this.bR=this.bQ;
this.bS=bS}function bT(b,a,c){if(b.bU){c.bR=a.bR}b.bV[a.bQ]=c}function bS(a){return a!=am&&this.bR==a.bR}function bW(a){return a!=am&&this.bQ==a.bQ}function bX(a,b){return bY(a,b)>=0}function bY(b,d){for(var c=0,a=bp(b);
c<a;
c++){if(b[c].bS(d)){return c}}return -1}function bZ(b,a){b.push.apply(b,a)}function b0(a,b){if(b!=am){a.push(b)}}function b1(a,c){for(var b=bp(a)-1;
b>=0;
b--){if(!bX(c,a[b])){a.splice(b,1)}}}function b2(b,a){for(var c,d=bp(b)-1;
d>=0;
d--){for(c=bp(a)-1;
c>=0;
c--){if(b[d].bS(a[c])){b.splice(d,1);
break}}}}function b3(b,e,c){for(var d=0,a=bp(b);
d<a;
d++){if(b[d].bS(e)){b[d]=c;
return T}}return F}function b4(d,b){if(b){for(var c=0,a=bp(b);
c<a;
c++){if(b[c].bS(d)){b.splice(c,1);
return T}}}return F}function b5(a,b){if(b==am){b=1}if(b!=0){a.unshift.apply(a,a.splice(b,bp(a)))}}function b6(b,d){for(var c=0,a=bp(d);
c<a;
c++){if(!bX(b,d[c])){return F}}return T}function b7(e,d){var b=Array.apply(am,arguments),c=[],f,a;
if(bp(b)>2){e=b.pop();
d=b7.apply(am,b)}for(f=0,a=bp(e);
f<a;
f++){if(bX(d,e[f])){c.push(e[f])}}return c}function b8(e,b){for(var c=[],d=0,a=bp(e);
d<a;
d++){if(!bX(b,e[d])){c.push(e[d])}}return c}function b9(c,b){for(var d=0,a=bp(b);
d<a;
d++){b_(c,b[d])}}function b_(a,b){if(b!=am&&!bX(a,b)){a.push(b);
return T}return F}function ca(a){if(a==am){return am}return this.bV[a.bQ]}function cb(b){if(b==am){return am}var c=this.bV[b.bQ],a;
if(!c){for(a in this.bV){if(b.bS(this.bV[a])){return b}}c=b.cc(this);
this.bV[b.bQ]=c}return c}function cd(a){this.bV={};
this.bU=a;
this.ca=ca;
this.cb=cb}function ce(a){return(720+a)%ak}function cf(a){var b=this.cc();
b.x+=a.x;
b.y+=a.y;
b.z+=a.z;
return b}function cg(b,a){var c=this.cc();
c.x-=b.x;
c.y-=b.y;
c.z=(a?0:c.z-b.z);
return c}function ch(b){var c=this,a=c.bp();
return(a>0?c.ci((b||1)/a):new cj())}function ck(b,a,d){var c=this;
if(b instanceof cj){c.x+=b.x;
c.y+=b.y;
c.z+=b.z}else{c.x+=b;
c.y+=a;
c.z+=bG(d)}}function cl(a){return(this.x==a.x&&this.y==a.y&&this.z==a.z)}function cm(g,e,c){var f=this,a,b,d;
if(f.bp()==0||f.cn(g)<0){return F}a=f.co(g,e);
if(!a){return isNaN(a)}b=f.co(e,c);
if(!b){return isNaN(b)}return(d=f.co(c,g)?(a*b>0&&a*d>0):isNaN(d))}function cp(b,a){var d=this.cn(b.cq(a));
if(d==0&&this.cr(a)<b.cr(a)){return NaN}return d}function cs(a){var b=this;
return new cj(b.x*a,b.y*a,b.z*a)}function ct(b,a){if(b!=1){var c=this;
if(a){c.cu(-a.x,-a.y,-a.z)}c.x*=b;
c.y*=b;
c.z*=b;
if(a){c.cu(a)}}}function cv(b,a){var c=this;
if(b&1){c.x=2*a.x-c.x
}if(b&2){c.y=2*a.y-c.y}}function cw(c,b){if(b){this.cu(-b.x,-b.y,-b.z)}var f=this,d=M.cos(c),e=M.sin(c),a=f.x*d-f.y*e;
f.y=f.x*e+f.y*d;
f.x=a;
if(b){f.cu(b)}}function cx(d,c,a){if(a){this.cu(-a.x,-a.y,-a.z)}var g=this,b=M.cos(c),f=M.sin(c),e=g.z*b-g.x*f;
g.x=g.x*b+g.z*f;
b=M.cos(d);
f=M.sin(d);
g.z=g.y*f+e*b;
g.y=g.y*b-e*f;
if(a){g.cu(a)}}function cy(i,h,g,f){var e=this,c=e.cz(i),b=e.cz(h),d=cA(c,b),a;
if(f){a=c.cq(b);
a=a.cq(d).cB();
if(a){d.cC(f*ag,a)}}if(g){d=d.cB(g)}d.cu(e);
return d}function cD(a){var b=this.cz(a);
return M.abs(b.x)+M.abs(b.y)-M.abs(b.z)}function cE(g,e,d){var f=this,c=g.cz(f),b=e.cz(f),a=c.cq(b);
if(d){a=a.cq(d.cz(f))}return a.cB()}function cF(m,g,a){if(m){if(a){this.cu(-a.x,-a.y,-a.z)}var e=this,i=M.cos(m),h=1-i,f=M.sin(m),l=e.x,k=e.y,j=e.z,d=g.x,c=g.y,b=g.z;
e.x=l*(i+d*d*h)+k*(d*c*h-b*f)+j*(d*b*h+c*f);
e.y=l*(c*d*h+b*f)+k*(i+c*c*h)+j*(c*b*h-d*f);
e.z=l*(b*d*h-c*f)+k*(b*c*h+d*f)+j*(i+b*b*h);
if(a){e.cu(a)}}}function cG(){return M.sqrt(this.cn(this))}function cH(b,a){var c=this.cz(b);
if(a){c.z=0}return c.bp()}function cI(a){var b=this;
return b.x*a.x+b.y*a.y+b.z*a.z}function cJ(b,a){var c=this;
if(a){c=c.cz(a);
b=b.cz(a)}return new cj(c.y*b.z-c.z*b.y,c.z*b.x-c.x*b.z,c.x*b.y-c.y*b.x)}function cK(g,d,b){var f=this,e=f.cz(g),c=f.cz(d),a=f.cz(b);
return e.cq(c).cn(a)}function cL(h,f,c){var a=this,i=h.cz(a),g=f.cz(a),d=c.cz(a),e=i.cM(g).cM(d),b=[];
b.push(e.cq(i).cB());
b.push(e.cq(g).cB());
b.push(e.cq(d).cB());
return b}function cN(b,c){if(c){return ce(this.cO(c)-this.cO(b))}else{var a=b.x-this.x,d=b.y-this.y;
if(!a&&!d){return 0}return ce(M.atan2(d,a)*ah)}}function cP(d,c){var e=this,b,a;
if(c){d=d.cz(e);
c=c.cz(e)}else{c=e}if((b=d.bp())&&(a=c.bp())){return ce(M.acos(d.cn(c)/b/a)*ah)}}function cQ(b,a){return this.cR(b,a)>0}function cS(b,a){var c=b.cT(a,T);
if(c>0){return M.abs(this.cR(b,a))/c}}function cU(b,a){return((a.x-b.x)*(this.y-b.y)-(a.y-b.y)*(this.x-b.x))}function cA(b,a){return new cj(0.5*(b.x+a.x),0.5*(b.y+a.y),0.5*(b.z+a.z))}function cV(c,b,a){return this.x>=M.min(c.x,b.x)-a&&this.x<=M.max(c.x,b.x)+a&&this.y>=M.min(c.y,b.y)-a&&this.y<=M.max(c.y,b.y)+a}function cW(f,e,c){for(var b=F,d=1,a=bp(f);
d<a;
d++){if((((f[d].y<=c)&&(c<f[d-1].y))||((f[d-1].y<=c)&&(c<f[d].y)))&&(e<(f[d-1].x-f[d].x)*(c-f[d].y)/(f[d-1].y-f[d].y)+f[d].x)){b=!b}}return b}function cX(c,b){var a=this;
if(b&&(b.x>a.x||b.x2<a.x||b.y>a.y||b.y2<a.y)){return F}return cW(c,a.x,a.y)}function cY(){return this.x+","+this.y}function cZ(b,a){return(this.x+b)+","+(this.y+a)}function c0(){var a=this;
return new cj(a.x,a.y,a.z)}function c1(f,e,b,a){var d=e*ag,c=b*ag;
return new cj(f.x+a*M.cos(c)*M.cos(d),f.y+a*M.cos(c)*M.sin(d),f.z+a*M.sin(c))}function c2(c,b,a){return c1(c,b,0,a)}function c3(e,d,c){var a=e.cT(d),b;
if(!a){return new cj()}b=c/a;
return new cj(b*(d.y-e.y),b*(d.x-e.x),0.5*(e.z+d.z))}function c4(e,d,a,c){var b,f;
if(c){b=1-c;
e.x=b*e.x+d.x*c;
e.y=b*e.y+d.y*c;
d.x=b*d.x+e.x*c;
d.y=b*d.y+e.y*c}if(a){f=c3(e,d,a);
e.x+=f.x;
d.x+=f.x;
e.y-=f.y;
d.y-=f.y}}function c5(d,c,b){var a=1;
if(d>c){a+=0.3*(d-c)/(b-c)}if(a<1.02){a=1}return a*a}function c6(n,b,q,l,g,o){var r=this,i=r.c7(),c=r.c8.c9.cc(),a=r.c_.c9.cc(),f=r.da(),e,k,p,j,h,m,d;

g=(g||1);
if(f){e=M.max(f.db.z,0.5*dc);
k=bq(e,M.min(f.dd.z,-0.5*dc));
g=M.min(g*c5(a.z,k,e),3.5)*b;
b*=c5(c.z,k,e)}else{g*=b}if(!n[aE]&&(p=(c.cT(a,T)/de))){l=bG(l)+df;
c4(c,a,q,l);
j=dg*(a.y-c.y)/p;
h=dg*(a.x-c.x)/p;
d=i.path("M"+c.dh(-j*b,h*b)+"L"+c.dh(j*b,-h*b)+"L"+a.dh(j*g,-h*g)+"L"+a.dh(-j*g,h*g)+"Z");
if(!o){l-=df+di;
c=r.c8.c9.cc();
a=r.c_.c9.cc();
c4(c,a,q,l);
j/=dg;
h/=dg;
n[aD]=0;
m=i.path("M"+c.dh(-j*b,h*b)+"L"+c.dh(j*b,-h*b)+"L"+a.dh(j*g,-h*g)+"L"+a.dh(-j*g,h*g)+"Z").attr(aH,n[aB])}}else{c4(c,a,q,l);
d=i.path("M"+c+"L"+a);
n[aD]=de*M.min(b,g);
if(!o){m=i.path("M"+c+"L"+a)}}r.dj.push(d.attr({fill:dk,stroke:dk,"stroke-width":dl*n[aD]}));
if(m){r.dj.push(m.attr(n))}}function dm(d,c){if(c||st.dn||d.dp||d.dq||d.dr||d.ds!=C||d.dt!=am||!bp(d.du)){return T}if(bp(d.du)!=2){return F}for(var b=0,a=bp(d.du);
b<a;
b++){if(d.du[b].dv!=2){return F}}return T}function dw(a){var c=this,b;
if(c.dj){if(a&&dx(c.dj)){a.insertAfter(c.dj)}c.dj.remove()}else{if(a&&(b=c.dy())){a.insertBefore(b)}}c.dj=a}function dz(b){for(var e,d,c=0,a=bp(b);
c<a;
c++){d=b[c].dj;
if(dx(d)){if(e){d.insertAfter(e)}e=d}}}function dA(b){var a;
if(b){if(!(a=b.node)&&bp(b)){a=b[0].node}}return(a&&a.parentNode)}function dx(a){var b;
if(a){if(!(b=a.node)&&bp(a)){b=a[bp(a)-1].node}}return(b&&b.parentNode)}function dy(){for(var g=this,c=st.dB(),e=g.dC(),b=c.dD(F),f,d=0,a=bp(b);
d<a;
d++){f=b[d];
if(f.dC()>=e&&dA(f.dj)){return f.dj}}}function dE(){this.dj=am}function dF(){var d=this,c=d.c7(),a=0.5*dG,b=c.path("M-"+a+",0H"+a+"M0,-"+a+"V"+a).attr(aB,d.dH?dI:dJ).attr(aD,dK).transform("t"+d.c9).data(as,d).mouseover(dL).mouseout(dM);
d.dw(b)}function dN(){var a=this,b=a.c7(),d,e=0.5*dO,i=0.5*(1-dP),h=a.dQ.cc(),g=a.dQ.cc(),c=a.dR.cc(),j=a.dR.cc(),f=dJ;
if(a.dS){f=dT}else{if(a.dH){f=dI}}c4(c,h,e,i);
c4(j,g,-e,i);
d=b.path("M"+a.dR+"L"+a.dQ+"L"+h+"M"+a.dQ+"L,"+g).attr(aB,f).attr(aD,dK).data(as,a).mouseover(dU).mouseout(dV);
a.dw(d)}function dW(a){a.remove()}function dX(b){var a=this;
if(a.dj){a.dj.forEach(dW);
a.dj.clear()}else{a.dj=b.set()}return a.dj}function dY(){if(!this.dZ&&!this.d0&&!this.d1){var O=this,o=O.da(),j,u,G,B,k,f,K,g,m,b,E,J,l,t,r,I,z,n,N,A,h,a,w,p,v,q=O.c7(),y={},e=O.c8.c9,d=O.c_.c9,L=bq(e.z,d.z),x=O.dJ||dJ,c=(O.dp?1.3:1);
if(o){o.d2();
j=o.dd.z;
u=bq(o.db.z,j)}if(O.dS){x=dT}else{if(O.dH){x=dI}}if(O.dp){x=tinycolor.mix(x,"#00f",50)}if(L<u&&j<u){x=tinycolor(x);
y[aB]=x.brighten(0.13*(255-x.getBrightness())*(u-L)/(u-j)).toString()}else{y[aB]=x}O.dX(q);
switch(O.dv){case 1.5:case 2:h=0;
a=bp(O.c8.du);
w=bp(O.c_.du);
if((a==1||w==1)&&(a>=3||w>=3||a==w)){}else{p=O.d3();
if(bp(p)){f=0;
for(G=0,B=bp(p);
G<B;
G++){A=bp(p[G].d4);
if(!k||A<f){f=A;
k=p[G]}}K=k.d5()}else{K=new cj();
g=0;
for(G=0,B=bp(O.c8.du);
G<B;
G++){m=O.c8.du[G];
b=(O.c8.bS(m.c8)?m.c_:m.c8);
if(b.bS(O.c_)){continue}K.x+=b.c9.x;
K.y+=b.c9.y;
g++}for(G=0,B=bp(O.c_.du);
G<B;
G++){m=O.c_.du[G];
b=(O.c_.bS(m.c8)?m.c_:m.c8);
if(b.bS(O.c8)){continue}K.x+=b.c9.x;
K.y+=b.c9.y;
g++}if(g){K.x/=g;
K.y/=g}}h=(e.cO(d)-K.cO(d))*ag;

if(M.abs(h)>M.PI){h*=-1}}if((h+2*M.PI)%M.PI>0.01||(a==2&&w==2)||(p&&bp(p))){O.d6(y,c);
if(O.dv==1.5){y[aE]=[aF]}O.d6(y,c,2*(h>0?-1:1),0.15)}else{O.d6(y,c,-1,-0.05);
if(O.dv==1.5){y[aE]=[aF]}O.d6(y,c,1,-0.05)}break;
case 3:O.d6(y,c,-1.5,0.15),O.d6(y,c),O.d6(y,c,1.5,0.15);
break;
default:if(O.d7!=0){K=(O.d7!=1);
O.d6(y,c,0,0,(K?2:4),K)}switch(O.d7){case 1:break;
case 4:y[aD]=de*c;
E=e.cT(d);
l=1.5;
J=2;
if(E){I=0;
J/=E;
t=J*(d.y-e.y);
r=J*(d.x-e.x);
n=0;
v="M"+e;
for(G=0;
G<=E;
G+=l){I++;
n=G/E;
z=(I%2?1:-1);
v+="L"+(e.x*(1-n)+(d.x+t*z)*n)+","+(e.y*(1-n)+(d.y-r*z)*n)}O.dj.push(q.path(v).attr(y))}break;
case 6:y[aD]=de*c;
E=e.cT(d);
l=2;
J=2;
if(E){J/=E;
t=J*(d.y-e.y);
r=J*(d.x-e.x);
v="";
for(G=0;
G<=E;
G+=l){n=G/E;
N=1-n;
v+="M"+(e.x*N+n*(d.x+t))+","+(e.y*N+n*(d.y-r))+"L"+(e.x*N+n*(d.x-t))+","+(e.y*N+n*(d.y+r))}O.dj.push(q.path(v).attr(y))}break;
default:if(O.dv==0){y[aE]=[aF]}O.d6(y,c)}}}else{this.dw()}d8(this)}function d9(a,c){var b=this;
a.d_.attr(aA,16*c).attr(aD,de);
a.bbox=a.d_.getBBox(T);
a.ea=b.eb.rect(a.bbox.x-a.ec,a.bbox.y-a.ec,a.bbox.width+2*a.ec,a.bbox.height+2*a.ec,1.5).attr(aH,a.dk).attr(aD,0).insertBefore(a.d_);
b.ed.push(a.ea,a.d_);
b.ee.push(a)}function ef(b,a){var e=this,d,c;
if(eg){if(b){e.x+=b;
e.d_.node.setAttribute("x",e.x);
e.ea.node.setAttribute("x",e.x-e.ec)}if(a){e.y+=a;
e.d_.node.setAttribute("y",e.y);
e.ea.node.setAttribute("y",e.y-e.ec)}}else{e.x+=bG(b);
e.y+=bG(a);
d=M.round(e.x*al);
c=M.round(e.y*al);
e.d_.shape.path=" m"+d+","+c+" l"+(d+1)+","+c+" e"}}function eh(b,h,f,i,e,g,c,d){var a=this;
a.eb=b;
a.x=h;
a.y=f;
a.dk=g;
a.ec=bG(c);
a.d_=a.eb.text(h,f,i).attr(aB,e).attr(aH,e).attr(aG,"start");
if(d){a.d_.attr("font-weight","bold")}a.bbox=a.d_.getBBox(T);
a.ei=ef}function ej(){for(var c=this,b=0,a=bp(c.ee);
b<a;
b++){c.ee[b].d_.insertAfter(c.ed)}return this.ed}function ek(c,a){var b=this;
b.eb=c;
b.ed=a;
b.ee=[];
b.el=d9;
b.ej=ej}function em(){if(!this.d0&&!this.dZ&&!this.d1){var J=this,v=J.c7(),x=J.c9,z=J.en(),l,a,j,K=dk,d=J.eo(),t=d.ep,e,b,q,G,f,u,g,r,k,n,y,c,h=0,I=0,E=0,o,w=0.8,B,A,m=J.dp;
if(!v){return}if(t&&eq=="tmpl"&&d.bS(t.er)){K=es}if(J.dS){j=dT}else{j=J.dJ||dJ}if(m||d.bS(et)){a=(J.eu?ev:ew)}else{if(J.dH){a=dI}}J.dX(v);
if(!dm(J,z)){if(a||K!=dk){l=v.rect(x.x-ex*ey,x.y-ex*ey,2*ex*ey,2*ex*ey);
if(a){l.attr(aB,a).attr(aD,de)}else{l.attr(aD,0)}if(K!=dk){l.attr(aH,(ez?"red":K))}J.dj.push(l)}}else{e=new ek(v,J.dj);
b=!!(A=bp(J.du));
for(B=0;
B<A;
B++){q=J.du[B];
o=eA(q.c8,q.c_)+90;
if(J.bS(q.c_)){o+=af}o%=ak;
if(o>af){b=F;
break}}G=new eh(v,0,0,J.ds+(st.dn&&!J.dS?J.getIndex()+1:""),j,K,ey,m);
G.d_.attr(aG,"middle");
f=eB*eC/G.bbox.height;
e.el(G,f);
u=G.bbox.width*0.5;
I-=u;
h-=u;
E+=u;
g=J.eD();
if(g&&!b){r=new eh(v,E,0,H,j,dk,ey,m);
e.el(r,f);
E+=r.bbox.width;
if(g>1){k=new eh(v,E,0.4*G.bbox.height,g,j,dk,ey,m);
e.el(k,f*w)}}if(z||J.dq){n="";
if(z&&M.abs(z)!=1){n+=M.abs(z)}if(z){n+=(z>0?"+":"\u2013")}if(J.dq==1){n+=":"}else{if(J.dq==2){n+="."}else{if(J.dq==3){n+=".."}}}y=new eh(v,E,-0.5*G.bbox.height,n,j,dk,ey,m);
e.el(y,f*w)}if(J.dr){c=new eh(v,0,-0.5*G.bbox.height,M.round(J.dr),j,dk,ey,m);

e.el(c,f*w);
I-=c.bbox.width;
c.ei(I)}if(g&&b){if(g>1){k=new eh(v,0,0.4*G.bbox.height,g,j,dk,ey,m);
e.el(k,f*w);
h=M.min(I,h-k.bbox.width);
k.ei(h)}r=new eh(v,0,0,H,j,dk,ey,m);
e.el(r,f);
h-=r.bbox.width;
r.ei(h)}J.dj.transform("t"+x);
if(a){J.dj.push(v.rect(x.x+h-ey,x.y-G.bbox.height*0.5,E-h+2*ey,G.bbox.height).attr(aB,a).attr(aD,de))}}}else{this.dw()}d8(this)}function eE(){if(!this.d1){var b=this,f,d,e,n,k,l={},c=b.c7(),p=new ek(c,b.dX(c)),a,j,h,o,m,g;
if(b==eF||(et&&b==et.eu)){g=(eg?1:1/eG);
b.d2();
o=c.set();
o.push(c.text(2,2,"Ph").attr(aA,2).attr("fill-opacity",0.8),c.path("M2,2L4,2L5,3.5L4,5L2,5L1,3.5Z M2.5,2.5L4,2.5 M4.5,3.5L3.5,4.75 M2.5,4.75L1.5,3.5").attr(aB,"#f00").attr(aD,de).attr(aC,0.85),c.path("M1,0L2,2").attr(aB,eH).attr(aD,de));
o.transform("t"+(b.db.x)+","+(b.dd.y)).data(as,b).mousedown(bo).mouseup(eI).click(eJ);
m=o.getBBox();
b.dj.push(c.rect(b.dd.x,b.dd.y,b.db.x+m.width*1.8*g-b.dd.x,b.db.y-b.dd.y).attr(eK).attr(aC,0.85).data(as,b).mouseout(eL));
b.dj.push(o);
if(b.type==au){b.dj.push(c.path(b.eM?"M0,4H4L2,2.5Z M0,0H4L2,1.5Z":"M0,1.5H4L2,0Z M0,2.5H4L2,4Z").transform("t"+(b.db.x+g)+","+(b.dd.y+m.height*1.3*g)).attr(aB,eH).attr(aD,de).attr(aH,"silver").data(as,b).mousedown(bo).mouseup(eI).click(eN))}}if(!b.eM){if(b.type==au){a=b.d5();
j=new eh(c,a.x,a.y,b.ds,dJ,dk,ey,(b.dH?dI:am));
j.d_.attr(aG,"middle");
h=eB*eC/j.bbox.height;
p.el(j,h)}else{a=b.eO();
l[aB]=(b.dH?dI:dJ);
l[aD]=de;
for(f=0,d=bp(b.eP);
f<d;
f++){e=b.eP[f];
n=e.dR.cc();
k=e.dQ.cc();
c4(n,k,eC*0.4*(a.eQ(n,k)?-1:1));
b.dj.push(c.path("M"+n+"L"+e.dR+"L"+e.dQ+"L"+k).attr(l))}if(b.ds){k=b.eR(3);
j=new eh(c,k.x+eC*0.3,k.y+eC*0.3,b.ds,dJ,dk,ey);
h=eB*eC/j.bbox.height;
p.el(j,h);
b.dj=p.ej()}}if(c==aZ){j.d_.click(function(i){b.eS(i);
return bo(i)}).mousedown(bo).mouseup(eI)}}}else{this.dw()}d8(this)}function cj(a,d,c){var b=this;
b.x=bG(a);
b.y=bG(d);
b.z=bG(c);
b.cM=cf;
b.cz=cg;
b.cB=ch;
b.cu=ck;
b.eT=ct;
b.eU=cw;
b.eV=cx;
b.cC=cF;
b.eW=cE;
b.eX=cy;
b.eY=cD;
b.eZ=cv;
b.bS=cl;
b.bp=cG;
b.cT=cH;
b.ci=cs;
b.cn=cI;
b.cq=cJ;
b.e0=cK;
b.e1=cL;
b.cO=cN;
b.cr=cP;
b.eQ=cQ;
b.co=cp;
b.e2=cS;
b.cR=cU;
b.e3=cm;
b.cV=cV;
b.cX=cX;
b.cc=c0;
b.toString=cY;
b.dh=cZ}function e4(){var a=this;
bP.apply(a);
a.moveBy=a.cu=e5;
a.rotateBy=a.eU=e6;
a.rotate3D=a.eV=e7;
a.rotateAround=a.e8=e9;
a.rotateAroundUnit=a.cC=e_;
a.flip=a.eZ=fa;
a.getCenter=a.d5=fb;
a.fc=fd;
a.dw=fe;

a.dE=ff;
a.setColor=fg}function fh(){var a=this;
bP.apply(a);
a.eo=fi;
a.dw=dw;
a.dX=dX;
a.dE=dE;
a.dy=dy}function fj(b,a){if(a){b4(b,a)}b.d1=T;
b.dw();
d8(b)}function fk(b){for(var c=0,a=bp(b);
c<a;
c++){fj(b[c])}b.length=0}function fl(d,c){var e=d.dC(),f=c.dC();
if(e<f){return -1}if(e>f){return 1}return 0}function fm(c){for(var d=[],b=0,a=bp(c);
b<a;
b++){b_(d,fn(c[b]))}return d}function fn(a){if(!a||a.fo||a.d1){return}var b=a.c7();
if(b){b_(b.fo,a);
a.fo=T}return b}function d8(a){if(!a||!a.fo){return}var b=a.c7();
if(b){b4(a,b.fo);
a.fo=am}}function fp(){dz(st.dB().dD(F))}function fq(d){var b,a,c;
if($.isArray(d)){for(b=0,a=bp(d);
b<a;
b++){fq(d[b])}}else{while(bp(d.fo)){c=d.fo.pop();
if(c.d1){c.dw()}else{c.fo=am;
c.fc()}}if(c){fp();
d.renderfix()}}}function resetDirty(b){while(bp(b.fo)){var a=b.fo.pop();
a.fo=am}}function fr(){var d=this,c,e,b,a;
if(!d.dd||!d.db){d.dd=new cj(ar,ar,ar);
d.db=new cj(-ar,-ar,-ar);
c=d.fs(T);
if(!bp(c)){c=d.fs()}for(b=0,a=bp(c);
b<a;
b++){e=c[b];
ft(d,e)}}}function ft(a,b){fu(a,b.x);
fv(a,b.y);
fw(a,b.z)}function fu(b,a){if(a>b.db.x){b.db.x=a}if(a<b.dd.x){b.dd.x=a}}function fv(b,a){if(a>b.db.y){b.db.y=a}if(a<b.dd.y){b.dd.y=a}}function fw(b,a){if(a>b.db.z){b.db.z=a}if(a<b.dd.z){b.dd.z=a}}function fb(){if(!this.fx){var e=this,b=new cj(),d=e.fs(T),c,a;
if(!bp(d)){d=e.fs()}for(c=0,a=bp(d);
c<a;
c++){b.cu(d[c])}if(a>1){b.x/=a;
b.y/=a;
b.z/=a}e.fx=b}return this.fx}function fe(){if(this.dj){dw.apply(this)}for(var c=this.dD(T),b=0,a=bp(c);
b<a;
b++){c[b].dw()}}function ff(){if(this.dj){dE.apply(this)}for(var c=this.dD(T),b=0,a=bp(c);
b<a;
b++){c[b].dE()}}function fg(b){for(var d=this.dD(T),c=0,a=bp(d);
c<a;
c++){d[c].dJ=b}this.fc()}function fd(){var a=fm(this.dD(F));
fq(a)}function e5(c,b,f){for(var e=this.fs(),d=0,a=bp(e);
d<a;
d++){e[d].cu(c,b,f)}this.fy(bd);
fm(this.dD(F))}function e6(f,b){var e,d,a,c,g=this;
if(!b){b=g.d5().cc();
c=T}e=g.fs();
for(d=0,a=bp(e);
d<a;
d++){e[d].eU(f,b)}g.fy((c?be:bg));
fm(g.dD(F))}function e7(e,d,b){var f,c,a,g=this;
if(!b){b=g.d5().cc()}f=g.fs();
for(c=0,a=bp(f);
c<a;
c++){f[c].eV(e,d,b)}g.fy(bg);
fm(g.dD(F))}function e_(f,c,b){for(var g=this,e=g.fs(),d=0,a=bp(e);
d<a;
d++){e[d].cC(f,c,b)}g.fy(bg);
fm(g.dD(F))}function e9(e,b,d){var a,c;
if(a=b.cT(d)){c=d.cz(b);
c.eT(1/a);
this.cC(e,c,b)}}function fz(d,b){var e,c,a,f=this;
if(!b){b=f.d5().cc()}e=f.fs();
for(c=0,a=bp(e);
c<a;
c++){e[c].eT(d,b)}f.fy(bg);
fm(f.dD(F))}function fa(c,b){if(!b){b=this.d5()}for(var e=this.fs(),d=0,a=bp(e);
d<a;
d++){e[d].eZ(c,b)}this.fy(bd);
fm(this.dD(F))}function fA(){return 0}function fB(){return ar}function fC(){return this.c9.z}function fD(a){b4(a,this.fE)
}function fF(){var b=this,a;
if(b.ep){for(a=bp(b.ep.du)-1;
a>=0;
a--){b.fG(b.ep.du[a])}for(a=bp(b.ep.d4)-1;
a>=0;
a--){b.fH(b.ep.d4[a])}}else{b.ep=new fI()}b.fJ=new fK(aZ);
b.fJ.fL(b.ep);
b.fM=new cd();
b.fM.fN=T}function fO(){var a=this;
return !a.fJ||!a.ep||(!a.fJ.fP&&!bp(a.ep.d4)&&!bp(a.ep.du))}function fQ(){for(var c=this.fJ.dD(F),b=0,a=bp(c);
b<a;
b++){c[b].fc();
aZ.fR.push(c[b].dj)}}function fS(c,a){var b=this;
b.fP=new fT(c,a);
b.fP.dS=T;
b.fJ.fU(b.fP);
return b.fP}function fV(a){var b=this.fM.cb(a);
fW(b,a);
bZ(b.du,a.du);
this.ep.fX(b);
return b}function fY(b){var c=b.dZ,a=b;
if(!c){c=b;
a=b.fZ}fj(c,this.ep.d4);
delete c.dZ;
if(a){delete a.fo;
fn(a);
delete a.dZ}}function f0(a){var b=this.fM.cb(a);
fW(b,a);
this.ep.f1(b);
return b}function f2(c,b){for(var a=bp(c)-1;
a>=0;
a--){c[a].dS=b}}function fW(c,a){c.dS=T;
c.fZ=a;
var b;
if((b=c.ep)&&a.ep){b.dS=T;
b.fZ=a.ep;
if(b=b.f3){b.dS=T;
b.fZ=a.ep.f3}}a.dZ=c}function f4(b){var c=b.dZ,a=b;
if(!c){c=b;
a=b.fZ}fj(c,this.ep.du);
delete c.dZ;
if(a){delete a.fo;
fn(a);
delete a.dZ}}function f5(b){for(var d,c=0,a=bp(b.d4);
c<a;
c++){d=this.fX(b.d4[c]);
d.du=[]}for(c=0,a=bp(b.du);
c<a;
c++){this.f1(b.du[c])}}function f6(c){for(var b=0,a=bp(c.f7);
b<a;
b++){this.fL(c.f7[b])}}function f8(){var a=this;
a.fX=fV;
a.fH=fY;
a.f1=f0;
a.fG=f4;
a.fL=f5;
a.f9=f6;
a.f_=fS;
a.fc=fQ;
a.ga=fF;
a.gb=fO;
a.ga()}function fi(){return(this.fZ?this.fZ:this)}var gc={H:{an:1,m:1.00794,v:1,gd:T,ge:1.007825,gf:{1:1.007825,2:2.01410177811,3:3.01604928}},D:{an:1,m:2.01410177811,v:1,ge:2.01410177811,iso:T},T:{an:1,m:3.01604928,v:1,ge:3.01604928,iso:T},He:{an:2,m:4.002602,ge:4.002603,gf:{3:3.0160293,4:4.0026032}},Li:{an:3,gg:T,m:6.941,gh:7,ge:7.016005,gf:{5:5.0125378,6:6.0151223,7:7.016004}},Be:{an:4,gg:T,m:9.012182,gh:6,ge:9.012183,gf:{7:7.0169292,9:9.0121821,10:10.0135337}},B:{an:5,m:10.811,v:3,gh:5,ge:11.009305,gf:{10:10.012937,11:11.0093055}},C:{an:6,m:12.011,v:4,gd:T,ge:12,gf:{11:11.0114338,12:12,13:13.0033548,14:14.003242}},N:{an:7,m:14.00674,v:5,ge:14.003074,gf:{13:13.0057386,14:14.003074,15:15.0001089,17:17.0084497}},O:{an:8,m:15.9994,v:6,ge:15.994915,gf:{14:14.0085953,15:15.0030654,16:15.9949146,17:16.9991315,18:17.9991604,19:19.0035787,20:20.0040761,21:21.0086546}},F:{an:9,m:18.9984032,v:7,ge:18.998403,gf:{17:17.0020952,18:18.0009377,19:18.9984032,20:19.9999813,21:20.9999489}},Ne:{an:10,m:20.1797,ge:19.992439,gf:{19:19.0018798,20:19.9924402,21:20.9938467,22:21.9913855,23:22.9944673,24:23.9936151}},Na:{an:11,gg:T,m:22.989768,gh:7,ge:22.98977,gf:{21:20.9976551,22:21.9944368,23:22.9897697,24:23.9909633,25:24.9899544}},Mg:{an:12,gg:T,m:24.305,gh:6,ge:23.985045,gf:{22:21.9995741,23:22.9941248,24:23.9850419,25:24.985837,26:25.982593,27:26.9843407,28:27.9838767}},Al:{an:13,gg:T,m:26.9811539,gh:5,ge:26.981541,gf:{25:24.9904286,26:25.9868917,27:26.9815384,28:27.9819102,29:28.9804448}},Si:{an:14,m:28.0855,v:4,ge:27.976928,gf:{27:26.9867048,28:27.9769265,29:28.9764947,30:29.9737702,31:30.9753633,32:31.9741481}},P:{an:15,m:30.973762,v:5,ge:30.973763,gf:{29:28.9818014,30:29.9783138,31:30.9737615,32:31.9739072,33:32.9717253,34:33.9736364}},S:{an:16,m:32.066,v:6,ge:31.972072,gf:{31:30.9795544,32:31.9720707,33:32.9714585,34:33.9678668,35:34.9690321,36:35.9670809,37:36.9711257,38:37.9711634,39:38.9751353}},Cl:{an:17,m:35.4527,v:7,ge:34.968853,gf:{33:32.9774518,34:33.973762,35:34.9688527,36:35.9683069,37:36.9659026,38:37.9680106,39:38.9680077,40:39.9704156,41:40.9706502}},Ar:{an:18,m:39.948,ge:39.962383,gf:{36:35.9675463,37:36.9667759,38:37.9627322,39:38.9643134,40:39.9623831,41:40.9645008,42:41.9630464,43:42.9656707,44:43.9653653,45:44.968095}},K:{an:19,gg:T,m:39.0983,gh:17,ge:38.963708,gf:{38:37.9690801,39:38.9637069,40:39.9639987,41:40.961826,42:41.9624031,43:42.9607157,44:43.9615561,45:44.9606997,46:45.9619762}},Ca:{an:20,gg:T,m:40.078,gh:16,ge:39.962591,gf:{40:39.9625912,41:40.9622783,42:41.9586183,43:42.9587668,44:43.9554811,45:44.9561859,46:45.9536928,47:46.9545465,48:47.9525335,49:48.9556733}},Sc:{an:21,gg:T,m:44.95591,gh:15,ge:44.955914,gf:{43:42.961151,44:43.959403,45:44.9559102,46:45.9551703,47:46.952408,48:47.952235,49:48.9500241}},Ti:{an:22,gg:T,m:47.867,gh:14,ge:47.947947,gf:{44:43.9596902,45:44.9581243,46:45.9526295,47:46.9517638,48:47.9479471,49:48.9478708,50:49.9447921,51:50.946616,52:51.9468982}},V:{an:23,gg:T,m:50.9415,gh:13,ge:50.943963,gf:{47:46.9549069,48:47.9522545,49:48.9485169,50:49.9471628,51:50.9439637,52:51.9447797,53:52.9443425}},Cr:{an:24,gg:T,m:51.9961,gh:12,ge:51.94051,gf:{48:47.9540359,49:48.9513411,50:49.9460496,51:50.9447718,52:51.9405119,53:52.9406538,54:53.9388849,55:54.9408442,56:55.9406452}},Mn:{an:25,gg:T,m:54.93805,gh:11,ge:54.938046,gf:{51:50.9482155,52:51.9455701,53:52.9412947,54:53.9403632,55:54.9380496,56:55.9389094,57:56.9382875}},Fe:{an:26,gg:T,m:55.845,gh:10,ge:55.934939,gf:{52:51.9481165,53:52.9453123,54:53.9396148,55:54.938298,56:55.9349421,57:56.9353987,58:57.9332805,59:58.9348805,60:59.9340769,61:60.9367495}},Co:{an:27,gg:T,m:58.9332,gh:9,ge:58.933198,gf:{55:54.9420031,56:55.9398439,57:56.9362962,58:57.9357576,59:58.9332002,60:59.9338222,61:60.9324794,62:61.9340542}},Ni:{an:28,gg:T,m:58.6934,gh:10,ge:57.935347,gf:{56:55.9421363,57:56.9398005,58:57.9353479,59:58.9343516,60:59.9307906,61:60.9310604,62:61.9283488,63:62.9296729,64:63.9279696,65:64.930088,66:65.9291152}},Cu:{an:29,gg:T,m:63.546,gh:7,ge:62.929599},Zn:{an:30,gg:T,m:65.39,gh:6,ge:63.929145},Ga:{an:31,m:69.723,gh:5,ge:68.925581},Ge:{an:32,m:72.61,ge:73.921179},As:{an:33,m:74.92159,ge:74.921596},Se:{an:34,m:78.96,ge:79.916521},Br:{an:35,m:79.904,v:7,ge:78.918336},Kr:{an:36,m:83.8,ge:83.911506},Rb:{an:37,gg:T,m:85.4678,gh:17,ge:84.9118},Sr:{an:38,gg:T,m:87.62,gh:16,ge:87.905625},Y:{an:39,gg:T,m:88.90585,gh:15,ge:88.905856},Zr:{an:40,gg:T,m:91.224,gh:14,ge:89.904708},Nb:{an:41,gg:T,m:92.90638,gh:13,ge:92.906378},Mo:{an:42,gg:T,m:95.94,gh:12,ge:97.905405},Tc:{an:43,gg:T,m:97.9072,gh:11},Ru:{an:44,gg:T,m:101.07,gh:10,ge:101.904348},Rh:{an:45,gg:T,m:102.9055,gh:9,ge:102.905503},Pd:{an:46,gg:T,m:106.42,gh:8,ge:105.903475},Ag:{an:47,gg:T,m:107.8682,gh:7,ge:106.905095},Cd:{an:48,gg:T,m:112.411,gh:6,ge:113.903361},In:{an:49,gg:T,m:114.818,gh:5,ge:114.903875},Sn:{an:50,gg:T,m:118.71,ge:119.902199},Sb:{an:51,m:121.76,ge:120.903824},Te:{an:52,m:127.6,ge:129.906229},I:{an:53,m:126.90447,v:7,ge:126.904477},Xe:{an:54,m:131.29,ge:131.904148},Cs:{an:55,gg:T,m:132.90543,gh:17,ge:132.905433},Ba:{an:56,gg:T,m:137.327,gh:16,ge:137.905236},La:{an:57,gg:T,m:138.9055,gh:15,ge:138.906355},Ce:{an:58,gg:T,m:140.115,gh:15,ge:139.905442},Pr:{an:59,gg:T,m:140.90765,gh:15,ge:140.907657},Nd:{an:60,gg:T,m:144.24,gh:15,ge:141.907731},Pm:{an:61,gg:T,m:144.9127,gh:15},Sm:{an:62,gg:T,m:150.36,gh:15,ge:151.919741},Eu:{an:63,gg:T,m:151.965,gh:15,ge:152.921243},Gd:{an:64,gg:T,m:157.25,gh:15,ge:157.924111},Tb:{an:65,gg:T,m:158.92534,gh:15,ge:158.92535},Dy:{an:66,gg:T,m:162.5,gh:15,ge:163.929183},Ho:{an:67,gg:T,m:164.93032,gh:15,ge:164.930332},Er:{an:68,gg:T,m:167.26,gh:15,ge:165.930305},Tm:{an:69,gg:T,m:168.9342,gh:15,ge:168.934225},Yb:{an:70,gg:T,m:173.04,gh:15,ge:173.938873},Lu:{an:71,gg:T,m:174.967,gh:15,ge:174.940785},Hf:{an:72,gg:T,m:178.49,gh:14,ge:179.946561},Ta:{an:73,gg:T,m:180.9479,gh:13,ge:180.948014},W:{an:74,gg:T,m:183.84,gh:12,ge:183.950953},Re:{an:75,gg:T,m:186.207,gh:11,ge:186.955765},Os:{an:76,gg:T,m:190.23,gh:10,ge:191.961487},Ir:{an:77,gg:T,m:192.217,gh:9,ge:192.962942},Pt:{an:78,gg:T,m:195.08,gh:8,ge:194.964785},Au:{an:79,gg:T,m:196.96654,gh:7,ge:196.96656},Hg:{an:80,gg:T,m:200.59,gh:6,ge:201.970632},Tl:{an:81,gg:T,m:204.3833,gh:5,ge:204.97441},Pb:{an:82,gg:T,m:207.2,gh:4,ge:207.976641},Bi:{an:83,gg:T,m:208.98037,gh:3,ge:208.980388},Po:{an:84,gg:T,m:208.9824},At:{an:85,m:209.9871},Rn:{an:86,m:222.0176},Fr:{an:87,gg:T,m:223.0197},Ra:{an:88,gg:T,m:226.0254},Ac:{an:89,gg:T,m:227.0278},Th:{an:90,gg:T,m:232.0381,ge:232.038054},Pa:{an:91,gg:T,m:231.03588},U:{an:92,gg:T,m:238.0289,ge:238.050786},Np:{an:93,gg:T,m:237.0482},Pu:{an:94,gg:T,m:244.0642},Am:{an:95,gg:T,m:243.0614},Cm:{an:96,gg:T,m:247.0703},Bk:{an:97,gg:T,m:247.0703},Cf:{an:98,gg:T,m:251.0796},Es:{an:99,gg:T,m:252.083},Fm:{an:100,gg:T,m:257.0915},Md:{an:101,gg:T,m:256.094},No:{an:102,gg:T,m:259.1009},Lr:{an:103,gg:T,m:262.11},Rf:{an:104,gg:T,m:261.11},Db:{an:105,gg:T,m:268},Sg:{an:106,gg:T,m:271},Bh:{an:107,gg:T,m:270},Hs:{an:108,gg:T,m:277},Mt:{an:109,gg:T,m:276},Ds:{an:110,gg:T,m:281},Rg:{an:111,gg:T,m:272},Cn:{an:112,gg:T},"%":{gi:T},M:{gi:T},X:{gi:T},Ln:{gi:T}},gj=[2,10,18,36,54,86],gk={};

function gl(){if(!this.ep){return -1}return bY(this.ep.d4,this)}function gm(a){return bA(round(a/eC,4,3),10)}function gn(){var e=0,g=this,d=bA("0",3),f=(g.dt!=am?g.dt+1:0),a=g.go(),b=M.round(bG(g.gp)),c=g.gq;
if(g.dr&&c){e=M.round(g.dr-c.m);
if(e<-3||e>4){e=0}}if(!c||a==c.v){a=0}else{if(a==0){a=15}}if(b!=0&&M.abs(b)<4){b=4-b}else{if(b!=4){b=0}}return ao+gm(g.c9.x)+gm(-g.c9.y)+gm(g.c9.z)+S+bC(g.ds,3,S)+bA(e,2)+bA(b,3)+d+bA(f,3)+d+bA(a,3)+bz(d,6)}function gr(a){if(a){a=a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}this.ds=a;
this.gs=am;
this.gq=gc[a]}function gt(b){if(!b){return}var e=0,d,a,g,f;
for(d=0,a=bp(b);
d<a;
d++){g=b.charAt(d);
if(g=="+"){e++}else{if(g=="-"){e--}}}f=bI(b);
if(f===""){return e}return f*e}function gu(b){if(b==H){return 1}if(b){if(b.charAt(0)==H){var a=bm(b.substr(1));
if(!isNaN(a)){return a}}}return am}function gv(k,e){var d=this,g=d.ep,c=new gw(T),b=g.er,a=k.ep,i=d,f=1,j,h;
if(k.ds=="*"&&bp(k.du)==1&&((j=k.du[0]).dv!=1||j.d7!=0)){f=-1}else{if(bp(d.du)>1||d.ds!=C){i=new gx(gy(d.eo(),1,e));
if(d.dS){i=gz.fX(i)}j=new gA(d,i,1,0);
if(d.dS){j=gz.f1(j)}else{g.fX(i);
g.f1(j)}}else{j=d.du[0]}}a.cu(i.c9.cz(k.c9));
c.fL(a);
if(j){h=f*eA(j.c8,j.c_)+(j.c_.bS(i)||j.c_.bS(i.fZ)||j.c_.bS(k)||j.c_.bS(k.fZ)?af:0)-f*(f==1?k:d).gB(1);
a.eU(h*ag,i.c9);
h=g.gC(a.d4,T);
a.e8(M.PI,j.c8.c9.cc(),j.c_.c9);
if(h<g.gC(a.d4,T)){a.e8(M.PI,j.c8.c9.cc(),j.c_.c9)}}if(d.dS){a.er=am;
gz.fL(a);
k=k.dZ}else{g.f3.gD(g,a);
if(d.dH){st.gE().fL(a)}}if(f==-1){g.gF(k,i)}else{if(!d.dS){g.gF(i,k)}}g.er=b;
return c}function gG(n,a){var b=this,l,g,e,d,k=0,j=0,h,f,m=b.eu;
if(m&&m.type==av){return}if(!a&&(l=gH(n))){if(m){return}b.attachTemplate(l.gI())}else{b.dq=0;
g="";
for(e=0,d=bp(n);
e<d;
e++){h=n.charAt(e);
if(h=="."){k++}else{if(h==":"){j++}else{g+=h}}}if(j==1){b.dq=1}else{if(k>0){b.dq=k+1}}if(f=a_.exec(g)){b.dr=bF(bm(f[1]),0);
b.gJ(f[2]);
b.dt=gu(f[3]);
b.gp=gt(f[4])}else{if(!!bK("wildcards")){b.gJ(g)}}b.fy(bh)}}function gK(b){var c,f,d,a,e;
if(c=this.gq){if(a=this.dr){if((f=c.gf)&&(f=f[a])){return f}e=c.an;
f=a-e;
d=15.67*a-17.23*M.pow(a,2/3)-0.714*e*(e-1)*M.pow(a,-1/3)-23.2875*M.pow(f-e,2)/a;
if(!(a%2)){d+=11.2*M.pow(a,-0.5)*(e%2?-1:1)}return(939.553*f+938.259*e-d)/931.494061}else{return(b?c.ge:c.m)}}}function gL(b,a){this.gM=a;
this.cO=eA(b,a)}function gN(d,c){if(d.cO<c.cO){return -1}if(d.cO>c.cO){return 1}return 0}function gO(l,o){var k=(o?o.concat():[]),m,f=this.eo(),a=bp(f.du),p,q,c,e,b,d,n,h=0,g;
for(c=0;
c<a;
c++){p=f.du[c];
q=(p.c8.bS(f)?p.c_:p.c8);
k.push(new gL(f,q))}a=bp(k);
k.sort(gN);
if(l){m=f.c9.cO(l);
for(c=0;
c<a;
c++){b=(c+1)%a;
e=k[c].cO;
d=(k[b].cO+ak)%ak;
if(b==0&&(m<d||e<m)){m=0.5*(e+d+ak);
break}else{if(e<m&&m<d){m=0.5*(e+d);
break}}}}else{for(c=0;
c<a;
c++){b=(c+1)%a;
n=(720+k[b].cO-k[c].cO)%ak;
if(n>h){h=n;
g=c}}m=k[g].cO+0.5*h}return m}function gP(){var c=this.eo(),e,a,b,d=c.c9,f=d.z;
for(b=bp(c.du)-1;
b>=0;
b--){e=c.du[b];
a=(e.c8.bS(c)?e.c_:e.c8);
if(M.abs(a.c9.z-f)>0.05*d.cT(a.c9)){return F}}return T}function gQ(b){var e=this,d=bp(e.du),a,c;
if(b){if(d==2){for(c=0;
c<d;
c++){a=e.du[c].gR(e);

if(!a.bS(b)){return a}}}}else{if(d==1){return e.du[0].gR(e)}}return am}function gS(g,e){var f,d=this.eo(),c=bp(d.du),h,i,b,a;
if(!c){if(e){f=d.c9.cO(e)}else{f=-30}}else{if(c==1){h=d.du[0];
i=d.gT();
if(g+h.dv==4){f=eA(d,i)+af}else{if(e){f=eA(d,i);
f+=M.round((d.c9.cO(e)-f+720)/60)*60}else{b=i.get1stNeighbour(d);
if(b){a=(eA(i,d,b)+af)%ak}f=eA(d,i)+ae*(a<af?1:-1)}}}else{f=d.gU(e)}}return f}function gV(){for(var b=0,c=0,a=bp(this.du);
c<a;
c++){b+=this.du[c].dv}return b}function gW(b){var c=this,a=(c.ds=="O"&&b.go()>3);
if(a){if(c.eD()>0){c.gX(-1)}else{if(c.en()<0){c.gX(1)}}if(b.en()<1){b.gX(1)}else{if(b.eD()>0){b.gX(-1)}}}return a}function gY(b){if(b){var c=this,a=c.en();
c.gp=a+b;
c.fy(bh);
fn(c)}}function gZ(){var b=this,a=$.inArray(b.dq,az);
a++;
a%=bp(az);
b.dq=az[a];
b.fy(bh);
fn(b)}function g0(c,a){var b=this;
if(!a){a=[]}else{if(bX(a,b)){return}}a.push(b);
b.z=am;
if(c>bg){b.g1=am;
b.g2=am}a.pop()}function g3(){return(this.gs==am&&this.gq?this.gq.v:this.gs)}function g4(a){if(a==am){return ar}var d=this,c=d.gV(),b=bG(d.gp);
if(d.dq==1||d.dq==3){c+=2}else{if(d.dq==2){c++}}return(a-b<4?a-c-M.abs(b):8-a-c+b)}function g5(c){for(var b=gj.length-1,a;
b>=0;
b--){if((a=c-gj[b])>0){return a}}}function g6(c){var b=this,a=b.gq;
return(a?(a.v?(a.an>13?2:b.g7(b.go())+c+(a.an==7?1:0)):M.min(g5(a.an),a.an>13?3:2)):3)}function g8(){var d=this,b=d.go(),c,a;
if(b==am){d.g2=0;
d.g1=0}else{a=d.dt;
if(a==am){a=d.g1=d.g7(b)}if(a<0&&d.gq){d.g1=0;
c=d.gq.an;
if(c==5){d.g2=a}else{if(c>10){if(a<8-2*b){a=8-2*b-a}else{a%=2}}d.g2=-a}}else{d.g2=0}if(d.g1>4||d.g1>b+1){d.g1=0}}}function g9(){var a=this;
if(a.dt!=am){return a.dt}if(a.g1==am){a.g_()}return a.g1}function ha(){var a=this;
if(a.gp!=am){return a.gp}if(a.g2==am){a.g_()}return a.g2}function hb(b){if(this.fZ){return this.fZ.cc(b)}if(!b){b=new cd()}var c=this,a=new gx(c.c9.cc());
bT(b,c,a);
a.gJ(c.ds);
a.dt=c.dt;
a.d0=c.d0;
a.gp=c.gp;
a.dq=c.dq;
a.dr=c.dr;
a.gs=c.gs;
a.eu=b.cb(c.eu);
a.dH=c.dH;
a.dS=c.dS;
return a}function hc(){var b=this,a=0;
if(b.ds!=C){a+=2}if(b.dr){a+=3}if(b.dq){a+=3}if(b.gp){a+=2}return a}function hd(){if(st.he||st.hf()){return}var c=this,b,a,d;
gz.ga();
switch(hg){case aK:b=gz.fX(c);
b.gG(hh());
gz.fc();
break;
case aL:case aM:if(!hi&&!hj){d=gy(c,hk);
b=gz.fX(c);
a=gz.fX(new gx(d));
gz.f1(new gA(b,a,hk,hl));
a.gG(hh());
gz.fc()}break;
case aT:if(hi){c.ep.fH(c)}break}}function hm(){gz.ga()}function c7(){if(this.eb){return this.eb}if(this.ep){return this.ep.c7()}}function hn(d){if(d){for(var e,b=this.ep,c=0,a=bp(this.du);
c<a;
c++){e=this.du[c];
if((e.c8.bS(d)||e.c_.bS(d))&&(!b||bX(b.du,e))){return e}}}}function ho(){return this.c9}function hp(a){if(!a||!this.d0){return[this.c9]}return[]}function hq(d,c){if(this.bS(d)){return
}if(c){if(bX(c.d4,this)){return c}}else{c=new gw(T)}c.fX(this);
for(var b=0,a=bp(this.du);
b<a;
b++){this.du[b].hr(d,c)}return c}function hs(){if(!this.ht){this.ht=[];
var b=this.ep.d3(),c,a;
for(c=0,a=bp(b);
c<a;
c++){if(bX(b[c].d4,this)){this.ht.push(b[c])}}}return this.ht}function hu(){if(this.z==am){for(var d=this,b=d.c9.z,c=0,a=bp(d.du);
c<a;
c++){b=M.max(d.du[c].dC(),b)}d.z=b+0.000001}return this.z}function gx(b){var a=this;
fh.apply(a);
a.ds=C;
a.du=[];
a.d0=F;
a.dq=0;
a.dr=0;
a.c9=b;
a.dH=F;
a.getCenter=a.d5=ho;
a.fs=hp;
a.hv=hn;
a.d3=hs;
a.attachTemplate=gv;
a.gG=gG;
a.gJ=gr;
a.getIndex=gl;
a.gU=gO;
a.hw=gP;
a.get1stNeighbour=gQ;
a.gT=gQ;
a.gB=gS;
a.go=g3;
a.g7=g4;
a.gV=gV;
a.hx=g6;
a.gX=gY;
a.hy=gW;
a.hz=gZ;
a.fy=g0;
a.g_=g8;
a.eD=g9;
a.en=ha;
a.hA=gK;
a.hB=hc;
a.hr=hq;
a.getMolecule=hC;
a.hD=gn;
a.fc=em;
a.dC=hu;
a.cc=hb;
a.c7=c7;
a.hE=hd;
a.hF=hm}function hG(d){if(!d){d=new cd()}var e=this,b=new e.constructor(),c,a;
bT(d,e,b);
for(c=0,a=bp(e.du);
c<a;
c++){e.du[c].cc(d)}for(c=0,a=bp(e.hH);
c<a;
c++){e.hH[c].cc(d)}for(c=0,a=bp(e.d4);
c<a;
c++){b.fX(d.cb(e.d4[c]),T)}for(c=0,a=bp(e.hI);
c<a;
c++){b.hJ(d.cb(e.hI[c]),T)}for(c=0,a=bp(e.du);
c<a;
c++){b.f1(d.cb(e.du[c]),T)}for(c=0,a=bp(e.hH);
c<a;
c++){b.hK(d.cb(e.hH[c]),T)}b.ds=e.ds;
b.hL=e.hL;
if(e.eP){for(c=0,a=bp(e.eP);
c<a;
c++){b.eP.push(e.eP[c].cc())}}b.hM=e.hM;
b.eM=e.eM;
return b}function hN(d){for(var c=this,b=0,a=bp(c.d4);
b<a;
b++){c.d4[b].d0=d}for(b=0,a=bp(c.du);
b<a;
b++){c.du[b].d0=d}for(b=0,a=bp(c.hH);
b<a;
b++){c.hH[b].d0=am}c.eM=!d;
fm(c.d4);
fm(c.du);
fm(c.hH)}function hO(){for(var d=this,c,b=0,a=bp(d.d4);
b<a;
b++){d.d4[b].d0=T}for(b=0,a=bp(d.hI);
b<a;
b++){d.hI[b].d0=am}for(b=0,a=bp(d.du);
b<a;
b++){c=d.du[b];
c.d0=(c.c8.d0||c.c_.d0)&&!d.hP(c)}d.eM=F;
fm(d.d4);
fm(d.du);
fm(d.hH)}function hQ(){for(var c=this,b=0,a=bp(c.d4);
b<a;
b++){c.d4[b].d0=am}for(b=0,a=bp(c.du);
b<a;
b++){c.du[b].d0=am}c.eM=am;
fm(c.d4);
fm(c.du);
fm(c.hH)}function hR(b){var a=b_(this.d4,b);
if(a){b.eu=this}return a}function hS(a){if(this.type!=aw){return b_(this.hI,a)}return F}function hT(a){return bX(this.hH,a)}function hU(b){if(bX(this.hH,b)){return F}var a=b_(this.du,b);
if(a){b.eu=this}return a}function hV(c,b,a,d){if(bX(a,c[b].c8)){d[2*b]=c[b].c8;
d[2*b+1]=c[b].c_}else{d[2*b]=c[b].c_;
d[2*b+1]=c[b].c8}}function createGroup(){var d=st.gE(),b,c,a;
if(!d.hW){return}a=d.d4[0].ep;
hX(T);
if(bp(d.hH)<=1){c=prompt(s("supaQ"),"")
}else{c=prompt(s("multQ"),"")}hX(F);
if(c==null){return}hY();
b=a.hZ(c,d.d4,d.du,d.hH);
d.h0(b);
b.fc();
h1();
return b}function h2(c){for(var e,f,g,b,d=0,a=bp(this.eP);
d<a;
d++){g=this.eP[d].dR;
b=g.x+c*g.y;
if(e==am||b>f){e=g;
f=b}g=this.eP[d].dQ;
b=g.x+c*g.y;
if(b>f){e=g;
f=b}}return e}function h3(a){var d=a.d5(),h=d.cc(),g=d.cc(),f=a.c8.c9,e=a.c_.c9,c=h4*(e.x-f.x),b=h4*(e.y-f.y);
h.cu(b,-c);
g.cu(-b,c);
this.eP.push(new h5(h,g))}function h6(){this.eP=[];
for(var b=0,a=bp(this.hH);
b<a;
b++){this.h7(this.hH[b])}}function h8(b){if($.isArray(b)){for(var c=0,a=bp(b);
c<a;
c++){this.hK(b[c])}}else{if(this.type!=av){if(bX(this.d4,b.c8)){this.hJ(b.c8)}else{if(bX(this.d4,b.c_)){this.hJ(b.c_)}}}b4(b,this.du);
b_(this.hH,b)}}function h9(d){var e=this,b=[],c=0,a=bp(e.hI);
if(d&&!e.eM&&a){for(;
c<a;
c++){b.push(e.hI[c].c9)}}else{for(a=bp(e.d4);
c<a;
c++){b.push(e.d4[c].c9)}}if(e.eP){for(c=0,a=bp(e.eP);
c<a;
c++){b.push(e.eP[c].dR,e.eP[c].dQ)}}b0(b,e.fx);
return b}function h_(){var a=this;
if(!a.dd||!a.db){fr.apply(a);
a.dd.x-=ia;
a.dd.y-=ia;
a.db.x+=ia;
a.db.y+=ia}}function ib(){if(st.hf()){return}switch(hg){case aT:if(hi){this.ep.ic(this);
break}}}function eN(c,a,d,b){if(!b){b=this.data(as)}hY();
b.ie(b.eM);
b.ep.fy(bg);
eF=am;
ig(aZ);
ih(T);
b.fc();
h1();
return bo(c)}function ii(h){var c=this,g=c.ep,b=bH(c.ds),f,i,l,j,d=st.gE(),a,k;
hX(T);
if(c.type==au){b=prompt(s("supaQ"),b)}else{b=prompt(s("multQ"),b)}hX(F);
if(b==null){return}k=bm(b);
hY();
if(c.type==av||(c.type==aw&&k<ij&&k>1)){if(c.type==av){f=c.hI.concat()}else{f=c.d4.concat()}i=c.du.concat();
l=c.hH.concat();
if(j=c.dH){d.ic(c)}c.ik(l,i);
a=g.hZ(b,f,i,l);
if(j){d.h0(a)}a.fc()}else{c.ds=b;
c.hL=k;
c.fc()}h1()}function eJ(c,a,d,b){if(!b){b=this.data(as)}hY();
b.ik();
h1();
return bo(c)}function eL(){}function il(j,b,g){var e=j[bp(j)-1],d=0,c=bp(e.du),h,f,a;
for(;
d<c;
d++){h=e.du[d];
f=(h.c8.bS(e)?h.c_:h.c8);
if(bX(j,f)){continue}if(h.bS(b)){return h}if(bX(g,f)){j.push(f);
a=il(j,b,g);
if(a){return a}j.pop()}}}function im(p,m){var c=this,k=c.ep,o,n,h,f,e,b,g,a,d=st.gE(),l;
if(c.type==av){o=c.hI;
n=b8(c.d4,o);
if(!p){p=c.hH.concat()}if((b=bp(p))==2){for(e=0;
e<b;
e++){for(h=0,f=bp(o);
h<f;
h++){a=o[h];
g=il([a],p[e],n);
if(!g){continue}l=g.dH;
k.fG(g,T);
if(bX(n,g.c8)){g.c8=a}else{g.c_=a}a.du.push(g);
g.eu=am;
k.f1(g);
if(m){m.push(g)}if(l){d.f1(g)}}}for(h=0,f=bp(n);
h<f;
h++){k.fH(n[h],T)}}}if(c.bS(eF)){eF=am;
ig(aZ)}c.dw();
while(bp(c.d4)){g=c.d4.pop();
g.eu=am;
g.d0=am;
fn(g)}while(bp(c.du)){g=c.du.pop();
g.eu=am;
g.d0=am;
fn(g)}c.hI=[];
fj(c,c.io.ip);
fj(c,k.ip);
d.ic(c);
if(m){b1(m,k.du);
b2(m,p)}}function iq(){if(!this.ep){return -1}return bY(this.ep.ip,this)}function ir(b){for(var a=bp(b)-1;
a>=0;
a--){b[a]=bn(b[a])}this.eP.push(new h5(new cj(b[0],-b[1]),new cj(b[2],-b[3])))
}function it(){if(!this.iu){var b=new cj(),d,c,a=bp(this.eP);
if(a>1){for(c=0;
c<a;
c++){d=this.eP[c];
b.cu(d.dR);
b.cu(d.dQ)}b.x/=a*2;
b.y/=a*2}this.iu=b}return this.iu}function iv(){return new h5(this.dR.cc(),this.dQ.cc())}function h5(b,a){this.dR=b;
this.dQ=a;
this.cc=iv}function iw(e,b){if(!b){b=[]}else{if(bX(b,this)){return}}b.push(this);
var d=this,c,a;
if(e==bg){d.fx=am;
d.iu=am}if(e>bd&&e<bh){d.dd=am;
d.db=am;
for(c=0,a=bp(d.hH);
c<a;
c++){d.hH[c].fy(bg,b)}d.ix()}if(e!=bd){e=bg}for(c=0,a=bp(d.d4);
c<a;
c++){d.d4[c].fy(e,b)}for(c=0,a=bp(d.du);
c<a;
c++){d.du[c].fy(e,b)}b.pop()}function iy(){var a=this;
fh.apply(a);
a.d4=[];
a.hI=[];
a.du=[];
a.hH=[];
a.iz=0;
a.getIndex=iq;
a.fy=iw;
a.ik=im;
a.fX=hR;
a.hJ=hS;
a.hP=hT;
a.f1=hU;
a.hK=h8;
a.d5=fb;
a.d2=h_;
a.fs=h9;
a.cc=hG;
a.c7=c7;
a.hE=ib;
a.hF=eL;
a.eS=ii;
a.fc=eE;
a.dC=fB}function iA(){iy.apply(this);
this.type=au;
this.ix=iB;
this.ie=hN}function iC(){var a=this;
iy.apply(a);
a.type=av;
a.eP=[];
a.eR=h2;
a.iD=ir;
a.h7=h3;
a.ix=h6;
a.eO=it;
a.ie=hO}function iE(){iC.apply(this);
this.type=aw;
this.ie=hQ}function iF(e){if(this.fZ){return this.fZ.cc(e)}if(!e){e=new cd()}var f=this,d,c,a,b;
if(e.fN){if(d=f.c8.dZ){c=d}if(d=f.c_.dZ){a=d}}if(!c){c=e.cb(f.c8)}if(!a){a=e.cb(f.c_)}b=new gA(c,a,f.dv,f.d7);
bT(e,f,b);
b.d0=f.d0;
b.eu=e.cb(f.eu);
b.dH=f.dH;
return b}function iG(){if(!this.fx){this.fx=cA(this.c8.c9,this.c_.c9)}return this.fx}function iH(f,c){if(!c){c=[]}else{if(bX(c,this)){return}}c.push(this);
if(f==bg){this.fx=am}if(f<bh){var b=this.ep,d,a,e;
if(b){for(d=0,a=bp(b.ip);
d<a;
d++){e=b.ip[d];
if(bX(e.hH,this)){e.fy(bg,c)}}}}c.pop()}function iI(){var b=this,a=b.dv;
a=(bs(ba,a)||a);
if(!b.c8||!b.c_||b.c8.bS(b.c_)){return""}return ao+bA(b.c8.getIndex()+1,3)+bA(b.c_.getIndex()+1,3)+bA(a,3)+bA(b.d7,3)+bz(bA("0",3),3)}function iJ(){if(!this.ht){var d=this,c,b,a;
if(!d.c8.io){d.ep.iK(T)}c=d.c8.io.d3();
d.ht=[];
for(b=0,a=bp(c);
b<a;
b++){if(bX(c[b].du,d)){d.ht.push(c[b])}}}return this.ht}function iL(){var a=0;
if(this.d7){a+=4}switch(this.dv){case 2:a+=2;
break;
case 3:a--;
break}return a}function iM(b){for(var d,c=0,a=bp(b.du);
c<a;
c++){d=b.du[c];
if(d.dv==1){d.dv=2}else{d.dv=1}fn(d)}}function iN(){if(this.dv>2){return}var k=this.d3(),l,h=[],d,a,g,f,e,c,b;
for(g=0,f=bp(k);
g<f;
g++){d=k[g];
a=bp(d.du);
if(a%4==2){l=F;
for(e=1;
e<a;
e++){b=d.du[e].dv;
c=d.du[e-1].dv;
if(c+b!=3||c<1||c>2||b<1||b>2){l=T;
break}}if(!l){h.push(d)}}}if(!bp(h)){return}d=h[0];
a=bp(d.du);
for(g=1,f=bp(h);
g<f;
g++){if(bp(h[g].du)<a){d=h[g];
a=bp(d.du)}}return d}function iO(e,d){if(d){var a=3*ey,c=e.cT(d.c8.c9,T),b=e.cT(d.c_.c9,T);

if(c<a&&c<b){return d.c8}else{if(b<a){return d.c_}}}return am}function iP(d){var e=this,c=e.c8,a=e.c_,b;
if(e.eu&&e.eu.type==av){return}if(hl!=0&&hl==e.d7){e.c8=a;
e.c_=c}else{if(hl!=0||hk!=1){e.dv=hk;
e.d7=hl}else{if(e.d7!=0){e.d7=0}else{b=e.dv;
e.dv=bG(M.floor(b)%M.min(3,c.hx(b),a.hx(b)))+1;
if(b==1&&e.dv==1){c.hy(a)||a.hy(c)}}}}c.fy(bh);
a.fy(bh);
if(!d){fn(e);
fn(c);
fn(a)}}function iQ(){if(!this.ep){return -1}return bY(this.ep.du,this)}function iR(a){if(!a||!this.d0){return[this.c8.c9,this.c_.c9]}return[]}function iS(b,a){if(a){if(bX(a.du,this)){return a}}else{a=new gw(T)}a.f1(this);
this.c8.hr(b,a);
this.c_.hr(b,a);
return a}function iT(){var b=this,a=b.ep;
if(b.c8.fZ){a=b.c8.fZ.ep}else{if(b.fZ){a=b.fZ.ep}}return a}function iU(){return bq(this.c8.c9.z,this.c_.c9.z)}function iV(a){var b=this;
return(b.c8.bS(a)?b.c_:b.c8)}function iW(){return this.c_.c9.cz(this.c8.c9)}function iX(a){return this.c8.bS(a)||this.c_.bS(a)}function gA(c,b,a,d){var e=this;
fh.apply(e);
e.c8=c;
e.c_=b;
e.dv=a;
e.d7=d;
e.dH=F;
e.getIndex=iQ;
e.fy=iH;
e.iY=iP;
e.d5=iG;
e.fs=iR;
e.d3=iJ;
e.iZ=iN;
e.i0=iM;
e.i1=iX;
e.hB=iL;
e.hr=iS;
e.getMolecule=hC;
e.hD=iI;
e.fc=dY;
e.dC=iU;
e.cc=iF;
e.gR=iV;
e.i2=iW;
e.c7=c7;
e.eo=fi;
e.da=iT;
e.d6=c6}function i3(g){g.sort(i4);
for(var b=[],d,c=[],e,f=0,a=bp(g);
f<a;
f++){e=g[f];
d=e.d4;
if(!i5(d)&&!b6(c,d)){b.push(e);
b9(c,d)}}return b}function i5(b){for(var d,c=0,a=bp(b);
c<a;
c++){d=b[c];
if(d.gq&&d.gq.gg){return T}}return F}function i4(e,c){var f=(e.d4?bp(e.d4):0),d=(c.d4?bp(c.d4):0);
if(f<d){return -1}if(f>d){return 1}return 0}function i6(e,c){var d=bp(e.d3()),f=bp(c.d3()),g,h;
if(d<f){return 1}if(d>f){return -1}g=bp(e.du),h=bp(c.du);
if(g<h){return 1}if(g>h){return -1}return 0}function i7(c){var e=this.d4,b=[],d,a,f;
if(c){bZ(b,this.du);
bZ(b,e)}else{for(d=0,a=bp(e);
d<a;
d++){f=e[d];
b.push(f);
b9(b,f.du);
b_(b,f.eu)}}return b}function i8(){if(!this.i9){for(var e=this,c=e.d5(),d=e.d4,b=bp(d)-1,a=d[0].c9.cz(c).cq(d[b].c9.cz(c));
b>0;
b--){a.cu(d[b].c9.cz(c).cq(d[b-1].c9.cz(c)))}if(c.e0(a.cM(c),d[0].c9,d[1].c9)>0){a.eT(-1)}e.i_=(e.i9=a.cB()).cc();
e.i_.cu(c)}}function ja(a){var b=this;
b.jb();
return ad-b.fx.cr(a.c9,b.i_)}function jc(){for(var d=0,e=this.du,b=bp(e),a,c=e[b-1].dv;
d<b;
d++){a=e[d].dv;
if(a==3||(a==2&&c==2)){return T}c=a}}function jd(){for(var b=0,c=this.du,a=bp(c);
b<a;
b++){if(c[b].dv!=1){return F}}return T}function je(){if(!this.fx){var b=new cj(),e=this.d4,d=0,c,a;
for(c=0,a=bp(e);
c<a;
c++){b.cu(e[c].c9);
d++}if(d>1){b.x/=d;
b.y/=d;
b.z/=d}this.fx=b}return this.fx}function jf(e){var c=this,b=[],d=[],h,k,g,f,a;
for(k=0,g=bp(c.d4);
k<g;
k++){h=c.d4[k];

if(!e||!h.d0){b.push(h.c9)}b_(d,h.eu)}for(k=0,g=bp(d);
k<g;
k++){h=d[k];
if(h.eP){for(f=0,a=bp(h.eP);
f<a;
f++){b.push(h.eP[f].dR,h.eP[f].dQ)}}if(!e){b0(b,h.fx);
b0(b,h.dd);
b0(b,h.db)}}if(!e){b0(b,c.fx);
b0(b,c.dd);
b0(b,c.db)}return b}function jg(f){if(!(f instanceof jh)){return F}var k=this.d4,a=bp(k),g,e,h,d,c,b;
if(a!=bp(f.d4)){return F}g=bY(f.d4,k[0]);
if(g==-1){return F}e=bY(f.d4,k[1]);
if(e==-1){return F}h=e-g;
if(M.abs(h)==a-1){h=-1}if(M.abs(h)!=1){return F}for(d=2,c=a;
d<c;
d++){b=(c+d*h+g)%c;
if(!k[d].bS(f.d4[b])){return F}}return T}function ji(d,b){if(!b){b=[]}else{if(bX(b,this)){return}}if(d!=bf){b.push(this);
this.i9=am;
if(d==bg){this.fx=am}if(d!=bd){d=bg}for(var c=0,a=bp(this.d4);
c<a;
c++){this.d4[c].fy(d,b)}for(c=0,a=bp(this.du);
c<a;
c++){this.du[c].fy(d,b)}b.pop()}}function jj(){var a=this.d4,b=a.concat(),c;
b.sort(i6);
c=bY(a,b[0]);
b5(a,c);
if(bY(b,a[1])>bY(b,a[bp(b)-1])){a.reverse();
b5(a,-1)}}function jh(a,c){var b=this;
b.bQ=bL();
b.d4=a;
b.du=c;
b.jk=jj;
b.dD=i7;
b.fy=ji;
b.d5=je;
b.jb=i8;
b.jl=ja;
b.jm=jc;
b.jn=jd;
b.fs=jf;
b.bS=jg}function jo(b){var a=b_(this.d4,b);
if(a){b.io=this}return a}function jp(a){return b_(this.du,a)}function jq(){for(var b=[],c=0,a=bp(this.d4);
c<a;
c++){b.push(this.d4[c].c9.cc())}return b}function jr(c){var b=0,a=bp(this.d4);
if(bp(c)!=a){alert("Error")}for(;
b<a;
b++){this.d4[b].c9=c[b].cc()}}function js(g,e,j){var a=bp(e),c=e[a-1],l,f,k,d,b,h;
if(a<=jt){for(d=0,b=bp(c.du);
d<b;
d++){l=c.du[d];
f=(c.bS(l.c8)?l.c_:l.c8);
if(a>=2&&f.bS(e[a-2])){continue}h=-1;
j[a-1]=l;
if(a>=2){h=bY(e,f)}if(h==-1){e[a]=f;
js(g,e,j);
e.length=a}else{k=new jh(e.slice(h),j.slice(h));
b_(g,k)}}}j.length=a-1;
return g}function ju(){var c=this;
if(!c.ht){c.ht=[];
for(var c=this,b=0,a=bp(c.du);
b<a;
b++){c.du[b].ht=am}if(bp(c.d4)){js(c.ht,[c.d4[0]],[])}}return c.ht}function jv(){var a=this;
e4.apply(a);
a.d4=[];
a.ip=[];
a.du=[];
a.fy=jw;
a.d3=ju;
a.dD=jx;
a.fs=jy;
a.eT=jz;
a.d2=fr;
a.gC=jA;
a.cB=jB;
a.jC=jD;
a.fX=jo;
a.f1=jp;
a.jE=jq;
a.jF=jr}function jG(t,n,b,h,f,k){if(f){n=f.c9}if(k){b=k.c9}if(!n||!b){return F}var a=eC*1.4,u=b.cT(n),o=M.min(M.round(u/a/M.cos(jH*ag)),jI),d,g=jH,l=[],j=[],r,q,c,m,p;
if(o<=0){return F}d=n.cO(b);
if(k){if(o>1){g=M.acos(bJ(u/o/a,-0.9,0.9))/ag}}gz.ga();
if(o==1){if(f&&(c=f.hv(k))){if(!h){c=gz.f1(c)}c.iY();
gz.fc();
return T}else{d+=g}}else{if(o%2){d+=g/(o-1)}}l[0]=M.cos((d-g)*ag);
l[1]=M.cos((d+g)*ag);
j[0]=M.sin((d-g)*ag);
j[1]=M.sin((d+g)*ag);
if(k){o--}if(h){m=st.gE();
if(!t.ctrlKey){m.jJ()}if(f){r=f;
h=f.ep}else{r=new gx(n.cc());
h.fX(r);
m.fX(r)}}else{if(f){r=gz.fX(f)}else{r=gz.fX(new gx(n.cc()))}aZ.jK.push(aZ.text(b.x,b.y+30/eG,o+(f?0:1)).attr(aA,2+20/eG))}if(!f){r.gG(hh(),T)}for(p=0;
p<o;
p++){q=r.cc();
if(p==0){q.gG(hh(),T)
}q.c9.x+=a*l[p%2];
q.c9.y+=a*j[p%2];
if(!h){q=gz.fX(q)}c=new gA(r,q,1,0);
if(h){h.fX(q);
h.f1(c);
m.f1(c);
m.fX(q)}else{c=gz.f1(c)}r=q}if(k){if(h){c=h.f3.jL(r,k,1,0);
m.f1(c)}else{q=gz.fX(k);
c=gz.f1(new gA(r,q,1,0))}}gz.fc();
return T}function jM(d){if(!d){d=new cd()}var e=this,b=new fI(),c,a;
bT(d,e,b);
b.jN=2;
for(c=0,a=bp(e.ip);
c<a;
c++){b.h0(d.cb(e.ip[c]),T)}for(c=0,a=bp(e.du);
c<a;
c++){b.f1(d.cb(e.du[c]),T)}for(c=0,a=bp(e.d4);
c<a;
c++){b.fX(d.cb(e.d4[c]),T)}b.er=d.cb(e.er);
b.jN=1;
b.iK();
return b}function jw(e,b){if(!b){b=[]}else{if(bX(b,this)){return}}var d=this,c,a;
b.push(d);
if(e>be){d.fx=am;
d.fE=am}if(e>bd&&e<bh){d.dd=am;
d.db=am}if(e!=bf){if(e!=bd){e=bg}for(c=0,a=bp(d.d4);
c<a;
c++){d.d4[c].fy(e,b)}for(c=0,a=bp(d.du);
c<a;
c++){d.du[c].fy(e,b)}if(d.ip){for(c=0,a=bp(d.ip);
c<a;
c++){d.ip[c].fy(e,b)}}if(d.jO){for(c=0,a=bp(d.jO);
c<a;
c++){d.jO[c].fy(e,b)}}if(d.ht){for(c=0,a=bp(d.ht);
c<a;
c++){d.ht[c].fy(e,b)}}}if(d.f3){d.f3.fy(e,b)}else{if(d.ep){d.ep.fy(e,b)}}b.pop()}function jP(f){if(!bp(this.d4)){return}this.d2();
if(f.x>this.dd.x&&f.x<this.db.x){var e=this,c=new jQ(e),d,a,b;
if(!e.jO){e.iK()}if(bp(e.d4)<2){return}for(d=0,a=bp(e.jO);
d<a;
d++){b=e.jO[d];
b.d2();
if(0.5*(b.dd.x+b.db.x)>f.x){c.jR.push(b)}else{c.jS.push(b)}}return c}}function jz(d,b){if(b){b=this.d5()}for(var e=this.fs(),c=0,a=bp(e);
c<a;
c++){e[c].eT(d,b)}}function jB(){if(bp(this.d4)>1){var h=this,e=0,g=0,d,a,c,f,b;
if(a=bp(h.du)){for(d=0;
d<a;
d++){f=h.du[d];
e+=f.c8.c9.cT(f.c_.c9);
g++}}else{for(d=0,a=bp(h.d4);
d<a;
d++){b=h.d4[d];
for(c=0;
c<d;
c++){e+=b.c9.cT(h.d4[c].c9);
g++}}}if(e>0){h.eT(dc*g/e)}}this.d2()}function jT(c,d){var b=c-this.dd.x,a=bG(d)-0.5*(this.dd.y+this.db.y);
this.cu(b,a)}function jU(d,b){var e=this,c,a;
if(!e.bS(d)){for(c=0,a=bp(d.d4);
c<a;
c++){e.fX(d.d4[c])}for(c=0,a=bp(d.du);
c<a;
c++){e.f1(d.du[c])}for(c=0,a=bp(d.ip);
c<a;
c++){e.h0(d.ip[c])}if(e.ht&&d.ht){bZ(e.ht,d.ht)}else{e.jV()}e.iK();
if(b||eq=="tmpl"){e.er=d.er}e.fy(bg)}}function jW(c,b){var d=this,a;
if(b_(d.d4,c)){c.ep=d;
c.d1=am;
c.fo=am;
if(!b){fn(c);
a=d.jX();
a.fy(bf);
if(a.fZ){a.fZ.fy(bf)}}return T}return F}function jY(h,c,g,m){var u=this,l,p,n,o,t,d,f,e=[],k=[],a=[],q=[],b,r=bp(m);
if(r<=1){l=new iA();
if(r){l.hJ(m[0].c8.dH?m[0].c8:m[0].c_)}}else{if((n=bm(h))<ij&&n>1){l=new iC();
u.fG(m[0],T);
u.fG(m[1],T);
bZ(e,c);
bZ(k,g);
b2(k,m);
hV(m,0,e,a);
hV(m,1,e,a);
for(p=0;
p<n;
p++){if(p>0){b=new cd();
q[p]=b}for(o=0,t=bp(k);
o<t;
o++){d=k[o];
if(p==0){l.f1(d);
b_(e,d.c8);
b_(e,d.c_)}else{f=b.cb(d);
l.f1(f);
u.f1(f,T)}}for(o=0,t=bp(e);
o<t;
o++){d=e[o];
if(p==0){l.fX(d);
l.hJ(d)}else{f=b.cb(d);
l.fX(f);
u.fX(f,T)}}}for(p=0;
p<=n;
p++){if(p==0){f=new gA(a[1],a[0],m[0].dv,m[0].d7);
m[0]=f}else{if(p==n){f=new gA(q[p-1].cb(a[2]),a[3],m[1].dv,m[1].d7);
m[1]=f}else{if(p==1){f=new gA(a[2],q[p].cb(a[0]),m[1].dv,0)}else{f=new gA(q[p-1].cb(a[2]),q[p].cb(a[0]),m[1].dv,0)
}}}l.f1(f);
u.f1(f,T)}}else{l=new iE();
if(n){l.hM=""}else{l.hM="HT"}}}l.hK(m);
if(l.type!=av){for(o=0,t=bp(g);
o<t;
o++){l.f1(g[o])}for(o=0,t=bp(c);
o<t;
o++){l.fX(c[o])}}l.ds=h;
l.hL=n;
l.ix();
u.h0(l);
l.ie(T);
return l}function jZ(c,b){if(b_(this.ip,c)){c.ep=this;
var a;
if(c.d4[0]&&(a=c.d4[0].io)){c.io=a;
b_(a.ip,c)}c.d1=am;
c.fo=am;
if(!b){fn(c)}return T}return F}function j0(d,c){if(d.bS(c)){return}fn(c);
this.fy(bh);
if(bX(this.d4,c)){fj(d,this.d4)}else{b3(this.d4,d,c);
fj(d)}var f=this,a,e,b;
for(a=bp(d.du)-1;
a>=0;
a--){e=d.du[a];
fn(e);
if(e.c8.bS(d)){e.c8=c;
fn(e.c_)}else{if(e.c_.bS(d)){e.c_=c;
fn(e.c8)}}b_(c.du,e)}c.fy(bh);
if(!d.dS){b=st.gE();
b3(b.d4,d,c);
c.dH=d.dH}if(d.bS(f.er)){f.er=c}f.jV();
f.iK();
if(d.bS(et)||c.bS(et)){ih()}}function j1(d,h){var g=this,b,f,c=st.gE(),e,a=d.io;
g.fy(bg);
fj(d,g.d4);
for(b=bp(d.du)-1;
b>=0;
b--){f=d.du[b];
if(f){g.fG(f,h)}}g.j2(d);
b4(d,c.d4);
if(d.bS(g.er)){g.er=am}if(g){if(a){b4(d,a.d4);
if(!bp(a.d4)){fj(a,g.jO)}}if(!bp(g.d4)&&(e=g.f3)){e.j3(g)}}if(d.bS(et)){et=am;
ih()}}function j4(d){var e=this;
e.fy(bg);
d.dw();
fj(d,e.ip);
var a,c,b=st.gE();
for(a=bp(d.du)-1;
a>=0;
a--){c=d.du[a];
if(c){e.fG(c)}}for(a=bp(d.d4)-1;
a>=0;
a--){c=d.d4[a];
if(c){e.fH(c)}}e.j2(d);
b4(d,b.ip);
if(d.bS(eF)){eF=am;
ih()}}function j5(e,d){var f=this,b=e.c8,a=e.c_,c;
if(!b||!a){return F}if(b_(f.du,e)){e.ep=f;
e.d1=am;
e.fo=am;
b_(e.c8.du,e);
b_(e.c_.du,e);
if(f.jN==1){c=e.c8.io;
if(!c){if(!e.c_.io){f.iK()}else{c=e.c_.io;
e.io=c;
e.c8.io=c;
b_(c.du,e);
b_(c.d4,e.c8)}}else{if(!e.c_.io){e.io=c;
e.c_.io=c;
b_(c.du,e);
b_(c.d4,e.c_)}else{if(!c.bS(e.c_.io)){f.iK()}else{f.jV();
b_(c.du,e)}}}}e.c8.fy(bh);
e.c_.fy(bh);
if(!d){fm(e.c8.du);
fm(e.c_.du);
fn(e.c8);
fn(e.c_)}return T}return F}function j6(c,b){if(bX(this.du,b)){fj(c,this.du)}else{b3(this.du,c,b);
fj(c)}if(bX(c.c8.du,b)){b4(c,c.c8.du)}else{b3(c.c8.du,c,b)}if(bX(c.c_.du,b)){b4(c,c.c_.du)}else{b3(c.c_.du,c,b)}fn(b);
c.c8.fy(bh);
c.c_.fy(bh);
fn(c.c8);
fn(c.c_);
fm(c.c8.du);
fm(c.c_.du);
this.fy(bh);
var a=st.gE();
b3(a.du,c,b);
b.dH=c.dH;
this.jV();
this.iK()}function j7(){for(var c=this,b=0,a=bp(c.du);
b<a;
b++){c.du[b].ht=am}for(b=0,a=bp(c.d4);
b<a;
b++){c.d4[b].ht=am}if(c.jO){for(b=0,a=bp(c.jO);
b<a;
b++){c.jO[b].ht=am}}c.ht=am}function j8(f,h){var g=this,d=st.gE(),c,a,e,b=f.c8.io;
if(!b){b=f.c_.io}fj(f,g.du);
b4(f,f.c8.du);
b4(f,f.c_.du);
f.c8.fy(bh);
f.c_.fy(bh);
fn(f.c8);
fn(f.c_);
fm(f.c8.du);
fm(f.c_.du);
g.fy(bg);
if(h){if(b){b4(f,b.du)}}else{g.iK();
g.jV()}g.j2(f);
d.fG(f);
for(c=0,a=bp(g.ip);
c<a;
c++){e=g.ip[c];
if(bX(e.hH,f)){if(e.type!=au){b4(f,e.hH)
}else{e.ik()}}}}function j9(e,b){e.io=b;
b.d4.push(e);
if(b_(b.ip,e.eu)){e.eu.io=b}var c,a,d;
for(c=0,a=bp(e.du);
c<a;
c++){d=e.du[c];
b_(b.du,d);
if(!d.c8.io){j9(d.c8,b)}else{if(!d.c_.io){j9(d.c_,b)}}}}function j_(d){if(d||!gz||gz.gb()){var e=this;
e.jO=[];
for(var b,c=0,a=bp(e.d4);
c<a;
c++){e.d4[c].io=am}for(c=0,a=bp(e.d4);
c<a;
c++){if(!e.d4[c].io){b=new jv();
e.jO.push(b);
b.ep=e;
j9(e.d4[c],b)}}}}function eA(b,a,c){if(c){return b.c9.cO(a.c9,c.c9)}else{return b.c9.cO(a.c9)}}function ka(b,a,c){if(c){return b.c9.cr(a.c9,c.c9)}else{return b.c9.cr(a.c9)}}function gy(l,q,n,m){var o,b=eC*1.4,c,d,r,p=[],h,g,f,a=3*kb,k=l.c9;
if(n){n.z=k.z}if(n&&m&&m.ctrlKey){if(m.shiftKey){return n}o=k.cO(n);
c=c2(k,o,b)}else{if(n&&m&&m.shiftKey){b=k.cT(n)}if(n!==F&&!hl&&(!m||!m.altKey)&&(f=bp(l.du))>1&&f<4&&q==1){for(h=0;
h<f;
h++){g=l.du[h];
if(g.dv>1){h=f+1;
break}r=g.gR(l);
for(g=h+1;
g<f;
g++){if(M.abs(aj-k.cr(r.c9,l.du[g].gR(l).c9))>6){h=f+1;
break}}}if(h==f){h=l.du[0].gR(l).c9;
g=l.du[1].gR(l).c9;
c=k.eX(h,g,b,0.5*aj);
r=k.eX(h,g,b,-0.5*aj);
f=l.ep;
if(n){h=n.cT(c);
g=n.cT(r)}else{h=f.gC(c);
g=f.gC(r)}if(g<h||(g==h&&k.eY(r)>k.eY(c))){c=r}f.kc(l,c)}}if(!c){o=l.gB(q,n);
do{c=c2(k,o,b);
d=l.ep.f3.kd(c,a,a);
if(!d||!bp(d)){break}for(h=0;
h<bp(d);
h++){p.push(new gL(l,d[h]))}o=l.gU(n,p)}while(bp(p)<10);
if(f>2||!l.hw()){a=0;
for(h=f-1;
h>=0;
h--){d=l.du[h].gR(l);
a+=(d.c9.z-k.z)/(M.abs(o-eA(l,d))+1)}c=c1(k,o,(a>0?-30:30),b)}}}return c}function ke(c,a,b){if(bG(b)!=0){return at+c+bA("1",3)+S+bA(a+1,3)+S+bA(M.round(b),3)}else{return""}}function kf(){var c=this,f,e,d,b,k,g,h=[],a=ab+ao+Number(new Date())+ao+navigator.userAgent+ao+bA(bp(c.d4),3)+bA(bp(c.du),3)+bz(ap,8)+(eq=="rxn"?ap:"999")+" V2000";
for(f=0,e=bp(c.d4);
f<e;
f++){a+=c.d4[f].hD()}for(f=0,e=bp(c.du);
f<e;
f++){a+=c.du[f].hD()}for(f=0,e=bp(c.d4);
f<e;
f++){a+=ke("CHG",f,c.d4[f].en());
a+=ke("RAD",f,c.d4[f].dq);
a+=ke("ISO",f,c.d4[f].dr)}if(eq=="tmpl"&&c.er){a+=at+"ATT"+bA("1",3)+S+bA(c.er.getIndex(),3)+S+a3.val()+S+a4.val()}for(f=0,e=bp(c.ip);
f<e;
f++){k=c.ip[f];
if(!(b=bp(k.d4))){continue}a+=at+"STY"+bA("1",3)+S+bA(f+1,3)+S+k.type;
if(k.type==aw&&k.hM){a+=at+"SCN"+bA("1",3)+S+bA(f+1,3)+S+k.hM}for(d=0;
d<b;
d++){a+=(d%15?"":at+"SAL "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.d4[d].getIndex()+1),4)}if(k.type==av){for(d=0,b=bp(k.hI);
d<b;
d++){a+=(d%15?"":at+"SPA "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.hI[d].getIndex()+1),4)}}if(k.eP){for(d=0,b=bp(k.eP);
d<b;
d++){g=k.eP[d];
a+=at+"SDI "+bA(f+1,3)+bA(4,3)+gm(g.dR.x)+gm(-g.dR.y)+gm(g.dQ.x)+gm(-g.dQ.y)}}for(d=0,b=bp(k.hH);
d<b;
d++){a+=(d%15?"":at+"SBL "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.hH[d].getIndex()+1),4)}a+=at+"SMT "+bA(f+1,3)+S+bH(k.ds);
if(k.eM){h.push(k)}}for(d=0,b=bp(h);
d<b;
d++){a+=(d%15?"":at+"SDS EXP"+bA(M.min(b-d,15),3)+S)+bA(h[d].getIndex()+1,3)}for(f=0,e=bp(c.kg);
f<e;
f++){a+=ao+c.kg[f]}a+=at+"END\n";
return a}function kh(b,a,d){var c=b.attributes[a];
if(c){c=c.value;
if(d){a=d[c];
if(a!=am){c=a}}return c}}function ki(b,a,c){var d=bm(kh(b,a));
if(c){if(d in c){d=c[d];

if(d in c){d=c[d]}}}return d}function kj(q,p){for(var d=new fI(),m=p.find("n"),l,k=0,h=bp(m),g,c,b,a,e,o={},f={},n;
k<h;
k++){e=m[k];
if((b=kh(e,"NodeType"))==am||bj[b]!=am){a=kh(e,"p");
c=bv(a);
n=new gx(new cj(bn(c[0]),bn(c[1]),bn(kh(e,"Z"))));
n.gp=bG(ki(e,"Charge"));
n.gJ(gk[bF(ki(e,"Element"),6)]);
n.kk=ki(e,"id");
n.dq=bG(ki(e,"Radical",bk));
n.dr=bF(ki(e,"Isotope"),am);
n.dt=bF(ki(e,"NumHydrogens"),am);
m[k]=n;
d.fX(n);
o[n.kk]=n}else{if(b=="ExternalConnectionPoint"){c=$(e).parents("n:first");
if(bp(c)){b=ki(e,"id");
a=ki(c[0],"id");
f[b]=a;
f[a]=b}}}}l=p.find("b");
c=$.extend({},f);
for(k=0,h=bp(l);
k<h;
k++){e=l[k];
b=ki(e,"B");
a=ki(e,"E");
if(b in c){f[c[b]]=a}if(a in c){f[c[a]]=b}}for(k=0,h=bp(l);
k<h;
k++){e=l[k];
b=o[ki(e,"B",f)];
a=o[ki(e,"E",f)];
c=bm(kh(e,"Display",bl));
if(c==4||c==7||c==12){n=a;
a=b;
b=n;
c--}n=new gA(b,a,bF(bn(kh(e,"Order")),(c==1?0:1)),bG(bb[c]));
n.kk=ki(e,"id");
o[n.kk]=n;
d.f1(n)}for(k=0,h=bp(m);
k<h;
k++){e=m[k];
if(e.attributes){if(kh(e,"NodeType")=="Fragment"){e=$(e);
b=[];
a=[];
c=e.find("n");
for(g=bp(c)-1;
g>=0;
g--){n=o[ki(c[g],"id")];
if(n){b.push(n)}}l=[];
c=e.find("b");
for(g=bp(c)-1;
g>=0;
g--){a.push(n=o[ki(c[g],"id")]);
if(n.c8&&n.c_&&(!bX(b,n.c8)||!bX(b,n.c_))){l.push(n)}}c=e.find("s").text();
if(bp(b)){b[0].ep.hZ(c,b,a,l)}}}}l=q.find("page:first > bracketedgroup");
for(k=0,h=bp(l);
k<h;
k++){e=l[k];
if(kh(e,"BracketUsage")=="MultipleGroup"){c=bv(kh(e,"BracketedObjectIDs"));
b=[];
a=[];
for(g=bp(c)-1;
g>=0;
g--){n=o[bm(c[g])];
if(n){if(n.c8){a.push(n)}else{b.push(n)}}}n=[];
c=$(e).find("crossingbond");
for(g=bp(c)-1;
g>=0;
g--){n.push(o[ki(c[g],"BondID")])}c=bG(ki(e,"RepeatCount"));
if(c<=1){c=bF(kh(e,"SRULabel"),"n")}if(bp(b)){b[0].ep.hZ(c,b,a,n)}}}return d}function kl(t){var h=new fI(),a=t.split(ao),p=0,m=bp(a),o,u,n,y,q={},c,d,b,x,w,f,g,l,v;
h.jN=0;
do{if(p<m){p++}else{return am}}while(a[p]!=am&&!bx(a[p],"V2000"));
c=bu(a[p],[3,3]);
for(o=0,u=bm(c[0]);
o<u;
o++){p++;
d=bu(a[p],[10,10,10,1,3,2,3,3,3,3,3,3,3,3,3,3]);
b=new gx(new cj(bn(d[0]),-bn(d[1]),bn(d[2])));
l=bm(d[6]);
if(l!=0){b.gp=4-l}b.gJ(d[4]);
b.dt=bm(d[8])-1;
if(b.dt<0){b.dt=am}b.gs=bm(d[10]);
if(b.gs>=15){b.gs=0}else{if(b.gs==0){b.gs=am}}if(d[5]!="0"&&b.gq){b.dr=M.round(b.gq.m)+bm(d[5])}h.fX(b)}for(o=0,u=bm(c[1]);
o<u;
o++){p++;
d=bu(a[p],[3,3,3,3,3,3,3]);
x=h.d4[bm(d[0])-1];
w=h.d4[bm(d[1])-1];
if(!x||!w||x.bS(w)){continue}l=bm(d[2]);
if(ba[l]!=am){l=ba[l]}f=new gA(x,w,l,bm(d[3]));
h.f1(f)}while(p<m){p++;
d=bv(a[p]);
switch(d[1]){case"CHG":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d4[bm(d[2*o+3])-1];
b.gp=l}}}catch(r){}break;
case"ISO":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d4[bm(d[2*o+3])-1];
b.dr=l}}}catch(r){}break;
case"RAD":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d4[bm(d[2*o+3])-1];
b.dq=l}}}catch(r){}break;
case"ATT":try{h.er=h.d4[bm(d[3])];
h.a3=bH(d[4]).split(",");
h.a4=bH(d[5])}catch(r){}break;
case"STY":u=3+2*bG(bm(d[2]));
try{for(o=3;
o<u;
o+=2){l=d[o+1].toUpperCase();
v=bm(d[o]);

if(l=="GEN"){l=aw}if(l==au){g=new iA()}else{if(l==av){g=new iC()}else{if(l==aw){g=new iE()}else{continue}}}h.h0(g);
q[v]=g}}catch(r){}break;
case"SCN":u=3+2*bG(bm(d[2]));
try{for(o=3;
o<u;
o+=2){v=bm(d[o]);
g=q[v];
if(g.type==aw){g.hM=d[o+1].toUpperCase()}}}catch(r){}break;
case"SDI":v=bm(d[2]);
try{g=q[v];
if(g&&g.iD){g.iD(d.slice(4))}}catch(r){}break;
case"SAL":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){g.fX(h.d4[bm(d[o])-1])}}}catch(r){}break;
case"SPA":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){g.hJ(h.d4[bm(d[o])-1])}}}catch(r){}break;
case"SBL":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){f=h.du[bm(d[o])-1];
g.hK(f)}}}catch(r){}break;
case"SDS":l=a[p].substr(13);
try{for(o=0,u=bp(l);
o<u;
o+=3){v=bm(bt(l.substr(o,3)));
g=q[v];
if(g){g.ie(F)}}}catch(r){}break;
case"SMT":v=bm(d[2]);
try{g=q[v];
if(g){g.ds=d[3].replace(/^[\s\^]+|[\s\^]+$/g,"");
g.hL=bm(d[3]);
if(g.hL){g.hM=""}}}catch(r){}break;
case"END":p=m;
break;
default:h.kg.push(a[p])}}for(p=0,m=bp(h.d4);
p<m;
p++){b=h.d4[p];
b.g_();
if(b.gp==b.g2){b.gp=am}if((b.ds=="N"&&b.gV()==5)||(b.ds=="S"&&b.gV()==4)){for(o=0,u=bp(b.du);
o<u;
o++){f=b.du[o];
if(f.dv==2&&(x=f.gR(b))&&x.ds=="O"&&x.en()==0){b.gX((b.g2==2&&x.en()==0)?-1:1);
f.dv--;
x.gX(-1);
break}}}}for(p=0,m=bp(h.ip);
p<m;
p++){g=h.ip[p];
for(o=0,u=bp(g.d4);
o<u;
o++){b=g.d4[o];
for(n=0,y=bp(b.du);
n<y;
n++){g.f1(b.du[n])}}if(g.type==au&&!bp(g.hH)){b9(g.hI,g.d4)}if(g.type!=av){for(o=0,u=bp(g.hI);
o<u;
o++){b=g.hI[o];
for(n=0,y=bp(b.du);
n<y;
n++){f=b.du[n];
if(!bX(g.d4,(f.c8.bS(b)?f.c_:f.c8))){b4(f,g.du)}}}}if(g.eM==am){g.ie(T)}}h.jN=1;
h.iK();
return h}function km(){if(!this.ht){if(!this.jO){this.iK()}this.ht=[];
for(var b=0,a=bp(this.jO);
b<a;
b++){bZ(this.ht,this.jO[b].d3())}}return this.ht}function kn(){var a=this;
if(a.eb){return a.eb}if(a.f3){return a.f3.c7()}}function jx(b){var c=this,a;
if(!c.fE){a=[];
bZ(a,c.du);
bZ(a,c.d4);
bZ(a,c.ip);
c.fE=a}return c.fE}function jA(e,a){var c=0,d,b;
if($.isArray(e)){for(b=bp(e)-1;
b>=0;
b--){c+=this.gC(e[b].c9,a)}}else{for(b=bp(this.d4)-1;
b>=0;
b--){d=ko-this.d4[b].c9.cT(e,a);
if(d>0){c+=kp*d*d}}}return c}function kq(c,h){var e,b,g,d=h,a=this.gC(h,T),f=0;
if(a>0){e=h.cc();
b=h.cc();
while(f++<10){e.eU(ag,c.c9);
if((g=this.gC(e,T))<a){a=g;
d=e.cc()}b.eU(-ag,c.c9);
if((g=this.gC(b,T))<a){a=g;
d=b.cc()}if(a==0){break}}f=h.cT(d);
h.x=d.x;
h.y=d.y}return f}function kr(){var d=this,c,b,a,e;
if(!d.dd||!d.db){fr.apply(d);
for(b=0,a=bp(d.ip);
b<a;
b++){c=d.ip[b];
if(c.type==au){e=0.4*ks*bp(c.ds);
fv(d,c.fx.y-e);
fv(d,c.fx.y+e)}}}}function jy(e){var h=this,b=[],g,d,a,c,f;
for(d=0,a=bp(h.d4);
d<a;
d++){g=h.d4[d];
if(!e||!g.d0){b.push(g.c9)}}if(!e){if(h.jO){for(d=0,a=bp(h.jO);
d<a;
d++){b0(b,h.jO[d].fx)}}if(h.ht){for(d=0,a=bp(h.ht);
d<a;
d++){b0(b,h.ht[d].fx)}}}for(d=0,a=bp(h.ip);
d<a;
d++){g=h.ip[d];
if(g.eP){for(c=0,f=bp(g.eP);
c<f;
c++){b.push(g.eP[c].dR,g.eP[c].dQ)}}if(!e){b0(b,g.fx);
b0(b,g.dd);
b0(b,g.db)}else{if(g.type==au){b0(b,g.d5())}}}if(!e){b0(b,h.fx);

b0(b,h.dd);
b0(b,h.db)}return b}function kt(b,a){this.gM=b;
this.ku=a}function kv(){for(var b=[],e,d,f,c=0,a=bp(this.d4);
c<a;
c++){e=this.d4[c];
if((d=e.gq)&&d.gh){f=d.gh+e.en()-e.gV();
if(f>0){b.push(new kt(e,f))}}}return b}function kw(){if(!this.f3){return -1}return bY(this.f3.f7,this)}function hC(){return this.ep}function kx(){return(this.f3?this.f3:this)}function jQ(a){this.ep=a;
this.jS=[];
this.jR=[]}function fI(){var a=this;
e4.apply(a);
a.d4=[];
a.ip=[];
a.du=[];
a.kg=[];
a.jN=1;
a.iK=j_;
a.d3=km;
a.fy=jw;
a.jV=j7;
a.kf=kf;
a.ky=kv;
a.eT=jz;
a.d2=kr;
a.gC=jA;
a.kc=kq;
a.cB=jB;
a.jT=jT;
a.fX=jW;
a.h0=jZ;
a.hZ=jY;
a.gF=j0;
a.removeAtom=j1;
a.fH=j1;
a.ic=j4;
a.f1=j5;
a.kz=j6;
a.fG=j8;
a.fL=jU;
a.kA=jP;
a.jC=kB;
a.dD=jx;
a.j2=fD;
a.fs=jy;
a.getIndex=kw;
a.cc=jM;
a.jX=kx;
a.eo=fi;
a.c7=kn}function kC(d){if(!d){d=new cd()}var e=this,b=new fK(e.eb),c,a;
bT(d,e,b);
for(c=0,a=bp(e.f7);
c<a;
c++){b.fL(e.f7[c].cc(d))}for(c=0,a=bp(e.kD);
c<a;
c++){b.kE(e.kD[c].cc(d),T)}b.kF=e.kF;
if(e.fP){b.fP=e.fP.cc(d);
b.fP.f3=b}b.kG=e.kG.cc(d);
return b}function kH(b){if(!b){b=new cd()}var c=this,a=new kI(c.c9.x,c.c9.y);
bT(b,c,a);
a.dH=c.dH;
return a}function kJ(b){if(!b){b=new cd()}var c=this,a=new fT(c.dR.cc(),c.dQ.cc());
bT(b,c,a);
a.dH=c.dH;
a.f3=b.cb(c.f3);
return a}function kK(){return cA(this.dR,this.dQ)}function kL(a){a.dw();
return b4(a,this.f7)}function kM(a,c,b){var d=this;
if(eq=="rxn"||!bp(d.f7)){if(b_(d.f7,a)){a.f3=d;
if(c){d.kN()}}}else{d.f7[0].fL(a,b)}}function kO(){this.kP();
this.kQ();
this.kR()}function kS(){if(eq!="rxn"){return}var c=this,f,e,g,a=c.f7,b,d,h,k,j;
for(f=bp(a)-1;
f>=0;
f--){b=a[f];
if(!bp(b.d4)){this.j3(b)}}a.sort(kT);
if(c.fP){g=c.fP.d5()}for(f=0,e=bp(a)-1;
f<e;
f++){b=a[f];
k=a[f+1];
d=b.d5();
j=k.d5();
if(g&&g.x>d.x&&g.x<j.x){c.kF=f+1}else{h=c.kU(d);
if(!h||h.c9.x>=j.x){b.d2();
k.d2();
c.kV(0.5*(b.db.x+k.dd.x),0.5*(j.y+d.y))}}}}function kW(l,k,d){if(l&&k){if(d){var c=this,b=l.d5(),j=k.d5(),e=M.min(b.x,j.x),a=M.max(b.x,j.x),g,f,h;
for(g=bp(c.kD)-1;
g>=0;
g--){f=c.kD[g].c9;
if(e<f.x&&f.x<a){c.kX(c.kD[g])}}if(c.fP){h=c.fP.d5();
if(e<h.x&&h.x<a){c.kY()}}}l.fL(k);
b4(k,this.f7);
this.kQ()}}function kZ(){var a=this,j=a.kD.concat(),e,g,c,f,b={},d={},h;
if(a.fP){j.push(a.fP)}j.sort(k0);
for(e=bp(j)-1;

e>=0;
e--){g=j[e];
f=g.d5();
h=this.k1(f);
if(!(h=this.k1(f))&&g instanceof kI){a.kX(g,T)}else{b[g.bQ]=h;
if(!(h=this.k2(f))&&g instanceof kI){a.kX(g,T)}d[g.bQ]=h}}for(e=bp(j)-2;
e>=0;
e--){g=j[e];
c=j[e+1];
h=b[g.bQ];
if(h&&h.bS(b[c.bQ])&&d[g.bQ]&&d[g.bQ].bS(d[c.bQ])){if(c instanceof kI){a.kX(c,T)}else{a.kX(g,T)}}}}function k3(f,j,g){for(var a,h=ar,b,c,e=0,d=bp(this.f7);
e<d;
e++){b=this.f7[e].d5();
if((b.x-f.x)*j>0||(b.y-f.y)*g>0){c=f.cT(b,T);
if(c<h){a=this.f7[e];
h=c}}}return a}function k4(a){return this.k5(a,-1,0)}function k6(a){return this.k5(a,1,0)}function k7(f,j,g){for(var a,h=ar,b,c,e=0,d=bp(this.kD);
e<d;
e++){b=this.kD[e].c9;
if((b.x-f.x)*j>0||(b.y-f.y)*g>0){c=f.cT(b,T);
if(c<h){a=this.kD[e];
h=c}}}return a}function k8(a){return this.k9(a,-1,0)}function k_(a){return this.k9(a,1,0)}function la(c){var k=c.ep,l=new fI(),b,h,m,g,f,e,a,d=st.gE();
this.f7.splice(bY(this.f7,k)+1,0,l);
l.f3=this;
l.jO=[];
this.kQ();
for(g=0,f=bp(c.jR);
g<f;
g++){b=c.jR[g];
for(e=0,a=bp(b.d4);
e<a;
e++){h=b.d4[e];
b4(h,k.d4);
if(!bX(l.d4,h)){l.fX(h)}}for(e=0,a=bp(b.du);
e<a;
e++){m=b.du[e];
b4(m,k.du);
if(!bX(l.du,m)){l.f1(m)}}b4(b,k.jO);
b_(l.jO,b);
k.ht=am;
k.fy(bg);
d.fy(bh)}}function lb(e,b){var c=this,d,a;
if(!b){d=c.k1(e.c9),a=c.k2(e.c9);
c.gD(d,a,F)}e.dw();
fj(e,c.kD);
c.j2(e);
if(!b){c.kQ()}}function lc(c,a){if(eq!="rxn"){return}var b=this;
b.kD.push(c);
c.f3=b;
if(!a){fn(c);
b.fy(bf)}return T}function ld(b,a,d){var c;
if(b instanceof cj){c=new kI(b.x,b.y)}else{c=new kI(b,a)}this.kE(c,d);
if(!d){this.le(c.c9)}return c}function dL(b,a,d,c){if(!c){c=this.data(as)}lf=c;
switch(hg){case aO:case aP:case aK:case aL:c.dj.attr("cursor","move");
break;
case aT:if(hi){c.f3.kX(c);
lf=am;
lg=T}break}}function dM(b,a,d,c){lf=am}function dU(c,a,d,b){if(!b){b=this.data(as)}lh=b;
switch(hg){case aO:case aP:case aK:case aL:b.dj.attr("cursor","move");
break;
case aT:if(hi){b.f3.kY(b);
lh=am}break}}function dV(c,a,d,b){lh=am}function li(h){for(var f=this,e,b,g=ar,d,c=0,a=bp(f.f7);
c<a;
c++){b=f.f7[c].kA(h);
if(b){d=h.cT(f.f7[c].d5(),T);
if(d<g){e=b;
g=d}}}if(e){f.lj(e)}f.kQ()}function lk(b){var c=this,a=c.fP;
if(!a){return F}if(b){c.kV(a.d5(),T)}c.j2(a);
a.dw();
c.fP=am}function ll(b,a,c){if(eq!="rxn"){return}if(!(b instanceof cj)){b=new cj(b,0)}if(!a){a=b.cc();
a.x+=lm}this.fU(new fT(b,a));
if(!c){this.le(cA(b,a))}}function ln(a){if(eq!="rxn"){return}var b=this;
if(b.fP){b.kY(T)}b.fP=a;
b.fP.f3=this;
b.fy(bf)}function lo(e,d,c,g){if(c==am){c=hk}if(g==am){g=hl}var b=e.ep,h,f,a;
if(!this.bS(b.f3)){return}if(b.bS(d.ep)){for(f=0,a=bp(b.du);
f<a;
f++){h=b.du[f];
if((h.c8.bS(e)&&h.c_.bS(d))||(h.c8.bS(d)&&h.c_.bS(e))){h.iY();
return h}}}else{this.gD(b,d.ep,T)}h=new gA(e,d,c,g);
b.f1(h);
return h}function lp(m,g){var e=m.lq,a=m.lr,h=e.ep,b=m.ls,d,c,f,k,j,l,i;

if(!this.bS(h.f3)){return}d=(m.eZ?a.c_:a.c8);
c=(m.eZ?a.c8:a.c_);
if(e.dv!=2||a.dv!=2){k=e.iZ();
if(k||e.dv!=a.dv){j=a.iZ();
if(e.dv!=2&&k){e.i0(k)}if(a.dv!=2&&j){a.i0(j)}}}if(!e.c8.io.bS(a.c8.io)){b.eU((eA(e.c8,e.c_)-eA(d,c))*ag,a.d5());
b.cu(e.c8.c9.cz(d.c9));
l=e.c8.c9.cT(e.c_.c9);
i=d.c9.cT(c.c9);
if(l>0&&i>0&&l!=i){b.eT(l/i,e.c8.c9)}}if(!h.bS(a.ep)){if(b){b4(a.ep,b.f7)}this.gD(h,a.ep,T)}f=(g[e.c8]||g[e.c_]||g[d]||g[c]);
if(f==2||(!f&&e.hB()+e.c8.hB()+e.c_.hB()>a.hB()+d.hB()+c.hB())){h.gF(d,e.c8);
g[e.c8]=2;
h.gF(c,e.c_);
g[e.c_]=2;
h.kz(a,e)}else{h.gF(e.c8,d);
g[d]=1;
h.gF(e.c_,c);
g[c]=1;
h.kz(e,a)}if(b){b.fG(a);
b.fH(d);
b.fH(c)}}function lt(d,a,h){var i=d.lq,e=d.lr,j=i.ep,f=d.ls,c,l;
if(!this.bS(j.f3)){return}if(a){if(!i.io){j.iK()}if(!i.io.bS(e.io)){f.cu(i.c9.cz(e.c9));
var b=i.g7(i.go()),g=i.gV(),m=e.g7(e.go()),k=e.gV();
if(b<k&&m<g&&(g>1||k>1)){f2(f.d4,T);
c=new gx(gy(i,1));
l=new gA(i,c,1,0);
j.fX(c);
j.f1(l);
h=1;
i=c;
f2(f.d4,F);
f.cu(c.c9.cz(e.c9))}else{if(m<g){h=2}else{if(b<k){h=1}}}}}if(!j.bS(e.ep)){if(f){b4(e.ep,f.f7)}this.gD(j,e.ep,T)}if(h==2||(!h&&i.hB()>e.hB())){j.gF(e,i)}else{j.gF(i,e)}if(f){f.fH(e)}}function kT(d,c){d.d2();
c.d2();
if(d.dd.x<c.dd.x){return -1}if(d.dd.x>c.dd.x){return 1}if(d.dd.y<c.dd.y){return -1}if(d.dd.y>c.dd.y){return 1}return 0}function k0(d,c){var e=d.d5(),f=c.d5();
if(e.x<f.x){return -1}if(e.x>f.x){return 1}if(e.y<f.y){return -1}if(e.y>f.y){return 1}return 0}function lu(){if(eq!="rxn"){return}this.kF=0;
var d=this,c,b,a;
if(d.fP){c=d.fP.d5()}for(b=0,a=bp(d.f7);
b<a;
b++){if(c&&d.f7[b].d5().x>=c.x){break}d.kF++}}function lv(){if(!this.f7||bp(this.f7)==0){return""}if(eq=="rxn"){for(var d=this,a,b,c=bp(d.f7)-1;
c>=0;
c--){if(!bp(d.f7[c].d4)){d.f7.splice(c,1)}}d.f7.sort(kT);
d.kQ();
b="$RXN\n\n"+ab+S+Number(new Date())+ao+ao+bA(d.kF,3)+bA(bp(d.f7)-d.kF,3)+ao;
for(c=0,a=bp(d.f7);
c<a;
c++){b+="$MOL\n";
b+=d.f7[c].kf()}return b}else{return this.f7[0].kf()}}function lw(a){this.lx(a);
this.fc()}function ly(c){var b=kh(c,"BoundingBox"),a;
if(b){a=b.indexOf(S);
if(a>0){b=b.substr(0,a)}}return bG(bn(b))}function lz(b,a){return ly(b)-ly(a)}function lA(m){m=by(m);
var c=this,k,h,g,f,o,d,a,l,n,j,b=0,e=0;
if(bw(m,"<!DOCTYPE CDXML")){m='<?xml version="1.0"  ?>'+m}if(bw(m,"<?xml")||bw(m,"<CDXML")){k=$($.parseXML(m));
h=k.find("page:first > fragment,page:first > group");
d=k.find("step");
if(bp(d)){c.kF=0;
h.sort(lz);
l=S+bH(d.attr("ReactionStepReactants"))+S+bH(d.attr("ReactionStepObjectsAboveArrow"));
for(g=0,f=bp(h);
g<f;
g++){j=kj(k,$(h[g]));
j.kk=bm(kh(h[g],"id"));
if(l.indexOf(S+j.kk)>-1){c.kF++}if(o=lB(c,j,b,e)){b=o;
e++}}if(g==c.kF){c.lC(b)}}else{c.kF=1;
j=kj(k,h);
j.cB();
c.fL(j)}}else{if(bw(m,"$RXN")){k=m.split("$MOL\n");
h=k.shift();
for(g=0,f=bp(k);
g<f;
g++){k[g]=ac(k[g])
}o=h.split(ao);
d=ac(o[bp(o)-2]);
c.kF=bm(d.substr(0,3));
a=bm(d.substr(3,3));
l=bm(d.substr(6,3));
if(l>0){n=k.splice(c.kF+a);
k.splice(c.kF,0,n);
c.kF+=l}for(g=0,f=bp(k);
g<f;
g++){j=kl(k[g]);
if(o=lB(c,j,b,e)){b=o;
e++}}if(g==c.kF){c.lC(b)}}else{if(m){c.kF=1;
j=kl(m);
j.cB();
c.fL(j);
if(eq=="tmpl"&&c.eb==aZ){if($.isArray(j.a3)){a3.val(j.a3.join(","))}if(j.a4!=am){a4.val(j.a4)}}}}}}function lB(d,a,c,b){if(!bp(a.d4)){if(b<d.kF){d.kF--}return am}if(b==d.kF){d.lC(c,am,T);
c+=lm+ec}else{if(b>0){d.kV(c,0,T);
c+=dG+ec}}a.cB();
a.jT(c);
d.fL(a);
c+=(a.db.x-a.dd.x)+ec;
return c}function lD(){var d=this;
if(!d.dd||!d.db){d.dd=new cj(ar,ar);
d.db=new cj(-ar,-ar);
for(var c=0,b=bp(d.f7);
c<b;
c++){var a=d.f7[c];
a.d2();
ft(d,a.db);
ft(d,a.dd)}}}function lE(d,a){if(!a){a=[]}else{if(bX(a,this)){return}}a.push(this);
if(d>bd&&d<bh&&d!=bf){var c=this,b;
if(c.dR.x>c.dQ.x){b=c.dR;
c.dR=c.dQ;
c.dQ=b}}a.pop()}function lF(e,b){if(!b){b=[]}else{if(bX(b,this)){return}}var d=this,c,a;
b.push(d);
if(e>be){d.fE=am}if(e>bd&&e<bh){d.lG()}d.f7.sort(kT);
if(e!=bd&&e!=bf){e=bg}for(c=0,a=bp(d.f7);
c<a;
c++){d.f7[c].fy(e,b)}d.kQ();
b.pop()}function lH(){this.dd=am;
this.db=am}function lI(){return this.eb}function lJ(a){this.eb=a;
this.dE()}function lK(c){var e=this,b,d,a;
if(!e.fE){b=[];
for(d=0,a=bp(e.f7);
d<a;
d++){bZ(b,e.f7[d].dD(c))}bZ(b,e.kD);
if(e.fP){b.push(e.fP)}b.sort(fl);
e.fE=b}return e.fE}function lL(d){for(var e=this,b=[],c=0,a=bp(e.f7);
c<a;
c++){bZ(b,e.f7[c].fs(d))}for(c=0,a=bp(e.kD);
c<a;
c++){b.push(e.kD[c].c9)}if(e.fP){b.push(e.fP.dR);
b.push(e.fP.dQ)}return b}function lM(){for(var b=[],c=0,a=bp(this.f7);
c<a;
c++){bZ(b,this.f7[c].d4)}return b}function lN(){for(var b=[],c=0,a=bp(this.f7);
c<a;
c++){bZ(b,this.f7[c].du)}return b}function lO(r,q,b){if(!r){return}if(q==am){q=kb}var h=r.x-q,c=r.x+q,g=r.y-q,a=r.y+q,f=r.z-b,t=r.z+b,e=[],m,l,k,d,p,o,n;
for(k=0,d=bp(this.f7);
k<d;
k++){p=this.f7[k];
for(m=0,l=bp(p.d4);
m<l;
m++){o=p.d4[m];
n=o.d5();
if(!o.dS&&!o.d0&&h<n.x&&n.x<c&&g<n.y&&n.y<a&&(b==am||(f<n.z&&n.z<t))){e.push(o)}}}return e}function lP(o,n){if(!o){return}if(n==am){n=lQ}var f=o.x-n,b=o.x+n,e=o.y-n,a=o.y+n,d,k,h,g,c,l,p,m;
for(g=0,c=bp(this.f7);
g<c;
g++){l=this.f7[g];
for(k=0,h=bp(l.du);
k<h;
k++){p=l.du[k];
if(!p.dS&&!p.d0&&f<M.max(p.c8.c9.x,p.c_.c9.x)&&M.min(p.c8.c9.x,p.c_.c9.x)<b&&e<M.max(p.c8.c9.y,p.c_.c9.y)&&M.min(p.c8.c9.y,p.c_.c9.y)<a){m=o.e2(p.c8.c9,p.c_.c9);
if(m<n){d=p;
n=m}}}}return d}function lR(n,m){if(!n){return}if(m==am){m=kb}var f=n.x-m,b=n.x+m,e=n.y-m,a=n.y+m,d=[],k,h,g,c,l,o;
for(g=0,c=bp(this.f7);
g<c;
g++){l=this.f7[g];
for(k=0,h=bp(l.ip);
k<h;
k++){o=l.ip[k];
o.d2();
if(f<o.db.x+o.iz&&o.dd.x<b&&e<o.db.y&&o.dd.y<a){d.push(o)}}}return d}function lS(b,a){return lT(b,this.kd(b,a))}function lU(b,a){return lT(b,this.lV(b,a))
}function lT(g,b){if(!b||!bp(b)){return}var d=b[0],f=d.d5().cT(g,T),e,c,a;
for(c=1,a=bp(b);
c<a;
c++){e=b[c].d5().cT(g,T);
if(e<f){d=b[c];
f=e}}return d}function lW(c){for(var b=[],e=0,a=bp(this.f7),d,g,f;
e<a;
e++){f=this.f7[e].d4;
for(d=0,g=bp(f);
d<g;
d++){if(f[d].ds==c){b.push(f[d])}}}return b}function lX(){return this.c9}function lY(a){return[this.c9]}function lZ(a){return[this.dR,this.dQ]}function l0(d){for(var e=this,b=d.kD,c=0,a=bp(b);
c<a;
c++){e.kE(b[c])}for(b=d.l1(),c=0,a=bp(b);
c<a;
c++){e.fL(b[c])}}function Reaction(a){fK.apply(this,[aZ,a])}function fK(b,c){var a=this;
e4.apply(a);
a.eb=b;
a.f7=[];
a.kD=[];
a.kF=0;
a.kG=new gw();
a.getAtoms=lM;
a.findAtoms=lW;
a.l2=lS;
a.l3=lP;
a.l4=lU;
a.kd=lO;
a.lV=lR;
a.l5=lN;
a.fy=lF;
a.d2=lD;
a.lG=lH;
a.kN=kO;
a.kP=kS;
a.kQ=lu;
a.kR=kZ;
a.l6=lv;
a.l7=lw;
a.lx=lA;
a.jL=lo;
a.l8=lt;
a.l9=lp;
a.kE=lc;
a.kV=ld;
a.kX=lb;
a.fU=ln;
a.lC=ll;
a.kY=lk;
a.fL=kM;
a.j3=kL;
a.gD=kW;
a.l_=l0;
a.le=li;
a.lj=la;
a.k5=k3;
a.k1=k4;
a.k2=k6;
a.k9=k7;
a.ma=k8;
a.kU=k_;
a.getAttAtom=function(){for(var e=0,d=bp(a.f7);
e<d;
e++){if(a.f7[e].er){return a.f7[e].er}}};
a.jC=mb;
a.dD=lK;
a.j2=fD;
a.fs=lL;
a.cu=e5;
a.cc=kC;
a.eo=fi;
a.c7=lI;
a.mc=lJ;
if(c){a.lx(c)}}function fT(c,a){var b=this;
fh.apply(b);
if(c.x>a.x){b.dR=a;
b.dQ=c}else{b.dR=c;
b.dQ=a}b.dH=F;
b.fy=lE;
b.d5=kK;
b.fs=lZ;
b.fc=dN;
b.dC=fA;
b.cc=kJ;
b.c7=kn}function kI(a,c){var b=this;
fh.apply(b);
b.c9=new cj(a,c);
b.dH=F;
b.fy=iB;
b.d5=lX;
b.fs=lY;
b.fc=dF;
b.dC=fA;
b.cc=kH;
b.c7=kn}function md(h,l){h=(h||st.dB());
var c=this,a=h.f7,g,e,b,f,d,k;
for(e=0,b=bp(a);
e<b;
e++){g=a[e];
for(f=0,d=bp(g.d4);
f<d;
f++){k=g.d4[f];
if(!l||!bX(l.d4,k)){c.fX(k)}}for(f=0,d=bp(g.du);
f<d;
f++){k=g.du[f];
if(!l||!bX(l.du,k)){c.f1(k)}}for(f=0,d=bp(g.ip);
f<d;
f++){k=g.ip[f];
if(!l||!bX(l.ip,k)){c.h0(k)}}}k=h.fP;
if(k&&(!l||!l.fP)){c.fU(k)}for(e=0,b=bp(h.kD);
e<b;
e++){k=h.kD[e];
if(!l||!bX(l.kD,k)){c.kE(k)}}}function me(){for(var d=this,a=d.d4,c,b=bp(d.du)-1;
b>=0;
b--){c=d.du[b];
if(!bX(d.d4,c.c8)||!bX(d.d4,c.c_)){d.fG(c)}}for(b=bp(d.hH)-1;
b>=0;
b--){d.fG(d.hH[b])}return d}function mf(d){for(var c,b=0,a=bp(this.d4);

b<a;
b++){c=this.d4[b];
c.gG(d);
fn(c)}}function mg(){for(var c,b=0,a=bp(this.ip);
b<a;
b++){c=this.ip[b];
c.ik();
this.ic(c)}}function mh(){var c=this,a=st.dB(),b;
while(bp(c.ip)){b=c.ip.pop();
b.ep.ic(b)}while(bp(c.du)){b=c.du.pop();
b.ep.fG(b)}while(bp(c.d4)){b=c.d4.pop();
b.ep.fH(b)}if(c.fP){a.kY();
c.kY()}while(bp(c.kD)){a.kX(c.kD.pop())}}function mi(){var a=this;
return !bp(a.d4)&&!bp(a.ip)&&!bp(a.du)&&!bp(a.kD)&&!a.fP}function mj(){var a=this;
while(bp(a.ip)){a.ic(a.ip[0])}while(bp(a.du)){a.fG(a.du[0])}while(bp(a.d4)){a.fH(a.d4[0])}a.kY();
while(bp(a.kD)){a.kX(a.kD[0])}}function mk(){var a=new gw(T);
a.bZ(am,this);
return a}function ml(m){var c=this,n=new cd(),h,g,d,b,f,o,l,k=[],a=[];
mm=c.cc(n,T);
for(h=0,g=bp(c.du);
h<g;
h++){b=c.du[h];
b_(k,b.c8);
b_(k,b.c_)}for(h=0,g=bp(c.hH);
h<g;
h++){b=c.hH[h];
b_(k,b.c8);
b_(k,b.c_)}for(h=0,g=bp(k);
h<g;
h++){b=k[h];
f=n.cb(b);
mm.fX(f,T);
o=b.ep;
l=n.bV[o.bQ];
if(!l){l=new fI();
n.bV[o.bQ]=l;
a.push(l)}l.fX(f,T)}if(mm.f7){bZ(mm.f7,a)}else{mm.f7=a}for(h=0,g=bp(c.d4);
h<g;
h++){b=c.d4[h];
f=n.cb(b);
for(d=bp(b.du)-1;
d>=0;
d--){if(!bX(c.du,b.du[d])){f=n.cb(b);
b4(n.cb(b.du[d]),f.du);
f.fy(bg)}}}for(h=0,g=bp(mm.d4);
h<g;
h++){mm.d4[h].dH=am}for(h=0,g=bp(mm.du);
h<g;
h++){mm.du[h].dH=am}for(h=0,g=bp(mm.hH);
h<g;
h++){mm.hH[h].dH=am}for(h=0,g=bp(mm.ip);
h<g;
h++){mm.ip[h].dH=am}mm.dE();
if(m){if(bp(mm.f7)==1){f=mm.f7[0].kf()}else{l=new fK();
l.l_(mm);
f=l.l6()}o=$(D.activeElement);
$("#copyHelper").val(f).focus().select();
D.execCommand("copy");
o.focus()}}function mn(b){var a,c;
if(bp(b.f7)==1){a=b.f7[0].kf()}else{c=new fK();
c.l_(b);
a=c.l6()}return a}function mo(){var d=this.l1(),b,c,a;
for(c=0,a=bp(d);
c<a;
c++){if(b=d[c].er){return b}}}function mp(){var c=this,b,a;
if(!c.f7){c.f7=[];
for(b=0,a=bp(c.du);
b<a;
b++){b_(c.f7,c.du[b].ep)}for(b=0,a=bp(c.d4);
b<a;
b++){b_(c.f7,c.d4[b].ep)}for(b=0,a=bp(c.ip);
b<a;
b++){b_(c.f7,c.ip[b].ep)}}return c.f7}function mq(){var c=this,b,a;
if(!c.jO){c.jO=[];
for(b=0,a=bp(c.du);
b<a;
b++){b_(c.jO,c.du[b].c8.io);
b_(c.jO,c.du[b].c_.io)}for(b=0,a=bp(c.d4);
b<a;
b++){b_(c.jO,c.d4[b].io)}for(b=0,a=bp(c.ip);
b<a;
b++){b_(c.jO,c.ip[b].io)}}return c.jO}function mr(a){this.copy(a);
this.ms()}function mt(b,a){var d=this,c=b.eu;
if(c&&!bX(d.ip,c)){return d.h0(c,a)}else{b_(d.d4,b);
if(!d.mu){d.fy(bg);
b.dH=T;
if(!a){fn(b)}}return T}}function mv(a){var b=this;
if(b4(a,b.d4)&&!b.mu){b.fy(bg);
a.dH=F;
b.j2(a);
fn(a)}}function mw(d,c){b_(this.ip,d);
for(var e=this,b=0,a=bp(d.d4);
b<a;
b++){e.fX(d.d4[b],c)}for(b=0,a=bp(d.du);
b<a;
b++){e.f1(d.du[b],c)}for(b=0,a=bp(d.hH);
b<a;
b++){e.f1(d.hH[b],c)}if(!e.mu){e.fy(bg);
d.dH=T;
if(!c){fn(d)
}}return T}function mx(c){var d=this,b,a;
if(b4(c,d.ip)&&!d.mu){d.fy(bg);
c.dH=F;
d.j2(c);
fn(c)}for(b=0,a=bp(c.d4);
b<a;
b++){d.fH(c.d4[b])}for(b=0,a=bp(c.du);
b<a;
b++){d.fG(c.du[b])}for(b=0,a=bp(c.hH);
b<a;
b++){d.fG(c.hH[b])}}function my(c,a){var d=this,b=c.eu;
if(b&&!bX(d.ip,b)){return d.h0(b)}else{if(b_(d.du,c)){if(!d.mu){d.fy(bg);
c.dH=T;
if(!a){fn(c)}}return T}return F}}function mz(a){var b=this;
if(b4(a,b.du)&&!b.mu){b.fy(bg);
a.dH=F;
b.j2(a);
fn(a)}}function mA(b){for(var c=0,a=bp(b.d4);
c<a;
c++){this.fX(b.d4[c])}for(c=0,a=bp(b.du);
c<a;
c++){this.f1(b.du[c])}}function mB(b,a){this.fP=b;
if(!this.mu){this.fy(bg);
b.dH=T;
if(!a){fn(b)}}return T}function mC(){var a=this;
if(a.fP){if(!a.mu){a.fy(bg);
a.fP.dH=F;
fn(a.fP)}a.fP=am}}function mD(b,a){if(b_(this.kD,b)){if(!this.mu){this.fy(bg);
b.dH=T;
if(!a){fn(b)}}return T}return F}function mE(a){if(b4(a,this.kD)&&!this.mu){this.fy(bg);
a.dH=F;
fn(a)}}function mF(o,n,l){l=bG(l);
var c=this,k=st.dB(),a=k.f7,h,e,b,g,d,m,f;
for(e=0,b=bp(a);
e<b;
e++){h=a[e];
for(g=0,d=bp(h.d4);
g<d;
g++){f=h.d4[g];
if(!f.d0&&f.c9.cV(o,n,l)){c.fX(f)}}for(g=0,d=bp(h.du);
g<d;
g++){f=h.du[g];
if(!f.d0&&f.d5().cV(o,n,l)){c.f1(f)}}for(g=0,d=bp(h.ip);
g<d;
g++){f=h.ip[g];
if(!f.eM&&f.d5().cV(o,n,l)){c.h0(f)}}}m=k.fP;
if(m){if(m.dR.cV(o,n,l)||m.dQ.cV(o,n,l)){c.fU(m)}}for(e=0,b=bp(k.kD);
e<b;
e++){f=k.kD[e];
if(f.c9.cV(o,n,l)){c.kE(f)}}}function mG(n,m){var c=this,k=st.dB(),a=k.f7,h,e,b,g,d,l,f;
for(e=0,b=bp(a);
e<b;
e++){h=a[e];
for(g=0,d=bp(h.d4);
g<d;
g++){f=h.d4[g];
if(!f.d0&&f.c9.cX(n,m)){c.fX(f)}}for(g=0,d=bp(h.du);
g<d;
g++){f=h.du[g];
if(!f.d0&&f.d5().cX(n,m)){c.f1(f)}}for(g=0,d=bp(h.ip);
g<d;
g++){f=h.ip[g];
if(!f.eM&&f.d5().cX(n,m)){c.h0(f)}}}l=k.fP;
if(l){if(l.dR.cX(n,m)||l.dQ.cX(n,m)){c.fU(l)}}for(e=0,b=bp(k.kD);
e<b;
e++){f=k.kD[e];
if(f.c9.cX(n,m)){c.kE(f)}}}function mH(c){var f=this,b,e,d,a;
if(!f.fE){b=[];
for(d=0,a=bp(f.d4);
d<a;
d++){e=f.d4[d];
b.push(e);
if(!c){b9(b,e.du)}}for(d=0,a=bp(f.du);
d<a;
d++){e=f.du[d];
b_(b,e);
if(!c){if(b_(b,e.c8)){b9(b,e.c8.du)}if(b_(b,e.c_)){b9(b,e.c_.du)}}}for(d=0,a=bp(f.ip);
d<a;
d++){e=f.ip[d];
b.push(e)}b0(b,f.fP);
bZ(b,f.kD);
f.fE=b}return f.fE}function mI(d){var c=this,b=[],k=[],g,l,m,h,f,e,a;
for(h=0,f=bp(c.d4);
h<f;
h++){g=c.d4[h];
if(!d||!g.d0){k.push(g);
b.push(g.c9)}}for(h=0,f=bp(c.du);
h<f;
h++){g=c.du[h];
if((!d||!g.d0)&&!bX(c.d4,g.c8)&&!bX(c.d4,g.c_)){k.push(g.c8);
k.push(g.c_);
b.push(g.c8.c9,g.c_.c9)}}for(h=0,f=bp(c.ip);
h<f;
h++){g=c.ip[h];
if(g.eP){for(e=0,a=bp(g.eP);
e<a;
e++){b.push(g.eP[e].dR,g.eP[e].dQ)}}if(!d){b0(b,g.fx);
b0(b,g.dd);
b0(b,g.db)}if(d&&!g.eM&&bp(g.hI)){for(e=0,a=bp(g.hI);
e<a;
e++){l=g.hI[e];
if(!bX(k,l)){b.push(l.c9)}}}else{for(e=0,a=bp(g.d4);
e<a;
e++){l=g.d4[e];
if(!bX(k,l)){b.push(l.c9)}}}}m=c.fP;
if(m){b.push(m.dR,m.dQ)
}for(h=0,f=bp(c.kD);
h<f;
h++){b.push(c.kD[h].c9)}if(!d){b0(b,c.fx)}return b}function mJ(k,h){if(!k){k=new cd()}h=(h==am?this.mu:h);
var d=this,c=new gw(h),b,f,a=[],g,e,l,j;
bT(k,d,c);
for(g=0,e=bp(d.ip);
g<e;
g++){b=d.ip[g];
f=k.cb(b);
c.h0(f,T);
l=b.ep;
j=k.bV[l.bQ];
if(!j){j=new fI();
k.bV[l.bQ]=j;
a.push(j)}j.h0(f,T)}for(g=0,e=bp(d.du);
g<e;
g++){b=d.du[g];
f=k.cb(b);
c.f1(f,T);
l=b.ep;
j=k.bV[l.bQ];
if(!j){j=new fI();
k.bV[l.bQ]=j;
a.push(j)}j.f1(f,T)}for(g=0,e=bp(d.hH);
g<e;
g++){b=d.hH[g];
f=k.cb(b);
b_(c.hH,f);
l=b.ep;
j=k.bV[l.bQ];
if(!j){j=new fI();
k.bV[l.bQ]=j;
a.push(j)}j.f1(f,T)}for(g=0,e=bp(d.d4);
g<e;
g++){b=d.d4[g];
f=k.cb(b);
c.fX(f,T);
l=b.ep;
j=k.bV[l.bQ];
if(!j){j=new fI();
k.bV[l.bQ]=j;
a.push(j)}j.fX(f,T)}if(d.fP){c.fU(k.cb(d.fP),T)}for(g=0,e=bp(d.kD);
g<e;
g++){c.kE(k.cb(d.kD[g]),T)}if(c.f7){bZ(c.f7,a)}else{c.f7=a}for(g=0,e=bp(c.f7);
g<e;
g++){j=c.f7[g];
j.ht=am;
j.iK()}if(d.fx){c.fx=d.fx.cc()}c.hW=d.hW;
c.dE();
return c}function mK(h,b){var g=this,f,e=st.dB(),d,c,a;
if(!b){b=[]}else{if(bX(b,g)){return}}b.push(g);
if(h>be){if(h!=bf){g.f7=am;
g.jO=am}g.fx=am;
g.fE=am}if(h!=bf){f=g.l1();
for(c=0,a=bp(f);
c<a;
c++){f[c].fy(bg,b)}if(d=g.fP){d.fy(h,b)}}e.fy(h,b);
b.pop()}function mL(d,a,b,c){this.ls=b;
this.lq=d;
this.lr=a;
this.cT=c}function mM(h,k){var b=[],l=h.getAtoms(),m,g,f,d,e,a,c;
b2(l,this.d4);
for(e=0,a=bp(l);
e<a;
e++){c=l[e];
if(!c.eu){for(g=0,f=bp(this.d4);
g<f;
g++){d=this.d4[g];
if(!d.eu){m=c.c9.cT(d.c9,T);
if(m<=k){b.push(new mL(c,d,this,m));
break}}}}}return b}function mN(m,n){var e=this,d=[],p=m.l5(),b,a,o,l,k,g,h,c,f;
b2(p,e.du);
for(h=0,c=bp(p);
h<c;
h++){f=p[h];
if(f.c8.eu||f.c_.eu){continue}for(l=0,k=bp(e.du);
l<k;
l++){g=e.du[l];
if(g.c8.eu||g.c_.eu){continue}if((b=f.c8.c9.cT(g.c8.c9,T))<=n&&(a=f.c_.c9.cT(g.c_.c9,T))<=n){d.push(new mL(f,g,e,0.5*(b+a)));
break}if((b=f.c8.c9.cT(g.c_.c9,T))<=n&&(a=f.c_.c9.cT(g.c8.c9,T))<=n){o=new mL(f,g,e,0.5*(b+a));
o.eZ=T;
d.push(o);
break}}}return d}function mO(b,a){if(!a){a=this.d5().cc()}fz.apply(this,arguments)}function gw(a){var b=this;
e4.apply(b);
b.mu=a;
b.d4=[];
b.ip=[];
b.du=[];
b.hH=[];
b.kD=[];
b.fy=mK;
b.gb=mi;
b.ms=mh;
b.jJ=mj;
b.mk=mk;
b.cut=mr;
b.copy=ml;
b.l1=mp;
b.mP=mq;
b.mQ=mo;
b.mR=mf;
b.ungroupGroups=mg;
b.dD=mH;
b.j2=fD;
b.fs=mI;
b.eT=mO;
b.mS=mM;
b.mT=mN;
b.addAll=b.bZ=md;
b.addRectSelection=mF;
b.mU=mG;
b.fX=mt;
b.fH=mv;
b.h0=mw;
b.ic=mx;
b.f1=my;
b.fG=mz;
b.mV=me;
b.kE=mD;
b.kX=mE;
b.fU=mB;
b.kY=mC;
b.fL=mA;
b.cc=mJ}function mW(){var b="",A=gc[H].m,f=gc[H].ge,n=st.gE(),a=bp(n.d4),c={},o="",l=0,r=0,y={},u="",k=0,v=0,z,m,w,h,t,p,q,x,e=st.dB().getAtoms(),d,g;

n.hH=[];
n.hW=T;
for(t=0,p=bp(e);
t<p;
t++){d=e[t];
if(!d.dH){z=d.eu;
m=(z&&z.type==aw&&z.hL)||1;
if(y){k+=m*d.hA(F);
v+=m*d.hA(T);
y[d.ds]=bG(y[d.ds])+m;
h=d.eD();
y[H]=bG(y[H])+(m*h);
k+=m*A*h;
v+=m*f*h}if(z){if(z.type==aw&&!z.hL){k=am;
v=am;
y=am;
u=s("poly");
break}}}}for(t=0,p=a;
t<p;
t++){d=n.d4[t];
z=d.eu;
m=(z&&z.type==aw&&z.hL)||1;
if(c){l+=m*d.hA(F);
r+=m*d.hA(T);
c[d.ds]=bG(c[d.ds])+m;
h=d.eD();
c[H]=bG(c[H])+(m*h);
l+=m*A*h;
r+=m*f*h}if(w){if(!w.bS(d.io)){n.hW=F}}else{w=d.io}if(z){n.hW=F;
if(z.type==aw&&!z.hL){l=am;
r=am;
c=am;
o=s("poly")}}for(q=0,x=bp(d.du);
q<x;
q++){if(!d.du[q].dH){n.hH.push(d.du[q])}}}for(t=0,p=bp(n.du);
t<p;
t++){g=n.du[t];
if(w){if(!w.bS(g.c8.io)){n.hW=F}}else{w=g.c8.io}if(g.eu){n.hW=F}if(!g.c8.dH||!g.c_.dH){n.hH.push(g)}}n.hW=(n.hW&&a>0&&bp(n.hH)<=2);
if(c){o=mX(c)}if(y){u=mX(y)}mY($("#bondRotate"),bp(n.hH)==1);
mY($("#groupSelection"),n.hW);
mY($("#ungroupSelection"),bp(n.ip));
if(a){b+=s("sele")+":&nbsp;"+o+mZ(l,r);
if(u){b+=S+s("rem")+":&nbsp;"+u+mZ(k,v)}}$("#info").html(b);
m0("change")}function mZ(b,a){if(b>0){return"&nbsp;("+round(b,2,3)+"/"+round(a,4,3)+")"}return""}function mX(h){var f,b,a=[C,H],d,e,g,c="";
br(h);
for(f=0,b=bp(a);
f<b;
f++){d=a[f];
e=h[d];
if(e>0){c+=d;
if(e>1){c+=aI+e+aJ}}}for(d in h){e=h[d];
g=gc[d];
if((!g||!g.gd)&&e>0){c+=d;
if(e>1){c+=aI+e+aJ}}}return c}function dB(){var a=this;
if(a.m1){return a.m1}a.m2=bJ(a.m2,0,bp(a.m3)-1);
return a.m3[a.m2]}function gE(){return this.dB().kG}function hf(){return this.m4}function m5(a){this.m4=a}function m6(){if(this.m4){this.m4.m7=am;
this.m4.m8=am;
this.m4=am}}function m9(){if(this.m_()){this.na(-1)}}function nb(){return this.m2>0}function nc(){if(this.nd()){this.na(1)}}function na(a){this.ne();
resetDirty(aZ);
this.m2+=a;
nf(aZ);
ng(this.dB()).fc();
mW()}function ng(a){a.d2();
$("#threed").fadeTo(500,(a.db.z-a.dd.z)>0?1:0).css("color",hl?"red":"black");
return a}function nh(){return this.m2<bp(this.m3)-1}function ni(){var a=bp(this.m3)-nj;
if(a>0){this.m3.splice(0,a);
this.m2-=a}}function nk(){var a=this;
a.ni();
a.m3.splice(a.m2,0,st.dB().cc(new cd(T)));
a.m2++;
a.m3.length=a.m2+1}function nl(a){var b=this;
b.ni();
b.m2++;
b.m3[b.m2]=ng(a);
b.m3.length=b.m2+1}function nm(){var b=this,a=b.m3[b.m2];
b.m3[b.m2]=a.cc(new cd(T));
b.m1=a}function nn(){return !!this.m1}function ne(){var a=this;
if(a.m1){a.m1.dw();
a.m1=am;
a.m6();
a.dB().fc()}}function no(){var a=this;
if(a.m1){a.nl(a.m1);
a.m1=am;
a.m6();
mW()}}function np(){var a=this;
a.m3=[];
a.m3[0]=new fK(aZ);
a.m2=0;
a.he=F;
a.nm=nm;
a.nn=nn;
a.ne=ne;
a.no=no;
a.getCurrentReaction=dB;
a.dB=dB;
a.gE=gE;

a.hf=hf;
a.m5=m5;
a.m6=m6;
a.ni=ni;
a.nk=nk;
a.nl=nl;
a.undo=m9;
a.m_=nb;
a.redo=nc;
a.nd=nh;
a.na=na}function nq(a){$("#"+a).click()}function activateTool(d,b){nr();
ns(hg,b);
if(hg!=b){nt=F;
var a=F;
switch(b){case aU:case aV:nu();
a=T;
break;
case aX:case aY:a=T;
break;
case aP:nt=T;
break}if(!a){$(nv).css({border:"",ec:""});
$(d).css({border:"1.5px solid black",ec:"0.5px"});
nv=d}hg=b}else{if(hj&&b==aT){var c=st.gE();
if(!c.gb()){nx()}}}if(st){ih()}}function useAtom(a){ny(a);
$("#atom").click()}function ns(b,a){switch(b){case aU:case aV:hi=F;
st.ne();
break}}function nz(){nA(nv)}function nA(a){if(a){$(a).trigger("click",{nB:T})}}function nC(a){nD=a.ctrlKey;
return bo(a)}function nE(b){if(!st.he){var a=b.dataTransfer;
if(!a&&b.originalEvent){a=b.originalEvent.dataTransfer}if(a){a=a.files}else{if(b.target){a=b.target.files}}nF(a,aU,F)}return bo(b)}function nF(c,b,d){if(c&&bp(c)){var a=new FileReader();
a.onload=function(f){var e=f.target.result;
if(d||nD){activateTool(am,b);
pasteMolFile(e)}else{l7(e)}};
a.readAsText(c[0],"iso-8859-1")}}function nG(b,a){if(b&&(!a||!a.nB)){nH=b.target}}function nI(a){nH=am}function nJ(d){if(!d||!d.data||!d.data.nB){nG(d);
var c=$(nH).parent().children(ax),a=aZ.height,b=c.height();
c.fadeIn(50).css("z-index",10000);
c.css(c.offset().top+b>a?{position:"absolute",top:(a-b-25)+"px"}:{position:am,top:am})}}function nK(a){setTimeout(function(){if(!a){nI()}var b=$(ax).filter(":visible");
if(bp(b)){if(nH){b=b.not($(nH).parent().children())}if(bp(b)){if(nL){b.hide()}else{b.fadeOut(100)}}}if(hj&&!bp(b)){nJ()}},100)}function nM(a){if(a.target.tagName.toLowerCase()=="img"){a7.prop("src",a.target.src);
a8=T;
nN()}}function nu(){a8=F;
nO()}function nN(){if(a8){a7.show()}}function nO(){if(a8){a7.hide()}}function nP(){var b=navigator.userAgent.toLowerCase(),a="";
if(/android|blackberry|kindle|mobile|phone/.test(b)){a="mobile"}else{if(/windows|macintosh|linux/.test(b)){a="desktop"}else{if(/Pad|Tablet/.test(navigator.userAgent)){a="mobile"}else{if(/CrOS|Mac/.test(navigator.userAgent)){a="desktop"}else{a=(nQ()?"mobile":"desktop")}}}}return a}function nQ(){return"ontouchstart" in document.documentElement}function setBond(a,b){hk=a;
hl=b;
ng(st.dB())}function hY(){ig(aZ);
st.nk()}function h1(a){ih(T);
ng(st.dB());
fq(a||aZ);
mW()}function nR(h){for(var b=a2.val(),g,d,c="",f=0,a=bp(b);
f<a;
f++){g=b.charCodeAt(f);
if((!d&&g>96&&g<123)||(g==104&&b!="Ph"&&b!="Rh"&&b!="Th")){g-=32}d|=(g>64&&g<91);
c+=String.fromCharCode(g)}if(b!=c){ny(c)}}function nS(g){if(nT||g.timeStamp<nU){hX(F);
return}if(nV(g)){return T}nW=T;
var f=g.which,d,b,c=g.ctrlKey,a=g.shiftKey;
if(nX(a2,g)&&f!=13){if(!a&&((((b=a2.val())==""||!isNaN(bm(b)))&&f>64&&f<91)||(f==72&&b!="P"&&b!="R"&&b!="T"))){ny(b+String.fromCharCode(f));
return F}return T}d=(g.altKey?0.2:1);
switch(f){case 37:nY(-d,0);

break;
case 38:nY(0,-d);
break;
case 39:nY(d,0);
break;
case 40:nY(0,d);
break;
case 74:if(c&&bp(b=st.gE().d4)==2){hY();
fn(st.dB().jL(b[0],b[1]));
h1();
break}case 36:nY(0,0,d);
break;
case 75:case 35:nY(0,0,-d);
break;
case 33:nZ();
n0();
break;
case 34:n1();
n0();
break;
case 67:case 86:case 88:if(c){return T}break}nK();
return bo(g)}function nX(a,b){return a&&b&&a.is(b.target)}function nV(a){return nX(a3,a)||nX(a4,a)||getSelection().toString()}function n2(a){return(nX(a2,a)||nV(a)?T:bo(a))}function hX(a){if(a){nT=T}else{clearTimeout(n3);
n3=setTimeout(function(){nT=F},500)}}function n4(h){if(st.he||nT||h.timeStamp<nU){nT=F;
return}if(nV(h)){return T}if(nX(a2,h)){if(h.which==27||h.which==113){a2.blur()}if(h.which!=13){return T}}var f=h.which,a,d=h.ctrlKey,b=h.altKey,g=(!d&&!h.shiftKey&&!b),c=st.gE();
if(f>15&&f<19){nU=h.timeStamp+200}switch(f){case 13:if(et){hY();
et.gG(hh());
fn(et);
h1()}else{if(!c.gb()){hY();
c.mR(hh());
h1()}}break;
case 27:et=am;
eF=am;
if(hi){n5=T;
hi=F;
st.ne();
ig(aZ)}else{st.m6();
clearSelection()}nz();
break;
case 46:if(c.gb()){nq("deleteButton")}else{nx()}break;
case 49:case 97:nq("single");
break;
case 50:case 98:nq(d?"clean2D":"double");
break;
case 51:case 99:nq(d?"clean3D":"triple");
break;
case 65:if(d){hY();
c.bZ();
h1()}else{nq(aK)}break;
case 67:if(d){copy(h)}else{if(g){a=T}}break;
case 68:nq("singleDown");
break;
case 69:nq(aO);
break;
case 71:if(d){if(h.shiftKey){doUngroup()}else{createGroup()}}break;
case 76:if(g){a="Cl"}break;
case 77:nq("singleEither");
break;
case 66:case 70:case 72:case 73:case 78:case 80:if(g){a=T}break;
case 79:if(d&&b){$("#fileUpload").click()}else{if(g){a=T}}break;
case 81:nq(aP);
break;
case 82:if(g){a="Br"}break;
case 83:if(d&&b){saveFile()}else{if(g){a=T}}break;
case 84:nq("3d_rotate");
break;
case 85:if(d){doUngroup()}else{nq("singleUp")}break;
case 86:if(d){return}else{nq(aQ)}break;
case 87:nq(aM);
break;
case 88:if(d){cut(h)}break;
case 89:if(d){st.redo()}break;
case 90:if(d){st.undo()}break;
case 107:case 171:case 187:if(et){hY();
et.gX(1);
fn(et);
h1()}break;
case 109:case 173:case 189:if(et){hY();
et.gX(-1);
fn(et);
h1()}break;
case 110:case 190:if(et){hY();
et.hz();
fn(et);
h1()}break;
case 113:a2.focus().select();
break}if(a){if(a===T){a=String.fromCharCode(f)}if(et){hY();
et.gG(a);
fn(et);
h1()}else{ny(a)}}return bo(h)}function n6(b){var a=1/eG;
return new cj((b.x-0.5*n7.x)*a+n8.x,(b.y-0.5*n7.y)*a+n8.y)}function n9(a){var b=a0.offset();
return n6(new cj(a.pageX-b.left,a.pageY-b.top))}function n_(b,a){if(a){oa=[];
ob="M"+b;
oc={x:b.x,y:b.y,x2:b.x,y2:b.y}}else{ob+="L"+b;
oc.x=M.min(oc.x,b.x);
oc.x2=M.max(oc.x2,b.x);
oc.y=M.min(oc.y,b.y);
oc.y2=M.max(oc.y2,b.y)}oa.push(b)
}function od(){return(et?et.ep:(oe?oe.ep:(eF?eF.ep:am)))}function nr(){et=oe=eF=lf=lh=am}function of(b){if(parent){parent.postMessage("focused","*")}if(hi||b.which!=1||st.hf()){return}if(eF){if([aT,aO,aP].indexOf(hg)<0){n5=T;
return}}nK();
og(b);
hi=T;
n5=F;
oh=et;
oi=oe;
oj=eF;
ok=lh;
ol=lf;
om=F;
var d=n9(b),a,c;
n_(d,T);
if(!st.he){switch(hg){case aO:case aP:case aX:case aM:case aK:case aL:case aT:case aN:st.nm();
break;
case aQ:case aR:case aS:a=st.gE();
st.nm();
if(a.gb()){a=new gw(T);
if(c=od()){a.fL(c)}else{a.bZ()}}nr();
st.m5(a);
break}}if(!st.he){return bo(b)}}function oo(c,d,b,a){if(eg){op(c,d,b,a)}else{oq+=b;
or+=a;
if(os){clearTimeout(os)}os=setTimeout(function(){op(c,d,oq,or);
oq=0;
or=0},500)}return bo(c)}function op(d,h,c,a){var g=n9(d),f,j,k,b,i;
if(st.he||d.ctrlKey){if(a<0){zoomOut()}else{zoomIn(cA(g,n8))}}else{if(d.shiftKey){f=(d.altKey?0.5:2.5);
if(d.ctrlKey){nY(-a*f,c*f)}else{nY(c*f,-a*f)}}else{if(!(j=st.hf())){hY();
j=st.gE();
if(j.gb()){j=new gw(T);
j.bZ()}}f=-M.PI*a/(d.altKey?af:12);
if(hg==aS){i=j.hH[0];
k=(i.c8.dH?i.c8:i.c_);
b=(i.c8.dH?i.c_:i.c8);
j.e8(f,k.c9.cc(),b.c9)}else{k=j.mQ();
j.eU(f,(k?k.c9.cc():am))}}}nr();
ig(aZ);
ih();
ot()}function ou(y){nK();
if(st.he&&y.which!=1){ov()}else{if(y.which==1&&!n5){og(y);
var f=ow,q=oa[0]||f,b=st.dB(),z,n,t,c,w,u,l,o,x,d,j,r,h,k,g,p,m,v={},a=(st.he?aY:hg);
if((om||!y.ctrlKey)&&(z=st.hf())){t=z.mT(b,ox);
for(w=0,u=bp(t);
w<u;
w++){b.l9(t[w],v)}c=z.mS(b,ox);
for(w=0,u=bp(c);
w<u;
w++){b.l8(c[w],u==1)}n=z.l1();
oy(n);
for(w=0,u=bp(n);
w<u;
w++){b.fL(n[w])}b.kN();
z.fy(bd);
st.no()}else{if(!om&&y.ctrlKey&&(l=(et||oe))){switch(a){case aT:b.j3(l.ep);
st.no();
break;
default:o=st.gE();
if(!y.shiftKey){o.jJ()}o.fL(l.ep);
st.no()}}else{switch(a){case aY:if(om){zoomBox(q,f)}else{zoomIn(f)}break;
case aQ:case aR:case aS:st.no();
break;
case aO:case aP:if(!z){o=st.gE();
if(!y.shiftKey){o.jJ()}x=0;
if(!om){x=3;
if(oe){o.f1(oe)}if(lh){o.fU(lh)}if(lf){o.kE(lf)}}if(a==aO){o.addRectSelection(q,f,x)}else{n_(f);
n_(q);
o.mU(oa,oc)}}st.no();
break;
case aW:hY();
d=b.kV(f);
fn(d);
h1();
break;
case aX:if(!om){f.x+=lm}b.lC(q,f);
fn(b);
st.no();
nz();
break;
case aM:if(oe&&!et&&!om){oe.iY();
st.no()}else{r=F;
if(oh){j=oh.ep;
if(!oh.eu&&oh.bS(et)){k=new gx(gy(oh,1));
g=new gA(oh,k,1,0);
j.fX(k);
j.f1(g);

k.gG(hh());
fn(oh);
ig(aZ);
st.no();
break}}else{if(eq=="rxn"||!bp(b.f7)){j=new fI();
b.fL(j);
r=T}else{j=b.f7[0]}}if((!oh||!oh.eu)&&(!et||!et.eu)&&jG(y,q,f,j,oh,et)){if(r){b.kP();
b.kQ()}st.no()}else{st.ne()}}break;
case aK:if(et){et.gG(hh());
fn(et);
st.no();
break}case aL:if(oe&&!et&&!om){oe.iY();
st.no()}else{if((oi&&!oh)||(oh&&oh.eu)||(et&&et.eu)){st.ne()}else{p=hh();
gz.ga();
h=oh;
k=et;
if(h&&k&&!k.bS(h)){if(g=h.hv(k)){g.iY()}else{h.ep.f3.jL(h,k)}}else{if(k&&k.bS(h)){om=F;
k=am}if(!om){f=am}r=F;
m=[];
if(eq!="rxn"){j=b.f7[0]}else{if(h){j=h.ep}else{if(k){j=k.ep}}}if(!j){j=new fI();
b.fL(j);
r=T}if(!h){h=new gx(q.cc());
j.fX(h);
m.push(h)}if(!k&&(om||oh||(a==aL&&p==C))){k=new gx(gy(h,hk,f,y));
j.fX(k);
m.push(k)}j.f1(new gA(h,k,hk,hl));
for(w=0,u=bp(m);
w<u;
w++){m[w].gG(p)}if(r){b.kP();
b.kQ()}}st.no();
hi=F;
ig(aZ);
ih(T)}}break;
case aT:if(eF){eF.ep.ic(eF);
eF=am}else{if(et){et.ep.fH(et);
et=am}if(oe){oe.ep.fG(oe);
oe=am}if(lh){lh.f3.kY(lh);
lh=am}if(lf){lf.f3.kX(lf);
lf=am}}st.no();
break;
case aN:if(et){j=et.ep;
if(j&&!et.bS(j.er)){fn(j.er);
j.er=et;
fn(et);
st.no()}else{st.ne()}}break}}}hi=F;
if(a==aU){if(oz){oA(y,y.pageX,y.pageY)}else{nz()}}ot()}}$(D.activeElement).focus()}function oB(g,i){var a={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"},d=g.originalEvent,f=d.changedTouches,b=a[d.type],h,c;
if(b){if(i||bp(f)==1){h=f[0];
c=D.createEvent("MouseEvent");
c.initMouseEvent(b,true,true,W,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);
h.target.dispatchEvent(c);
d.preventDefault();
if(b=="mouseup"&&!om){c=D.createEvent("MouseEvent");
c.initMouseEvent("click",true,true,W,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);
h.target.dispatchEvent(c)}return T}return F}}function oC(a){if(a){a.remove();
a.clear()}}function ig(a){if(!a){return}oC(a.jK);
if(!eF){oC(a.oD)}if(!et){oC(a.fR)}}function ih(e){var d=st.dB(),a=d.l2(ow),c=d.l4(ow),b;
if(et&&(e||!et.bS(a))){et.hF();
fn(et);
m0("outAtom",et)}if(eF&&(e||!eF.bS(c))){eF.hF()}if(!a){et=am;
b=d.l3(ow);
if(oe&&(e||!oe.bS(b))){m0("outBond",oe)}if(b&&(e||!b.bS(oe))){m0("overBond",b)}oe=b;
if(b){fn(b)}}else{if(e||!a.bS(et)){et=a;
if(oe){fn(oe);
m0("outBond",oe);
oe=am}et.hE();
fn(et);
m0("overAtom",et)}}if(!c){setTimeout(function(){fn(eF);
eF=am},400)}else{if(e||(!c.bS(eF)&&(!eF||!eF.eM))){eF=c;
eF.hE();
fn(eF)}}}function m0(a,b){$(W).trigger(a,{obj:b})}function og(b){nD=b.ctrlKey;
var a=b.clientX,c=b.clientY;
if(hj){a6.css({left:a-4,top:c-4})
}a7.css({left:a+30,top:c+30});
ow=n9(b);
ig(aZ);
if(!et){gz.ga()}ih()}function oE(b,a,c){if(eg){oF(b,a,c)}else{clearTimeout(oG);
oG=setTimeout(function(){oF(b,a,c)},250)}}function oF(h,p,n){og(h);
a0.css("cursor","");
var o,c,j,l,b,q,t,m,d,a,r,g,f,k=(st.he?aY:hg);
if(hi){o=ow;
c=oa[0];
j=st.dB();
if(nt){n_(o)}if(!om){om=(o.cT(c)>oH);
if(om){switch(k){case aO:case aP:if((oh&&oh.dH)||(oi&&oi.dH)||(ok&&ok.dH)||(ol&&ol.dH)){l=st.gE()}else{l=new gw(T);
if(oh){l.fX(oh)}else{if(oi){l.f1(oi)}else{if(oj){l.h0(oj);
eF=am;
ig(aZ)}else{if(ok){l.fU(ok)}else{if(ol){l.kE(ol)}}}}}}if(!l.gb()){st.m5(l)}break}}}if(l=st.hf()){switch(k){case aQ:case aS:if(om){b=bG(l.m8);
q=M.atan2(o.y-c.y,o.x-c.x);
if(k==aS){r=l.hH[0];
t=(r.c8.dH?r.c8:r.c_);
m=(r.c8.dH?r.c_:r.c8);
l.e8(q-b,t.c9.cc(),m.c9)}else{l.eU(q-b,c)}l.m8=q;
l.fc();
aZ.jK.push(aZ.path("M"+c+"L"+o).attr(aB,"#f00").attr(aD,de),aZ.text(o.x,o.y+30/eG,round(q*ah,1)+"°").attr(aA,2+20/eG))}break;
case aR:if(om){b=(l.m7||c);
l.m7=o;
q=(h.altKey?0.01:0.1);
l.eV(q*(b.y-o.y),q*(o.x-b.x),l.d5())}break;
default:oI(c,o,j,aZ)}}else{switch(k){case aY:case aO:oJ(aZ,c,o);
break;
case aP:aZ.jK.push(aZ.path(ob+"Z").attr(oK));
break;
case aM:if((!oh||!oh.eu)&&(!et||(!et.eu&&!et.bS(oh)))){jG(h,c,o,am,oh,et)}break;
case aK:case aL:if(om&&!oi&&(!oh||!oh.eu)&&(!et||(!et.eu&&!et.bS(oh)))){gz.ga();
t=oh;
m=et;
d=[];
if(t&&(r=t.hv(m))){r=gz.f1(r);
r.iY()}else{a=hh();
if(!t){t=gz.fX(new gx(c.cc()));
d.push(t)}if(!m){m=gz.fX(new gx(gy(t,hk,o,h)));
d.push(m)}gz.f1(new gA(t,m,hk,hl));
for(g=0,f=bp(d);
g<f;
g++){d[g].gG(a)}}gz.fc()}break;
case aX:if(om){gz.f_(c,o);
gz.fc()}break;
case aT:if(et){et.ep.fH(et);
et=am}if(oe){oe.ep.fG(oe);
oe=am}break}}}else{if(oe){switch(k){case aK:a0.css("cursor","move");
break;
case aL:fn(oe);
var r=gz.f1(oe);
r.iY();
gz.fc();
break}}}switch(k){case aO:case aP:if(et||oe){a0.css("cursor","move")}break}ot()}function oJ(d,c,e){var b=M.min(c.x,e.x),a=M.min(c.y,e.y);
d.jK.push(d.rect(b,a,M.abs(e.x-c.x),M.abs(e.y-c.y)).attr(oK))}function oI(b,j,g,c){var h=st.hf(),m,l,d,a,n,k,f,e;
if(!h||st.he){return}m=(h.m7||b);
l=j.cz(m);
h.cu(l.x,l.y);
h.m7=j;
if(g){d=h.mS(g,1.5*ox);
for(f=0,e=bp(d);
f<e;
f++){a=d[f];
n=a.lr.c9;
k=a.lq.c9;
c.jK.push(c.ellipse(n.x,n.y,ox,ox).attr(oL).attr(aH,a.cT<ox?oM:oN));
c.jK.push(c.ellipse(k.x,k.y,ox,ox).attr(oL).attr(aH,a.cT<ox?oM:oN))}}}function oO(c,d,b){var a="templates/"+b+".mol";

jQuery.get(a,{},function(e){d.push(new oP(a,e,c));
oO(c,d,b+1)},"text")}function oQ(){var a=$("#builtinTemplates").remove(".template");
if(!bK("noTemplates")){oO(a[0],oR.server,0)}}function addTemplate(b,e){var d,a,c=$(e?"#tmpl"+e:"#serverTemplates"),f=oR.server;
if(!c.length){$("<tr>").append($("<td>").addClass("menuWithPopup").mouseleave(nK).click(nK).append(c=$("<div id="+bE("tmpl"+e)+' class="menuPopup templatesMenu">'+getImgSt("del")+' class="button" style="float:right" onClick="hideMenu();"/></div>').css({opacity:0.85}).mouseleave({obj:this},oS).click(nI)).append($(getImgSt(e)+' class="button"/>').mouseenter(nJ).click(nG))).insertBefore("#groupSelection")}if($.isArray(b)){for(d=0,a=bp(b);
d<a;
d++){f.push(oT(b[d],c))}}else{f.push(d=oT(b,c));
return d}}function oT(a,b){try{a=pako.ungzip(atob(a),{to:"string"})}catch(c){}return new oP(am,a,b)}function gH(b){if(!b){return}b=b.charAt(0).toUpperCase()+b.substr(1);
for(var d,c=0,a=bp(oR.server);
c<a;
c++){d=oR.server[c];
if(d.er&&$.inArray(b,d.oU)!=-1){return d}}}function oV(){if(this.url){jQuery.get(this.url,{},function(a){this.oW(a);
this.fc()},"text")}}function oX(){var a=this,f=a.f3,c,b,e,g,j=ks,h=ks,d=a.oY.parent(".templatesMenu");
for(c=0,b=bp(f.f7);
c<b;
c++){e=f.f7[c];
if(!a.er){a.er=e.er}if(!a.tooltip){a.tooltip=e.a4}if(!$.isArray(a.oU)){a.oU=e.a3}}g=bH(a.tooltip);
if(a.oU&&bp(a.oU)){g+=" ("+a.oU.join(",")+")"}a.oY.attr("title",g);
f.d2();
j+=M.max(oZ-f.db.x+f.dd.x,0);
h+=M.max(oZ-f.db.y+f.dd.y,0);
a.dj.setViewBox(f.dd.x-j,f.dd.y-h,f.db.x-f.dd.x+2*j,f.db.y-f.dd.y+2*h);
d.show();
f.fc();
d.hide()}function oy(c){for(var b=0,a=bp(c);
b<a;
b++){fn(c[b].er);
c[b].er=am}}function o0(b,a,c){oz=F;
o1=b.data.obj;
oA(b,a,c);
oS();
setTimeout(nK,700)}function o2(b,a,c){oz=T}function oA(b,a,c){o3();
oE(b,a,c)}function o3(){activateTool(am,aU);
o4(o1.f3.cc(),o1.er)}function o4(c,b){st.nm();
var e=c.f7,g=st.dB(),d,a,f=new gw(T);
c.mc(aZ);
for(d=0,a=bp(e);
d<a;
d++){g.fL(e[d],F,T);
f.fL(e[d])}hi=T;
oa[0]=(b?b.c9:f.d5());
st.m5(f)}function o5(c){var b=c.data.obj,a=$(b.oY[0].firstChild).clone().attr("width",o6).attr("height",o6);
$("#overlay").empty().append(a).show().mouseenter(function(){$(".templatesMenu").hide()})}function oS(){var a=$("#overlay");
if(bi){a.hide()}else{a.fadeOut()}}function gI(){var a=new cd();
this.f3.cc(a);
return a.cb(this.er)}function o7(a){var b=this;
b.f3=new fK(b.dj,a);
b.f3.fP=am}function oP(b,a,c){var f=this,e,d=(hj?33:50);
f.url=b;
f.oY=$("<div>").css({display:"inline-block"}).addClass("button template").appendTo(c).click({obj:f},o0).dblclick({obj:f},o2).mouseenter({obj:f},o5);
f.dj=new Raphael(f.oY[0],o8,o9);
bP.apply(f.dj);
nf(f.dj);
f.oW=o7;
f.oW(a);
if(e=f.f3.f7[0]){e=bH(e.a4).substr(0,12);
f.oY.append($("<div>").css({position:"absolute",top:0,height:"100%",padding:"25% 3px","background-color":"white",opacity:0.3,"font-size":(bp(e)>6?d:d*2)+"%"}).text(e))
}f.gI=gI;
f.reload=oV;
f.fc=oX;
f.fc()}var isReady=F,lang=bF(bK("lang"),"en"),bN=["en","de"],langDef={},o_=(typeof nw!="undefined"),pa=!!bK("embedded"),eg=Raphael.svg,hj=(nP()=="mobile"),iconSize=(hj?35:20),nL=bi,n8=new cj(),eG,pb=1000,pc=0.001,pd=0.25,ij=16,n7,st,mm,gz,hg,hk=1,hl=0,eq=bF(bK("mode"),"mol"),ez=!!bK("debug"),n5=F,nD,ow,nH,et,eF,oe,lf,lh,hi=F,nT=F,nU=0,n3,oG,os,oq=0,or=0,om,nt=F,oa=[],ob="",oc={},oh,oj,oi,ol,ok,pe=4,oH=3,nv,o1,oz=F;
bM();
var nj=30,jt=12,jI=30,o8=50,o9=50,eC=10,dc=eC*1.4,dl=2,dg=1.5,df=0.06,di=0.01,ec=1.5*eC,dG=7,lm=55,dO=7,dP=0.2,h4=0.5,ox=0.25*eC,pf=0.1,eB=0.38,de=(eg?0.333333333:1),dK=1,ey=0.02*eC,ex=6,ia=eC*0.5,kb=eC*0.25,lQ=2,jH=30,o6,eH="#000",dJ=eH,dk=(ez?"gray":"#fff"),es="#f00",dI="#0f0",dT="#666",ew="#00f",ev="#f00",oM="#0f0",oN="#f00",oL={"stroke-width":0,"fill-opacity":0.4},oK={stroke:dI,fill:dI,"fill-opacity":0.2},eK={stroke:"deepskyblue",fill:"deepskyblue","fill-opacity":0.2,"stroke-width":de},oR={server:[]},ks=0.45*eC,oZ=3.5*ks,pg=dc/720,ph=0.2,kp=0.3,ko=0.6*dc,pi=0.3*dc,pj=400,pk=80,pl=0.6,pm=0.1;
function hh(){var a=a2.val();
if(!a){a=C}return a}function ny(a){a2.val(a)}function n0(){var a=1/eG;
if(aZ){aZ.setViewBox(n8.x-0.5*a*n7.x,n8.y-0.5*a*n7.y,n7.x*a,n7.y*a)}if(!eg){st.dB().fc()}}function pn(a){n8=a;
n0()}function po(a){if(!a){return pe}return M.max(M.min(a,pb),pc)}function ov(f){var c=st.dB(),b,e,a,d;
if(bp(c.getAtoms())>0){c.d2();
b=c.dd.x-ec;
e=c.dd.y-ec;
a=c.db.x+ec;
d=c.db.y+ec;
eG=po(M.min(n7.x/(a-b),n7.y/(d-e)));
if(f&&eG>f){eG=f}}else{eG=pe}pn(new cj(0.5*(b+a),0.5*(e+d)))}function zoomBox(a,b){eG=M.min(pb,n7.x/M.abs(b.x-a.x),n7.y/M.abs(b.y-a.y));
pn(cA(a,b))}function zoomIn(a){nZ();
if(a){pn(a)}else{n0()}if(!st.he){nz()}}function nZ(){if(eG<pb){eG/=1-pd}}function zoomOut(){if(hg==aY){nz()}n1();
n0()}function n1(){if(eG>pc){eG*=1-pd}}function nY(b,a,f){var e=b*eC/eG,d=a*eC/eG,c=st.gE();
if(st.he||c.gb()){n8.x+=e;
n8.y+=d;
if(f&&!st.he){hY();
st.dB().cu(0,0,f);
h1()}n0()}else{hY();
c.cu(e,d,f);
h1()}ih()}function eI(a){if(!hi){return bo(a)
}}function iB(){}function pp(){if(!a0){a0=$("#svgParent")}if(aZ){aZ.canvas.style.display="none"}n7=new cj(a0.width(),a0.height());
if(aZ){aZ.canvas.style.display="";
aZ.setSize((eg?"100%":n7.x),n7.y)}else{aZ=new Raphael("svgParent",(eg?"100%":n7.x),n7.y);
bP.apply(aZ);
aZ.pq=T;
st=new np();
nf(aZ);
gz=new f8();
aZ.canvas.onselectstart=bo;
a0.mousedown(of).mousemove(oE).mouseup(ou).mousewheel(oo).mouseover(nN).mouseout(nO).bind("touchstart",oB).bind("touchmove",oB).bind("touchend",oB)}n0()}function clearSelection(){hY();
st.gE().jJ();
h1()}function nx(){hY();
st.gE().ms();
h1()}function cut(a){hY();
st.gE().cut(a);
h1()}function copy(a){st.gE().copy(a)}function getSelectionAsMolfile(){return mn(st.gE().cc().mV())}function getNonselectionAsMolfile(){return mn(st.gE().mk().cc().mV())}function pr(e,d){var c,a;
if(d){var b=e.getData(d),c=new fK(aZ,b);
if(bp(c.getAtoms())){if(c.kF==0||c.kF==bp(c.f7)){c.kY()}else{if(st.dB().fP){c.kY(T)}}d=c.kG;
d.mu=T;
d.bZ(c);
return d}}else{for(a=0,d=bp(bc);
a<d;
a++){c=pr(e,bc[a]);
if(c){return c}}nF(e.files,aV,T)}}function pasteMolFile(a){o4(new fK(aZ,a))}function paste(b){var c=(b?(b.originalEvent||b):W).clipboardData,a;
activateTool(am,aV);
st.nm();
if(c){a=pr(c)}if(!a&&mm){a=mm.cc(am,T)}if(a){st.dB().l_(a);
hi=T;
oa[0]=a.d5();
st.m5(a);
ih();
return bo(b)}else{st.ne()}}function flip(a){hY();
var b=st.gE();
if(b.gb()){b.bZ();
b.eZ(a,n8);
b.jJ()}else{b.eZ(a)}h1()}function doUngroup(){var a=st.gE();
if(eF){hY();
eF.ik();
h1()}else{if(!a.gb()){hY();
a.ungroupGroups();
h1()}}}function clearReaction(){l7("")}function nf(a){a.clear();
a.jK=a.set();
a.oD=a.set();
a.fR=a.set();
a.fo=[]}function saveContent(b,a){var c=D.createElement("a");
c.download=a;
c.href="data:,"+encodeURIComponent(b);
c.click()}function saveFile(a){saveContent(l6(),eq=="rxn"?(a||"reaction")+".rxn":(a||"molecule")+".mol")}function getSVG(b,d){if(aZ&&aZ.canvas){var e=st.dB(),c,a;
e.d2();
c=e.db.x-e.dd.x+2*ec;
a=e.db.y-e.dd.y+2*ec;
aZ.setSize(c,a);
aZ.setViewBox(e.dd.x-ec,e.dd.y-ec,c,a);
$(aZ.canvas).prepend($("<title>").text(b)).children("desc").text(d);
c=aZ.canvas.outerHTML;
pp();
return c}}function saveSVG(a){var b=getSVG();
if(b){saveContent(b,(a||"structure")+".svg")}}function ot(){fq(aZ)}function l6(){st.ne();
return st.dB().l6()}function l7(b){if(!aZ){pp()}nf(aZ);
var a=new fK(aZ,b);
st.nl(a);
if(eg){a.fc()}h1();
ov(3)}function getReadOnly(){return st.he}function setReadOnly(b){if(st.he!=b){st.he=b;
var a=$("#leftCol");
if(b){a.attr("data-width",a.attr("width"));
a.attr("width",1);
$(".toolbar").hide();
gz.ga();
st.ne();

nr();
ig(aZ);
ot();
nu()}else{a.attr("width",a.attr("data-width"));
$(".toolbar").show();
a8=T}}}function getDisplayAtomNumbers(){return st.dn}function setDisplayAtomNumbers(a){if(st.dn!=a){st.dn=a;
st.dB().fc()}}function highlightAtom(d,b,a){if(a==am){a=T}var c=st.dB().f7[bG(b)];
if(c){if(!Array.isArray(d)){d=[d]}$.each(d,function(e,g){var f=c.d4[g];
if(f){f.dp=a;
f.fc()}})}}function unhighlightAtoms(b){var a=st.dB(),e,d,c;
if(b!=am){e=a.f7[bG(b)];
for(c=bp(e.d4)-1;
c>=0;
c--){d=e.d4[c];
if(d.dp){d.dp=F;
d.fc()}}}else{for(c=bp(a.f7)-1;
c>=0;
c--){unhighlightAtoms(c)}}}function highlightBond(c,b,a){if(a==am){a=T}var d=st.dB().f7[bG(b)],e;
if(d){e=d.du[c];
if(e){e.dp=a;
e.fc()}}}function unhighlightBonds(b){var a=st.dB(),d,e,c;
if(b!=am){d=a.f7[bG(b)];
for(c=bp(d.du)-1;
c>=0;
c--){e=d.du[c];
if(e.dp){e.dp=F;
e.fc()}}}else{for(c=bp(a.f7)-1;
c>=0;
c--){unhighlightBonds(c)}}}function unhighlightAll(a){unhighlightAtoms(a);
unhighlightBonds(a)}function showURL(a){var c=$("#infoArea"),b=(hj?1.8:1);
if(!a){c.hide();
pp()}else{if(a.indexOf("/")<0&&(c.firstChild||(n7.x>600*b&&n7.y>400*b)||!open(a))){c.show().height("50%");
$("#infoContent").html("<iframe src="+bE(a)+' width="99%" height="'+(bi?0.5*n7.y:"95%")+'"/>');
pp()}}}function getMode(){return eq}function getParams(){return"?lang="+lang+"&mode="+eq+"&embedded="+(pa||"")}function mY(b,a){bi?(a?b.show():b.hide()):(a?b.slideDown():b.slideUp())}function getImgSt(a){return'<img src="icons/'+a+(eg?'.svg" width="'+iconSize+'" height="'+iconSize+'"':'.png"')}$(D).ready(function(){a1=$("html");
a2=$("#newAtomSym");
a3=$("#templateShortcuts");
a4=$("#templateName");
a5=$(".templatesMenu").css({opacity:0.85}).mouseleave({obj:this},oS);
a7=$("#editIcon");
$("#fileUpload").change(nE);
a1.bind("paste",paste).bind("drop",nE).bind("dragover",nC).bind("dragend",bo).keydown(nS).keyup(n4);
$("#info").bind("contextmenu",stopPropagation);
if(o_){a1.bind("contextmenu",bo)}if(!ez){$("body").bind("contextmenu",bo)}a1.onscroll=bo;
if(hj){a1.bind("input",nR)}W.onresize=pp;
var a=M.min(a1.width(),a1.height()),b;
for(b in gc){if(!gc[b]["iso"]){gk[gc[b]["an"]]=b}}eG=po(0.01*a);
o6=M.min(600,a)+aq;
pp();
b=a0.offset();
$("#overlay").css({left:b.left+aq,top:b.top+aq});
if(eq=="rxn"){$(".modeRxn").show()}else{if(eq=="tmpl"){$(".modeTmpl").show()}else{$(".modeMol").show()}}if(!bi&&!pa){$(".modeFile").show()}if(pa){$("#copyright").hide();
$("#info").css("font-size","7pt")}if(bK("readonly")){setReadOnly(T)}else{$(ay+" > img").mouseenter(nJ).click(nG);
$(ay).mouseleave(nK).click(nK);
$(ax).click(nI);
$(".tool").click(nM);
$("td.separator + td").addClass("afterSeparator");
setTimeout(function(){oQ()},50);
bO();
nA(".defaultTool");
if(!bK("nofocus")){a2.focus().blur()}}$.rule(ax).css("left",(iconSize+6)+"px");
if(hj){a6=$("#touchCursor").show();
$.rule("input,.button").css("font-size","20pt");
a2.click(function(){this.select()})}isReady=T});
function cleanStructure(d){st.ne();
var e,c=st.gE(),f=[],b,a;
hY();
if(c.gb()){f.push(st.dB())}else{f=c.mP()}for(b=0,a=bp(f);

b<a;
b++){e=f[b];
e.jC(d);
e.fc()}h1();
ov(3);
if(o1&&hg==aU){o3()}}function mb(e){var g=this,f=g.f7,b,d,a,c=0,h;
g.kY(F);
for(d=bp(g.kD)-1;
d>=0;
d--){g.kX(g.kD[d],T)}for(d=bp(f)-1;
d>=0;
d--){b=f[d];
if(!bp(b.d4)){b4(b,g.f7);
if(d<g.kF){g.kF--}}}h=g.kF;
for(d=0,a=bp(f);
d<a;
d++){b=f[d];
b.jC(e);
if(d==h){g.lC(c,am,T);
c+=lm+ec}else{if(d>0){g.kV(c,0,T);
c+=dG+ec}}b.d2();
b.jT(c);
c+=(b.db.x-b.dd.x)+ec}if(d==h){g.lC(c)}g.kF=h;
ov(3);
nr()}function kB(d){if(!this.jO){this.iK()}for(var e=this,c=e.ky(),b=0,a=bp(e.jO);
b<a;
b++){e.jO[b].jC(d,c)}}function jD(c,b){var d=this,a=d.d5().cc();
new ps(d,c,b);
d.cu(a.cz(d.d5()))}function pt(){var e=this,c=e.io,g,h,f=e.pu(),l=e.pv(),b=e.pw(),j,d,a,i=pl,k=c.jE();
while((e.px=f+l+b)>pm){if(g==1||(!g&&b>f)){e.py(i);
h=1}else{e.pz(i);
h=2}j=e.pu();
d=e.pv();
a=e.pw();
if(j+d+a<e.px){f=j;
l=d;
b=a;
k=c.jE();
i*=0.98}else{c.jF(k);
if(M.abs(i)<0.05){break}if(g){i*=0.5;
g=0}else{i*=-0.8;
if(h==1){g=2}else{g=1}}}}}function pA(){var d=this,b=!d.pB,c=d.io,l,g,f,k,e,a,n,m,h,o=0;
d.pC=[];
for(l=0,g=bp(c.d4);
l<g;
l++){k=c.d4[l];
for(f=0;
f<l;
f++){e=c.d4[f];
a=k.c9.cT(e.c9,b);
if((n=ko*(b?1:2)-a)>0){m=kp*n*n;
d.pC.push(new pD(k,e,a,n,m));
o+=m}}if(b){o+=M.abs(k.c9.z)}}for(l=0,g=bp(c.du);
l<g;
l++){k=c.du[l];
h=dc;
if(k.dv==0){h*=1.3}a=k.c8.c9.cT(k.c_.c9,b);
if(a!=h){d.pC.push(k)}k.pE=h;
k.bp=a;
n=M.abs(h-a);
m=(a>pi?n:n*pj);
k.pF=m;
o+=m}return o}function pG(){var r=this,f=!r.pB,k=r.io,n,l,m,p,b,c,u,t,a,v,e,h,g,q,o=0;
for(n=0,l=bp(k.du);
n<l;
n++){c=k.du[n];
u=c.c8;
t=c.c_;
a=t.c9.cz(u.c9,f);
if(!a.x&&!a.y&&!a.z){o+=pk;
continue}e=a.cB();
g=am;
for(m=0,p=bp(k.d4);
m<p;
m++){b=k.d4[m];
if(!b.bS(u)&&!b.bS(t)){v=b.c9.cz(u.c9,f);
if((q=pi-e.cq(v).bp())>0){if((h=a.cn(v))>=0&&h<=(g||(g=a.cn(a)))){o+=pk*q*q}}}}}return o}function pH(){var e=this,b,a,d,f,c=0;
for(b=0,a=bp(e.pI);
b<a;
b++){d=e.pI[b];
d.pJ();
f=pg*(ph*d.cT*d.cT+M.abs(d.cT));
d.pF=f;
c+=f}return c}function pK(){for(var f=this,d=0,c,a,e=[],b;
d<3;
d++){f.pL[d].pJ()}f.cT=0;
if(a=f.pM){for(d=0;
d<3;
d++){e[d]=[];
for(c=0;
c<3;
c++){e[d][c]=(f.pL[d].pN?M.abs(a[c]-f.pL[d].pM):0)}}b=pO(e);
for(d=0;
d<3;
d++){for(c=0;
c<3;
c++){if(f.pL[d].pN){if(c!=b[d]){e[d][c]=ar}}else{e[d][c]=M.abs(a[c]-f.pL[d].pM)}}}b=pO(e);
for(d=0;
d<3;
d++){f.cT+=(f.pL[d].pM=e[d][b[d]])}}}function pO(e){for(var g=0,b=bp(e),j=[],h=[],f,a,l,d;
g<b;
g++){h[g]=0;
j[g]=g}d=pP(e,j);
l=j.slice();
g=1;
while(d>0&&g<b){if(h[g]<g){f=g%2&&h[g];
a=j[g];
j[g]=j[f];
j[f]=a;
++h[g];
g=1;
if(pP(e,j)<d){l=j.slice()}}else{h[g]=0;
++g}}return l}function pP(e,d){for(var b=0,c=0,a=bp(d);
b<a;
b++){c+=e[b][d[b]]}return c}function pQ(){var d=this,b=d.pR,c=d.pS,a=d.gM;
d.pT=(d.pU.pB?ka(a,c,b):eA(a,c,b));
d.cT=d.pT-d.pM}function pV(){var c=this,b=c.gM,a=bp(b.du);
if(a>3||a==b.gV()){if(a<5){c.pM=[aj,aj,aj]}else{if(a==5){c.pM=[ad,ad,ae]}else{if(a==6){c.pM=[ad,ad,ad]}else{if(a==7){c.pM=[72,ad,ad]
}else{if(a==8){c.pM=[0.5*aj,ad,ad]}}}}}}else{c.pM=[ae,ae,ae]}}function pW(b){var h=this,a=h.pU,f=h.gM,d=bp(f.du),e=f.gV(),c=f.ds,g;
if(e==4&&d==2){h.pM=af}else{if((a.pB?d==e:d==4)&&(c=="P"||c=="S")){h.pM=ad}else{if(a.pB&&(c=="P"||c=="S"||d==e)){h.pM=aj}else{if(d==6||(d>3&&h.pT<90)){h.pM=60}else{if((g=a.pX)&&bp(g)&&d==3&&(c=="N"||c=="P")){h.pM=(b?210:(a.pB?90:75))}else{if(d==2&&h.pT>af){h.pM=240}else{h.pM=ae}}}}}}}function pY(d,c){if(d.pF==c.pF){return 0}if(d.pF==undefined||d.pF<c.pF){return 1}return -1}function pZ(l){var n=this.pC,k=this.pB,j,g,h,f,e,a,c,b,r,q,p=0,d,o,m;
if(g=bp(n)){l=M.abs(l);
n.sort(pY);
for(j=0;
j<g;
j++){h=n[j];
if(h.pF<0.1){break}if(j/g<M.random()){a=h.bp;
c=h.c8;
b=h.c_;
r=l*(b.c9.x-c.c9.x)*(h.pE-a)/a;
q=l*(b.c9.y-c.c9.y)*(h.pE-a)/a;
if(k){p=l*(b.c9.z-c.c9.z)*(h.pE-a)/a}o=bp(c.du);
m=bp(b.du);
d=o+m;
o/=d;
m/=d;
if(!(h instanceof gA)||bp(h.d3())==0){f=c.hr(b);
f.fG(h);
e=b.hr(c);
e.fG(h)}else{f=c.c9;
e=b.c9}f.cu(-r*m,-q*m,-p*m);
e.cu(r*o,q*o,p*o)}}if(!k){l=0.9-l;
for(n=this.io.fs(),j=g-1;
j>=0;
j--){n[j].z*=l}}this.io.cB()}}function p0(b,a){return(M.abs(b.cT)<31-M.abs(a)*50?0:(b.cT>0?-1:1))}function p1(w){var A=this.pI,x=this.p2,G,z,E,L,B,r,a,b,l,K,g=[],I,v,e,o,n,h,f,m=[],q=(w>0?1:0),t,J,u,N,d,p,y,O,c;
x.sort(pY);
for(G=0,z=bp(x);
G<z;
G++){f=F;
r=x[G];
b=r.gM;
a=b.c9;
u=d=p=0;
N=a.e0(r.p3[0].c9,r.p3[1].c9,r.p3[2].c9);
for(E=0;
E<3;
E++){l=r.du[E];
N/=l.c8.c9.cT(l.c_.c9)+Number.p4}if(t=(M.abs(N)<0.0001)){e=0;
for(E=0;
E<3;
E++){O=r.pL[E].pT;
e+=O;
if(O>u){u=r.pL[E].pT;
N=E}}e=(e<358);
u=p0(r.pL[N],w)}for(E=0;
E<3;
E++){d+=(K=p0(r.pL[E],w));
if(K==0){p++;
if(!t){N=E}}}if(p<3){y=[];
for(E=0;
E<3;
E++){l=r.du[E];
if(bp(l.d3())){O=new gw(T);
O.f1(l);
O.fX(l.gR(b));
f=T}else{O=l.hr(b)}y.push(O)}if(t){c=r.pL[N];
if(M.abs(d)>1&&e){o=a.eW(c.pS.c9,c.pR.c9);
n=a.cM(o);
l=0;
for(E=0;
E<3;
E++){l+=(E==N?1:-1)*r.pL[E].cT;
g[E]=0}for(E=0;
E<3;
E++){if(E!=N){J=r.pL[E].cT+0.3*l;
for(B=0;
B<3;
B++){if(E!=B){g[B]+=(a.e0(r.du[B].gR(b).c9,r.du[E].gR(b).c9,n)>0?1:-1)*J}}}}for(E=0;
E<3;
E++){y[E].cC(g[E]*ag,o,a)}}if(d<0||(e&&u<d-u)||(r.pL[N].pT>175&&r.pL[N].cT>0)){J=0;
for(B=0;
B<3;
B++){if(!e||N!=B){J-=r.pL[B].cT}}c=a.eW(c.pS.c9,c.pR.c9,r.p3[N].c9);
for(B=0;
B<3;
B++){y[B].cC(bJ((B==N?0.5:-0.25)*J*w,-30,30)*ag,c,a)}}}if(M.abs(d)>(t?2:1)){J=0;
c=a.e1(r.p3[0].c9,r.p3[1].c9,r.p3[2].c9);
for(E=0;
E<3;
E++){for(B=0;
B<3;
B++){if(E!=B){J-=r.pL[B].cT}}y[E].cC(bJ(J*M.abs(w),-30,30)*ag,c[E],a)}}else{if(p==1&&(!t||u==0)){for(B=0;
B<3;
B++){if(N!=B){if((h=r.pL[B].cT)>0){o=B}else{n=B}J+=M.abs(h)}}if(o+n){c=a.eW(r.p3[n].c9,r.p3[o].c9);
y[N].cC(bJ(0.5*J*M.abs(w),-30,30)*ag,c,a)}}}}if(f){for(B=0;
B<3;
B++){c=this.p5[r.p3[B].bQ];
for(E=0,L=bp(c);
E<L;
E++){c[E].pJ()}}}else{for(B=0;
B<3;
B++){r.pL[B].pJ()}}}if(bp(A)){A.sort(pY);
w=M.abs(w);
m=[];
for(G=0,z=bp(A);
G<z;
G++){r=A[G];
if(r.pF<1){break}if(G/z<M.random()&&(G+q)%2){b=r.gM;
a=b.c9;
o=r.pS;
n=r.pR;
h=bp(o.du);
f=bp(n.du);
e=h+f;
c=a.eW(n.c9,o.c9);
if(L=bp(r.p6)){for(E=0;
E<L;
E++){I=r.p6[E];

v=I.hr(b);
v.cC(w/pl/L*r.cT*ag*(I.i1(n)?1:-1),c,a)}}else{if(!bX(m,b)&&!bX(m,o)&&!bX(m,n)){m.push(b,o,n);
o.c9.cC(r.cT*w*f/e*ag,c,a);
n.c9.cC(r.cT*-w*h/e*ag,c,a)}}}this.io.cB()}}}function p7(p){var o=this.pI,h,f,e,c,g,k,b,t,d,r,q,m,l,a=[],n=(p>0?1:0);
p=M.abs(p);
if(f=bp(o)){o.sort(pY);
for(h=0;
h<f;
h++){g=o[h];
if(g.pF<1){break}if(h/f<M.random()&&(h+n)%2){k=g.gM.c9;
m=g.pS;
l=g.pR;
r=bp(m.du);
q=bp(l.du);
d=r+q;
if(c=bp(g.p6)){for(e=0;
e<c;
e++){b=g.p6[e];
t=b.hr(g.gM);
t.eU(p/pl/c*g.cT*ag*(b.bS(g.du[0])?1:-1),k)}}else{if(!bX(a,g.gM)&&!bX(a,m)&&!bX(a,l)){a.push(g.gM,m,l);
m.c9.eU(g.cT*p*q/d*ag,k);
l.c9.eU(g.cT*-p*r/d*ag,k)}}}}this.io.cB()}}function pD(b,a,c,e,d){this.c8=b;
this.c_=a;
this.pE=ko;
this.bp=c;
this.cT=e;
this.pF=d}function p8(a,d,c,b){var e=this;
bP.apply(e);
e.pU=a;
e.gM=d;
e.pS=c;
e.pR=b;
e.du=[d.hv(c),d.hv(b)];
e.p9=p_;
e.pJ=pQ;
e.qa=pW;
e.pJ()}function qb(a,e,d,c,b){var f=this;
bP.apply(f);
f.gM=e;
f.p3=[d,c,b];
f.du=[e.hv(d),e.hv(c),e.hv(b)];
f.pL=[a.qc(e,c,b),a.qc(e,d,b),a.qc(e,d,c)];
f.p9=qd;
f.pJ=pK;
f.qa=pV}function qe(g,f,d){for(var h=this,c=h.p5[g.bQ],b,e=0,a=bp(c);
e<a;
e++){b=c[e];
if((f.bS(b.pS)&&d.bS(b.pR))||(f.bS(b.pR)&&d.bS(b.pS))){break}}if(e==a){b=new p8(h,g,f,d)}return b}function qf(h,b,a,j){var e=this,c=e.qg[h.bQ],g,f,d;
if(c){for(g=0,f=bp(c);
g<f;
g++){d=c[g];
if(bX(d.p3,b)&&bX(d.p3,a)&&bX(d.p3,j)){break}}}else{c=[];
e.qg[h.bQ]=c}if(g==f){d=new qb(e,h,b,a,j);
c.push(d);
e.p2.push(d);
d.p9()}return d}function qd(){for(var a=0;
a<3;
a++){this.pL[a].p9()}this.qa()}function p_(k){var b=this,f=b.pU,g=b.du,e=bp(g)-1,d,c,h,j,a=(b.pT<af||bp(b.gM.du)>2);
if(!b.p6){if(a){b.p6=[];
for(;
e>=0;
e--){if(!bp(g[e].d3())){b.p6.push(g[e])}}f.p5[b.gM.bQ].push(b)}j=b7(f.ht,g[0].d3(),g[1].d3());
if(d=bp(j)){for(e=0;
e<d;
e++){c=j[e];
h=f.qh[c.bQ];
if(!h){h=[];
f.qh[c.bQ]=h}if(a){h.push(b)}if(!c.pM){k=bp(c.d4);
c.pM=(f.pB&&!c.jm()&&(k==8||(k==6&&c.jn()))?aj:qi(k))}}b.pM=(a?j[0].pM:ak-j[0].pM);
b.pN=T}else{b.qa(k)}}return !!d}function qi(a){return af-ak/a}function qj(d,c){if(d.pT<c.pT){return 1}if(d.pT>c.pT){return -1}return 0}function qk(){var p,l,h,b,g,f,d,e=this,c=e.io,t,u,r,q,o,a,w,v;
for(p=0,l=bp(c.d4);
p<l;
p++){t=c.d4[p];
u=t.du;
a=[];
e.p5[t.bQ]=[];
b=bp(u);
if(e.pB&&b>2){for(h=0;
h<b;
h++){r=u[h];
for(g=h+1;
g<b;
g++){q=u[g];
for(f=g+1;
f<b;
f++){o=u[f];
for(d=f+1;
d<b;
d++){if(u[d].i2().e3(r.i2(),q.i2(),o.i2())){d=-1;
break}}if(d>0){e.ql(t,r.gR(t),q.gR(t),o.gR(t))}}}}}else{if(b>1){for(h=0;
h<b;
h++){a.push(new gL(t,u[h].gR(t)))}a.sort(gN);
v=T;
for(h=0;
h<b;
h++){g=(h+1)%b;
w=e.qc(t,a[h].gM,a[g].gM);
if(!w.p9(v)){v=F}}}}b9(e.pI,e.p5[t.bQ])
}}function qm(){for(var d,a,g=this.io.d4,h,f,n,k,m,b,l,e=0,c=bp(g);
e<c;
e++){h=g[e];
n=this.p5[h.bQ];
if((a=bp(n))>2){m=0;
k=0;
if(!this.pB||a<4){b=ak}else{if(a<7){b=aj}else{if(a<11){b=96}else{if(a<16||a>21){b=ad}else{b=82.29}}}b*=a}for(d=0;
d<a;
d++){f=n[d];
if(f.pN){m+=f.pM}else{k+=f.pM}}k+=m;
if(this.pB?k>b:k!=b){if(m<b){l=(b-m)/(k-m);
for(d=0;
d<a;
d++){f=n[d];
if(!f.pN){f.pM*=l}}}else{l=b/k;
for(d=0;
d<a;
d++){f=n[d];
f.pM*=l}}}}}}function qn(){for(var d=this.io.du,c,b=0,a=bp(d);
b<a;
b++){c=d[b];
c.pE=am;
c.bp=am;
c.pF=am}d=this.ht;
a=bp(d);
for(b=0;
b<a;
b++){d[b].pM=am}}function qo(d){if(bp(d.d4)<10){var b=this,h=d.d4,k,f,a=d.pM,m=b.qh[d.bQ],g,e=bp(m),p,n=0,o=0,j,c,l;
for(g=0;
g<e;
g++){p=m[g];
if(M.abs(p.pM-a)<pf){n++}else{o+=a-p.pM}}if(o){j=o/n;
for(g=0;
g<e;
g++){p=m[g];
if(M.abs(p.pM-a)<pf){p.pM+=j}}}d.jk();
e=bp(h);
if(b.pB){d.jb();
if(a==aj){a=qi(e);
if(e==8){k=[[p=15,p,-p,-p,p,p,-p,-p,3]]}else{k=[[p=(aj-ad)*0.5,p,-p,p,p,-p,2],[p,-p,p,-p,p,-p,1]]}}if(k){f=ar;
while(j=k.pop()){o=j.pop();
for(;
o>=0;
o--){c=0;
for(g=0;
g<e;
g++){c+=M.abs(d.jl(h[g])-j[g])}if(c<f){f=c;
n=j.slice()}if(f==0){break}if(o>0){b5(j)}}}j=n}a=af-a;
k=h[0];
n=k.c9;
n.cu(d.i9.ci(-d.i9.cn(n.cz(d.fx))));
n.eT(0.5*dc/M.sin(0.5*a*ag)/n.cT(d.fx),d.fx);
for(g=1;
g<e;
g++){k=h[g];
k.c9=n.cc();
k.c9.cC(a*g*ag,d.i9,d.fx)}if(j){for(g=0;
g<e;
g++){k=h[g].c9;
k.cC(-j[g]*ag,d.i9.cq(k.cz(d.fx)).cB(),d.fx)}}}else{for(g=1;
g<e;
g++){k=h[g];
f=h[g-1];
if(g==1){c=eA(f,k);
k.c9=c2(f.c9,c,dc)}else{p=b7(m,b.p5[k.bQ]);
if(bp(p)==1){p=p[0];
if(!l){l=(h[2].c9.eQ(h[0].c9,h[1].c9)?1:-1)}c+=(af-p.pM)*l;
k.c9=c2(f.c9,c,dc)}}}}}}function qp(){for(var c=this,b=0,a=bp(c.ht);
b<a;
b++){c.qq(c.ht[b])}}function ps(a,j,e){var b=this,g=[],f,h,l,d,c,k=1;
b.io=a;
b.pB=j;
b.pI=[];
b.p2=[];
b.p5={};
b.qg={};
b.qh={};
b.pX=e;
b.qr=qk;
b.pu=pA;
b.pv=pG;
b.pw=pH;
b.pz=pZ;
b.py=(j?p1:p7);
b.qs=qp;
b.qq=qo;
b.qt=qm;
b.jC=pt;
b.qu=qn;
b.qc=qe;
b.ql=qf;
for(d=bp(a.ip)-1;
d>=0;
d--){c=a.ip[d];
if(c.type==av){f=c.hI.slice();
h=c.du.slice();
l=c.hH.slice();
c.ik(l,h);
g.push({ds:c.ds,d4:f,du:h,hH:l})}}b.ht=i3(a.d3());
b.qr();
do{b.qs();
b.qt();
b.jC();
k--}while(k>0&&b.px>pm);
b.qu();
for(d=bp(g)-1;
d>=0;
d--){c=g[d];
a.ep.hZ(c.ds,c.d4,c.du,c.hH)}a.fy(bg)}hideMenu=nK;
getMolRxnfile=l6;
setMolRxnfile=l7;
beforeChange=hY;
afterChange=h1;
centerView=pn;
zoomFit=ov;
redrawChanged=ot;
delSelection=nx;
Point3D=cj;
Molecule=fI;
Atom=gx;
Bond=gA;
Selection=gw;
