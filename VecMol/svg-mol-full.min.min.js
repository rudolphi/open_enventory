var ab="Sciformation VectorMol (c) 2012-2024 Felix Rudolphi",W=window,D=document,M=Math,ac=unescape,ad=90,ae=120,af=180,ag=M.PI/af,ah=1/ag,ai=2*M.atan(M.SQRT2),aj=ai*ah,ak=360,al=21600,T=true,F=false,am,S=" ",ao="\n",ap="  0",aq="px",ar=Number.MAX_VALUE,as="obj",C="C",H="H",at="\nM  ",au="SUP",av="MUL",aw="SRU",ax=".menuPopup",ay=".menuWithPopup",az=[0,2,1,3],aA="font-size",aB="stroke",aC="stroke-opacity",aD="stroke-width",aE="stroke-dasharray",aF="--",aG="text-anchor",aH="fill",aI="<sub>",aJ="</sub>",aK="atom",aL="draw",aM="drawChain",aN="drawHotspot",aO="selRect",aP="selLasso",aQ="rotate",aR="3d_rotate",aS="bond_rotate",aT="delete",aU="insertTemplate",aV="paste",aW="drawPlus",aX="drawArrow",aY="zoomIn",aZ,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9=0,a_=new RegExp("^(\\d*)([A-Z%*][a-z#]{0,2})(H\\d*)?\\s*(\\d*[\\+\\-]+)?\\s*$"),ba={8:0,4:1.5},bb={3:6,6:1,11:4},bc=["text/xml","chemical/x-mdl-molfile","text/plain","Text"],bd=0,be=1,bf=2,bg=3,bh=4,bi=!D.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),bj={Element:1,Unspecified:0},bk={Singlet:1,Doublet:2,Triplet:3},bl={Solid:0,Dash:1,WedgedHashBegin:3,WedgedHashEnd:4,WedgeBegin:6,WedgeEnd:7,WavyWedgeBegin:11,WavyWedgeEnd:12};
bm=parseInt;
bn=parseFloat;
function bo(a){if(bi){if(!a){a=W.event}a.returnValue=F;
a.cancelBubble=T}else{a.preventDefault();
a.stopPropagation()}return F}function stopPropagation(a){if(bi){if(!a){a=W.event}a.cancelBubble=T}else{a.stopPropagation()}}function bp(a){return a.length}function bq(){for(var c=0,b=0,a=bp(arguments);
b<a;
b++){c+=arguments[b]}return c/a}function br(b){var e=[],f=[],d,c,a;
for(d in b){f.push(d)}f.sort();
for(c=0,a=bp(f);
c<a;
c++){d=f[c];
e[d]=b[d];
delete b[d]}for(c=0;
c<a;
c++){d=f[c];
b[d]=e[d]}}function bs(a,c){for(var b in a){if(a[b]==c){return b}}}function bt(b){if(!b){return b}var a=/^[\s\n\r\t]*(.*?)[\s\n\r\t]*$/;
if(a.exec(b)){return RegExp.$1}}function bu(e,h,j){if(!$.isArray(h)){return e}var a=[],f=0,b,g,d,c;
if(e!=am){for(d=0,c=bp(h);
d<c;
d++){b=h[d];
g=e.substr(f,b);
if(!j){g=bt(g)}a.push(g);
f+=b}if(bp(e)>b){g=e.substr(f);
if(!j){g=bt(g)}a.push(g)}}return a}function bv(d){for(var c=[],b,e=0,a=(d?bp(d):0);
e<a;
e++){if(d.charAt(e)==S){continue}b=d.indexOf(S,e+1);
if(b==-1){c.push(d.substr(e));
break}c.push(d.substring(e,b));
e=b}return c}function bw(b,c,a){var d=b.substr(0,bp(c));
if(a!=T){d=d.toLowerCase();
c=c.toLowerCase()}return(d==c)}function bx(c,d,b){var e=bp(c)-bp(d),a;
if(e<0){return F}a=c.substr(e);
if(b!=T){a=a.toLowerCase();
d=d.toLowerCase()}return(a==d)}function by(a){if(a==am||a==""){return""}return String(a).replace(/:/g,".").replace(/\r\n/g,ao).replace(/\r/g,ao).replace(/\|/g,ao)}function bz(e,c){c=bm(c);
if(isNaN(c)||c<1){return""}e=String(e);
for(var d="",b=0;
b<c;
b++){d+=e}return d}function bA(a,b){return bB(a,b,S)}function bB(c,d,b){c=String(c);
if(bp(c)>d){return c.substr(0,d)}var a=bp(c);
while(a<d){a++;
c=b+c}return c}function bC(c,d,b){c=String(c);
if(bp(c)>d){return c.substr(0,d)}var a=bp(c);
while(a<d){a++;
c+=b}return c}function bD(a){a=String(a);
return a.replace(/(["\\])/g,"\\$1")}function bE(a){return'"'+bD(a)+'"'}function bF(a,b){if(a==am||a==null||(isNaN(a)&&typeof a=="number")){return b}return a}function bG(a){return bF(a,0)}function bH(a){return bF(a,"")}function bI(b){b=String(b);
var a=b.match(/\-?\d+[\.,]?\d*/);
if(a!=null&&bp(a)>0){return bH(a[0])}return""}function bJ(c,b,a){return M.max(b,M.min(a,c))}function round(c,e,f){var g=1,d,b,a;

c=bn(c);
e=bm(e);
if(isNaN(c)||c==am){return""}if(f!=3){if(c==0){return 0}if(c<0){g=-1;
c*=-1}}b=M.pow(10,e);
switch(f){case 1:d=M.floor(M.log(c)/M.LN10);
break;
case 2:d=M.floor(M.log(c)/3/M.LN10)*3;
break;
case 3:return c.toFixed(bJ(e,0,20));
break;
case 4:e-=M.ceil(M.log(c)/M.LN10);
return g*c.toFixed(bJ(e,0,20));
break;
default:return(g*M.round(c*b)/b)}switch(f){case 1:case 2:a=String(g*M.round(c/M.pow(10,d)*b)/b);
if(d==0){return a}return a+"&sdot;10<sup>"+d+"</sup>"}}function bK(c){var b=location.search,d,a;
if(b&&c){d=new RegExp("[&?]"+c+"=([^&$]*)");
if(a=d.exec(b)){return decodeURIComponent(a[1])}}}function bL(){return a9++}function s(a){return bH(langDef[a])}function bM(){if($.inArray(lang,bN)>=0){document.write('<script type="text/javascript" src="lang_'+lang+'.js"><\/script>')}}function bO(){$(".button, .wTooltip").attr("title",function(){return s(this.id)}).on("dragstart",bo)}function bP(){this.bQ=bL();
this.bR=this.bQ;
this.bS=bS}function bT(b,a,c){if(b.bU){c.bR=a.bR}b.bV[a.bQ]=c}function bS(a){return a!=am&&this.bR==a.bR}function bW(a){return a!=am&&this.bQ==a.bQ}function bX(b,d){for(var c=0,a=bp(d);
c<a;
c++){if(!bY(b,d[c])){return F}}return T}function bY(a,b){return bZ(a,b)>=0}function bZ(b,d){for(var c=0,a=bp(b);
c<a;
c++){if(b[c].bS(d)){return c}}return -1}function b0(b,a){b.push.apply(b,a)}function b1(a,b){if(b!=am){a.push(b)}}function b2(a,c){for(var b=bp(a)-1;
b>=0;
b--){if(!bY(c,a[b])){a.splice(b,1)}}}function b3(b,a){for(var c,d=bp(b)-1;
d>=0;
d--){for(c=bp(a)-1;
c>=0;
c--){if(b[d].bS(a[c])){b.splice(d,1);
break}}}}function b4(b,e,c){for(var d=0,a=bp(b);
d<a;
d++){if(b[d].bS(e)){b[d]=c;
return T}}return F}function b5(d,b){if(b){for(var c=0,a=bp(b);
c<a;
c++){if(b[c].bS(d)){b.splice(c,1);
return T}}}return F}function b6(a,b){if(b==am){b=1}if(b!=0){a.unshift.apply(a,a.splice(b,bp(a)))}}function b7(b,d){for(var c=0,a=bp(d);
c<a;
c++){if(!bY(b,d[c])){return F}}return T}function b8(e,d){var b=Array.apply(am,arguments),c=[],f,a;
if(bp(b)>2){e=b.pop();
d=b8.apply(am,b)}for(f=0,a=bp(e);
f<a;
f++){if(bY(d,e[f])){c.push(e[f])}}return c}function b9(e,b){for(var c=[],d=0,a=bp(e);
d<a;
d++){if(!bY(b,e[d])){c.push(e[d])}}return c}function b_(c,b){for(var d=0,a=bp(b);
d<a;
d++){ca(c,b[d])}}function ca(a,b){if(b!=am&&!bY(a,b)){a.push(b);
return T}return F}function cb(a){if(a==am){return am}return this.bV[a.bQ]}function cc(b){if(b==am){return am}var c=this.bV[b.bQ],a;
if(!c){for(a in this.bV){if(b.bS(this.bV[a])){return b}}c=b.cd(this);
this.bV[b.bQ]=c}return c}function ce(a){this.bV={};
this.bU=a;
this.cb=cb;
this.cc=cc}function cf(a){return(720+a)%ak}function cg(a){var b=this.cd();
b.x+=a.x;
b.y+=a.y;
b.z+=a.z;
return b}function ch(b,a){var c=this.cd();
c.x-=b.x;
c.y-=b.y;
c.z=(a?0:c.z-b.z);
return c}function ci(b){var c=this,a=c.bp();
return(a>0?c.cj((b||1)/a):new ck())}function cl(b,a,d){var c=this;
if(b instanceof ck){c.x+=b.x;
c.y+=b.y;
c.z+=b.z}else{c.x+=b;
c.y+=a;
c.z+=bG(d)}}function cm(a){return(this.x==a.x&&this.y==a.y&&this.z==a.z)}function cn(g,e,c){var f=this,a,b,d;
if(f.bp()==0||f.co(g)<0){return F}a=f.cp(g,e);
if(!a){return isNaN(a)}b=f.cp(e,c);
if(!b){return isNaN(b)}return(d=f.cp(c,g)?(a*b>0&&a*d>0):isNaN(d))}function cq(b,a){var d=this.co(b.cr(a));
if(d==0&&this.cs(a)<b.cs(a)){return NaN}return d}function ct(a){var b=this;
return new ck(b.x*a,b.y*a,b.z*a)}function cu(b,a){if(b!=1){var c=this;

if(a){c.cv(-a.x,-a.y,-a.z)}c.x*=b;
c.y*=b;
c.z*=b;
if(a){c.cv(a)}}}function cw(b,a){var c=this;
if(b&1){c.x=2*a.x-c.x}if(b&2){c.y=2*a.y-c.y}}function cx(c,b){if(b){this.cv(-b.x,-b.y,-b.z)}var f=this,d=M.cos(c),e=M.sin(c),a=f.x*d-f.y*e;
f.y=f.x*e+f.y*d;
f.x=a;
if(b){f.cv(b)}}function cy(d,c,a){if(a){this.cv(-a.x,-a.y,-a.z)}var g=this,b=M.cos(c),f=M.sin(c),e=g.z*b-g.x*f;
g.x=g.x*b+g.z*f;
b=M.cos(d);
f=M.sin(d);
g.z=g.y*f+e*b;
g.y=g.y*b-e*f;
if(a){g.cv(a)}}function cz(i,h,g,f){var e=this,c=e.cA(i),b=e.cA(h),d=cB(c,b),a;
if(f){a=c.cr(b);
a=a.cr(d).cC();
if(a){d.cD(f*ag,a)}}if(g){d=d.cC(g)}d.cv(e);
return d}function cE(a){var b=this.cA(a);
return M.abs(b.x)+M.abs(b.y)-M.abs(b.z)}function cF(g,e,d){var f=this,c=g.cA(f),b=e.cA(f),a=c.cr(b);
if(d){a=a.cr(d.cA(f))}return a.cC()}function cG(m,g,a){if(m){if(a){this.cv(-a.x,-a.y,-a.z)}var e=this,i=M.cos(m),h=1-i,f=M.sin(m),l=e.x,k=e.y,j=e.z,d=g.x,c=g.y,b=g.z;
e.x=l*(i+d*d*h)+k*(d*c*h-b*f)+j*(d*b*h+c*f);
e.y=l*(c*d*h+b*f)+k*(i+c*c*h)+j*(c*b*h-d*f);
e.z=l*(b*d*h-c*f)+k*(b*c*h+d*f)+j*(i+b*b*h);
if(a){e.cv(a)}}}function cH(){return M.sqrt(this.co(this))}function cI(b,a){var c=this.cA(b);
if(a){c.z=0}return c.bp()}function cJ(a){var b=this;
return b.x*a.x+b.y*a.y+b.z*a.z}function cK(b,a){var c=this;
if(a){c=c.cA(a);
b=b.cA(a)}return new ck(c.y*b.z-c.z*b.y,c.z*b.x-c.x*b.z,c.x*b.y-c.y*b.x)}function cL(g,d,b){var f=this,e=f.cA(g),c=f.cA(d),a=f.cA(b);
return e.cr(c).co(a)}function cM(h,f,c){var a=this,i=h.cA(a),g=f.cA(a),d=c.cA(a),e=i.cN(g).cN(d),b=[];
b.push(e.cr(i).cC());
b.push(e.cr(g).cC());
b.push(e.cr(d).cC());
return b}function cO(b,c){if(c){return cf(this.cP(c)-this.cP(b))}else{var a=b.x-this.x,d=b.y-this.y;
if(!a&&!d){return 0}return cf(M.atan2(d,a)*ah)}}function cQ(d,c){var e=this,b,a;
if(c){d=d.cA(e);
c=c.cA(e)}else{c=e}if((b=d.bp())&&(a=c.bp())){return cf(M.acos(d.co(c)/b/a)*ah)}}function cR(b,a){return this.cS(b,a)>0}function cT(b,a){var c=b.cU(a,T);
if(c>0){return M.abs(this.cS(b,a))/c}}function cV(b,a){return((a.x-b.x)*(this.y-b.y)-(a.y-b.y)*(this.x-b.x))}function cB(b,a){return new ck(0.5*(b.x+a.x),0.5*(b.y+a.y),0.5*(b.z+a.z))}function cW(c,b,a){return this.x>=M.min(c.x,b.x)-a&&this.x<=M.max(c.x,b.x)+a&&this.y>=M.min(c.y,b.y)-a&&this.y<=M.max(c.y,b.y)+a}function cX(f,e,c){for(var b=F,d=1,a=bp(f);
d<a;
d++){if((((f[d].y<=c)&&(c<f[d-1].y))||((f[d-1].y<=c)&&(c<f[d].y)))&&(e<(f[d-1].x-f[d].x)*(c-f[d].y)/(f[d-1].y-f[d].y)+f[d].x)){b=!b}}return b}function cY(c,b){var a=this;
if(b&&(b.x>a.x||b.x2<a.x||b.y>a.y||b.y2<a.y)){return F}return cX(c,a.x,a.y)}function cZ(){return this.x+","+this.y}function c0(b,a){return(this.x+b)+","+(this.y+a)}function c1(){var a=this;
return new ck(a.x,a.y,a.z)}function c2(f,e,b,a){var d=e*ag,c=b*ag;
return new ck(f.x+a*M.cos(c)*M.cos(d),f.y+a*M.cos(c)*M.sin(d),f.z+a*M.sin(c))}function c3(c,b,a){return c2(c,b,0,a)}function c4(e,d,c){var a=e.cU(d),b;
if(!a){return new ck()}b=c/a;
return new ck(b*(d.y-e.y),b*(d.x-e.x),0.5*(e.z+d.z))}function c5(e,d,a,c){var b,f;
if(c){b=1-c;
e.x=b*e.x+d.x*c;
e.y=b*e.y+d.y*c;
d.x=b*d.x+e.x*c;
d.y=b*d.y+e.y*c}if(a){f=c4(e,d,a);
e.x+=f.x;
d.x+=f.x;
e.y-=f.y;
d.y-=f.y}}function c6(d,c,b){var a=1;
if(d>c){a+=0.3*(d-c)/(b-c)}if(a<1.02){a=1}return a*a}function c7(n,b,q,l,g,o){var r=this,i=r.c8(),c=r.c9.c_.cd(),a=r.da.c_.cd(),f=r.db(),e,k,p,j,h,m,d;

g=(g||1);
if(f){e=M.max(f.dc.z,0.5*dd);
k=bq(e,M.min(f.de.z,-0.5*dd));
g=M.min(g*c6(a.z,k,e),3.5)*b;
b*=c6(c.z,k,e)}else{g*=b}if(!n[aE]&&(p=(c.cU(a,T)/df))){l=bG(l)+dg;
c5(c,a,q,l);
j=dh*(a.y-c.y)/p;
h=dh*(a.x-c.x)/p;
d=i.path("M"+c.di(-j*b,h*b)+"L"+c.di(j*b,-h*b)+"L"+a.di(j*g,-h*g)+"L"+a.di(-j*g,h*g)+"Z");
if(!o){l-=dg+dj;
c=r.c9.c_.cd();
a=r.da.c_.cd();
c5(c,a,q,l);
j/=dh;
h/=dh;
n[aD]=0;
m=i.path("M"+c.di(-j*b,h*b)+"L"+c.di(j*b,-h*b)+"L"+a.di(j*g,-h*g)+"L"+a.di(-j*g,h*g)+"Z").attr(aH,n[aB])}}else{c5(c,a,q,l);
d=i.path("M"+c+"L"+a);
n[aD]=df*M.min(b,g);
if(!o){m=i.path("M"+c+"L"+a)}}r.dk.push(d.attr({fill:dl,stroke:dl,"stroke-width":dm*n[aD]}));
if(m){r.dk.push(m.attr(n))}}function dn(d,c){if(c||st.dp||d.dq||d.dr||d.ds||d.dt!=C||d.du!=am||!bp(d.dv)){return T}if(bp(d.dv)!=2){return F}for(var b=0,a=bp(d.dv);
b<a;
b++){if(d.dv[b].dw!=2){return F}}return T}function dx(a){var c=this,b;
if(c.dk){if(a&&dy(c.dk)){a.insertAfter(c.dk)}c.dk.remove()}else{if(a&&(b=c.dz())){a.insertBefore(b)}}c.dk=a}function dA(b){for(var e,d,c=0,a=bp(b);
c<a;
c++){d=b[c].dk;
if(dy(d)){if(e){d.insertAfter(e)}e=d}}}function dB(b){var a;
if(b){if(!(a=b.node)&&bp(b)){a=b[0].node}}return(a&&a.parentNode)}function dy(a){var b;
if(a){if(!(b=a.node)&&bp(a)){b=a[bp(a)-1].node}}return(b&&b.parentNode)}function dz(){for(var g=this,c=st.dC(),e=g.dD(),b=c.dE(F),f,d=0,a=bp(b);
d<a;
d++){f=b[d];
if(f.dD()>=e&&dB(f.dk)){return f.dk}}}function dF(){this.dk=am}function dG(){var d=this,c=d.c8(),a=0.5*dH,b=c.path("M-"+a+",0H"+a+"M0,-"+a+"V"+a).attr(aB,d.dI?dJ:dK).attr(aD,dL).transform("t"+d.c_).data(as,d).mouseover(dM).mouseout(dN);
d.dx(b)}function dO(){var a=this,b=a.c8(),d,e=0.5*dP,i=0.5*(1-dQ),h=a.dR.cd(),g=a.dR.cd(),c=a.dS.cd(),j=a.dS.cd(),f=dK;
if(a.dT){f=dU}else{if(a.dI){f=dJ}}c5(c,h,e,i);
c5(j,g,-e,i);
d=b.path("M"+a.dS+"L"+a.dR+"L"+h+"M"+a.dR+"L,"+g).attr(aB,f).attr(aD,dL).data(as,a).mouseover(dV).mouseout(dW);
a.dx(d)}function dX(a){a.remove()}function dY(b){var a=this;
if(a.dk){a.dk.forEach(dX);
a.dk.clear()}else{a.dk=b.set()}return a.dk}function dZ(){if(!this.d0&&!this.d1&&!this.d2){var O=this,o=O.db(),j,u,G,B,k,f,K,g,m,b,E,J,l,t,r,I,z,n,N,A,h,a,w,p,v,q=O.c8(),y={},e=O.c9.c_,d=O.da.c_,L=bq(e.z,d.z),x=O.dK||dK,c=(O.dq?1.3:1);
if(o){o.d3();
j=o.de.z;
u=bq(o.dc.z,j)}if(O.dT){x=dU}else{if(O.dI){x=dJ}}if(O.dq){x=tinycolor.mix(x,"#00f",50)}if(L<u&&j<u){x=tinycolor(x);
y[aB]=x.brighten(0.13*(255-x.getBrightness())*(u-L)/(u-j)).toString()}else{y[aB]=x}O.dY(q);
switch(O.dw){case 1.5:case 2:h=0;
a=bp(O.c9.dv);
w=bp(O.da.dv);
if((a==1||w==1)&&(a>=3||w>=3||a==w)){}else{p=O.d4();
if(bp(p)){f=0;
for(G=0,B=bp(p);
G<B;
G++){A=bp(p[G].d5);
if(!k||A<f){f=A;
k=p[G]}}K=k.d6()}else{K=new ck();
g=0;
for(G=0,B=bp(O.c9.dv);
G<B;
G++){m=O.c9.dv[G];
b=(O.c9.bS(m.c9)?m.da:m.c9);
if(b.bS(O.da)){continue}K.x+=b.c_.x;
K.y+=b.c_.y;
g++}for(G=0,B=bp(O.da.dv);
G<B;
G++){m=O.da.dv[G];
b=(O.da.bS(m.c9)?m.da:m.c9);
if(b.bS(O.c9)){continue}K.x+=b.c_.x;
K.y+=b.c_.y;
g++}if(g){K.x/=g;
K.y/=g}}h=(e.cP(d)-K.cP(d))*ag;

if(M.abs(h)>M.PI){h*=-1}}if((h+2*M.PI)%M.PI>0.01||(a==2&&w==2)||(p&&bp(p))){O.d7(y,c);
if(O.dw==1.5){y[aE]=[aF]}O.d7(y,c,2*(h>0?-1:1),0.15)}else{O.d7(y,c,-1,-0.05);
if(O.dw==1.5){y[aE]=[aF]}O.d7(y,c,1,-0.05)}break;
case 3:O.d7(y,c,-1.5,0.15),O.d7(y,c),O.d7(y,c,1.5,0.15);
break;
default:if(O.d8!=0){K=(O.d8!=1);
O.d7(y,c,0,0,(K?2:4),K)}switch(O.d8){case 1:break;
case 4:y[aD]=df*c;
E=e.cU(d);
l=1.5;
J=2;
if(E){I=0;
J/=E;
t=J*(d.y-e.y);
r=J*(d.x-e.x);
n=0;
v="M"+e;
for(G=0;
G<=E;
G+=l){I++;
n=G/E;
z=(I%2?1:-1);
v+="L"+(e.x*(1-n)+(d.x+t*z)*n)+","+(e.y*(1-n)+(d.y-r*z)*n)}O.dk.push(q.path(v).attr(y))}break;
case 6:y[aD]=df*c;
E=e.cU(d);
l=2;
J=2;
if(E){J/=E;
t=J*(d.y-e.y);
r=J*(d.x-e.x);
v="";
for(G=0;
G<=E;
G+=l){n=G/E;
N=1-n;
v+="M"+(e.x*N+n*(d.x+t))+","+(e.y*N+n*(d.y-r))+"L"+(e.x*N+n*(d.x-t))+","+(e.y*N+n*(d.y+r))}O.dk.push(q.path(v).attr(y))}break;
default:if(O.dw==0){y[aE]=[aF]}O.d7(y,c)}}}else{this.dx()}d9(this)}function d_(a,c){var b=this;
a.ea.attr(aA,16*c).attr(aD,df);
a.bbox=a.ea.getBBox(T);
a.eb=b.ec.rect(a.bbox.x-a.ed,a.bbox.y-a.ed,a.bbox.width+2*a.ed,a.bbox.height+2*a.ed,1.5).attr(aH,a.dl).attr(aD,0).insertBefore(a.ea);
b.ee.push(a.eb,a.ea);
b.ef.push(a)}function eg(b,a){var e=this,d,c;
if(eh){if(b){e.x+=b;
e.ea.node.setAttribute("x",e.x);
e.eb.node.setAttribute("x",e.x-e.ed)}if(a){e.y+=a;
e.ea.node.setAttribute("y",e.y);
e.eb.node.setAttribute("y",e.y-e.ed)}}else{e.x+=bG(b);
e.y+=bG(a);
d=M.round(e.x*al);
c=M.round(e.y*al);
e.ea.shape.path=" m"+d+","+c+" l"+(d+1)+","+c+" e"}}function ei(b,h,f,i,e,g,c,d){var a=this;
a.ec=b;
a.x=h;
a.y=f;
a.dl=g;
a.ed=bG(c);
a.ea=a.ec.text(h,f,i).attr(aB,e).attr(aH,e).attr(aG,"start");
if(d){a.ea.attr("font-weight","bold")}a.bbox=a.ea.getBBox(T);
a.ej=eg}function ek(){for(var c=this,b=0,a=bp(c.ef);
b<a;
b++){c.ef[b].ea.insertAfter(c.ee)}return this.ee}function el(c,a){var b=this;
b.ec=c;
b.ee=a;
b.ef=[];
b.em=d_;
b.ek=ek}function en(){if(!this.d1&&!this.d0&&!this.d2){var J=this,v=J.c8(),x=J.c_,z=J.eo(),l,a,j,K=dl,d=J.ep(),t=d.eq,e,b,q,G,f,u,g,r,k,n,y,c,h=0,I=0,E=0,o,w=0.8,B,A,m=J.dq;
if(!v){return}if(t&&er=="tmpl"&&d.bS(t.es)){K=et}if(J.dT){j=dU}else{j=J.dK||dK}if(m||d.bS(eu)){a=(J.ev?ew:ex)}else{if(J.dI){a=dJ}}J.dY(v);
if(!dn(J,z)){if(a||K!=dl){l=v.rect(x.x-ey*ez,x.y-ey*ez,2*ey*ez,2*ey*ez);
if(a){l.attr(aB,a).attr(aD,df)}else{l.attr(aD,0)}if(K!=dl){l.attr(aH,(eA?"red":K))}J.dk.push(l)}}else{e=new el(v,J.dk);
b=!!(A=bp(J.dv));
for(B=0;
B<A;
B++){q=J.dv[B];
o=eB(q.c9,q.da)+90;
if(J.bS(q.da)){o+=af}o%=ak;
if(o>af){b=F;
break}}G=new ei(v,0,0,J.dt+(st.dp&&!J.dT?J.getIndex()+1:""),j,K,ez,m);
G.ea.attr(aG,"middle");
f=eC*eD/G.bbox.height;
e.em(G,f);
u=G.bbox.width*0.5;
I-=u;
h-=u;
E+=u;
g=J.eE();
if(g&&!b){r=new ei(v,E,0,H,j,dl,ez,m);
e.em(r,f);
E+=r.bbox.width;
if(g>1){k=new ei(v,E,0.4*G.bbox.height,g,j,dl,ez,m);
e.em(k,f*w)}}if(z||J.dr){n="";
if(z&&M.abs(z)!=1){n+=M.abs(z)}if(z){n+=(z>0?"+":"\u2013")}if(J.dr==1){n+=":"}else{if(J.dr==2){n+="."}else{if(J.dr==3){n+=".."}}}y=new ei(v,E,-0.5*G.bbox.height,n,j,dl,ez,m);
e.em(y,f*w)}if(J.ds){c=new ei(v,0,-0.5*G.bbox.height,M.round(J.ds),j,dl,ez,m);

e.em(c,f*w);
I-=c.bbox.width;
c.ej(I)}if(g&&b){if(g>1){k=new ei(v,0,0.4*G.bbox.height,g,j,dl,ez,m);
e.em(k,f*w);
h=M.min(I,h-k.bbox.width);
k.ej(h)}r=new ei(v,0,0,H,j,dl,ez,m);
e.em(r,f);
h-=r.bbox.width;
r.ej(h)}J.dk.transform("t"+x);
if(a){J.dk.push(v.rect(x.x+h-ez,x.y-G.bbox.height*0.5,E-h+2*ez,G.bbox.height).attr(aB,a).attr(aD,df))}}}else{this.dx()}d9(this)}function eF(){if(!this.d2){var b=this,f,d,e,n,k,l={},c=b.c8(),p=new el(c,b.dY(c)),a,j,h,o,m,g;
if(b==eG||(eu&&b==eu.ev)){g=(eh?1:1/eH);
b.d3();
o=c.set();
o.push(c.text(2,2,"Ph").attr(aA,2).attr("fill-opacity",0.8),c.path("M2,2L4,2L5,3.5L4,5L2,5L1,3.5Z M2.5,2.5L4,2.5 M4.5,3.5L3.5,4.75 M2.5,4.75L1.5,3.5").attr(aB,"#f00").attr(aD,df).attr(aC,0.85),c.path("M1,0L2,2").attr(aB,eI).attr(aD,df));
o.transform("t"+(b.dc.x)+","+(b.de.y)).data(as,b).mousedown(bo).mouseup(eJ).click(eK);
m=o.getBBox();
b.dk.push(c.rect(b.de.x,b.de.y,b.dc.x+m.width*1.8*g-b.de.x,b.dc.y-b.de.y).attr(eL).attr(aC,0.85).data(as,b).mouseout(eM));
b.dk.push(o);
if(b.type==au){b.dk.push(c.path(b.eN?"M0,4H4L2,2.5Z M0,0H4L2,1.5Z":"M0,1.5H4L2,0Z M0,2.5H4L2,4Z").transform("t"+(b.dc.x+g)+","+(b.de.y+m.height*1.3*g)).attr(aB,eI).attr(aD,df).attr(aH,"silver").data(as,b).mousedown(bo).mouseup(eJ).click(eO))}}if(!b.eN){if(b.type==au){a=b.d6();
j=new ei(c,a.x,a.y,b.dt,dK,dl,ez,(b.dI?dJ:am));
j.ea.attr(aG,"middle");
h=eC*eD/j.bbox.height;
p.em(j,h)}else{a=b.eP();
l[aB]=(b.dI?dJ:dK);
l[aD]=df;
for(f=0,d=bp(b.eQ);
f<d;
f++){e=b.eQ[f];
n=e.dS.cd();
k=e.dR.cd();
c5(n,k,eD*0.4*(a.eR(n,k)?-1:1));
b.dk.push(c.path("M"+n+"L"+e.dS+"L"+e.dR+"L"+k).attr(l))}if(b.dt){k=b.eS(3);
j=new ei(c,k.x+eD*0.3,k.y+eD*0.3,b.dt,dK,dl,ez);
h=eC*eD/j.bbox.height;
p.em(j,h);
b.dk=p.ek()}}if(c==aZ){j.ea.click(function(i){b.eT(i);
return bo(i)}).mouseup(eJ)}}}else{this.dx()}d9(this)}function ck(a,d,c){var b=this;
b.x=bG(a);
b.y=bG(d);
b.z=bG(c);
b.cN=cg;
b.cA=ch;
b.cC=ci;
b.cv=cl;
b.eU=cu;
b.eV=cx;
b.eW=cy;
b.cD=cG;
b.eX=cF;
b.eY=cz;
b.eZ=cE;
b.e0=cw;
b.bS=cm;
b.bp=cH;
b.cU=cI;
b.cj=ct;
b.co=cJ;
b.cr=cK;
b.e1=cL;
b.e2=cM;
b.cP=cO;
b.cs=cQ;
b.eR=cR;
b.cp=cq;
b.e3=cT;
b.cS=cV;
b.e4=cn;
b.cW=cW;
b.cY=cY;
b.cd=c1;
b.toString=cZ;
b.di=c0}function e5(){var a=this;
bP.apply(a);
a.moveBy=a.cv=e6;
a.rotateBy=a.eV=e7;
a.rotate3D=a.eW=e8;
a.rotateAround=a.e9=e_;
a.rotateAroundUnit=a.cD=fa;
a.flip=a.e0=fb;
a.getCenter=a.d6=fc;
a.fd=fe;
a.dx=ff;
a.dF=fg;

a.setColor=fh}function fi(){var a=this;
bP.apply(a);
a.ep=fj;
a.dx=dx;
a.dY=dY;
a.dF=dF;
a.dz=dz}function fk(b,a){if(a){b5(b,a)}b.d2=T;
b.dx();
d9(b)}function fl(b){for(var c=0,a=bp(b);
c<a;
c++){fk(b[c])}b.length=0}function fm(d,c){var e=d.dD(),f=c.dD();
if(e<f){return -1}if(e>f){return 1}return 0}function fn(c){for(var d=[],b=0,a=bp(c);
b<a;
b++){ca(d,fo(c[b]))}return d}function fo(a){if(!a||a.fp||a.d2){return}var b=a.c8();
if(b){ca(b.fp,a);
a.fp=T}return b}function d9(a){if(!a||!a.fp){return}var b=a.c8();
if(b){b5(a,b.fp);
a.fp=am}}function fq(){dA(st.dC().dE(F))}function fr(d){var b,a,c;
if($.isArray(d)){for(b=0,a=bp(d);
b<a;
b++){fr(d[b])}}else{while(bp(d.fp)){c=d.fp.pop();
if(c.d2){c.dx()}else{c.fp=am;
c.fd()}}if(c){fq();
d.renderfix()}}}function resetDirty(b){while(bp(b.fp)){var a=b.fp.pop();
a.fp=am}}function fs(){var d=this,c,e,b,a;
if(!d.de||!d.dc){d.de=new ck(ar,ar,ar);
d.dc=new ck(-ar,-ar,-ar);
c=d.ft(T);
if(!bp(c)){c=d.ft()}for(b=0,a=bp(c);
b<a;
b++){e=c[b];
fu(d,e)}}}function fu(a,b){fv(a,b.x);
fw(a,b.y);
fx(a,b.z)}function fv(b,a){if(a>b.dc.x){b.dc.x=a}if(a<b.de.x){b.de.x=a}}function fw(b,a){if(a>b.dc.y){b.dc.y=a}if(a<b.de.y){b.de.y=a}}function fx(b,a){if(a>b.dc.z){b.dc.z=a}if(a<b.de.z){b.de.z=a}}function fc(){if(!this.fy){var e=this,b=new ck(),d=e.ft(T),c,a;
if(!bp(d)){d=e.ft()}for(c=0,a=bp(d);
c<a;
c++){b.cv(d[c])}if(a>1){b.x/=a;
b.y/=a;
b.z/=a}e.fy=b}return this.fy}function ff(){if(this.dk){dx.apply(this)}for(var c=this.dE(T),b=0,a=bp(c);
b<a;
b++){c[b].dx()}}function fg(){if(this.dk){dF.apply(this)}for(var c=this.dE(T),b=0,a=bp(c);
b<a;
b++){c[b].dF()}}function fh(b){for(var d=this.dE(T),c=0,a=bp(d);
c<a;
c++){d[c].dK=b}this.fd()}function fe(){var a=fn(this.dE(F));
fr(a)}function e6(c,b,f){for(var e=this.ft(),d=0,a=bp(e);
d<a;
d++){e[d].cv(c,b,f)}this.fz(bd);
fn(this.dE(F))}function e7(f,b){var e,d,a,c,g=this;
if(!b){b=g.d6().cd();
c=T}e=g.ft();
for(d=0,a=bp(e);
d<a;
d++){e[d].eV(f,b)}g.fz((c?be:bg));
fn(g.dE(F))}function e8(e,d,b){var f,c,a,g=this;
if(!b){b=g.d6().cd()}f=g.ft();
for(c=0,a=bp(f);
c<a;
c++){f[c].eW(e,d,b)}g.fz(bg);
fn(g.dE(F))}function fa(f,c,b){for(var g=this,e=g.ft(),d=0,a=bp(e);
d<a;
d++){e[d].cD(f,c,b)}g.fz(bg);
fn(g.dE(F))}function e_(e,b,d){var a,c;
if(a=b.cU(d)){c=d.cA(b);
c.eU(1/a);
this.cD(e,c,b)}}function fA(d,b){var e,c,a,f=this;
if(!b){b=f.d6().cd()}e=f.ft();
for(c=0,a=bp(e);
c<a;
c++){e[c].eU(d,b)}f.fz(bg);
fn(f.dE(F))}function fb(c,b){if(!b){b=this.d6()}for(var e=this.ft(),d=0,a=bp(e);
d<a;
d++){e[d].e0(c,b)}this.fz(bd);
fn(this.dE(F))}function fB(){return 0}function fC(){return ar}function fD(){return this.c_.z}function fE(a){b5(a,this.fF)
}function fG(){var b=this,a;
if(b.eq){for(a=bp(b.eq.dv)-1;
a>=0;
a--){b.fH(b.eq.dv[a])}for(a=bp(b.eq.d5)-1;
a>=0;
a--){b.fI(b.eq.d5[a])}}else{b.eq=new fJ()}b.fK=new fL(aZ);
b.fK.fM(b.eq);
b.fN=new ce();
b.fN.fO=T}function fP(){var a=this;
return !a.fK||!a.eq||(!a.fK.fQ&&!bp(a.eq.d5)&&!bp(a.eq.dv))}function fR(){for(var c=this.fK.dE(F),b=0,a=bp(c);
b<a;
b++){c[b].fd();
aZ.fS.push(c[b].dk)}}function fT(c,a){var b=this;
b.fQ=new fU(c,a);
b.fQ.dT=T;
b.fK.fV(b.fQ);
return b.fQ}function fW(a){var b=this.fN.cc(a);
fX(b,a);
b0(b.dv,a.dv);
this.eq.fY(b);
return b}function fZ(b){var c=b.d0,a=b;
if(!c){c=b;
a=b.f0}fk(c,this.eq.d5);
delete c.d0;
if(a){delete a.fp;
fo(a);
delete a.d0}}function f1(a){var b=this.fN.cc(a);
fX(b,a);
this.eq.f2(b);
return b}function f3(c,b){for(var a=bp(c)-1;
a>=0;
a--){c[a].dT=b}}function fX(c,a){c.dT=T;
c.f0=a;
var b;
if((b=c.eq)&&a.eq){b.dT=T;
b.f0=a.eq;
if(b=b.f4){b.dT=T;
b.f0=a.eq.f4}}a.d0=c}function f5(b){var c=b.d0,a=b;
if(!c){c=b;
a=b.f0}fk(c,this.eq.dv);
delete c.d0;
if(a){delete a.fp;
fo(a);
delete a.d0}}function f6(b){for(var d,c=0,a=bp(b.d5);
c<a;
c++){d=this.fY(b.d5[c]);
d.dv=[]}for(c=0,a=bp(b.dv);
c<a;
c++){this.f2(b.dv[c])}}function f7(c){for(var b=0,a=bp(c.f8);
b<a;
b++){this.fM(c.f8[b])}}function f9(){var a=this;
a.fY=fW;
a.fI=fZ;
a.f2=f1;
a.fH=f5;
a.fM=f6;
a.f_=f7;
a.ga=fT;
a.fd=fR;
a.gb=fG;
a.gc=fP;
a.gb()}function fj(){return(this.f0?this.f0:this)}var gd={H:{an:1,m:1.00794,v:1,ge:T,gf:1.007825,gg:{1:1.007825,2:2.01410177811,3:3.01604928}},D:{an:1,m:2.01410177811,v:1,gf:2.01410177811,iso:T},T:{an:1,m:3.01604928,v:1,gf:3.01604928,iso:T},He:{an:2,m:4.002602,gf:4.002603,gg:{3:3.0160293,4:4.0026032}},Li:{an:3,gh:T,m:6.941,gi:7,gf:7.016005,gg:{5:5.0125378,6:6.0151223,7:7.016004}},Be:{an:4,gh:T,m:9.012182,gi:6,gf:9.012183,gg:{7:7.0169292,9:9.0121821,10:10.0135337}},B:{an:5,m:10.811,v:3,gi:5,gf:11.009305,gg:{10:10.012937,11:11.0093055}},C:{an:6,m:12.011,v:4,ge:T,gf:12,gg:{11:11.0114338,12:12,13:13.0033548,14:14.003242}},N:{an:7,m:14.00674,v:5,gf:14.003074,gg:{13:13.0057386,14:14.003074,15:15.0001089,17:17.0084497}},O:{an:8,m:15.9994,v:6,gf:15.994915,gg:{14:14.0085953,15:15.0030654,16:15.9949146,17:16.9991315,18:17.9991604,19:19.0035787,20:20.0040761,21:21.0086546}},F:{an:9,m:18.9984032,v:7,gf:18.998403,gg:{17:17.0020952,18:18.0009377,19:18.9984032,20:19.9999813,21:20.9999489}},Ne:{an:10,m:20.1797,gf:19.992439,gg:{19:19.0018798,20:19.9924402,21:20.9938467,22:21.9913855,23:22.9944673,24:23.9936151}},Na:{an:11,gh:T,m:22.989768,gi:7,gf:22.98977,gg:{21:20.9976551,22:21.9944368,23:22.9897697,24:23.9909633,25:24.9899544}},Mg:{an:12,gh:T,m:24.305,gi:6,gf:23.985045,gg:{22:21.9995741,23:22.9941248,24:23.9850419,25:24.985837,26:25.982593,27:26.9843407,28:27.9838767}},Al:{an:13,gh:T,m:26.9811539,gi:5,gf:26.981541,gg:{25:24.9904286,26:25.9868917,27:26.9815384,28:27.9819102,29:28.9804448}},Si:{an:14,m:28.0855,v:4,gf:27.976928,gg:{27:26.9867048,28:27.9769265,29:28.9764947,30:29.9737702,31:30.9753633,32:31.9741481}},P:{an:15,m:30.973762,v:5,gf:30.973763,gg:{29:28.9818014,30:29.9783138,31:30.9737615,32:31.9739072,33:32.9717253,34:33.9736364}},S:{an:16,m:32.066,v:6,gf:31.972072,gg:{31:30.9795544,32:31.9720707,33:32.9714585,34:33.9678668,35:34.9690321,36:35.9670809,37:36.9711257,38:37.9711634,39:38.9751353}},Cl:{an:17,m:35.4527,v:7,gf:34.968853,gg:{33:32.9774518,34:33.973762,35:34.9688527,36:35.9683069,37:36.9659026,38:37.9680106,39:38.9680077,40:39.9704156,41:40.9706502}},Ar:{an:18,m:39.948,gf:39.962383,gg:{36:35.9675463,37:36.9667759,38:37.9627322,39:38.9643134,40:39.9623831,41:40.9645008,42:41.9630464,43:42.9656707,44:43.9653653,45:44.968095}},K:{an:19,gh:T,m:39.0983,gi:17,gf:38.963708,gg:{38:37.9690801,39:38.9637069,40:39.9639987,41:40.961826,42:41.9624031,43:42.9607157,44:43.9615561,45:44.9606997,46:45.9619762}},Ca:{an:20,gh:T,m:40.078,gi:16,gf:39.962591,gg:{40:39.9625912,41:40.9622783,42:41.9586183,43:42.9587668,44:43.9554811,45:44.9561859,46:45.9536928,47:46.9545465,48:47.9525335,49:48.9556733}},Sc:{an:21,gh:T,m:44.95591,gi:15,gf:44.955914,gg:{43:42.961151,44:43.959403,45:44.9559102,46:45.9551703,47:46.952408,48:47.952235,49:48.9500241}},Ti:{an:22,gh:T,m:47.867,gi:14,gf:47.947947,gg:{44:43.9596902,45:44.9581243,46:45.9526295,47:46.9517638,48:47.9479471,49:48.9478708,50:49.9447921,51:50.946616,52:51.9468982}},V:{an:23,gh:T,m:50.9415,gi:13,gf:50.943963,gg:{47:46.9549069,48:47.9522545,49:48.9485169,50:49.9471628,51:50.9439637,52:51.9447797,53:52.9443425}},Cr:{an:24,gh:T,m:51.9961,gi:12,gf:51.94051,gg:{48:47.9540359,49:48.9513411,50:49.9460496,51:50.9447718,52:51.9405119,53:52.9406538,54:53.9388849,55:54.9408442,56:55.9406452}},Mn:{an:25,gh:T,m:54.93805,gi:11,gf:54.938046,gg:{51:50.9482155,52:51.9455701,53:52.9412947,54:53.9403632,55:54.9380496,56:55.9389094,57:56.9382875}},Fe:{an:26,gh:T,m:55.845,gi:10,gf:55.934939,gg:{52:51.9481165,53:52.9453123,54:53.9396148,55:54.938298,56:55.9349421,57:56.9353987,58:57.9332805,59:58.9348805,60:59.9340769,61:60.9367495}},Co:{an:27,gh:T,m:58.9332,gi:9,gf:58.933198,gg:{55:54.9420031,56:55.9398439,57:56.9362962,58:57.9357576,59:58.9332002,60:59.9338222,61:60.9324794,62:61.9340542}},Ni:{an:28,gh:T,m:58.6934,gi:10,gf:57.935347,gg:{56:55.9421363,57:56.9398005,58:57.9353479,59:58.9343516,60:59.9307906,61:60.9310604,62:61.9283488,63:62.9296729,64:63.9279696,65:64.930088,66:65.9291152}},Cu:{an:29,gh:T,m:63.546,gi:7,gf:62.929599},Zn:{an:30,gh:T,m:65.39,gi:6,gf:63.929145},Ga:{an:31,m:69.723,gi:5,gf:68.925581},Ge:{an:32,m:72.61,gf:73.921179},As:{an:33,m:74.92159,gf:74.921596},Se:{an:34,m:78.96,gf:79.916521},Br:{an:35,m:79.904,v:7,gf:78.918336},Kr:{an:36,m:83.8,gf:83.911506},Rb:{an:37,gh:T,m:85.4678,gi:17,gf:84.9118},Sr:{an:38,gh:T,m:87.62,gi:16,gf:87.905625},Y:{an:39,gh:T,m:88.90585,gi:15,gf:88.905856},Zr:{an:40,gh:T,m:91.224,gi:14,gf:89.904708},Nb:{an:41,gh:T,m:92.90638,gi:13,gf:92.906378},Mo:{an:42,gh:T,m:95.94,gi:12,gf:97.905405},Tc:{an:43,gh:T,m:97.9072,gi:11},Ru:{an:44,gh:T,m:101.07,gi:10,gf:101.904348},Rh:{an:45,gh:T,m:102.9055,gi:9,gf:102.905503},Pd:{an:46,gh:T,m:106.42,gi:8,gf:105.903475},Ag:{an:47,gh:T,m:107.8682,gi:7,gf:106.905095},Cd:{an:48,gh:T,m:112.411,gi:6,gf:113.903361},In:{an:49,gh:T,m:114.818,gi:5,gf:114.903875},Sn:{an:50,gh:T,m:118.71,gf:119.902199},Sb:{an:51,m:121.76,gf:120.903824},Te:{an:52,m:127.6,gf:129.906229},I:{an:53,m:126.90447,v:7,gf:126.904477},Xe:{an:54,m:131.29,gf:131.904148},Cs:{an:55,gh:T,m:132.90543,gi:17,gf:132.905433},Ba:{an:56,gh:T,m:137.327,gi:16,gf:137.905236},La:{an:57,gh:T,m:138.9055,gi:15,gf:138.906355},Ce:{an:58,gh:T,m:140.115,gi:15,gf:139.905442},Pr:{an:59,gh:T,m:140.90765,gi:15,gf:140.907657},Nd:{an:60,gh:T,m:144.24,gi:15,gf:141.907731},Pm:{an:61,gh:T,m:144.9127,gi:15},Sm:{an:62,gh:T,m:150.36,gi:15,gf:151.919741},Eu:{an:63,gh:T,m:151.965,gi:15,gf:152.921243},Gd:{an:64,gh:T,m:157.25,gi:15,gf:157.924111},Tb:{an:65,gh:T,m:158.92534,gi:15,gf:158.92535},Dy:{an:66,gh:T,m:162.5,gi:15,gf:163.929183},Ho:{an:67,gh:T,m:164.93032,gi:15,gf:164.930332},Er:{an:68,gh:T,m:167.26,gi:15,gf:165.930305},Tm:{an:69,gh:T,m:168.9342,gi:15,gf:168.934225},Yb:{an:70,gh:T,m:173.04,gi:15,gf:173.938873},Lu:{an:71,gh:T,m:174.967,gi:15,gf:174.940785},Hf:{an:72,gh:T,m:178.49,gi:14,gf:179.946561},Ta:{an:73,gh:T,m:180.9479,gi:13,gf:180.948014},W:{an:74,gh:T,m:183.84,gi:12,gf:183.950953},Re:{an:75,gh:T,m:186.207,gi:11,gf:186.955765},Os:{an:76,gh:T,m:190.23,gi:10,gf:191.961487},Ir:{an:77,gh:T,m:192.217,gi:9,gf:192.962942},Pt:{an:78,gh:T,m:195.08,gi:8,gf:194.964785},Au:{an:79,gh:T,m:196.96654,gi:7,gf:196.96656},Hg:{an:80,gh:T,m:200.59,gi:6,gf:201.970632},Tl:{an:81,gh:T,m:204.3833,gi:5,gf:204.97441},Pb:{an:82,gh:T,m:207.2,gi:4,gf:207.976641},Bi:{an:83,gh:T,m:208.98037,gi:3,gf:208.980388},Po:{an:84,gh:T,m:208.9824},At:{an:85,m:209.9871},Rn:{an:86,m:222.0176},Fr:{an:87,gh:T,m:223.0197},Ra:{an:88,gh:T,m:226.0254},Ac:{an:89,gh:T,m:227.0278},Th:{an:90,gh:T,m:232.0381,gf:232.038054},Pa:{an:91,gh:T,m:231.03588},U:{an:92,gh:T,m:238.0289,gf:238.050786},Np:{an:93,gh:T,m:237.0482},Pu:{an:94,gh:T,m:244.0642},Am:{an:95,gh:T,m:243.0614},Cm:{an:96,gh:T,m:247.0703},Bk:{an:97,gh:T,m:247.0703},Cf:{an:98,gh:T,m:251.0796},Es:{an:99,gh:T,m:252.083},Fm:{an:100,gh:T,m:257.0915},Md:{an:101,gh:T,m:256.094},No:{an:102,gh:T,m:259.1009},Lr:{an:103,gh:T,m:262.11},Rf:{an:104,gh:T,m:261.11},Db:{an:105,gh:T,m:268},Sg:{an:106,gh:T,m:271},Bh:{an:107,gh:T,m:270},Hs:{an:108,gh:T,m:277},Mt:{an:109,gh:T,m:276},Ds:{an:110,gh:T,m:281},Rg:{an:111,gh:T,m:272},Cn:{an:112,gh:T},"%":{gj:T},M:{gj:T},X:{gj:T},Ln:{gj:T}},gk=[2,10,18,36,54,86],gl={};

function gm(){if(!this.eq){return -1}return bZ(this.eq.d5,this)}function gn(a){return bA(round(a/eD,4,3),10)}function go(){var e=0,g=this,d=bA("0",3),f=(g.du!=am?g.du+1:0),a=g.gp(),b=M.round(bG(g.gq)),c=g.gr;
if(g.ds&&c){e=M.round(g.ds-c.m);
if(e<-3||e>4){e=0}}if(!c||a==c.v){a=0}else{if(a==0){a=15}}if(b!=0&&M.abs(b)<4){b=4-b}else{if(b!=4){b=0}}return ao+gn(g.c_.x)+gn(-g.c_.y)+gn(g.c_.z)+S+bC(g.dt,3,S)+bA(e,2)+bA(b,3)+d+bA(f,3)+d+bA(a,3)+bz(d,6)}function gs(a){if(a){a=a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}this.dt=a;
this.gt=am;
this.gr=gd[a]}function gu(b){if(!b){return}var e=0,d,a,g,f;
for(d=0,a=bp(b);
d<a;
d++){g=b.charAt(d);
if(g=="+"){e++}else{if(g=="-"){e--}}}f=bI(b);
if(f===""){return e}return f*e}function gv(b){if(b==H){return 1}if(b){if(b.charAt(0)==H){var a=bm(b.substr(1));
if(!isNaN(a)){return a}}}return am}function gw(k,e){var d=this,g=d.eq,c=new gx(T),b=g.es,a=k.eq,i=d,f=1,j,h;
if(k.dt=="*"&&bp(k.dv)==1&&((j=k.dv[0]).dw!=1||j.d8!=0)){f=-1}else{if(bp(d.dv)>1||d.dt!=C){i=new gy(gz(d.ep(),1,e));
if(d.dT){i=gA.fY(i)}j=new gB(d,i,1,0);
if(d.dT){j=gA.f2(j)}else{g.fY(i);
g.f2(j)}}else{j=d.dv[0]}}a.cv(i.c_.cA(k.c_));
c.fM(a);
if(j){h=f*eB(j.c9,j.da)+(j.da.bS(i)||j.da.bS(i.f0)||j.da.bS(k)||j.da.bS(k.f0)?af:0)-f*(f==1?k:d).gC(1);
a.eV(h*ag,i.c_);
h=g.gD(a.d5,T);
a.e9(M.PI,j.c9.c_.cd(),j.da.c_);
if(h<g.gD(a.d5,T)){a.e9(M.PI,j.c9.c_.cd(),j.da.c_)}}if(d.dT){a.es=am;
gA.fM(a);
k=k.d0}else{g.f4.gE(g,a);
if(d.dI){st.gF().fM(a)}}if(f==-1){g.gG(k,i)}else{if(!d.dT){g.gG(i,k)}}g.es=b;
return c}function gH(n,a){var b=this,l,g,e,d,k=0,j=0,h,f,m=b.ev;
if(m&&m.type==av){return}if(!a&&(l=gI(n))){if(m){return}b.attachTemplate(l.gJ())}else{b.dr=0;
g="";
for(e=0,d=bp(n);
e<d;
e++){h=n.charAt(e);
if(h=="."){k++}else{if(h==":"){j++}else{g+=h}}}if(j==1){b.dr=1}else{if(k>0){b.dr=k+1}}if(f=a_.exec(g)){b.ds=bF(bm(f[1]),0);
b.gK(f[2]);
b.du=gv(f[3]);
b.gq=gu(f[4])}else{if(!!bK("wildcards")){b.gK(g)}}b.fz(bh)}}function gL(b){var c,f,d,a,e;
if(c=this.gr){if(a=this.ds){if((f=c.gg)&&(f=f[a])){return f}e=c.an;
f=a-e;
d=15.67*a-17.23*M.pow(a,2/3)-0.714*e*(e-1)*M.pow(a,-1/3)-23.2875*M.pow(f-e,2)/a;
if(!(a%2)){d+=11.2*M.pow(a,-0.5)*(e%2?-1:1)}return(939.553*f+938.259*e-d)/931.494061}else{return(b?c.gf:c.m)}}}function gM(b,a){this.gN=a;
this.cP=eB(b,a)}function gO(d,c){if(d.cP<c.cP){return -1}if(d.cP>c.cP){return 1}return 0}function gP(l,o){var k=(o?o.concat():[]),m,f=this.ep(),a=bp(f.dv),p,q,c,e,b,d,n,h=0,g;
for(c=0;
c<a;
c++){p=f.dv[c];
q=(p.c9.bS(f)?p.da:p.c9);
k.push(new gM(f,q))}a=bp(k);
k.sort(gO);
if(l){m=f.c_.cP(l);
for(c=0;
c<a;
c++){b=(c+1)%a;
e=k[c].cP;
d=(k[b].cP+ak)%ak;
if(b==0&&(m<d||e<m)){m=0.5*(e+d+ak);
break}else{if(e<m&&m<d){m=0.5*(e+d);
break}}}}else{for(c=0;
c<a;
c++){b=(c+1)%a;
n=(720+k[b].cP-k[c].cP)%ak;
if(n>h){h=n;
g=c}}m=k[g].cP+0.5*h}return m}function gQ(){var c=this.ep(),e,a,b,d=c.c_,f=d.z;
for(b=bp(c.dv)-1;
b>=0;
b--){e=c.dv[b];
a=(e.c9.bS(c)?e.da:e.c9);
if(M.abs(a.c_.z-f)>0.05*d.cU(a.c_)){return F}}return T}function gR(b){var e=this,d=bp(e.dv),a,c;
if(b){if(d==2){for(c=0;
c<d;
c++){a=e.dv[c].gS(e);

if(!a.bS(b)){return a}}}}else{if(d==1){return e.dv[0].gS(e)}}return am}function gT(g,e){var f,d=this.ep(),c=bp(d.dv),h,i,b,a;
if(!c){if(e){f=d.c_.cP(e)}else{f=-30}}else{if(c==1){h=d.dv[0];
i=d.gU();
if(g+h.dw==4){f=eB(d,i)+af}else{if(e){f=eB(d,i);
f+=M.round((d.c_.cP(e)-f+720)/60)*60}else{b=i.get1stNeighbour(d);
if(b){a=(eB(i,d,b)+af)%ak}f=eB(d,i)+ae*(a<af?1:-1)}}}else{f=d.gV(e)}}return f}function gW(){for(var b=0,c=0,a=bp(this.dv);
c<a;
c++){b+=this.dv[c].dw}return b}function gX(b){var c=this,a=(c.dt=="O"&&b.gp()>3);
if(a){if(c.eE()>0){c.gY(-1)}else{if(c.eo()<0){c.gY(1)}}if(b.eo()<1){b.gY(1)}else{if(b.eE()>0){b.gY(-1)}}}return a}function gZ(b){if(b){var c=this,a=c.eo();
c.gq=a+b;
c.fz(bh);
fo(c)}}function g0(){var b=this,a=$.inArray(b.dr,az);
a++;
a%=bp(az);
b.dr=az[a];
b.fz(bh);
fo(b)}function g1(c,a){var b=this;
if(!a){a=[]}else{if(bY(a,b)){return}}a.push(b);
b.z=am;
if(c>bg){b.g2=am;
b.g3=am}a.pop()}function g4(){return(this.gt==am&&this.gr?this.gr.v:this.gt)}function g5(a){if(a==am){return ar}var d=this,c=d.gW(),b=bG(d.gq);
if(d.dr==1||d.dr==3){c+=2}else{if(d.dr==2){c++}}return(a-b<4?a-c-M.abs(b):8-a-c+b)}function g6(c){for(var b=gk.length-1,a;
b>=0;
b--){if((a=c-gk[b])>0){return a}}}function g7(c){var b=this,a=b.gr;
return(a?(a.v?(a.an>13?2:b.g8(b.gp())+c+(a.an==7?1:0)):M.min(g6(a.an),a.an>13?3:2)):3)}function g9(){var g=this,c=g.gp(),e,b,d,a,f=0;
if(c==am){g.g3=0;
g.g2=0}else{b=g.du;
if(b==am){b=g.g2=g.g8(c)}if(b<0&&g.gr){g.g2=0;
e=g.gr.an;
if(e==5){if(b>=-1){g.g3=b}}else{for(d=bp(g.dv);
d>0;
d--){a=g.dv[d-1].gS(g);
if(a&&a.dt=="B"){f++}}if(f>1){b=0}else{if(e>10){if(b<8-2*c){b=8-2*c-b}else{b%=2}}}g.g3=-b}}else{g.g3=0}if(g.g2>4||g.g2>c+1){g.g2=0}}}function g_(){var a=this;
if(a.du!=am){return a.du}if(a.g2==am){a.ha()}return a.g2}function hb(){var a=this;
if(a.gq!=am){return a.gq}if(a.g3==am){a.ha()}return a.g3}function hc(b){if(this.f0){return this.f0.cd(b)}if(!b){b=new ce()}var c=this,a=new gy(c.c_.cd());
bT(b,c,a);
a.gK(c.dt);
a.du=c.du;
a.d1=c.d1;
a.gq=c.gq;
a.dr=c.dr;
a.ds=c.ds;
a.gt=c.gt;
a.ev=b.cc(c.ev);
a.dI=c.dI;
a.dT=c.dT;
return a}function hd(){var b=this,a=0;
if(b.dt!=C){a+=2}if(b.ds){a+=3}if(b.dr){a+=3}if(b.gq){a+=2}return a}function he(){if(st.hf||st.hg()){return}var c=this,b,a,d;
gA.gb();
switch(hh){case aK:b=gA.fY(c);
b.gH(hi());
gA.fd();
break;
case aL:case aM:if(!hj&&!hk){d=gz(c,hl);
b=gA.fY(c);
a=gA.fY(new gy(d));
gA.f2(new gB(b,a,hl,hm));
a.gH(hi());
gA.fd()}break;
case aT:if(hj){c.eq.fI(c)}break}}function hn(){gA.gb()}function c8(){if(this.ec){return this.ec}if(this.eq){return this.eq.c8()}}function ho(d){if(d){for(var e,b=this.eq,c=0,a=bp(this.dv);
c<a;
c++){e=this.dv[c];
if((e.c9.bS(d)||e.da.bS(d))&&(!b||bY(b.dv,e))){return e}}}}function hp(){return this.c_
}function hq(a){if(!a||!this.d1){return[this.c_]}return[]}function hr(d,c){if(this.bS(d)){return}if(c){if(bY(c.d5,this)){return c}}else{c=new gx(T)}c.fY(this);
for(var b=0,a=bp(this.dv);
b<a;
b++){this.dv[b].hs(d,c)}return c}function ht(){if(!this.hu){this.hu=[];
var b=this.eq.d4(),c,a;
for(c=0,a=bp(b);
c<a;
c++){if(bY(b[c].d5,this)){this.hu.push(b[c])}}}return this.hu}function hv(){if(this.z==am){for(var d=this,b=d.c_.z,c=0,a=bp(d.dv);
c<a;
c++){b=M.max(d.dv[c].dD(),b)}d.z=b+0.000001}return this.z}function gy(b){var a=this;
fi.apply(a);
a.dt=C;
a.dv=[];
a.d1=F;
a.dr=0;
a.ds=0;
a.c_=b;
a.dI=F;
a.getCenter=a.d6=hp;
a.ft=hq;
a.hw=ho;
a.d4=ht;
a.attachTemplate=gw;
a.gH=gH;
a.gK=gs;
a.getIndex=gm;
a.gV=gP;
a.hx=gQ;
a.get1stNeighbour=gR;
a.gU=gR;
a.gC=gT;
a.gp=g4;
a.g8=g5;
a.gW=gW;
a.hy=g7;
a.gY=gZ;
a.hz=gX;
a.hA=g0;
a.fz=g1;
a.ha=g9;
a.eE=g_;
a.eo=hb;
a.hB=gL;
a.hC=hd;
a.hs=hr;
a.getMolecule=hD;
a.hE=go;
a.fd=en;
a.dD=hv;
a.cd=hc;
a.c8=c8;
a.hF=he;
a.hG=hn}function hH(d){if(!d){d=new ce()}var e=this,b=new e.constructor(),c,a;
bT(d,e,b);
for(c=0,a=bp(e.dv);
c<a;
c++){e.dv[c].cd(d)}for(c=0,a=bp(e.hI);
c<a;
c++){e.hI[c].cd(d)}for(c=0,a=bp(e.d5);
c<a;
c++){b.fY(d.cc(e.d5[c]),T)}for(c=0,a=bp(e.hJ);
c<a;
c++){b.hK(d.cc(e.hJ[c]),T)}for(c=0,a=bp(e.dv);
c<a;
c++){b.f2(d.cc(e.dv[c]),T)}for(c=0,a=bp(e.hI);
c<a;
c++){b.hL(d.cc(e.hI[c]),T)}b.dt=e.dt;
b.hM=e.hM;
if(e.eQ){for(c=0,a=bp(e.eQ);
c<a;
c++){b.eQ.push(e.eQ[c].cd())}}b.hN=e.hN;
b.eN=e.eN;
return b}function hO(d){for(var c=this,b=0,a=bp(c.d5);
b<a;
b++){c.d5[b].d1=d}for(b=0,a=bp(c.dv);
b<a;
b++){c.dv[b].d1=d}for(b=0,a=bp(c.hI);
b<a;
b++){c.hI[b].d1=am}c.eN=!d;
fn(c.d5);
fn(c.dv);
fn(c.hI)}function hP(){for(var d=this,c,b=0,a=bp(d.d5);
b<a;
b++){d.d5[b].d1=T}for(b=0,a=bp(d.hJ);
b<a;
b++){d.hJ[b].d1=am}for(b=0,a=bp(d.dv);
b<a;
b++){c=d.dv[b];
c.d1=(c.c9.d1||c.da.d1)&&!d.hQ(c)}d.eN=F;
fn(d.d5);
fn(d.dv);
fn(d.hI)}function hR(){for(var c=this,b=0,a=bp(c.d5);
b<a;
b++){c.d5[b].d1=am}for(b=0,a=bp(c.dv);
b<a;
b++){c.dv[b].d1=am}c.eN=am;
fn(c.d5);
fn(c.dv);
fn(c.hI)}function hS(b){var a=ca(this.d5,b);
if(a){b.ev=this}return a}function hT(a){if(this.type!=aw){return ca(this.hJ,a)}return F}function hU(a){return bY(this.hI,a)}function hV(b){if(bY(this.hI,b)){return F}var a=ca(this.dv,b);
if(a){b.ev=this}return a}function hW(c,b,a,d){if(bY(a,c[b].c9)){d[2*b]=c[b].c9;
d[2*b+1]=c[b].da}else{d[2*b]=c[b].da;
d[2*b+1]=c[b].c9}}function createGroup(){var d=st.gF(),b,c,a;

if(!d.hX){return}a=d.d5[0].eq;
hY(T);
if(bp(d.hI)<=1){c=prompt(s("supaQ"),"")}else{c=prompt(s("multQ"),"")}hY(F);
if(c==null){return}hZ();
b=a.h0(c,d.d5,d.dv,d.hI);
d.h1(b);
b.fd();
h2();
return b}function h3(c){for(var e,f,g,b,d=0,a=bp(this.eQ);
d<a;
d++){g=this.eQ[d].dS;
b=g.x+c*g.y;
if(e==am||b>f){e=g;
f=b}g=this.eQ[d].dR;
b=g.x+c*g.y;
if(b>f){e=g;
f=b}}return e}function h4(a){var d=a.d6(),h=d.cd(),g=d.cd(),f=a.c9.c_,e=a.da.c_,c=h5*(e.x-f.x),b=h5*(e.y-f.y);
h.cv(b,-c);
g.cv(-b,c);
this.eQ.push(new h6(h,g))}function h7(){this.eQ=[];
for(var b=0,a=bp(this.hI);
b<a;
b++){this.h8(this.hI[b])}}function h9(b){if($.isArray(b)){for(var c=0,a=bp(b);
c<a;
c++){this.hL(b[c])}}else{if(this.type!=av){if(bY(this.d5,b.c9)){this.hK(b.c9)}else{if(bY(this.d5,b.da)){this.hK(b.da)}}}b5(b,this.dv);
ca(this.hI,b)}}function h_(d){var e=this,b=[],c=0,a=bp(e.hJ);
if(d&&!e.eN&&a){for(;
c<a;
c++){b.push(e.hJ[c].c_)}}else{for(a=bp(e.d5);
c<a;
c++){b.push(e.d5[c].c_)}}if(e.eQ){for(c=0,a=bp(e.eQ);
c<a;
c++){b.push(e.eQ[c].dS,e.eQ[c].dR)}}b1(b,e.fy);
return b}function ia(){var a=this;
if(!a.de||!a.dc){fs.apply(a);
a.de.x-=ib;
a.de.y-=ib;
a.dc.x+=ib;
a.dc.y+=ib}}function ic(){if(st.hg()){return}switch(hh){case aT:if(hj){this.eq.ie(this);
break}}}function eO(c,a,d,b){if(!b){b=this.data(as)}hZ();
b.ig(b.eN);
b.eq.fz(bg);
eG=am;
ih(aZ);
ii(T);
b.fd();
h2();
return bo(c)}function ij(h){var c=this,g=c.eq,b=bH(c.dt),f,i,l,j,d=st.gF(),a,k;
hY(T);
if(c.type==au){b=prompt(s("supaQ"),b)}else{b=prompt(s("multQ"),b)}hY(F);
if(b==null){return}k=bm(b);
hZ();
if(c.type==av||(c.type==aw&&k<ik&&k>1)){if(c.type==av){f=c.hJ.concat()}else{f=c.d5.concat()}i=c.dv.concat();
l=c.hI.concat();
if(j=c.dI){d.ie(c)}c.il(l,i);
a=g.h0(b,f,i,l);
if(j){d.h1(a)}a.fd()}else{c.dt=b;
c.hM=k;
c.fd()}h2()}function eK(c,a,d,b){if(!b){b=this.data(as)}hZ();
b.il();
h2();
return bo(c)}function eM(){}function im(j,b,g){var e=j[bp(j)-1],d=0,c=bp(e.dv),h,f,a;
for(;
d<c;
d++){h=e.dv[d];
f=(h.c9.bS(e)?h.da:h.c9);
if(bY(j,f)){continue}if(h.bS(b)){return h}if(bY(g,f)){j.push(f);
a=im(j,b,g);
if(a){return a}j.pop()}}}function io(p,m){var c=this,k=c.eq,o,n,h,f,e,b,g,a,d=st.gF(),l;
if(c.type==av){o=c.hJ;
n=b9(c.d5,o);
if(!p){p=c.hI.concat()}if((b=bp(p))==2){for(e=0;
e<b;
e++){for(h=0,f=bp(o);
h<f;
h++){a=o[h];
g=im([a],p[e],n);
if(!g){continue}l=g.dI;
k.fH(g,T);
if(bY(n,g.c9)){g.c9=a}else{g.da=a}a.dv.push(g);
g.ev=am;
k.f2(g);
if(m){m.push(g)}if(l){d.f2(g)}}}for(h=0,f=bp(n);
h<f;
h++){k.fI(n[h],T)}}}if(c.bS(eG)){eG=am;
ih(aZ)}c.dx();
while(bp(c.d5)){g=c.d5.pop();
g.ev=am;
g.d1=am;
fo(g)}while(bp(c.dv)){g=c.dv.pop();
g.ev=am;
g.d1=am;
fo(g)}c.hJ=[];
fk(c,c.ip.iq);
fk(c,k.iq);
d.ie(c);
if(m){b2(m,k.dv);
b3(m,p)}}function ir(){if(!this.eq){return -1}return bZ(this.eq.iq,this)
}function it(b){for(var a=bp(b)-1;
a>=0;
a--){b[a]=bn(b[a])}this.eQ.push(new h6(new ck(b[0],-b[1]),new ck(b[2],-b[3])))}function iu(){if(!this.iv){var b=new ck(),d,c,a=bp(this.eQ);
if(a>1){for(c=0;
c<a;
c++){d=this.eQ[c];
b.cv(d.dS);
b.cv(d.dR)}b.x/=a*2;
b.y/=a*2}this.iv=b}return this.iv}function iw(){return new h6(this.dS.cd(),this.dR.cd())}function h6(b,a){this.dS=b;
this.dR=a;
this.cd=iw}function ix(e,b){if(!b){b=[]}else{if(bY(b,this)){return}}b.push(this);
var d=this,c,a;
if(e==bg){d.fy=am;
d.iv=am}if(e>bd&&e<bh){d.de=am;
d.dc=am;
for(c=0,a=bp(d.hI);
c<a;
c++){d.hI[c].fz(bg,b)}d.iy()}if(e!=bd){e=bg}for(c=0,a=bp(d.d5);
c<a;
c++){d.d5[c].fz(e,b)}for(c=0,a=bp(d.dv);
c<a;
c++){d.dv[c].fz(e,b)}b.pop()}function iz(){var a=this;
fi.apply(a);
a.d5=[];
a.hJ=[];
a.dv=[];
a.hI=[];
a.iA=0;
a.getIndex=ir;
a.fz=ix;
a.il=io;
a.fY=hS;
a.hK=hT;
a.hQ=hU;
a.f2=hV;
a.hL=h9;
a.d6=fc;
a.d3=ia;
a.ft=h_;
a.cd=hH;
a.c8=c8;
a.hF=ic;
a.hG=eM;
a.eT=ij;
a.fd=eF;
a.dD=fC}function iB(){iz.apply(this);
this.type=au;
this.iy=iC;
this.ig=hO}function iD(){var a=this;
iz.apply(a);
a.type=av;
a.eQ=[];
a.eS=h3;
a.iE=it;
a.h8=h4;
a.iy=h7;
a.eP=iu;
a.ig=hP}function iF(){iD.apply(this);
this.type=aw;
this.ig=hR}function iG(e){if(this.f0){return this.f0.cd(e)}if(!e){e=new ce()}var f=this,d,c,a,b;
if(e.fO){if(d=f.c9.d0){c=d}if(d=f.da.d0){a=d}}if(!c){c=e.cc(f.c9)}if(!a){a=e.cc(f.da)}b=new gB(c,a,f.dw,f.d8);
bT(e,f,b);
b.d1=f.d1;
b.ev=e.cc(f.ev);
b.dI=f.dI;
return b}function iH(){if(!this.fy){this.fy=cB(this.c9.c_,this.da.c_)}return this.fy}function iI(f,c){if(!c){c=[]}else{if(bY(c,this)){return}}c.push(this);
if(f==bg){this.fy=am}if(f<bh){var b=this.eq,d,a,e;
if(b){for(d=0,a=bp(b.iq);
d<a;
d++){e=b.iq[d];
if(bY(e.hI,this)){e.fz(bg,c)}}}}c.pop()}function iJ(){var b=this,a=b.dw;
a=(bs(ba,a)||a);
if(!b.c9||!b.da||b.c9.bS(b.da)){return""}return ao+bA(b.c9.getIndex()+1,3)+bA(b.da.getIndex()+1,3)+bA(a,3)+bA(b.d8,3)+bz(bA("0",3),3)}function iK(){if(!this.hu){var d=this,c,b,a;
if(!d.c9.ip){d.eq.iL(T)}c=d.c9.ip.d4();
d.hu=[];
for(b=0,a=bp(c);
b<a;
b++){if(bY(c[b].dv,d)){d.hu.push(c[b])}}}return this.hu}function iM(){var a=0;
if(this.d8){a+=4}switch(this.dw){case 2:a+=2;
break;
case 3:a--;
break}return a}function iN(b){for(var d,c=0,a=bp(b.dv);
c<a;
c++){d=b.dv[c];
if(d.dw==1){d.dw=2}else{d.dw=1}fo(d)}}function iO(){if(this.dw>2){return}var k=this.d4(),l,h=[],d,a,g,f,e,c,b;
for(g=0,f=bp(k);
g<f;
g++){d=k[g];
a=bp(d.dv);
if(a%4==2){l=F;
for(e=1;
e<a;
e++){b=d.dv[e].dw;
c=d.dv[e-1].dw;
if(c+b!=3||c<1||c>2||b<1||b>2){l=T;
break}}if(!l){h.push(d)}}}if(!bp(h)){return}d=h[0];
a=bp(d.dv);

for(g=1,f=bp(h);
g<f;
g++){if(bp(h[g].dv)<a){d=h[g];
a=bp(d.dv)}}return d}function iP(e,d){if(d){var a=3*ez,c=e.cU(d.c9.c_,T),b=e.cU(d.da.c_,T);
if(c<a&&c<b){return d.c9}else{if(b<a){return d.da}}}return am}function iQ(d){var e=this,c=e.c9,a=e.da,b;
if(e.ev&&e.ev.type==av){return}if(hm!=0&&hm==e.d8){e.c9=a;
e.da=c}else{if(hm!=0||hl!=1){e.dw=hl;
e.d8=hm}else{if(e.d8!=0){e.d8=0}else{b=e.dw;
e.dw=bG(M.floor(b)%M.min(3,c.hy(b),a.hy(b)))+1;
if(b==1&&e.dw==1){c.hz(a)||a.hz(c)}}}}c.fz(bh);
a.fz(bh);
if(!d){fo(e);
fo(c);
fo(a)}}function iR(){if(!this.eq){return -1}return bZ(this.eq.dv,this)}function iS(){var b=this,a=[];
iT(a,b.c9);
iT(a,b.da);
return a}function iT(a,b){if(b.ev){b0(a,b.ev.getAtoms())}else{a.push(b)}}function iU(a,b){if(b.ev){b0(a,b.ev.ft())}else{a.push(b.c_)}}function iV(b){var c=this,a=[];
if(!b||!this.d1){iU(a,c.c9);
iU(a,c.da)}return a}function iW(b,a){if(a){if(bY(a.dv,this)){return a}}else{a=new gx(T)}a.f2(this);
this.c9.hs(b,a);
this.da.hs(b,a);
return a}function iX(){var b=this,a=b.eq;
if(b.c9.f0){a=b.c9.f0.eq}else{if(b.f0){a=b.f0.eq}}return a}function iY(){return bq(this.c9.c_.z,this.da.c_.z)}function iZ(a){var b=this;
return(b.c9.bS(a)?b.da:b.c9)}function i0(){return this.da.c_.cA(this.c9.c_)}function i1(a){return this.c9.bS(a)||this.da.bS(a)}function gB(c,b,a,d){var e=this;
fi.apply(e);
e.c9=c;
e.da=b;
e.dw=a;
e.d8=d;
e.dI=F;
e.getIndex=iR;
e.fz=iI;
e.i2=iQ;
e.d6=iH;
e.getAtoms=iS;
e.ft=iV;
e.d4=iK;
e.i3=iO;
e.i4=iN;
e.i5=i1;
e.hC=iM;
e.hs=iW;
e.getMolecule=hD;
e.hE=iJ;
e.fd=dZ;
e.dD=iY;
e.cd=iG;
e.gS=iZ;
e.i6=i0;
e.c8=c8;
e.ep=fj;
e.db=iX;
e.d7=c7}function i7(g){g.sort(i8);
for(var b=[],d,c=[],e,f=0,a=bp(g);
f<a;
f++){e=g[f];
d=e.d5;
if(!i9(d)&&!b7(c,d)){b.push(e);
b_(c,d)}}return b}function i9(b){for(var d,c=0,a=bp(b);
c<a;
c++){d=b[c];
if(d.gr&&d.gr.gh){return T}}return F}function i8(e,c){var f=(e.d5?bp(e.d5):0),d=(c.d5?bp(c.d5):0);
if(f<d){return -1}if(f>d){return 1}return 0}function i_(e,c){var d=bp(e.d4()),f=bp(c.d4()),g,h;
if(d<f){return 1}if(d>f){return -1}g=bp(e.dv),h=bp(c.dv);
if(g<h){return 1}if(g>h){return -1}return 0}function ja(c){var e=this.d5,b=[],d,a,f;
if(c){b0(b,this.dv);
b0(b,e)}else{for(d=0,a=bp(e);
d<a;
d++){f=e[d];
b.push(f);
b_(b,f.dv);
ca(b,f.ev)}}return b}function jb(){if(!this.jc){for(var e=this,c=e.d6(),d=e.d5,b=bp(d)-1,a=d[0].c_.cA(c).cr(d[b].c_.cA(c));
b>0;
b--){a.cv(d[b].c_.cA(c).cr(d[b-1].c_.cA(c)))}if(c.e1(a.cN(c),d[0].c_,d[1].c_)>0){a.eU(-1)}e.jd=(e.jc=a.cC()).cd();
e.jd.cv(c)}}function je(a){var b=this;
b.jf();
return ad-b.fy.cs(a.c_,b.jd)}function jg(){for(var d=0,e=this.dv,b=bp(e),a,c=e[b-1].dw;

d<b;
d++){a=e[d].dw;
if(a==3||(a==2&&c==2)){return T}c=a}}function jh(){for(var b=0,c=this.dv,a=bp(c);
b<a;
b++){if(c[b].dw!=1){return F}}return T}function ji(){if(!this.fy){var b=new ck(),e=this.d5,d=0,c,a;
for(c=0,a=bp(e);
c<a;
c++){b.cv(e[c].c_);
d++}if(d>1){b.x/=d;
b.y/=d;
b.z/=d}this.fy=b}return this.fy}function jj(e){var c=this,b=[],d=[],h,k,g,f,a;
for(k=0,g=bp(c.d5);
k<g;
k++){h=c.d5[k];
if(!e||!h.d1){b.push(h.c_)}ca(d,h.ev)}for(k=0,g=bp(d);
k<g;
k++){h=d[k];
if(h.eQ){for(f=0,a=bp(h.eQ);
f<a;
f++){b.push(h.eQ[f].dS,h.eQ[f].dR)}}if(!e){b1(b,h.fy);
b1(b,h.de);
b1(b,h.dc)}}if(!e){b1(b,c.fy);
b1(b,c.de);
b1(b,c.dc)}return b}function jk(f){if(!(f instanceof jl)){return F}var k=this.d5,a=bp(k),g,e,h,d,c,b;
if(a!=bp(f.d5)){return F}g=bZ(f.d5,k[0]);
if(g==-1){return F}e=bZ(f.d5,k[1]);
if(e==-1){return F}h=e-g;
if(M.abs(h)==a-1){h=-1}if(M.abs(h)!=1){return F}for(d=2,c=a;
d<c;
d++){b=(c+d*h+g)%c;
if(!k[d].bS(f.d5[b])){return F}}return T}function jm(d,b){if(!b){b=[]}else{if(bY(b,this)){return}}if(d!=bf){b.push(this);
this.jc=am;
if(d==bg){this.fy=am}if(d!=bd){d=bg}for(var c=0,a=bp(this.d5);
c<a;
c++){this.d5[c].fz(d,b)}for(c=0,a=bp(this.dv);
c<a;
c++){this.dv[c].fz(d,b)}b.pop()}}function jn(){var a=this.d5,b=a.concat(),c;
b.sort(i_);
c=bZ(a,b[0]);
b6(a,c);
if(bZ(b,a[1])>bZ(b,a[bp(b)-1])){a.reverse();
b6(a,-1)}}function jl(a,c){var b=this;
b.bQ=bL();
b.d5=a;
b.dv=c;
b.jo=jn;
b.dE=ja;
b.fz=jm;
b.d6=ji;
b.jf=jb;
b.jp=je;
b.jq=jg;
b.jr=jh;
b.ft=jj;
b.bS=jk}function js(b){var a=ca(this.d5,b);
if(a){b.ip=this}return a}function jt(a){return ca(this.dv,a)}function ju(){for(var b=[],c=0,a=bp(this.d5);
c<a;
c++){b.push(this.d5[c].c_.cd())}return b}function jv(c){var b=0,a=bp(this.d5);
if(bp(c)!=a){alert("Error")}for(;
b<a;
b++){this.d5[b].c_=c[b].cd()}}function jw(g,e,j){var a=bp(e),c=e[a-1],l,f,k,d,b,h;
if(a<=jx){for(d=0,b=bp(c.dv);
d<b;
d++){l=c.dv[d];
f=(c.bS(l.c9)?l.da:l.c9);
if(a>=2&&f.bS(e[a-2])){continue}h=-1;
j[a-1]=l;
if(a>=2){h=bZ(e,f)}if(h==-1){e[a]=f;
jw(g,e,j);
e.length=a}else{k=new jl(e.slice(h),j.slice(h));
ca(g,k)}}}j.length=a-1;
return g}function jy(){var c=this;
if(!c.hu){c.hu=[];
for(var c=this,b=0,a=bp(c.dv);
b<a;
b++){c.dv[b].hu=am}if(bp(c.d5)){jw(c.hu,[c.d5[0]],[])}}return c.hu}function jz(){var a=this;
e5.apply(a);
a.d5=[];
a.iq=[];
a.dv=[];
a.fz=jA;
a.d4=jy;
a.dE=jB;
a.ft=jC;
a.eU=jD;
a.d3=fs;
a.gD=jE;
a.cC=jF;
a.jG=jH;
a.fY=js;
a.f2=jt;
a.jI=ju;
a.jJ=jv}function jK(t,n,b,h,f,k){if(f){n=f.c_}if(k){b=k.c_}if(!n||!b){return F}var a=eD*1.4,u=b.cU(n),o=M.min(M.round(u/a/M.cos(jL*ag)),jM),d,g=jL,l=[],j=[],r,q,c,m,p;
if(o<=0){return F}d=n.cP(b);
if(k){if(o>1){g=M.acos(bJ(u/o/a,-0.9,0.9))/ag}}gA.gb();
if(o==1){if(f&&(c=f.hw(k))){if(!h){c=gA.f2(c)}c.i2();
gA.fd();
return T}else{d+=g}}else{if(o%2){d+=g/(o-1)}}l[0]=M.cos((d-g)*ag);
l[1]=M.cos((d+g)*ag);

j[0]=M.sin((d-g)*ag);
j[1]=M.sin((d+g)*ag);
if(k){o--}if(h){m=st.gF();
if(!t.ctrlKey){m.jN()}if(f){r=f;
h=f.eq}else{r=new gy(n.cd());
h.fY(r);
m.fY(r)}}else{if(f){r=gA.fY(f)}else{r=gA.fY(new gy(n.cd()))}aZ.jO.push(aZ.text(b.x,b.y+30/eH,o+(f?0:1)).attr(aA,2+20/eH))}if(!f){r.gH(hi(),T)}for(p=0;
p<o;
p++){q=r.cd();
if(p==0){q.gH(hi(),T)}q.c_.x+=a*l[p%2];
q.c_.y+=a*j[p%2];
if(!h){q=gA.fY(q)}c=new gB(r,q,1,0);
if(h){h.fY(q);
h.f2(c);
m.f2(c);
m.fY(q)}else{c=gA.f2(c)}r=q}if(k){if(h){c=h.f4.jP(r,k,1,0);
m.f2(c)}else{q=gA.fY(k);
c=gA.f2(new gB(r,q,1,0))}}gA.fd();
return T}function jQ(d){if(!d){d=new ce()}var e=this,b=new fJ(),c,a;
bT(d,e,b);
b.jR=2;
for(c=0,a=bp(e.iq);
c<a;
c++){b.h1(d.cc(e.iq[c]),T)}for(c=0,a=bp(e.dv);
c<a;
c++){b.f2(d.cc(e.dv[c]),T)}for(c=0,a=bp(e.d5);
c<a;
c++){b.fY(d.cc(e.d5[c]),T)}b.es=d.cc(e.es);
b.jR=1;
b.iL();
return b}function jA(e,b){if(!b){b=[]}else{if(bY(b,this)){return}}var d=this,c,a;
b.push(d);
if(e>be){d.fy=am;
d.fF=am}if(e>bd&&e<bh){d.de=am;
d.dc=am}if(e!=bf){if(e!=bd){e=bg}for(c=0,a=bp(d.d5);
c<a;
c++){d.d5[c].fz(e,b)}for(c=0,a=bp(d.dv);
c<a;
c++){d.dv[c].fz(e,b)}if(d.iq){for(c=0,a=bp(d.iq);
c<a;
c++){d.iq[c].fz(e,b)}}if(d.jS){for(c=0,a=bp(d.jS);
c<a;
c++){d.jS[c].fz(e,b)}}if(d.hu){for(c=0,a=bp(d.hu);
c<a;
c++){d.hu[c].fz(e,b)}}}if(d.f4){d.f4.fz(e,b)}else{if(d.eq){d.eq.fz(e,b)}}b.pop()}function jT(f){if(!bp(this.d5)){return}this.d3();
if(f.x>this.de.x&&f.x<this.dc.x){var e=this,c=new jU(e),d,a,b;
if(!e.jS){e.iL()}if(bp(e.d5)<2){return}for(d=0,a=bp(e.jS);
d<a;
d++){b=e.jS[d];
b.d3();
if(0.5*(b.de.x+b.dc.x)>f.x){c.jV.push(b)}else{c.jW.push(b)}}return c}}function jD(d,b){if(b){b=this.d6()}for(var e=this.ft(),c=0,a=bp(e);
c<a;
c++){e[c].eU(d,b)}}function jF(){if(bp(this.d5)>1){var h=this,e=0,g=0,d,a,c,f,b;
if(a=bp(h.dv)){for(d=0;
d<a;
d++){f=h.dv[d];
e+=f.c9.c_.cU(f.da.c_);
g++}}else{for(d=0,a=bp(h.d5);
d<a;
d++){b=h.d5[d];
for(c=0;
c<d;
c++){e+=b.c_.cU(h.d5[c].c_);
g++}}}if(e>0){h.eU(dd*g/e)}}this.d3()}function jX(c,d){var b=c-this.de.x,a=bG(d)-0.5*(this.de.y+this.dc.y);
this.cv(b,a)}function jY(d,b){var e=this,c,a;
if(!e.bS(d)){for(c=0,a=bp(d.d5);
c<a;
c++){e.fY(d.d5[c])}for(c=0,a=bp(d.dv);
c<a;
c++){e.f2(d.dv[c])}for(c=0,a=bp(d.iq);
c<a;
c++){e.h1(d.iq[c])}if(e.hu&&d.hu){b0(e.hu,d.hu)}else{e.jZ()}e.iL();
if(b||er=="tmpl"){e.es=d.es}e.fz(bg)}}function j0(c,b){var d=this,a;
if(ca(d.d5,c)){c.eq=d;
c.d2=am;
c.fp=am;
if(!b){fo(c);
a=d.j1();
a.fz(bf);
if(a.f0){a.f0.fz(bf)}}return T}return F}function j2(h,c,g,m){var u=this,l,p,n,o,t,d,f,e=[],k=[],a=[],q=[],b,r=bp(m);
if(r<=1){l=new iB();
if(r){l.hK(m[0].c9.dI?m[0].c9:m[0].da)}}else{if((n=bm(h))<ik&&n>1){l=new iD();
u.fH(m[0],T);
u.fH(m[1],T);
b0(e,c);
b0(k,g);
b3(k,m);
hW(m,0,e,a);
hW(m,1,e,a);
for(p=0;
p<n;
p++){if(p>0){b=new ce();
q[p]=b}for(o=0,t=bp(k);
o<t;
o++){d=k[o];
if(p==0){l.f2(d);
ca(e,d.c9);

ca(e,d.da)}else{f=b.cc(d);
l.f2(f);
u.f2(f,T)}}for(o=0,t=bp(e);
o<t;
o++){d=e[o];
if(p==0){l.fY(d);
l.hK(d)}else{f=b.cc(d);
l.fY(f);
u.fY(f,T)}}}for(p=0;
p<=n;
p++){if(p==0){f=new gB(a[1],a[0],m[0].dw,m[0].d8);
m[0]=f}else{if(p==n){f=new gB(q[p-1].cc(a[2]),a[3],m[1].dw,m[1].d8);
m[1]=f}else{if(p==1){f=new gB(a[2],q[p].cc(a[0]),m[1].dw,0)}else{f=new gB(q[p-1].cc(a[2]),q[p].cc(a[0]),m[1].dw,0)}}}l.f2(f);
u.f2(f,T)}}else{l=new iF();
if(n){l.hN=""}else{l.hN="HT"}}}l.hL(m);
if(l.type!=av){for(o=0,t=bp(g);
o<t;
o++){l.f2(g[o])}for(o=0,t=bp(c);
o<t;
o++){l.fY(c[o])}}l.dt=h;
l.hM=n;
l.iy();
u.h1(l);
l.ig(T);
return l}function j3(c,b){if(ca(this.iq,c)){c.eq=this;
var a;
if(c.d5[0]&&(a=c.d5[0].ip)){c.ip=a;
ca(a.iq,c)}c.d2=am;
c.fp=am;
if(!b){fo(c)}return T}return F}function j4(d,c){if(d.bS(c)){return}fo(c);
this.fz(bh);
if(bY(this.d5,c)){fk(d,this.d5)}else{b4(this.d5,d,c);
fk(d)}var f=this,a,e,b;
for(a=bp(d.dv)-1;
a>=0;
a--){e=d.dv[a];
fo(e);
if(e.c9.bS(d)){e.c9=c;
fo(e.da)}else{if(e.da.bS(d)){e.da=c;
fo(e.c9)}}ca(c.dv,e)}c.fz(bh);
if(!d.dT){b=st.gF();
b4(b.d5,d,c);
c.dI=d.dI}if(d.bS(f.es)){f.es=c}f.jZ();
f.iL();
if(d.bS(eu)||c.bS(eu)){ii()}}function j5(d,h){var g=this,b,f,c=st.gF(),e,a=d.ip;
g.fz(bg);
fk(d,g.d5);
for(b=bp(d.dv)-1;
b>=0;
b--){f=d.dv[b];
if(f){g.fH(f,h)}}g.j6(d);
b5(d,c.d5);
if(d.bS(g.es)){g.es=am}if(g){if(a){b5(d,a.d5);
if(!bp(a.d5)){fk(a,g.jS)}}if(!bp(g.d5)&&(e=g.f4)){e.j7(g)}}if(d.bS(eu)){eu=am;
ii()}}function j8(d){var e=this;
e.fz(bg);
d.dx();
fk(d,e.iq);
var a,c,b=st.gF();
for(a=bp(d.dv)-1;
a>=0;
a--){c=d.dv[a];
if(c){e.fH(c)}}for(a=bp(d.d5)-1;
a>=0;
a--){c=d.d5[a];
if(c){e.fI(c)}}e.j6(d);
b5(d,b.iq);
if(d.bS(eG)){eG=am;
ii()}}function j9(e,d){var f=this,b=e.c9,a=e.da,c;
if(!b||!a){return F}if(ca(f.dv,e)){e.eq=f;
e.d2=am;
e.fp=am;
ca(e.c9.dv,e);
ca(e.da.dv,e);
if(f.jR==1){c=e.c9.ip;
if(!c){if(!e.da.ip){f.iL()}else{c=e.da.ip;
e.ip=c;
e.c9.ip=c;
ca(c.dv,e);
ca(c.d5,e.c9)}}else{if(!e.da.ip){e.ip=c;
e.da.ip=c;
ca(c.dv,e);
ca(c.d5,e.da)}else{if(!c.bS(e.da.ip)){f.iL()}else{f.jZ();
ca(c.dv,e)}}}}e.c9.fz(bh);
e.da.fz(bh);
if(!d){fn(e.c9.dv);
fn(e.da.dv);
fo(e.c9);
fo(e.da)}return T}return F}function j_(c,b){if(bY(this.dv,b)){fk(c,this.dv)}else{b4(this.dv,c,b);
fk(c)}if(bY(c.c9.dv,b)){b5(c,c.c9.dv)}else{b4(c.c9.dv,c,b)}if(bY(c.da.dv,b)){b5(c,c.da.dv)}else{b4(c.da.dv,c,b)}fo(b);
c.c9.fz(bh);
c.da.fz(bh);
fo(c.c9);
fo(c.da);
fn(c.c9.dv);
fn(c.da.dv);
this.fz(bh);
var a=st.gF();
b4(a.dv,c,b);
b.dI=c.dI;
this.jZ();
this.iL()}function ka(){for(var c=this,b=0,a=bp(c.dv);
b<a;
b++){c.dv[b].hu=am}for(b=0,a=bp(c.d5);
b<a;
b++){c.d5[b].hu=am}if(c.jS){for(b=0,a=bp(c.jS);
b<a;
b++){c.jS[b].hu=am}}c.hu=am}function kb(f,h){var g=this,d=st.gF(),c,a,e,b=f.c9.ip;

if(!b){b=f.da.ip}fk(f,g.dv);
b5(f,f.c9.dv);
b5(f,f.da.dv);
f.c9.fz(bh);
f.da.fz(bh);
fo(f.c9);
fo(f.da);
fn(f.c9.dv);
fn(f.da.dv);
g.fz(bg);
if(h){if(b){b5(f,b.dv)}}else{g.iL();
g.jZ()}g.j6(f);
d.fH(f);
for(c=0,a=bp(g.iq);
c<a;
c++){e=g.iq[c];
if(bY(e.hI,f)){if(e.type!=au){b5(f,e.hI)}else{e.il()}}}}function kc(e,b){e.ip=b;
b.d5.push(e);
if(ca(b.iq,e.ev)){e.ev.ip=b}var c,a,d;
for(c=0,a=bp(e.dv);
c<a;
c++){d=e.dv[c];
ca(b.dv,d);
if(!d.c9.ip){kc(d.c9,b)}else{if(!d.da.ip){kc(d.da,b)}}}}function kd(d){if(d||!gA||gA.gc()){var e=this;
e.jS=[];
for(var b,c=0,a=bp(e.d5);
c<a;
c++){e.d5[c].ip=am}for(c=0,a=bp(e.d5);
c<a;
c++){if(!e.d5[c].ip){b=new jz();
e.jS.push(b);
b.eq=e;
kc(e.d5[c],b)}}}}function eB(b,a,c){if(c){return b.c_.cP(a.c_,c.c_)}else{return b.c_.cP(a.c_)}}function ke(b,a,c){if(c){return b.c_.cs(a.c_,c.c_)}else{return b.c_.cs(a.c_)}}function gz(l,q,n,m){var o,b=eD*1.4,c,d,r,p=[],h,g,f,a=3*kf,k=l.c_;
if(n){n.z=k.z}if(n&&m&&m.ctrlKey){if(m.shiftKey){return n}o=k.cP(n);
c=c3(k,o,b)}else{if(n&&m&&m.shiftKey){b=k.cU(n)}if(n!==F&&!hm&&(!m||!m.altKey)&&(f=bp(l.dv))>1&&f<4&&q==1){for(h=0;
h<f;
h++){g=l.dv[h];
if(g.dw>1){h=f+1;
break}r=g.gS(l);
for(g=h+1;
g<f;
g++){if(M.abs(aj-k.cs(r.c_,l.dv[g].gS(l).c_))>6){h=f+1;
break}}}if(h==f){h=l.dv[0].gS(l).c_;
g=l.dv[1].gS(l).c_;
c=k.eY(h,g,b,0.5*aj);
r=k.eY(h,g,b,-0.5*aj);
f=l.eq;
if(n){h=n.cU(c);
g=n.cU(r)}else{h=f.gD(c);
g=f.gD(r)}if(g<h||(g==h&&k.eZ(r)>k.eZ(c))){c=r}f.kg(l,c)}}if(!c){o=l.gC(q,n);
do{c=c3(k,o,b);
d=l.eq.f4.kh(c,a,a);
if(!d||!bp(d)){break}for(h=0;
h<bp(d);
h++){p.push(new gM(l,d[h]))}o=l.gV(n,p)}while(bp(p)<10);
if(f>2||!l.hx()){a=0;
for(h=f-1;
h>=0;
h--){d=l.dv[h].gS(l);
a+=(d.c_.z-k.z)/(M.abs(o-eB(l,d))+1)}c=c2(k,o,(a>0?-30:30),b)}}}return c}function ki(c,a,b){if(bG(b)!=0){return at+c+bA("1",3)+S+bA(a+1,3)+S+bA(M.round(b),3)}else{return""}}function kj(){var c=this,f,e,d,b,k,g,h=[],a=ab+ao+Number(new Date())+ao+navigator.userAgent+ao+bA(bp(c.d5),3)+bA(bp(c.dv),3)+bz(ap,8)+(er=="rxn"?ap:"999")+" V2000";
for(f=0,e=bp(c.d5);
f<e;
f++){a+=c.d5[f].hE()}for(f=0,e=bp(c.dv);
f<e;
f++){a+=c.dv[f].hE()}for(f=0,e=bp(c.d5);
f<e;
f++){a+=ki("CHG",f,c.d5[f].eo());
a+=ki("RAD",f,c.d5[f].dr);
a+=ki("ISO",f,c.d5[f].ds)}if(er=="tmpl"&&c.es){a+=at+"ATT"+bA("1",3)+S+bA(c.es.getIndex(),3)+S+a3.val()+S+a4.val()}for(f=0,e=bp(c.iq);
f<e;
f++){k=c.iq[f];
if(!(b=bp(k.d5))){continue}a+=at+"STY"+bA("1",3)+S+bA(f+1,3)+S+k.type;
if(k.type==aw&&k.hN){a+=at+"SCN"+bA("1",3)+S+bA(f+1,3)+S+k.hN}for(d=0;
d<b;
d++){a+=(d%15?"":at+"SAL "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.d5[d].getIndex()+1),4)}if(k.type==av){for(d=0,b=bp(k.hJ);
d<b;
d++){a+=(d%15?"":at+"SPA "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.hJ[d].getIndex()+1),4)}}if(k.eQ){for(d=0,b=bp(k.eQ);
d<b;
d++){g=k.eQ[d];
a+=at+"SDI "+bA(f+1,3)+bA(4,3)+gn(g.dS.x)+gn(-g.dS.y)+gn(g.dR.x)+gn(-g.dR.y)}}for(d=0,b=bp(k.hI);
d<b;
d++){a+=(d%15?"":at+"SBL "+bA(f+1,3)+bA(M.min(b-d,15),3))+bA((k.hI[d].getIndex()+1),4)
}a+=at+"SMT "+bA(f+1,3)+S+bH(k.dt);
if(k.eN){h.push(k)}}for(d=0,b=bp(h);
d<b;
d++){a+=(d%15?"":at+"SDS EXP"+bA(M.min(b-d,15),3)+S)+bA(h[d].getIndex()+1,3)}for(f=0,e=bp(c.kk);
f<e;
f++){a+=ao+c.kk[f]}a+=at+"END\n";
return a}function kl(b,a,d){var c=b.attributes[a];
if(c){c=c.value;
if(d){a=d[c];
if(a!=am){c=a}}return c}}function km(b,a,c){var d=bm(kl(b,a));
if(c){if(d in c){d=c[d];
if(d in c){d=c[d]}}}return d}function kn(q,p){for(var d=new fJ(),m=p.find("n"),l,k=0,h=bp(m),g,c,b,a,e,o={},f={},n;
k<h;
k++){e=m[k];
if((b=kl(e,"NodeType"))==am||bj[b]!=am){a=kl(e,"p");
c=bv(a);
n=new gy(new ck(bn(c[0]),bn(c[1]),bn(kl(e,"Z"))));
n.gq=bG(km(e,"Charge"));
n.gK(gl[bF(km(e,"Element"),6)]);
n.ko=km(e,"id");
n.dr=bG(km(e,"Radical",bk));
n.ds=bF(km(e,"Isotope"),am);
n.du=bF(km(e,"NumHydrogens"),am);
m[k]=n;
d.fY(n);
o[n.ko]=n}else{if(b=="ExternalConnectionPoint"){c=$(e).parents("n:first");
if(bp(c)){b=km(e,"id");
a=km(c[0],"id");
f[b]=a;
f[a]=b}}}}l=p.find("b");
c=$.extend({},f);
for(k=0,h=bp(l);
k<h;
k++){e=l[k];
b=km(e,"B");
a=km(e,"E");
if(b in c){f[c[b]]=a}if(a in c){f[c[a]]=b}}for(k=0,h=bp(l);
k<h;
k++){e=l[k];
b=o[km(e,"B",f)];
a=o[km(e,"E",f)];
c=bm(kl(e,"Display",bl));
if(c==4||c==7||c==12){n=a;
a=b;
b=n;
c--}n=new gB(b,a,bF(bn(kl(e,"Order")),(c==1?0:1)),bG(bb[c]));
n.ko=km(e,"id");
o[n.ko]=n;
d.f2(n)}for(k=0,h=bp(m);
k<h;
k++){e=m[k];
if(e.attributes){if(kl(e,"NodeType")=="Fragment"){e=$(e);
b=[];
a=[];
c=e.find("n");
for(g=bp(c)-1;
g>=0;
g--){n=o[km(c[g],"id")];
if(n){b.push(n)}}l=[];
c=e.find("b");
for(g=bp(c)-1;
g>=0;
g--){a.push(n=o[km(c[g],"id")]);
if(n.c9&&n.da&&(!bY(b,n.c9)||!bY(b,n.da))){l.push(n)}}c=e.find("s").text();
if(bp(b)){b[0].eq.h0(c,b,a,l)}}}}l=q.find("page:first > bracketedgroup");
for(k=0,h=bp(l);
k<h;
k++){e=l[k];
if(kl(e,"BracketUsage")=="MultipleGroup"){c=bv(kl(e,"BracketedObjectIDs"));
b=[];
a=[];
for(g=bp(c)-1;
g>=0;
g--){n=o[bm(c[g])];
if(n){if(n.c9){a.push(n)}else{b.push(n)}}}n=[];
c=$(e).find("crossingbond");
for(g=bp(c)-1;
g>=0;
g--){n.push(o[km(c[g],"BondID")])}c=bG(km(e,"RepeatCount"));
if(c<=1){c=bF(kl(e,"SRULabel"),"n")}if(bp(b)){b[0].eq.h0(c,b,a,n)}}}return d}function kp(t){var h=new fJ(),a=t.split(ao),p=0,m=bp(a),o,u,n,y,q={},c,d,b,x,w,f,g,l,v;
h.jR=0;
do{if(p<m){p++}else{return am}}while(a[p]!=am&&!bx(a[p],"V2000"));
c=bu(a[p],[3,3]);
for(o=0,u=bm(c[0]);
o<u;
o++){p++;
d=bu(a[p],[10,10,10,1,3,2,3,3,3,3,3,3,3,3,3,3]);
b=new gy(new ck(bn(d[0]),-bn(d[1]),bn(d[2])));
l=bm(d[6]);
if(l!=0){b.gq=4-l}b.gK(d[4]);
b.du=bm(d[8])-1;
if(b.du<0){b.du=am}b.gt=bm(d[10]);
if(b.gt>=15){b.gt=0}else{if(b.gt==0){b.gt=am}}if(d[5]!="0"&&b.gr){b.ds=M.round(b.gr.m)+bm(d[5])}h.fY(b)}for(o=0,u=bm(c[1]);
o<u;
o++){p++;
d=bu(a[p],[3,3,3,3,3,3,3]);
x=h.d5[bm(d[0])-1];
w=h.d5[bm(d[1])-1];
if(!x||!w||x.bS(w)){continue}l=bm(d[2]);
if(ba[l]!=am){l=ba[l]}f=new gB(x,w,l,bm(d[3]));
h.f2(f)}while(p<m){p++;
d=bv(a[p]);
switch(d[1]){case"CHG":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d5[bm(d[2*o+3])-1];
b.gq=l}}}catch(r){}break;
case"ISO":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d5[bm(d[2*o+3])-1];

b.ds=l}}}catch(r){}break;
case"RAD":u=bG(bm(d[2]));
try{for(o=0;
o<u;
o++){l=bm(d[2*o+4]);
if(!isNaN(l)){b=h.d5[bm(d[2*o+3])-1];
b.dr=l}}}catch(r){}break;
case"ATT":try{h.es=h.d5[bm(d[3])];
h.a3=bH(d[4]).split(",");
h.a4=bH(d[5])}catch(r){}break;
case"STY":u=3+2*bG(bm(d[2]));
try{for(o=3;
o<u;
o+=2){l=d[o+1].toUpperCase();
v=bm(d[o]);
if(l=="GEN"){l=aw}if(l==au){g=new iB()}else{if(l==av){g=new iD()}else{if(l==aw){g=new iF()}else{continue}}}h.h1(g);
q[v]=g}}catch(r){}break;
case"SCN":u=3+2*bG(bm(d[2]));
try{for(o=3;
o<u;
o+=2){v=bm(d[o]);
g=q[v];
if(g.type==aw){g.hN=d[o+1].toUpperCase()}}}catch(r){}break;
case"SDI":v=bm(d[2]);
try{g=q[v];
if(g&&g.iE){g.iE(d.slice(4))}}catch(r){}break;
case"SAL":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){g.fY(h.d5[bm(d[o])-1])}}}catch(r){}break;
case"SPA":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){g.hK(h.d5[bm(d[o])-1])}}}catch(r){}break;
case"SBL":v=bm(d[2]);
try{g=q[v];
if(g){for(o=4,u=bp(d);
o<u;
o++){f=h.dv[bm(d[o])-1];
g.hL(f)}}}catch(r){}break;
case"SDS":l=a[p].substr(13);
try{for(o=0,u=bp(l);
o<u;
o+=3){v=bm(bt(l.substr(o,3)));
g=q[v];
if(g){g.ig(F)}}}catch(r){}break;
case"SMT":v=bm(d[2]);
try{g=q[v];
if(g){g.dt=d[3].replace(/^[\s\^]+|[\s\^]+$/g,"");
g.hM=bm(d[3]);
if(g.hM){g.hN=""}}}catch(r){}break;
case"END":p=m;
break;
default:h.kk.push(a[p])}}for(p=0,m=bp(h.d5);
p<m;
p++){b=h.d5[p];
b.ha();
if(b.gq==b.g3){b.gq=am}if((b.dt=="N"&&b.gW()==5)||(b.dt=="S"&&b.gW()==4)){for(o=0,u=bp(b.dv);
o<u;
o++){f=b.dv[o];
if(f.dw==2&&(x=f.gS(b))&&x.dt=="O"&&x.eo()==0){b.gY((b.g3==2&&x.eo()==0)?-1:1);
f.dw--;
x.gY(-1);
break}}}}for(p=0,m=bp(h.iq);
p<m;
p++){g=h.iq[p];
for(o=0,u=bp(g.d5);
o<u;
o++){b=g.d5[o];
for(n=0,y=bp(b.dv);
n<y;
n++){g.f2(b.dv[n])}}if(g.type==au&&!bp(g.hI)){b_(g.hJ,g.d5)}if(g.type!=av){for(o=0,u=bp(g.hJ);
o<u;
o++){b=g.hJ[o];
for(n=0,y=bp(b.dv);
n<y;
n++){f=b.dv[n];
if(!bY(g.d5,(f.c9.bS(b)?f.da:f.c9))){b5(f,g.dv)}}}}if(g.eN==am){g.ig(T)}}h.jR=1;
h.iL();
return h}function kq(){if(!this.hu){if(!this.jS){this.iL()}this.hu=[];
for(var b=0,a=bp(this.jS);
b<a;
b++){b0(this.hu,this.jS[b].d4())}}return this.hu}function kr(){var a=this;
if(a.ec){return a.ec}if(a.f4){return a.f4.c8()}}function jB(b){var c=this,a;
if(!c.fF){a=[];
b0(a,c.dv);
b0(a,c.d5);
b0(a,c.iq);
c.fF=a}return c.fF}function jE(e,a){var c=0,d,b;
if($.isArray(e)){for(b=bp(e)-1;
b>=0;
b--){c+=this.gD(e[b].c_,a)}}else{for(b=bp(this.d5)-1;
b>=0;
b--){d=ks-this.d5[b].c_.cU(e,a);
if(d>0){c+=kt*d*d}}}return c}function ku(c,h){var e,b,g,d=h,a=this.gD(h,T),f=0;
if(a>0){e=h.cd();
b=h.cd();
while(f++<10){e.eV(ag,c.c_);
if((g=this.gD(e,T))<a){a=g;
d=e.cd()}b.eV(-ag,c.c_);
if((g=this.gD(b,T))<a){a=g;
d=b.cd()}if(a==0){break}}f=h.cU(d);
h.x=d.x;
h.y=d.y}return f}function kv(){var d=this,c,b,a,e;
if(!d.de||!d.dc){fs.apply(d);
for(b=0,a=bp(d.iq);
b<a;
b++){c=d.iq[b];
if(c.type==au){e=0.4*kw*bp(c.dt);
fw(d,c.fy.y-e);
fw(d,c.fy.y+e)}}}}function jC(e){var h=this,b=[],g,d,a,c,f;
for(d=0,a=bp(h.d5);
d<a;
d++){g=h.d5[d];
if(!e||!g.d1){b.push(g.c_)}}if(!e){if(h.jS){for(d=0,a=bp(h.jS);

d<a;
d++){b1(b,h.jS[d].fy)}}if(h.hu){for(d=0,a=bp(h.hu);
d<a;
d++){b1(b,h.hu[d].fy)}}}for(d=0,a=bp(h.iq);
d<a;
d++){g=h.iq[d];
if(g.eQ){for(c=0,f=bp(g.eQ);
c<f;
c++){b.push(g.eQ[c].dS,g.eQ[c].dR)}}if(!e){b1(b,g.fy);
b1(b,g.de);
b1(b,g.dc)}else{if(g.type==au){b1(b,g.d6())}}}if(!e){b1(b,h.fy);
b1(b,h.de);
b1(b,h.dc)}return b}function kx(b,a){this.gN=b;
this.ky=a}function kz(){for(var b=[],e,d,f,c=0,a=bp(this.d5);
c<a;
c++){e=this.d5[c];
if((d=e.gr)&&d.gi){f=d.gi+e.eo()-e.gW();
if(f>0){b.push(new kx(e,f))}}}return b}function kA(){if(!this.f4){return -1}return bZ(this.f4.f8,this)}function hD(){return this.eq}function kB(){return(this.f4?this.f4:this)}function jU(a){this.eq=a;
this.jW=[];
this.jV=[]}function fJ(){var a=this;
e5.apply(a);
a.d5=[];
a.iq=[];
a.dv=[];
a.kk=[];
a.jR=1;
a.iL=kd;
a.d4=kq;
a.fz=jA;
a.jZ=ka;
a.kj=kj;
a.kC=kz;
a.eU=jD;
a.d3=kv;
a.gD=jE;
a.kg=ku;
a.cC=jF;
a.jX=jX;
a.fY=j0;
a.h1=j3;
a.h0=j2;
a.gG=j4;
a.removeAtom=j5;
a.fI=j5;
a.ie=j8;
a.f2=j9;
a.kD=j_;
a.fH=kb;
a.fM=jY;
a.kE=jT;
a.jG=kF;
a.dE=jB;
a.j6=fE;
a.ft=jC;
a.getIndex=kA;
a.cd=jQ;
a.j1=kB;
a.ep=fj;
a.c8=kr}function kG(d){if(!d){d=new ce()}var e=this,b=new fL(e.ec),c,a;
bT(d,e,b);
for(c=0,a=bp(e.f8);
c<a;
c++){b.fM(e.f8[c].cd(d))}for(c=0,a=bp(e.kH);
c<a;
c++){b.kI(e.kH[c].cd(d),T)}b.kJ=e.kJ;
if(e.fQ){b.fQ=e.fQ.cd(d);
b.fQ.f4=b}b.kK=e.kK.cd(d);
return b}function kL(b){if(!b){b=new ce()}var c=this,a=new kM(c.c_.x,c.c_.y);
bT(b,c,a);
a.dI=c.dI;
return a}function kN(b){if(!b){b=new ce()}var c=this,a=new fU(c.dS.cd(),c.dR.cd());
bT(b,c,a);
a.dI=c.dI;
a.f4=b.cc(c.f4);
return a}function kO(){return cB(this.dS,this.dR)}function kP(a){a.dx();
return b5(a,this.f8)}function kQ(a,c,b){var d=this;
if(er=="rxn"||!bp(d.f8)){if(ca(d.f8,a)){a.f4=d;
if(c){d.kR()}}}else{d.f8[0].fM(a,b)}}function kS(){this.kT();
this.kU();
this.kV()}function kW(){if(er!="rxn"){return}var c=this,f,e,g,a=c.f8,b,d,h,k,j;
for(f=bp(a)-1;
f>=0;
f--){b=a[f];
if(!bp(b.d5)){this.j7(b)}}a.sort(kX);
if(c.fQ){g=c.fQ.d6()}for(f=0,e=bp(a)-1;
f<e;
f++){b=a[f];
k=a[f+1];
d=b.d6();
j=k.d6();
if(g&&g.x>d.x&&g.x<j.x){c.kJ=f+1}else{h=c.kY(d);
if(!h||h.c_.x>=j.x){b.d3();
k.d3();
c.kZ(0.5*(b.dc.x+k.de.x),0.5*(j.y+d.y))}}}}function k0(l,k,d){if(l&&k){if(d){var c=this,b=l.d6(),j=k.d6(),e=M.min(b.x,j.x),a=M.max(b.x,j.x),g,f,h;

for(g=bp(c.kH)-1;
g>=0;
g--){f=c.kH[g].c_;
if(e<f.x&&f.x<a){c.k1(c.kH[g])}}if(c.fQ){h=c.fQ.d6();
if(e<h.x&&h.x<a){c.k2()}}}l.fM(k);
b5(k,this.f8);
this.kU()}}function k3(){var a=this,j=a.kH.concat(),e,g,c,f,b={},d={},h;
if(a.fQ){j.push(a.fQ)}j.sort(k4);
for(e=bp(j)-1;
e>=0;
e--){g=j[e];
f=g.d6();
h=this.k5(f);
if(!(h=this.k5(f))&&g instanceof kM){a.k1(g,T)}else{b[g.bQ]=h;
if(!(h=this.k6(f))&&g instanceof kM){a.k1(g,T)}d[g.bQ]=h}}for(e=bp(j)-2;
e>=0;
e--){g=j[e];
c=j[e+1];
h=b[g.bQ];
if(h&&h.bS(b[c.bQ])&&d[g.bQ]&&d[g.bQ].bS(d[c.bQ])){if(c instanceof kM){a.k1(c,T)}else{a.k1(g,T)}}}}function k7(f,j,g){for(var a,h=ar,b,c,e=0,d=bp(this.f8);
e<d;
e++){b=this.f8[e].d6();
if((b.x-f.x)*j>0||(b.y-f.y)*g>0){c=f.cU(b,T);
if(c<h){a=this.f8[e];
h=c}}}return a}function k8(a){return this.k9(a,-1,0)}function k_(a){return this.k9(a,1,0)}function la(f,j,g){for(var a,h=ar,b,c,e=0,d=bp(this.kH);
e<d;
e++){b=this.kH[e].c_;
if((b.x-f.x)*j>0||(b.y-f.y)*g>0){c=f.cU(b,T);
if(c<h){a=this.kH[e];
h=c}}}return a}function lb(a){return this.lc(a,-1,0)}function ld(a){return this.lc(a,1,0)}function le(c){var k=c.eq,l=new fJ(),b,h,m,g,f,e,a,d=st.gF();
this.f8.splice(bZ(this.f8,k)+1,0,l);
l.f4=this;
l.jS=[];
this.kU();
for(g=0,f=bp(c.jV);
g<f;
g++){b=c.jV[g];
for(e=0,a=bp(b.d5);
e<a;
e++){h=b.d5[e];
b5(h,k.d5);
if(!bY(l.d5,h)){l.fY(h)}}for(e=0,a=bp(b.dv);
e<a;
e++){m=b.dv[e];
b5(m,k.dv);
if(!bY(l.dv,m)){l.f2(m)}}b5(b,k.jS);
ca(l.jS,b);
k.hu=am;
k.fz(bg);
d.fz(bh)}}function lf(e,b){var c=this,d,a;
if(!b){d=c.k5(e.c_),a=c.k6(e.c_);
c.gE(d,a,F)}e.dx();
fk(e,c.kH);
c.j6(e);
if(!b){c.kU()}}function lg(c,a){if(er!="rxn"){return}var b=this;
b.kH.push(c);
c.f4=b;
if(!a){fo(c);
b.fz(bf)}return T}function lh(b,a,d){var c;
if(b instanceof ck){c=new kM(b.x,b.y)}else{c=new kM(b,a)}this.kI(c,d);
if(!d){this.li(c.c_)}return c}function dM(b,a,d,c){if(!c){c=this.data(as)}lj=c;
switch(hh){case aO:case aP:case aK:case aL:c.dk.attr("cursor","move");
break;
case aT:if(hj){c.f4.k1(c);
lj=am;
lk=T}break}}function dN(b,a,d,c){lj=am}function dV(c,a,d,b){if(!b){b=this.data(as)}ll=b;
switch(hh){case aO:case aP:case aK:case aL:b.dk.attr("cursor","move");
break;
case aT:if(hj){b.f4.k2(b);
ll=am}break}}function dW(c,a,d,b){ll=am}function lm(h){for(var f=this,e,b,g=ar,d,c=0,a=bp(f.f8);
c<a;
c++){b=f.f8[c].kE(h);
if(b){d=h.cU(f.f8[c].d6(),T);
if(d<g){e=b;
g=d}}}if(e){f.ln(e)}f.kU()}function lo(b){var c=this,a=c.fQ;
if(!a){return F}if(b){c.kZ(a.d6(),T)}c.j6(a);
a.dx();
c.fQ=am}function lp(b,a,c){if(er!="rxn"){return}if(!(b instanceof ck)){b=new ck(b,0)}if(!a){a=b.cd();
a.x+=lq}this.fV(new fU(b,a));
if(!c){this.li(cB(b,a))}}function lr(a){if(er!="rxn"){return}var b=this;
if(b.fQ){b.k2(T)}b.fQ=a;
b.fQ.f4=this;
b.fz(bf)}function ls(e,d,c,g){if(c==am){c=hl
}if(g==am){g=hm}var b=e.eq,h,f,a;
if(!this.bS(b.f4)){return}if(b.bS(d.eq)){for(f=0,a=bp(b.dv);
f<a;
f++){h=b.dv[f];
if((h.c9.bS(e)&&h.da.bS(d))||(h.c9.bS(d)&&h.da.bS(e))){h.i2();
return h}}}else{this.gE(b,d.eq,T)}h=new gB(e,d,c,g);
b.f2(h);
return h}function lt(m,g){var e=m.lu,a=m.lv,h=e.eq,b=m.lw,d,c,f,k,j,l,i;
if(!this.bS(h.f4)){return}d=(m.e0?a.da:a.c9);
c=(m.e0?a.c9:a.da);
if(e.dw!=2||a.dw!=2){k=e.i3();
if(k||e.dw!=a.dw){j=a.i3();
if(e.dw!=2&&k){e.i4(k)}if(a.dw!=2&&j){a.i4(j)}}}if(!e.c9.ip.bS(a.c9.ip)){b.eV((eB(e.c9,e.da)-eB(d,c))*ag,a.d6());
b.cv(e.c9.c_.cA(d.c_));
l=e.c9.c_.cU(e.da.c_);
i=d.c_.cU(c.c_);
if(l>0&&i>0&&l!=i){b.eU(l/i,e.c9.c_)}}if(!h.bS(a.eq)){if(b){b5(a.eq,b.f8)}this.gE(h,a.eq,T)}f=(g[e.c9]||g[e.da]||g[d]||g[c]);
if(f==2||(!f&&e.hC()+e.c9.hC()+e.da.hC()>a.hC()+d.hC()+c.hC())){h.gG(d,e.c9);
g[e.c9]=2;
h.gG(c,e.da);
g[e.da]=2;
h.kD(a,e)}else{h.gG(e.c9,d);
g[d]=1;
h.gG(e.da,c);
g[c]=1;
h.kD(e,a)}if(b){b.fH(a);
b.fI(d);
b.fI(c)}}function lx(d,a,h){var i=d.lu,e=d.lv,j=i.eq,f=d.lw,c,l;
if(!this.bS(j.f4)){return}if(a){if(!i.ip){j.iL()}if(!i.ip.bS(e.ip)){f.cv(i.c_.cA(e.c_));
var b=i.g8(i.gp()),g=i.gW(),m=e.g8(e.gp()),k=e.gW();
if(b<k&&m<g&&(g>1||k>1)){f3(f.d5,T);
c=new gy(gz(i,1));
l=new gB(i,c,1,0);
j.fY(c);
j.f2(l);
h=1;
i=c;
f3(f.d5,F);
f.cv(c.c_.cA(e.c_))}else{if(m<g){h=2}else{if(b<k){h=1}}}}}if(!j.bS(e.eq)){if(f){b5(e.eq,f.f8)}this.gE(j,e.eq,T)}if(h==2||(!h&&i.hC()>e.hC())){j.gG(e,i)}else{j.gG(i,e)}if(f){f.fI(e)}}function kX(d,c){d.d3();
c.d3();
if(d.de.x<c.de.x){return -1}if(d.de.x>c.de.x){return 1}if(d.de.y<c.de.y){return -1}if(d.de.y>c.de.y){return 1}return 0}function k4(d,c){var e=d.d6(),f=c.d6();
if(e.x<f.x){return -1}if(e.x>f.x){return 1}if(e.y<f.y){return -1}if(e.y>f.y){return 1}return 0}function ly(){if(er!="rxn"){return}this.kJ=0;
var d=this,c,b,a;
if(d.fQ){c=d.fQ.d6()}for(b=0,a=bp(d.f8);
b<a;
b++){if(c&&d.f8[b].d6().x>=c.x){break}d.kJ++}}function lz(){if(!this.f8||bp(this.f8)==0){return""}if(er=="rxn"){for(var d=this,a,b,c=bp(d.f8)-1;
c>=0;
c--){if(!bp(d.f8[c].d5)){d.f8.splice(c,1)}}d.f8.sort(kX);
d.kU();
b="$RXN\n\n"+ab+S+Number(new Date())+ao+ao+bA(d.kJ,3)+bA(bp(d.f8)-d.kJ,3)+ao;
for(c=0,a=bp(d.f8);
c<a;
c++){b+="$MOL\n";
b+=d.f8[c].kj()}return b}else{return this.f8[0].kj()}}function lA(a){this.lB(a);
this.fd()}function lC(c){var b=kl(c,"BoundingBox"),a;
if(b){a=b.indexOf(S);
if(a>0){b=b.substr(0,a)}}return bG(bn(b))}function lD(b,a){return lC(b)-lC(a)}function lE(m){m=by(m);
var c=this,k,h,g,f,o,d,a,l,n,j,b=0,e=0;
if(bw(m,"<!DOCTYPE CDXML")){m='<?xml version="1.0"  ?>'+m}if(bw(m,"<?xml")||bw(m,"<CDXML")){k=$($.parseXML(m));
h=k.find("page:first > fragment,page:first > group");
d=k.find("step");
if(bp(d)){c.kJ=0;
h.sort(lD);
l=S+bH(d.attr("ReactionStepReactants"))+S+bH(d.attr("ReactionStepObjectsAboveArrow"));

for(g=0,f=bp(h);
g<f;
g++){j=kn(k,$(h[g]));
j.ko=bm(kl(h[g],"id"));
if(l.indexOf(S+j.ko)>-1){c.kJ++}if(o=lF(c,j,b,e)){b=o;
e++}}if(g==c.kJ){c.lG(b)}}else{c.kJ=1;
j=kn(k,h);
j.cC();
c.fM(j)}}else{if(bw(m,"$RXN")){k=m.split("$MOL\n");
h=k.shift();
for(g=0,f=bp(k);
g<f;
g++){k[g]=ac(k[g])}o=h.split(ao);
d=ac(o[bp(o)-2]);
c.kJ=bm(d.substr(0,3));
a=bm(d.substr(3,3));
l=bm(d.substr(6,3));
if(l>0){n=k.splice(c.kJ+a);
k.splice(c.kJ,0,n);
c.kJ+=l}for(g=0,f=bp(k);
g<f;
g++){j=kp(k[g]);
if(o=lF(c,j,b,e)){b=o;
e++}}if(g==c.kJ){c.lG(b)}}else{if(m){c.kJ=1;
j=kp(m);
j.cC();
c.fM(j);
if(er=="tmpl"&&c.ec==aZ){if($.isArray(j.a3)){a3.val(j.a3.join(","))}if(j.a4!=am){a4.val(j.a4)}}}}}}function lF(d,a,c,b){if(!bp(a.d5)){if(b<d.kJ){d.kJ--}return am}if(b==d.kJ){d.lG(c,am,T);
c+=lq+ed}else{if(b>0){d.kZ(c,0,T);
c+=dH+ed}}a.cC();
a.jX(c);
d.fM(a);
c+=(a.dc.x-a.de.x)+ed;
return c}function lH(){var d=this;
if(!d.de||!d.dc){d.de=new ck(ar,ar);
d.dc=new ck(-ar,-ar);
for(var c=0,b=bp(d.f8);
c<b;
c++){var a=d.f8[c];
a.d3();
fu(d,a.dc);
fu(d,a.de)}}}function lI(d,a){if(!a){a=[]}else{if(bY(a,this)){return}}a.push(this);
if(d>bd&&d<bh&&d!=bf){var c=this,b;
if(c.dS.x>c.dR.x){b=c.dS;
c.dS=c.dR;
c.dR=b}}a.pop()}function lJ(e,b){if(!b){b=[]}else{if(bY(b,this)){return}}var d=this,c,a;
b.push(d);
if(e>be){d.fF=am}if(e>bd&&e<bh){d.lK()}d.f8.sort(kX);
if(e!=bd&&e!=bf){e=bg}for(c=0,a=bp(d.f8);
c<a;
c++){d.f8[c].fz(e,b)}d.kU();
b.pop()}function lL(){this.de=am;
this.dc=am}function lM(){return this.ec}function lN(a){this.ec=a;
this.dF()}function lO(c){var e=this,b,d,a;
if(!e.fF){b=[];
for(d=0,a=bp(e.f8);
d<a;
d++){b0(b,e.f8[d].dE(c))}b0(b,e.kH);
if(e.fQ){b.push(e.fQ)}b.sort(fm);
e.fF=b}return e.fF}function lP(d){for(var e=this,b=[],c=0,a=bp(e.f8);
c<a;
c++){b0(b,e.f8[c].ft(d))}for(c=0,a=bp(e.kH);
c<a;
c++){b.push(e.kH[c].c_)}if(e.fQ){b.push(e.fQ.dS);
b.push(e.fQ.dR)}return b}function lQ(){for(var b=[],c=0,a=bp(this.f8);
c<a;
c++){b0(b,this.f8[c].d5)}return b}function lR(){for(var b=[],c=0,a=bp(this.f8);
c<a;
c++){b0(b,this.f8[c].dv)}return b}function lS(r,q,b){if(!r){return}if(q==am){q=kf}var h=r.x-q,c=r.x+q,g=r.y-q,a=r.y+q,f=r.z-b,t=r.z+b,e=[],m,l,k,d,p,o,n;
for(k=0,d=bp(this.f8);
k<d;
k++){p=this.f8[k];
for(m=0,l=bp(p.d5);
m<l;
m++){o=p.d5[m];
n=o.d6();
if(!o.dT&&!o.d1&&h<n.x&&n.x<c&&g<n.y&&n.y<a&&(b==am||(f<n.z&&n.z<t))){e.push(o)}}}return e}function lT(o,n){if(!o){return}if(n==am){n=lU}var f=o.x-n,b=o.x+n,e=o.y-n,a=o.y+n,d,k,h,g,c,l,p,m;
for(g=0,c=bp(this.f8);
g<c;
g++){l=this.f8[g];
for(k=0,h=bp(l.dv);
k<h;
k++){p=l.dv[k];
if(!p.dT&&!p.d1&&f<M.max(p.c9.c_.x,p.da.c_.x)&&M.min(p.c9.c_.x,p.da.c_.x)<b&&e<M.max(p.c9.c_.y,p.da.c_.y)&&M.min(p.c9.c_.y,p.da.c_.y)<a){m=o.e3(p.c9.c_,p.da.c_);
if(m<n){d=p;
n=m}}}}return d}function lV(n,m){if(!n){return}if(m==am){m=kf
}var f=n.x-m,b=n.x+m,e=n.y-m,a=n.y+m,d=[],k,h,g,c,l,o;
for(g=0,c=bp(this.f8);
g<c;
g++){l=this.f8[g];
for(k=0,h=bp(l.iq);
k<h;
k++){o=l.iq[k];
o.d3();
if(f<o.dc.x+o.iA&&o.de.x<b&&e<o.dc.y&&o.de.y<a){d.push(o)}}}return d}function lW(b,a){return lX(b,this.kh(b,a))}function lY(b,a){return lX(b,this.lZ(b,a))}function lX(g,b){if(!b||!bp(b)){return}var d=b[0],f=d.d6().cU(g,T),e,c,a;
for(c=1,a=bp(b);
c<a;
c++){e=b[c].d6().cU(g,T);
if(e<f){d=b[c];
f=e}}return d}function l0(c){for(var b=[],e=0,a=bp(this.f8),d,g,f;
e<a;
e++){f=this.f8[e].d5;
for(d=0,g=bp(f);
d<g;
d++){if(f[d].dt==c){b.push(f[d])}}}return b}function l1(){return this.c_}function l2(a){return[this.c_]}function l3(a){return[this.dS,this.dR]}function l4(d){for(var e=this,b=d.kH,c=0,a=bp(b);
c<a;
c++){e.kI(b[c])}for(b=d.l5(),c=0,a=bp(b);
c<a;
c++){e.fM(b[c])}}function Reaction(a){fL.apply(this,[aZ,a])}function fL(b,c){var a=this;
e5.apply(a);
a.ec=b;
a.f8=[];
a.kH=[];
a.kJ=0;
a.kK=new gx();
a.getAtoms=lQ;
a.findAtoms=l0;
a.l6=lW;
a.l7=lT;
a.l8=lY;
a.kh=lS;
a.lZ=lV;
a.l9=lR;
a.fz=lJ;
a.d3=lH;
a.lK=lL;
a.kR=kS;
a.kT=kW;
a.kU=ly;
a.kV=k3;
a.l_=lz;
a.ma=lA;
a.lB=lE;
a.jP=ls;
a.mb=lx;
a.mc=lt;
a.kI=lg;
a.kZ=lh;
a.k1=lf;
a.fV=lr;
a.lG=lp;
a.k2=lo;
a.fM=kQ;
a.j7=kP;
a.gE=k0;
a.md=l4;
a.li=lm;
a.ln=le;
a.k9=k7;
a.k5=k8;
a.k6=k_;
a.lc=la;
a.me=lb;
a.kY=ld;
a.getAttAtom=function(){for(var e=0,d=bp(a.f8);
e<d;
e++){if(a.f8[e].es){return a.f8[e].es}}};
a.jG=mf;
a.dE=lO;
a.j6=fE;
a.ft=lP;
a.cv=e6;
a.cd=kG;
a.ep=fj;
a.c8=lM;
a.mg=lN;
if(c){a.lB(c)}}function fU(c,a){var b=this;
fi.apply(b);
if(c.x>a.x){b.dS=a;
b.dR=c}else{b.dS=c;
b.dR=a}b.dI=F;
b.fz=lI;
b.d6=kO;
b.ft=l3;
b.fd=dO;
b.dD=fB;
b.cd=kN;
b.c8=kr}function kM(a,c){var b=this;
fi.apply(b);
b.c_=new ck(a,c);
b.dI=F;
b.fz=iC;
b.d6=l1;
b.ft=l2;
b.fd=dG;
b.dD=fB;
b.cd=kL;
b.c8=kr}function mh(h,l){h=(h||st.dC());
var c=this,a=h.f8,g,e,b,f,d,k;
for(e=0,b=bp(a);
e<b;
e++){g=a[e];
for(f=0,d=bp(g.d5);
f<d;
f++){k=g.d5[f];
if(!l||!bY(l.d5,k)){c.fY(k)}}for(f=0,d=bp(g.dv);
f<d;
f++){k=g.dv[f];
if(!l||!bY(l.dv,k)){c.f2(k)}}for(f=0,d=bp(g.iq);
f<d;
f++){k=g.iq[f];
if(!l||!bY(l.iq,k)){c.h1(k)
}}}k=h.fQ;
if(k&&(!l||!l.fQ)){c.fV(k)}for(e=0,b=bp(h.kH);
e<b;
e++){k=h.kH[e];
if(!l||!bY(l.kH,k)){c.kI(k)}}}function mi(){for(var d=this,a=d.d5,c,b=bp(d.dv)-1;
b>=0;
b--){c=d.dv[b];
if(!bY(d.d5,c.c9)||!bY(d.d5,c.da)){d.fH(c)}}for(b=bp(d.hI)-1;
b>=0;
b--){d.fH(d.hI[b])}return d}function mj(d){for(var c,b=0,a=bp(this.d5);
b<a;
b++){c=this.d5[b];
c.gH(d);
fo(c)}}function mk(){for(var c,b=0,a=bp(this.iq);
b<a;
b++){c=this.iq[b];
c.il();
this.ie(c)}}function ml(){var c=this,a=st.dC(),b;
while(bp(c.iq)){b=c.iq.pop();
b.eq.ie(b)}while(bp(c.dv)){b=c.dv.pop();
b.eq.fH(b)}while(bp(c.d5)){b=c.d5.pop();
b.eq.fI(b)}if(c.fQ){a.k2();
c.k2()}while(bp(c.kH)){a.k1(c.kH.pop())}}function mm(){var a=this;
return !bp(a.d5)&&!bp(a.iq)&&!bp(a.dv)&&!bp(a.kH)&&!a.fQ}function mn(){var a=this;
while(bp(a.iq)){a.ie(a.iq[0])}while(bp(a.dv)){a.fH(a.dv[0])}while(bp(a.d5)){a.fI(a.d5[0])}a.k2();
while(bp(a.kH)){a.k1(a.kH[0])}}function mo(){var a=new gx(T);
a.b0(am,this);
return a}function mp(m){var c=this,n=new ce(),h,g,d,b,f,o,l,k=[],a=[];
mq=c.cd(n,T);
for(h=0,g=bp(c.dv);
h<g;
h++){b=c.dv[h];
ca(k,b.c9);
ca(k,b.da)}for(h=0,g=bp(c.hI);
h<g;
h++){b=c.hI[h];
ca(k,b.c9);
ca(k,b.da)}for(h=0,g=bp(k);
h<g;
h++){b=k[h];
f=n.cc(b);
mq.fY(f,T);
o=b.eq;
l=n.bV[o.bQ];
if(!l){l=new fJ();
n.bV[o.bQ]=l;
a.push(l)}l.fY(f,T)}if(mq.f8){b0(mq.f8,a)}else{mq.f8=a}for(h=0,g=bp(c.d5);
h<g;
h++){b=c.d5[h];
f=n.cc(b);
for(d=bp(b.dv)-1;
d>=0;
d--){if(!bY(c.dv,b.dv[d])){f=n.cc(b);
b5(n.cc(b.dv[d]),f.dv);
f.fz(bg)}}}for(h=0,g=bp(mq.d5);
h<g;
h++){mq.d5[h].dI=am}for(h=0,g=bp(mq.dv);
h<g;
h++){mq.dv[h].dI=am}for(h=0,g=bp(mq.hI);
h<g;
h++){mq.hI[h].dI=am}for(h=0,g=bp(mq.iq);
h<g;
h++){mq.iq[h].dI=am}mq.dF();
if(m){if(bp(mq.f8)==1){f=mq.f8[0].kj()}else{l=new fL();
l.md(mq);
f=l.l_()}o=$(D.activeElement);
$("#copyHelper").val(f).focus().select();
D.execCommand("copy");
o.focus()}}function mr(b){var a,c;
if(bp(b.f8)==1){a=b.f8[0].kj()}else{c=new fL();
c.md(b);
a=c.l_()}return a}function ms(){var d=this.l5(),b,c,a;
for(c=0,a=bp(d);
c<a;
c++){if(b=d[c].es){return b}}}function mt(){var c=this,b,a;
if(!c.f8){c.f8=[];
for(b=0,a=bp(c.dv);
b<a;
b++){ca(c.f8,c.dv[b].eq)}for(b=0,a=bp(c.d5);
b<a;
b++){ca(c.f8,c.d5[b].eq)}for(b=0,a=bp(c.iq);
b<a;
b++){ca(c.f8,c.iq[b].eq)}}return c.f8}function mu(){var c=this,b,a;
if(!c.jS){c.jS=[];
for(b=0,a=bp(c.dv);
b<a;
b++){ca(c.jS,c.dv[b].c9.ip);
ca(c.jS,c.dv[b].da.ip)}for(b=0,a=bp(c.d5);
b<a;
b++){ca(c.jS,c.d5[b].ip)}for(b=0,a=bp(c.iq);
b<a;
b++){ca(c.jS,c.iq[b].ip)}}return c.jS}function mv(a){this.copy(a);
this.mw()}function mx(b,a){var d=this,c=b.ev;
if(c&&!bY(d.iq,c)){return d.h1(c,a)}else{ca(d.d5,b);
if(!d.my){d.fz(bg);
b.dI=T;
if(!a){fo(b)}}return T}}function mz(a){var b=this;

if(b5(a,b.d5)&&!b.my){b.fz(bg);
a.dI=F;
b.j6(a);
fo(a)}}function mA(d,c){ca(this.iq,d);
for(var e=this,b=0,a=bp(d.d5);
b<a;
b++){e.fY(d.d5[b],c)}for(b=0,a=bp(d.dv);
b<a;
b++){e.f2(d.dv[b],c)}if(!e.my){e.fz(bg);
d.dI=T;
if(!c){fo(d)}}return T}function mB(c){var d=this,b,a;
if(b5(c,d.iq)&&!d.my){d.fz(bg);
c.dI=F;
d.j6(c);
fo(c)}for(b=0,a=bp(c.d5);
b<a;
b++){d.fI(c.d5[b])}for(b=0,a=bp(c.dv);
b<a;
b++){d.fH(c.dv[b])}for(b=0,a=bp(c.hI);
b<a;
b++){d.fH(c.hI[b])}}function mC(a){var b=this;
if(a instanceof gy){return(a.dI?b.fI(a):b.fY(a))}if(a instanceof gB){return(a.dI?b.fH(a):b.f2(a))}if(a instanceof kM){return(a.dI?b.k1(a):b.kI(a))}if(a instanceof fU){return(a.dI?b.k2(a):b.fV(a))}}function mD(c,a){var d=this,b=c.ev;
if(b&&!bY(d.iq,b)){return d.h1(b)}else{if(ca(d.dv,c)){if(!d.my){d.fz(bg);
c.dI=T;
if(!a){fo(c)}}mE(d,c.c9,a);
mE(d,c.da,a);
return T}return F}}function mE(c,b,a){if(!bY(c.d5,b)&&bX(c.dv,b.dv)){c.fY(b,a)}}function mF(a){var b=this;
if(b5(a,b.dv)&&!b.my){b.fz(bg);
a.dI=F;
b.j6(a);
fo(a)}}function mG(b){for(var c=0,a=bp(b.d5);
c<a;
c++){this.fY(b.d5[c])}for(c=0,a=bp(b.dv);
c<a;
c++){this.f2(b.dv[c])}}function mH(b,a){this.fQ=b;
if(!this.my){this.fz(bg);
b.dI=T;
if(!a){fo(b)}}return T}function mI(){var a=this;
if(a.fQ){if(!a.my){a.fz(bg);
a.fQ.dI=F;
fo(a.fQ)}a.fQ=am}}function mJ(b,a){if(ca(this.kH,b)){if(!this.my){this.fz(bg);
b.dI=T;
if(!a){fo(b)}}return T}return F}function mK(a){if(b5(a,this.kH)&&!this.my){this.fz(bg);
a.dI=F;
fo(a)}}function mL(o,n,l){l=bG(l);
var c=this,k=st.dC(),a=k.f8,h,e,b,g,d,m,f;
for(e=0,b=bp(a);
e<b;
e++){h=a[e];
for(g=0,d=bp(h.d5);
g<d;
g++){f=h.d5[g];
if(!f.d1&&f.c_.cW(o,n,l)){c.fY(f)}}for(g=0,d=bp(h.dv);
g<d;
g++){f=h.dv[g];
if(!f.d1&&f.d6().cW(o,n,l)){c.f2(f)}}for(g=0,d=bp(h.iq);
g<d;
g++){f=h.iq[g];
if(!f.eN&&f.d6().cW(o,n,l)){c.h1(f)}}}m=k.fQ;
if(m){if(m.dS.cW(o,n,l)||m.dR.cW(o,n,l)){c.fV(m)}}for(e=0,b=bp(k.kH);
e<b;
e++){f=k.kH[e];
if(f.c_.cW(o,n,l)){c.kI(f)}}}function mM(n,m){var c=this,k=st.dC(),a=k.f8,h,e,b,g,d,l,f;
for(e=0,b=bp(a);
e<b;
e++){h=a[e];
for(g=0,d=bp(h.d5);
g<d;
g++){f=h.d5[g];
if(!f.d1&&f.c_.cY(n,m)){c.fY(f)}}for(g=0,d=bp(h.dv);
g<d;
g++){f=h.dv[g];
if(!f.d1&&f.d6().cY(n,m)){c.f2(f)}}for(g=0,d=bp(h.iq);
g<d;
g++){f=h.iq[g];
if(!f.eN&&f.d6().cY(n,m)){c.h1(f)}}}l=k.fQ;
if(l){if(l.dS.cY(n,m)||l.dR.cY(n,m)){c.fV(l)}}for(e=0,b=bp(k.kH);
e<b;
e++){f=k.kH[e];
if(f.c_.cY(n,m)){c.kI(f)}}}function mN(c){var f=this,b,e,d,a;
if(!f.fF){b=[];
for(d=0,a=bp(f.d5);
d<a;
d++){e=f.d5[d];
b.push(e);
if(!c){b_(b,e.dv)}}for(d=0,a=bp(f.dv);
d<a;
d++){e=f.dv[d];
ca(b,e);
if(!c){if(ca(b,e.c9)){b_(b,e.c9.dv)}if(ca(b,e.da)){b_(b,e.da.dv)}}}for(d=0,a=bp(f.iq);
d<a;
d++){e=f.iq[d];
b.push(e)}b1(b,f.fQ);

b0(b,f.kH);
f.fF=b}return f.fF}function mO(d){var c=this,b=[],k=[],g,l,m,h,f,e,a;
for(h=0,f=bp(c.d5);
h<f;
h++){g=c.d5[h];
if(!d||!g.d1){k.push(g);
b.push(g.c_)}}for(h=0,f=bp(c.dv);
h<f;
h++){g=c.dv[h];
if((!d||!g.d1)&&!bY(c.d5,g.c9)&&!bY(c.d5,g.da)){b0(k,g.getAtoms());
b0(b,g.ft())}}for(h=0,f=bp(c.iq);
h<f;
h++){g=c.iq[h];
if(g.eQ){for(e=0,a=bp(g.eQ);
e<a;
e++){b.push(g.eQ[e].dS,g.eQ[e].dR)}}if(!d){b1(b,g.fy);
b1(b,g.de);
b1(b,g.dc)}if(d&&!g.eN&&bp(g.hJ)){for(e=0,a=bp(g.hJ);
e<a;
e++){l=g.hJ[e];
if(!bY(k,l)){b.push(l.c_)}}}else{for(e=0,a=bp(g.d5);
e<a;
e++){l=g.d5[e];
if(!bY(k,l)){b.push(l.c_)}}}}m=c.fQ;
if(m){b.push(m.dS,m.dR)}for(h=0,f=bp(c.kH);
h<f;
h++){b.push(c.kH[h].c_)}if(!d){b1(b,c.fy)}return b}function mP(k,h){if(!k){k=new ce()}h=(h==am?this.my:h);
var d=this,c=new gx(h),b,f,a=[],g,e,l,j;
bT(k,d,c);
for(g=0,e=bp(d.iq);
g<e;
g++){b=d.iq[g];
f=k.cc(b);
c.h1(f,T);
l=b.eq;
j=k.bV[l.bQ];
if(!j){j=new fJ();
k.bV[l.bQ]=j;
a.push(j)}j.h1(f,T)}for(g=0,e=bp(d.dv);
g<e;
g++){b=d.dv[g];
f=k.cc(b);
c.f2(f,T);
l=b.eq;
j=k.bV[l.bQ];
if(!j){j=new fJ();
k.bV[l.bQ]=j;
a.push(j)}j.f2(f,T)}for(g=0,e=bp(d.hI);
g<e;
g++){b=d.hI[g];
f=k.cc(b);
ca(c.hI,f);
l=b.eq;
j=k.bV[l.bQ];
if(!j){j=new fJ();
k.bV[l.bQ]=j;
a.push(j)}j.f2(f,T)}for(g=0,e=bp(d.d5);
g<e;
g++){b=d.d5[g];
f=k.cc(b);
c.fY(f,T);
l=b.eq;
j=k.bV[l.bQ];
if(!j){j=new fJ();
k.bV[l.bQ]=j;
a.push(j)}j.fY(f,T)}if(d.fQ){c.fV(k.cc(d.fQ),T)}for(g=0,e=bp(d.kH);
g<e;
g++){c.kI(k.cc(d.kH[g]),T)}if(c.f8){b0(c.f8,a)}else{c.f8=a}for(g=0,e=bp(c.f8);
g<e;
g++){j=c.f8[g];
j.hu=am;
j.iL()}if(d.fy){c.fy=d.fy.cd()}c.hX=d.hX;
c.dF();
return c}function mQ(h,b){var g=this,f,e=st.dC(),d,c,a;
if(!b){b=[]}else{if(bY(b,g)){return}}b.push(g);
if(h>be){if(h!=bf){g.f8=am;
g.jS=am}g.fy=am;
g.fF=am}if(h!=bf){f=g.l5();
for(c=0,a=bp(f);
c<a;
c++){f[c].fz(bg,b)}if(d=g.fQ){d.fz(h,b)}}e.fz(h,b);
b.pop()}function mR(d,a,b,c){this.lw=b;
this.lu=d;
this.lv=a;
this.cU=c}function mS(h,k){var b=[],l=h.getAtoms(),m,g,f,d,e,a,c;
b3(l,this.d5);
for(e=0,a=bp(l);
e<a;
e++){c=l[e];
if(!c.ev){for(g=0,f=bp(this.d5);
g<f;
g++){d=this.d5[g];
if(!d.ev){m=c.c_.cU(d.c_,T);
if(m<=k){b.push(new mR(c,d,this,m));
break}}}}}return b}function mT(m,n){var e=this,d=[],p=m.l9(),b,a,o,l,k,g,h,c,f;
b3(p,e.dv);
for(h=0,c=bp(p);
h<c;
h++){f=p[h];
if(f.c9.ev||f.da.ev){continue}for(l=0,k=bp(e.dv);
l<k;
l++){g=e.dv[l];
if(g.c9.ev||g.da.ev){continue}if((b=f.c9.c_.cU(g.c9.c_,T))<=n&&(a=f.da.c_.cU(g.da.c_,T))<=n){d.push(new mR(f,g,e,0.5*(b+a)));
break}if((b=f.c9.c_.cU(g.da.c_,T))<=n&&(a=f.da.c_.cU(g.c9.c_,T))<=n){o=new mR(f,g,e,0.5*(b+a));
o.e0=T;
d.push(o);
break}}}return d}function mU(b,a){if(!a){a=this.d6().cd()}fA.apply(this,arguments)}function gx(a){var b=this;
e5.apply(b);
b.my=a;
b.d5=[];
b.iq=[];
b.dv=[];
b.hI=[];
b.kH=[];
b.fz=mQ;
b.gc=mm;
b.mw=ml;
b.jN=mn;
b.mo=mo;
b.cut=mv;
b.copy=mp;
b.l5=mt;
b.mV=mu;
b.mW=ms;

b.mX=mj;
b.ungroupGroups=mk;
b.dE=mN;
b.j6=fE;
b.ft=mO;
b.eU=mU;
b.mY=mS;
b.mZ=mT;
b.addAll=b.b0=mh;
b.addRectSelection=mL;
b.m0=mM;
b.m1=mC;
b.fY=mx;
b.fI=mz;
b.h1=mA;
b.ie=mB;
b.f2=mD;
b.fH=mF;
b.m2=mi;
b.kI=mJ;
b.k1=mK;
b.fV=mH;
b.k2=mI;
b.fM=mG;
b.cd=mP}function m3(){var b="",A=gd[H].m,f=gd[H].gf,n=st.gF(),a=bp(n.d5),c={},o="",l=0,r=0,y={},u="",k=0,v=0,z,m,w,h,t,p,q,x,e=st.dC().getAtoms(),d,g;
n.hI=[];
n.hX=T;
for(t=0,p=bp(e);
t<p;
t++){d=e[t];
if(!d.dI){z=d.ev;
m=(z&&z.type==aw&&z.hM)||1;
if(y){k+=m*d.hB(F);
v+=m*d.hB(T);
y[d.dt]=bG(y[d.dt])+m;
h=d.eE();
y[H]=bG(y[H])+(m*h);
k+=m*A*h;
v+=m*f*h}if(z){if(z.type==aw&&!z.hM){k=am;
v=am;
y=am;
u=s("poly");
break}}}}for(t=0,p=a;
t<p;
t++){d=n.d5[t];
z=d.ev;
m=(z&&z.type==aw&&z.hM)||1;
if(c){l+=m*d.hB(F);
r+=m*d.hB(T);
c[d.dt]=bG(c[d.dt])+m;
h=d.eE();
c[H]=bG(c[H])+(m*h);
l+=m*A*h;
r+=m*f*h}if(w){if(!w.bS(d.ip)){n.hX=F}}else{w=d.ip}if(z){n.hX=F;
if(z.type==aw&&!z.hM){l=am;
r=am;
c=am;
o=s("poly")}}for(q=0,x=bp(d.dv);
q<x;
q++){if(!d.dv[q].dI){n.hI.push(d.dv[q])}}}for(t=0,p=bp(n.dv);
t<p;
t++){g=n.dv[t];
if(w){if(!w.bS(g.c9.ip)){n.hX=F}}else{w=g.c9.ip}if(g.ev){n.hX=F}if(!g.c9.dI||!g.da.dI){n.hI.push(g)}}n.hX=(n.hX&&a>0&&bp(n.hI)<=2);
if(c){o=m4(c)}if(y){u=m4(y)}m5($("#bondRotate"),bp(n.hI)==1);
m5($("#groupSelection"),n.hX);
m5($("#ungroupSelection"),bp(n.iq));
if(a){b+=s("sele")+":&nbsp;"+o+m6(l,r);
if(u){b+=S+s("rem")+":&nbsp;"+u+m6(k,v)}}$("#info").html(b);
m7("change")}function m6(b,a){if(b>0){return"&nbsp;("+round(b,2,3)+"/"+round(a,4,3)+")"}return""}function m4(h){var f,b,a=[C,H],d,e,g,c="";
br(h);
for(f=0,b=bp(a);
f<b;
f++){d=a[f];
e=h[d];
if(e>0){c+=d;
if(e>1){c+=aI+e+aJ}}}for(d in h){e=h[d];
g=gd[d];
if((!g||!g.ge)&&e>0){c+=d;
if(e>1){c+=aI+e+aJ}}}return c}function dC(){var a=this;
if(a.m8){return a.m8}a.m9=bJ(a.m9,0,bp(a.m_)-1);
return a.m_[a.m9]}function gF(){return this.dC().kK}function hg(){return this.na}function nb(a){this.na=a}function nc(){if(this.na){this.na.nd=am;
this.na.ne=am;
this.na=am}}function nf(){if(this.ng()){this.nh(-1)}}function ni(){return this.m9>0}function nj(){if(this.nk()){this.nh(1)}}function nh(a){this.nl();
resetDirty(aZ);
this.m9+=a;
nm(aZ);
nn(this.dC()).fd();
m3()}function nn(a){a.d3();
$("#threed").fadeTo(500,(a.dc.z-a.de.z)>0?1:0).css("color",hm?"red":"black");
return a}function no(){return this.m9<bp(this.m_)-1}function np(){var a=bp(this.m_)-nq;
if(a>0){this.m_.splice(0,a);
this.m9-=a}}function nr(){var a=this;
a.np();
a.m_.splice(a.m9,0,st.dC().cd(new ce(T)));

a.m9++;
a.m_.length=a.m9+1}function ns(a){var b=this;
b.np();
b.m9++;
b.m_[b.m9]=nn(a);
b.m_.length=b.m9+1}function nt(){var b=this,a=b.m_[b.m9];
b.m_[b.m9]=a.cd(new ce(T));
b.m8=a}function nu(){return !!this.m8}function nl(){var a=this;
if(a.m8){a.m8.dx();
a.m8=am;
a.nc();
a.dC().fd()}}function nv(){var a=this;
if(a.m8){a.ns(a.m8);
a.m8=am;
a.nc();
m3()}}function nx(){var a=this;
a.m_=[];
a.m_[0]=new fL(aZ);
a.m9=0;
a.hf=F;
a.nt=nt;
a.nu=nu;
a.nl=nl;
a.nv=nv;
a.getCurrentReaction=dC;
a.dC=dC;
a.gF=gF;
a.hg=hg;
a.nb=nb;
a.nc=nc;
a.np=np;
a.nr=nr;
a.ns=ns;
a.undo=nf;
a.ng=ni;
a.redo=nj;
a.nk=no;
a.nh=nh}function ny(a){$("#"+a).click()}function activateTool(d,b){nz();
nA(hh,b);
if(hh!=b){nB=F;
var a=F;
switch(b){case aU:case aV:nC();
a=T;
break;
case aX:case aY:a=T;
break;
case aP:nB=T;
break}if(!a){$(nD).css({border:"",ed:""});
$(d).css({border:"1.5px solid black",ed:"0.5px"});
nD=d}hh=b}else{if(hk&&b==aT){var c=st.gF();
if(!c.gc()){nE()}}}if(st){ii()}}function useAtom(a){nF(a);
$("#atom").click()}function nA(b,a){switch(b){case aU:case aV:hj=F;
st.nl();
break}}function nG(){nH(nD)}function nH(a){if(a){$(a).trigger("click",{nI:T})}}function nJ(a){nK=a.ctrlKey;
return bo(a)}function nL(b){if(!st.hf){var a=b.dataTransfer;
if(!a&&b.originalEvent){a=b.originalEvent.dataTransfer}if(a){a=a.files}else{if(b.target){a=b.target.files}}nM(a,aU,F)}return bo(b)}function nM(c,b,d){if(c&&bp(c)){var a=new FileReader();
a.onload=function(f){var e=f.target.result;
if(d||nK){activateTool(am,b);
pasteMolFile(e)}else{ma(e)}};
a.readAsText(c[0],"iso-8859-1")}}function nN(b,a){if(b&&(!a||!a.nI)){nO=b.target}}function nP(a){nO=am}function nQ(d){if(!d||!d.data||!d.data.nI){nN(d);
var c=$(nO).parent().children(ax),a=aZ.height,b=c.height();
c.fadeIn(50).css("z-index",10000);
c.css(c.offset().top+b>a?{position:"absolute",top:(a-b-25)+"px"}:{position:am,top:am})}}function nR(a){setTimeout(function(){if(!a){nP()}var b=$(ax).filter(":visible");
if(bp(b)){if(nO){b=b.not($(nO).parent().children())}if(bp(b)){if(nS){b.hide()}else{b.fadeOut(100)}}}if(hk&&!bp(b)){nQ()}},100)}function nT(a){if(a.target.tagName.toLowerCase()=="img"){a7.prop("src",a.target.src);
a8=T;
nU()}}function nC(){a8=F;
nV()}function nU(){if(a8){a7.show()}}function nV(){if(a8){a7.hide()}}function nW(){var b=navigator.userAgent.toLowerCase(),a="";
if(/android|blackberry|kindle|mobile|phone/.test(b)){a="mobile"}else{if(/windows|macintosh|linux/.test(b)){a="desktop"}else{if(/Pad|Tablet/.test(navigator.userAgent)){a="mobile"}else{if(/CrOS|Mac/.test(navigator.userAgent)){a="desktop"}else{a=(nX()?"mobile":"desktop")}}}}return a
}function nX(){return"ontouchstart" in document.documentElement}function setBond(a,b){hl=a;
hm=b;
nn(st.dC())}function hZ(){ih(aZ);
st.nr()}function h2(a){ii(T);
nn(st.dC());
fr(a||aZ);
m3()}function nY(h){for(var b=a2.val(),g,d,c="",f=0,a=bp(b);
f<a;
f++){g=b.charCodeAt(f);
if((!d&&g>96&&g<123)||(g==104&&b!="Ph"&&b!="Rh"&&b!="Th")){g-=32}d|=(g>64&&g<91);
c+=String.fromCharCode(g)}if(b!=c){nF(c)}}function nZ(g){if(n0||g.timeStamp<n1){hY(F);
return}if(n2(g)){return T}n3=T;
var f=g.which,d,b,c=g.ctrlKey,a=g.shiftKey;
if(n4(a2,g)&&f!=13){if(!a&&((((b=a2.val())==""||bm(b)==b)&&f>64&&f<91)||(f==72&&b!="P"&&b!="R"&&b!="T"))){nF(b+String.fromCharCode(f));
return F}return T}d=(g.altKey?0.2:1);
switch(f){case 37:n5(-d,0);
break;
case 38:n5(0,-d);
break;
case 39:n5(d,0);
break;
case 40:n5(0,d);
break;
case 74:if(c&&bp(b=st.gF().d5)==2){hZ();
fo(st.dC().jP(b[0],b[1]));
h2();
break}case 36:n5(0,0,d);
break;
case 75:case 35:n5(0,0,-d);
break;
case 33:n6();
n7();
break;
case 34:n8();
n7();
break;
case 67:case 86:case 88:if(c){return T}break}nR();
return bo(g)}function n4(a,b){return a&&b&&a.is(b.target)}function n2(a){return n4(a3,a)||n4(a4,a)||getSelection().toString()}function n9(a){return(n4(a2,a)||n2(a)?T:bo(a))}function hY(a){if(a){n0=T}else{clearTimeout(n_);
n_=setTimeout(function(){n0=F},500)}}function oa(h){if(st.hf||n0||h.timeStamp<n1){n0=F;
return}if(n2(h)){return T}if(n4(a2,h)){if(h.which==27||h.which==113){a2.blur()}if(h.which!=13){return T}}var f=h.which,a,d=h.ctrlKey,b=h.altKey,g=(!d&&!h.shiftKey&&!b),c=st.gF();
if(f>15&&f<19){n1=h.timeStamp+200}switch(f){case 13:if(eu){hZ();
eu.gH(hi());
fo(eu);
h2()}else{if(!c.gc()){hZ();
c.mX(hi());
h2()}}break;
case 27:eu=am;
eG=am;
if(hj){ob=T;
hj=F;
st.nl();
ih(aZ)}else{st.nc();
clearSelection()}nG();
break;
case 46:if(c.gc()){ny("deleteButton")}else{nE()}break;
case 49:case 97:ny("single");
break;
case 50:case 98:ny(d?"clean2D":"double");
break;
case 51:case 99:ny(d?"clean3D":"triple");
break;
case 65:if(d){hZ();
c.b0();
h2()}else{ny(aK)}break;
case 67:if(d){copy(h)}else{if(g){a=T}}break;
case 68:ny("singleDown");
break;
case 69:ny(aO);
break;
case 71:if(d){if(h.shiftKey){doUngroup()}else{createGroup()}}break;
case 76:if(g){a="Cl"}break;
case 77:ny("singleEither");
break;
case 66:case 70:case 72:case 73:case 78:case 80:if(g){a=T}break;
case 79:if(d&&b){$("#fileUpload").click()}else{if(g){a=T}}break;
case 81:ny(aP);
break;
case 82:if(g){a="Br"}break;
case 83:if(d&&b){saveFile()}else{if(g){a=T}}break;
case 84:ny("3d_rotate");
break;
case 85:if(d){doUngroup()}else{ny("singleUp")}break;
case 86:if(d){return}else{ny(aQ)}break;
case 87:ny(aM);
break;
case 88:if(d){cut(h)}break;
case 89:if(d){st.redo()}break;
case 90:if(d){st.undo()}break;
case 107:case 171:case 187:if(eu){hZ();
eu.gY(1);
fo(eu);
h2()}break;
case 109:case 173:case 189:if(eu){hZ();

eu.gY(-1);
fo(eu);
h2()}break;
case 110:case 190:if(eu){hZ();
eu.hA();
fo(eu);
h2()}break;
case 113:a2.focus().select();
break}if(a){if(a===T){a=String.fromCharCode(f)}if(eu){hZ();
eu.gH(a);
fo(eu);
h2()}else{nF(a)}}return bo(h)}function oc(b){var a=1/eH;
return new ck((b.x-0.5*od.x)*a+oe.x,(b.y-0.5*od.y)*a+oe.y)}function of(a){var b=a0.offset();
return oc(new ck(a.pageX-b.left,a.pageY-b.top))}function og(b,a){if(a){oh=[];
oi="M"+b;
oj={x:b.x,y:b.y,x2:b.x,y2:b.y}}else{oi+="L"+b;
oj.x=M.min(oj.x,b.x);
oj.x2=M.max(oj.x2,b.x);
oj.y=M.min(oj.y,b.y);
oj.y2=M.max(oj.y2,b.y)}oh.push(b)}function ok(){return(eu?eu.eq:(ol?ol.eq:(eG?eG.eq:am)))}function nz(){eu=ol=eG=lj=ll=am}function om(b){if(parent){parent.postMessage("focused","*")}if(hj||b.which!=1||st.hg()){return}if(eG&&eG.eN){if([aT,aO,aP].indexOf(hh)<0){ob=T;
return}}nR();
oo(b);
hj=T;
ob=F;
op=eu;
oq=ol;
or=eG;
os=ll;
ot=lj;
ou=F;
var d=of(b),a,c;
og(d,T);
switch(hh){case aO:case aP:case aX:case aM:case aK:case aL:case aT:case aN:st.nt();
break;
case aQ:case aR:case aS:a=st.gF();
st.nt();
if(a.gc()){a=new gx(T);
if(c=ok()){a.fM(c)}else{a.b0()}}nz();
st.nb(a);
break}return bo(b)}function ov(c,d,b,a){if(eh){ow(c,d,b,a)}else{ox+=b;
oy+=a;
if(oz){clearTimeout(oz)}oz=setTimeout(function(){ow(c,d,ox,oy);
ox=0;
oy=0},500)}return bo(c)}function ow(d,h,c,a){var g=of(d),f,j,k,b,i;
if(st.hf||d.ctrlKey){if(a<0){zoomOut()}else{zoomIn(cB(g,oe))}}else{if(d.shiftKey){f=(d.altKey?0.5:2.5);
if(d.ctrlKey){n5(-a*f,c*f)}else{n5(c*f,-a*f)}}else{if(!(j=st.hg())){hZ();
j=st.gF();
if(j.gc()){j=new gx(T);
j.b0()}}f=-M.PI*a/(d.altKey?af:12);
if(hh==aS){i=j.hI[0];
k=(i.c9.dI?i.c9:i.da);
b=(i.c9.dI?i.da:i.c9);
j.e9(f,k.c_.cd(),b.c_)}else{k=j.mW();
j.eV(f,(k?k.c_.cd():am))}}}nz();
ih(aZ);
ii();
oA()}function oB(x){nR();
if(st.hf&&x.which!=1){oC()}if(x.which==1&&!ob){oo(x);
var d=oD,p=oh[0]||d,a=st.dC(),y,m,r,b,v,t,k,n,w,c,h,q,g,j,f,o,l,u={};
if((ou||!x.ctrlKey)&&(y=st.hg())){r=y.mZ(a,oE);
for(v=0,t=bp(r);
v<t;
v++){a.mc(r[v],u)}b=y.mY(a,oE);
for(v=0,t=bp(b);
v<t;
v++){a.mb(b[v],t==1)}m=y.l5();
oF(m);
for(v=0,t=bp(m);
v<t;
v++){a.fM(m[v])}a.kR();
y.fz(bd);
st.nv()}else{if(!ou&&x.ctrlKey&&(k=(eu||ol))){switch(hh){case aT:a.j7(k.eq);
st.nv();
break;
default:n=st.gF();
if(!x.shiftKey){n.jN()}n.fM(k.eq);
st.nv()}}else{switch(hh){case aY:if(ou){zoomBox(p,d)
}else{zoomIn(d)}break;
case aQ:case aR:case aS:st.nv();
break;
case aO:case aP:if(!y){n=st.gF();
if(!x.shiftKey){n.jN()}w=0;
if(!ou){w=3;
n.m1(eu);
n.m1(ol);
n.m1(ll);
n.m1(lj)}if(hh==aO){n.addRectSelection(p,d,w)}else{og(d);
og(p);
n.m0(oh,oj)}}st.nv();
break;
case aW:hZ();
c=a.kZ(d);
fo(c);
h2();
break;
case aX:if(!ou){d.x+=lq}a.lG(p,d);
fo(a);
st.nv();
nG();
break;
case aM:if(ol&&!eu&&!ou){ol.i2();
st.nv()}else{q=F;
if(op){h=op.eq;
if(!op.ev&&op.bS(eu)){j=new gy(gz(op,1));
f=new gB(op,j,1,0);
h.fY(j);
h.f2(f);
j.gH(hi());
fo(op);
ih(aZ);
st.nv();
break}}else{if(er=="rxn"||!bp(a.f8)){h=new fJ();
a.fM(h);
q=T}else{h=a.f8[0]}}if((!op||!op.ev)&&(!eu||!eu.ev)&&jK(x,p,d,h,op,eu)){if(q){a.kT();
a.kU()}st.nv()}else{st.nl()}}break;
case aK:if(eu){eu.gH(hi());
fo(eu);
st.nv();
break}case aL:if(ol&&!eu&&!ou){ol.i2();
st.nv()}else{if((oq&&!op)||(op&&op.ev)||(eu&&eu.ev)){st.nl()}else{o=hi();
gA.gb();
g=op;
j=eu;
if(g&&j&&!j.bS(g)){if(f=g.hw(j)){f.i2()}else{g.eq.f4.jP(g,j)}}else{if(j&&j.bS(g)){ou=F;
j=am}if(!ou){d=am}q=F;
l=[];
if(er!="rxn"){h=a.f8[0]}else{if(g){h=g.eq}else{if(j){h=j.eq}}}if(!h){h=new fJ();
a.fM(h);
q=T}if(!g){g=new gy(p.cd());
h.fY(g);
l.push(g)}if(!j&&(ou||op||(hh==aL&&o==C))){j=new gy(gz(g,hl,d,x));
h.fY(j);
l.push(j)}h.f2(new gB(g,j,hl,hm));
for(v=0,t=bp(l);
v<t;
v++){l[v].gH(o)}if(q){a.kT();
a.kU()}}st.nv();
hj=F;
ih(aZ);
ii(T)}}break;
case aT:if(eG){eG.eq.ie(eG);
eG=am}else{if(eu){eu.eq.fI(eu);
eu=am}if(ol){ol.eq.fH(ol);
ol=am}if(ll){ll.f4.k2(ll);
ll=am}if(lj){lj.f4.k1(lj);
lj=am}}st.nv();
break;
case aN:if(eu){h=eu.eq;
if(h&&!eu.bS(h.es)){fo(h.es);
h.es=eu;
fo(eu);
st.nv()}else{st.nl()}}break}}}hj=F;
if(hh==aU){if(oG){oH(x,x.pageX,x.pageY)}else{nG()}}oA()}$(D.activeElement).focus()}function oI(g,i){var a={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"},d=g.originalEvent,f=d.changedTouches,b=a[d.type],h,c;
if(b){if(i||bp(f)==1){h=f[0];
c=D.createEvent("MouseEvent");
c.initMouseEvent(b,true,true,W,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);
h.target.dispatchEvent(c);
d.preventDefault();
if(b=="mouseup"&&!ou){c=D.createEvent("MouseEvent");
c.initMouseEvent("click",true,true,W,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);
h.target.dispatchEvent(c)}return T}return F}}function oJ(a){if(a){a.remove();
a.clear()}}function ih(a){if(!a){return}oJ(a.jO);
if(!eG){oJ(a.oK)}if(!eu){oJ(a.fS)}}function ii(e){var d=st.dC(),a=d.l6(oD),c=d.l8(oD),b;

if(eu&&(e||!eu.bS(a))){eu.hG();
fo(eu);
m7("outAtom",eu)}if(eG&&(e||!eG.bS(c))){eG.hG()}if(!a){eu=am;
b=d.l7(oD);
if(ol&&(e||!ol.bS(b))){m7("outBond",ol)}if(b&&(e||!b.bS(ol))){m7("overBond",b)}ol=b;
if(b){fo(b)}}else{if(e||!a.bS(eu)){eu=a;
if(ol){fo(ol);
m7("outBond",ol);
ol=am}eu.hF();
fo(eu);
m7("overAtom",eu)}}if(!c){setTimeout(function(){fo(eG);
eG=am},400)}else{if(e||(!c.bS(eG)&&(!eG||!eG.eN))){eG=c;
eG.hF();
fo(eG)}}}function m7(a,b){$(W).trigger(a,{obj:b})}function oo(b){nK=b.ctrlKey;
var a=b.clientX,c=b.clientY;
if(hk){a6.css({left:a-4,top:c-4})}a7.css({left:a+30,top:c+30});
oD=of(b);
ih(aZ);
if(!eu){gA.gb()}ii()}function oL(b,a,c){if(eh){oM(b,a,c)}else{clearTimeout(oN);
oN=setTimeout(function(){oM(b,a,c)},250)}}function oM(h,o,m){oo(h);
a0.css("cursor","");
var n,c,j,k,b,p,r,l,d,a,q,g,f;
if(hj){n=oD;
c=oh[0];
j=st.dC();
if(nB){og(n)}if(!ou){ou=(n.cU(c)>oO);
if(ou){switch(hh){case aO:case aP:if((op&&op.dI)||(oq&&oq.dI)||(os&&os.dI)||(ot&&ot.dI)){k=st.gF()}else{k=new gx(T);
if(op){k.fY(op)}else{if(or){k.h1(or);
eG=am;
ih(aZ)}else{if(oq){k.fY(oq.c9);
k.fY(oq.da);
k.f2(oq)}else{if(os){k.fV(os)}else{if(ot){k.kI(ot)}}}}}}if(!k.gc()){st.nb(k)}break}}}if(k=st.hg()){switch(hh){case aQ:case aS:if(ou){b=bG(k.ne);
p=M.atan2(n.y-c.y,n.x-c.x);
if(hh==aS){q=k.hI[0];
r=(q.c9.dI?q.c9:q.da);
l=(q.c9.dI?q.da:q.c9);
k.e9(p-b,r.c_.cd(),l.c_)}else{k.eV(p-b,c)}k.ne=p;
k.fd();
aZ.jO.push(aZ.path("M"+c+"L"+n).attr(aB,"#f00").attr(aD,df),aZ.text(n.x,n.y+30/eH,round(p*ah,1)+"°").attr(aA,2+20/eH))}break;
case aR:if(ou){b=(k.nd||c);
k.nd=n;
p=(h.altKey?0.01:0.1);
k.eW(p*(b.y-n.y),p*(n.x-b.x),k.d6())}break;
default:oP(c,n,j,aZ)}}else{switch(hh){case aY:case aO:oQ(aZ,c,n);
break;
case aP:aZ.jO.push(aZ.path(oi+"Z").attr(oR));
break;
case aM:if((!op||!op.ev)&&(!eu||(!eu.ev&&!eu.bS(op)))){jK(h,c,n,am,op,eu)}break;
case aK:case aL:if(ou&&!oq&&(!op||!op.ev)&&(!eu||(!eu.ev&&!eu.bS(op)))){gA.gb();
r=op;
l=eu;
d=[];
if(r&&(q=r.hw(l))){q=gA.f2(q);
q.i2()}else{a=hi();
if(!r){r=gA.fY(new gy(c.cd()));
d.push(r)}if(!l){l=gA.fY(new gy(gz(r,hl,n,h)));
d.push(l)}gA.f2(new gB(r,l,hl,hm));
for(g=0,f=bp(d);
g<f;
g++){d[g].gH(a)}}gA.fd()}break;
case aX:if(ou){gA.ga(c,n);
gA.fd()}break;
case aT:if(eu){eu.eq.fI(eu);
eu=am}if(ol){ol.eq.fH(ol);
ol=am}break}}}else{if(ol){switch(hh){case aK:a0.css("cursor","move");
break;
case aL:fo(ol);
var q=gA.f2(ol);

q.i2();
gA.fd();
break}}}switch(hh){case aO:case aP:if(eu||ol){a0.css("cursor","move")}break}oA()}function oQ(d,c,e){var b=M.min(c.x,e.x),a=M.min(c.y,e.y);
d.jO.push(d.rect(b,a,M.abs(e.x-c.x),M.abs(e.y-c.y)).attr(oR))}function oP(b,j,g,c){var h=st.hg(),m,l,d,a,n,k,f,e;
if(!h){return}m=(h.nd||b);
l=j.cA(m);
h.cv(l.x,l.y);
h.nd=j;
if(g){d=h.mY(g,1.5*oE);
for(f=0,e=bp(d);
f<e;
f++){a=d[f];
n=a.lv.c_;
k=a.lu.c_;
c.jO.push(c.ellipse(n.x,n.y,oE,oE).attr(oS).attr(aH,a.cU<oE?oT:oU));
c.jO.push(c.ellipse(k.x,k.y,oE,oE).attr(oS).attr(aH,a.cU<oE?oT:oU))}}}function oV(c,d,b){var a="templates/"+b+".mol";
jQuery.get(a,{},function(e){d.push(new oW(a,e,c));
oV(c,d,b+1)},"text")}function oX(){var a=$("#builtinTemplates").remove(".template");
if(!bK("noTemplates")){oV(a[0],oY.server,0)}}function addTemplate(b,e){var d,a,c=$(e?"#tmpl"+e:"#serverTemplates"),f=oY.server;
if(!c.length){$("<tr>").append($("<td>").addClass("menuWithPopup").mouseleave(nR).click(nR).append(c=$("<div id="+bE("tmpl"+e)+' class="menuPopup templatesMenu">'+getImgSt("del")+' class="button" style="float:right" onClick="hideMenu();"/></div>').css({opacity:0.85}).mouseleave({obj:this},oZ).click(nP)).append($(getImgSt(e)+' class="button"/>').mouseenter(nQ).click(nN))).insertBefore("#groupSelection")}if($.isArray(b)){for(d=0,a=bp(b);
d<a;
d++){f.push(o0(b[d],c))}}else{f.push(d=o0(b,c));
return d}}function o0(a,b){try{a=pako.ungzip(atob(a),{to:"string"})}catch(c){}return new oW(am,a,b)}function gI(b){if(!b){return}b=b.charAt(0).toUpperCase()+b.substr(1);
for(var d,c=0,a=bp(oY.server);
c<a;
c++){d=oY.server[c];
if(d.es&&$.inArray(b,d.o1)!=-1){return d}}}function o2(){if(this.url){jQuery.get(this.url,{},function(a){this.o3(a);
this.fd()},"text")}}function o4(){var a=this,f=a.f4,c,b,e,g,j=kw,h=kw,d=a.o5.parent(".templatesMenu");
for(c=0,b=bp(f.f8);
c<b;
c++){e=f.f8[c];
if(!a.es){a.es=e.es}if(!a.tooltip){a.tooltip=e.a4}if(!$.isArray(a.o1)){a.o1=e.a3}}g=bH(a.tooltip);
if(a.o1&&bp(a.o1)){g+=" ("+a.o1.join(",")+")"}a.o5.attr("title",g);
f.d3();
j+=M.max(o6-f.dc.x+f.de.x,0);
h+=M.max(o6-f.dc.y+f.de.y,0);
a.dk.setViewBox(f.de.x-j,f.de.y-h,f.dc.x-f.de.x+2*j,f.dc.y-f.de.y+2*h);
d.show();
f.fd();
d.hide()}function oF(c){for(var b=0,a=bp(c);
b<a;
b++){fo(c[b].es);
c[b].es=am}}function o7(b,a,c){oG=F;
o8=b.data.obj;
oH(b,a,c);
oZ();
setTimeout(nR,700)}function o9(b,a,c){oG=T}function oH(b,a,c){o_();
oL(b,a,c)}function o_(){activateTool(am,aU);
pa(o8.f4.cd(),o8.es)}function pa(c,b){st.nt();
var e=c.f8,g=st.dC(),d,a,f=new gx(T);
c.mg(aZ);
for(d=0,a=bp(e);
d<a;
d++){g.fM(e[d],F,T);
f.fM(e[d])}hj=T;
oh[0]=(b?b.c_:f.d6());
st.nb(f)}function pb(c){var b=c.data.obj,a=$(b.o5[0].firstChild).clone().attr("width",pc).attr("height",pc);

$("#overlay").empty().append(a).show().mouseenter(function(){$(".templatesMenu").hide()})}function oZ(){var a=$("#overlay");
if(bi){a.hide()}else{a.fadeOut()}}function gJ(){var a=new ce();
this.f4.cd(a);
return a.cc(this.es)}function pd(a){var b=this;
b.f4=new fL(b.dk,a);
b.f4.fQ=am}function oW(b,a,c){var f=this,e,d=(hk?33:50);
f.url=b;
f.o5=$("<div>").css({display:"inline-block"}).addClass("button template").appendTo(c).click({obj:f},o7).dblclick({obj:f},o9).mouseenter({obj:f},pb);
f.dk=new Raphael(f.o5[0],pe,pf);
bP.apply(f.dk);
nm(f.dk);
f.o3=pd;
f.o3(a);
if(e=f.f4.f8[0]){e=bH(e.a4).substr(0,12);
f.o5.append($("<div>").css({position:"absolute",top:0,height:"100%",padding:"25% 3px","background-color":"white",opacity:0.3,"font-size":(bp(e)>6?d:d*2)+"%"}).text(e))}f.gJ=gJ;
f.reload=o2;
f.fd=o4;
f.fd()}var isReady=F,lang=bF(bK("lang"),"en"),bN=["en","de"],langDef={},pg=(typeof nw!="undefined"),ph=!!bK("embedded"),eh=Raphael.svg,hk=(nW()=="mobile"),iconSize=(hk?35:20),nS=bi,oe=new ck(),eH,pi=1000,pj=0.001,pk=0.25,ik=16,od,st,mq,gA,hh,hl=1,hm=0,er=bF(bK("mode"),"mol"),eA=!!bK("debug"),ob=F,nK,oD,nO,eu,eG,ol,lj,ll,hj=F,n0=F,n1=0,n_,oN,oz,ox=0,oy=0,ou,nB=F,oh=[],oi="",oj={},op,or,oq,ot,os,pl=4,oO=3,nD,o8,oG=F;
bM();
var nq=30,jx=12,jM=30,pe=50,pf=50,eD=10,dd=eD*1.4,dm=2,dh=1.5,dg=0.06,dj=0.01,ed=1.5*eD,dH=7,lq=55,dP=7,dQ=0.2,h5=0.5,oE=0.25*eD,pm=0.1,eC=0.38,df=(eh?0.333333333:1),dL=1,ez=0.02*eD,ey=6,ib=eD*0.5,kf=eD*0.25,lU=2,jL=30,pc,eI="#000",dK=eI,dl=(eA?"gray":"#fff"),et="#f00",dJ="#0f0",dU="#666",ex="#00f",ew="#f00",oT="#0f0",oU="#f00",oS={"stroke-width":0,"fill-opacity":0.4},oR={stroke:dJ,fill:dJ,"fill-opacity":0.2},eL={stroke:"deepskyblue",fill:"deepskyblue","fill-opacity":0.2,"stroke-width":df},oY={server:[]},kw=0.45*eD,o6=3.5*kw,pn=dd/720,po=0.2,kt=0.3,ks=0.6*dd,pp=0.3*dd,pq=400,pr=80,ps=0.6,pt=0.1;
function hi(){var a=a2.val();
if(!a){a=C}return a}function nF(a){a2.val(a)}function n7(){var a=1/eH;
if(aZ){aZ.setViewBox(oe.x-0.5*a*od.x,oe.y-0.5*a*od.y,od.x*a,od.y*a)}if(!eh){st.dC().fd()}}function pu(a){oe=a;
n7()}function pv(a){if(!a){return pl}return M.max(M.min(a,pi),pj)}function oC(f){var c=st.dC(),b,e,a,d;
if(bp(c.getAtoms())>0){c.d3();
b=c.de.x-ed;
e=c.de.y-ed;
a=c.dc.x+ed;
d=c.dc.y+ed;

eH=pv(M.min(od.x/(a-b),od.y/(d-e)));
if(f&&eH>f){eH=f}}else{eH=pl}pu(new ck(0.5*(b+a),0.5*(e+d)))}function zoomBox(a,b){eH=M.min(pi,od.x/M.abs(b.x-a.x),od.y/M.abs(b.y-a.y));
pu(cB(a,b))}function zoomIn(a){n6();
if(a){pu(a)}else{n7()}if(!st.hf){nG()}}function n6(){if(eH<pi){eH/=1-pk}}function zoomOut(){if(hh==aY){nG()}n8();
n7()}function n8(){if(eH>pj){eH*=1-pk}}function n5(b,a,f){var e=b*eD/eH,d=a*eD/eH,c=st.gF();
if(st.hf||c.gc()){oe.x+=e;
oe.y+=d;
if(f&&!st.hf){hZ();
st.dC().cv(0,0,f);
h2()}n7()}else{hZ();
c.cv(e,d,f);
h2()}ii()}function eJ(a){if(!hj){return bo(a)}}function iC(){}function pw(){if(!a0){a0=$("#svgParent")}if(aZ){aZ.canvas.style.display="none"}od=new ck(a0.width(),a0.height());
if(aZ){aZ.canvas.style.display="";
aZ.setSize((eh?"100%":od.x),od.y)}else{aZ=new Raphael("svgParent",(eh?"100%":od.x),od.y);
bP.apply(aZ);
aZ.px=T;
st=new nx();
nm(aZ);
gA=new f9();
aZ.canvas.onselectstart=bo;
a0.mousedown(om).mousemove(oL).mouseup(oB).mousewheel(ov).mouseover(nU).mouseout(nV).bind("touchstart",oI).bind("touchmove",oI).bind("touchend",oI)}n7()}function clearSelection(){hZ();
st.gF().jN();
h2()}function nE(){hZ();
st.gF().mw();
h2()}function cut(a){hZ();
st.gF().cut(a);
h2()}function copy(a){st.gF().copy(a)}function getSelectionAsMolfile(){return mr(st.gF().cd().m2())}function getNonselectionAsMolfile(){return mr(st.gF().mo().cd().m2())}function py(e,d){var c,a;
if(d){var b=e.getData(d),c=new fL(aZ,b);
if(bp(c.getAtoms())){if(c.kJ==0||c.kJ==bp(c.f8)){c.k2()}else{if(st.dC().fQ){c.k2(T)}}d=c.kK;
d.my=T;
d.b0(c);
return d}}else{for(a=0,d=bp(bc);
a<d;
a++){c=py(e,bc[a]);
if(c){return c}}nM(e.files,aV,T)}}function pasteMolFile(a){pa(new fL(aZ,a))}function paste(b){var c=(b?(b.originalEvent||b):W).clipboardData,a;
activateTool(am,aV);
st.nt();
if(c){a=py(c)}if(!a&&mq){a=mq.cd(am,T)}if(a){st.dC().md(a);
hj=T;
oh[0]=a.d6();
st.nb(a);
ii();
return bo(b)}else{st.nl()}}function flip(a){hZ();
var b=st.gF();
if(b.gc()){b.b0();
b.e0(a,oe);
b.jN()}else{b.e0(a)}h2()}function doUngroup(){var a=st.gF();
if(eG){hZ();
eG.il();
h2()}else{if(!a.gc()){hZ();
a.ungroupGroups();
h2()}}}function clearReaction(){ma("")}function nm(a){a.clear();
a.jO=a.set();
a.oK=a.set();
a.fS=a.set();
a.fp=[]}function saveContent(b,a){var c=D.createElement("a");
c.download=a;
c.href="data:,"+encodeURIComponent(b);
c.click()}function saveFile(a){saveContent(l_(),er=="rxn"?(a||"reaction")+".rxn":(a||"molecule")+".mol")
}function getSVG(b,d){if(aZ&&aZ.canvas){var e=st.dC(),c,a;
e.d3();
c=e.dc.x-e.de.x+2*ed;
a=e.dc.y-e.de.y+2*ed;
aZ.setSize(c,a);
aZ.setViewBox(e.de.x-ed,e.de.y-ed,c,a);
$(aZ.canvas).prepend($("<title>").text(b)).children("desc").text(d);
c=aZ.canvas.outerHTML;
pw();
return c}}function saveSVG(a){var b=getSVG();
if(b){saveContent(b,(a||"structure")+".svg")}}function oA(){fr(aZ)}function l_(){st.nl();
return st.dC().l_()}function ma(b){if(!aZ){pw()}nm(aZ);
var a=new fL(aZ,b);
st.ns(a);
if(eh){a.fd()}h2();
oC(3)}function getReadOnly(){return st.hf}function setReadOnly(b){if(st.hf!=b){st.hf=b;
var a=$("#leftCol");
if(b){a.attr("data-width",a.attr("width"));
a.attr("width",1);
$(".toolbar").hide();
gA.gb();
st.nl();
nz();
ih(aZ);
oA();
nC()}else{a.attr("width",a.attr("data-width"));
$(".toolbar").show();
a8=T}}}function getDisplayAtomNumbers(){return st.dp}function setDisplayAtomNumbers(a){if(st.dp!=a){st.dp=a;
st.dC().fd()}}function highlightAtom(d,b,a){if(a==am){a=T}var c=st.dC().f8[bG(b)];
if(c){if(!Array.isArray(d)){d=[d]}$.each(d,function(e,g){var f=c.d5[g];
if(f){f.dq=a;
f.fd()}})}}function unhighlightAtoms(b){var a=st.dC(),e,d,c;
if(b!=am){e=a.f8[bG(b)];
for(c=bp(e.d5)-1;
c>=0;
c--){d=e.d5[c];
if(d.dq){d.dq=F;
d.fd()}}}else{for(c=bp(a.f8)-1;
c>=0;
c--){unhighlightAtoms(c)}}}function highlightBond(c,b,a){if(a==am){a=T}var d=st.dC().f8[bG(b)],e;
if(d){e=d.dv[c];
if(e){e.dq=a;
e.fd()}}}function unhighlightBonds(b){var a=st.dC(),d,e,c;
if(b!=am){d=a.f8[bG(b)];
for(c=bp(d.dv)-1;
c>=0;
c--){e=d.dv[c];
if(e.dq){e.dq=F;
e.fd()}}}else{for(c=bp(a.f8)-1;
c>=0;
c--){unhighlightBonds(c)}}}function unhighlightAll(a){unhighlightAtoms(a);
unhighlightBonds(a)}function showURL(a){var c=$("#infoArea"),b=(hk?1.8:1);
if(!a){c.hide();
pw()}else{if(a.indexOf("/")<0&&(c.firstChild||(od.x>600*b&&od.y>400*b)||!open(a))){c.show().height("50%");
$("#infoContent").html("<iframe src="+bE(a)+' width="99%" height="'+(bi?0.5*od.y:"95%")+'"/>');
pw()}}}function getMode(){return er}function getParams(){return"?lang="+lang+"&mode="+er+"&embedded="+(ph||"")}function m5(b,a){bi?(a?b.show():b.hide()):(a?b.slideDown():b.slideUp())}function getImgSt(a){return'<img src="icons/'+a+(eh?'.svg" width="'+iconSize+'" height="'+iconSize+'"':'.png"')}$(D).ready(function(){a1=$("html");
a2=$("#newAtomSym");
a3=$("#templateShortcuts");
a4=$("#templateName");
a5=$(".templatesMenu").css({opacity:0.85}).mouseleave({obj:this},oZ);
a7=$("#editIcon");
$("#fileUpload").change(nL);
a1.bind("paste",paste).bind("drop",nL).bind("dragover",nJ).bind("dragend",bo).keydown(nZ).keyup(oa);
$("#info").bind("contextmenu",stopPropagation);
if(pg){a1.bind("contextmenu",bo)}if(!eA){$("body").bind("contextmenu",bo)}a1.onscroll=bo;
if(hk){a1.bind("input",nY)}W.onresize=pw;
var a=M.min(a1.width(),a1.height()),b;
for(b in gd){if(!gd[b]["iso"]){gl[gd[b]["an"]]=b}}eH=pv(0.01*a);
pc=M.min(600,a)+aq;
pw();
b=a0.offset();
$("#overlay").css({left:b.left+aq,top:b.top+aq});
if(er=="rxn"){$(".modeRxn").show()
}else{if(er=="tmpl"){$(".modeTmpl").show()}else{$(".modeMol").show()}}if(!bi&&!ph){$(".modeFile").show()}if(ph){$("#copyright").hide();
$("#info").css("font-size","7pt")}if(bK("readonly")){setReadOnly(T);
nH("#3d_rotate")}else{$(ay+" > img").mouseenter(nQ).click(nN);
$(ay).mouseleave(nR).click(nR);
$(ax).click(nP);
$(".tool").click(nT);
$("td.separator + td").addClass("afterSeparator");
setTimeout(function(){oX()},50);
bO();
nH(".defaultTool");
if(!bK("nofocus")){a2.focus().blur()}}if(a=bK("load")){jQuery.get(a,{},function(c){ma(c)},"text")}$.rule(ax).css("left",(iconSize+6)+"px");
if(hk){a6=$("#touchCursor").show();
$.rule("input,.button").css("font-size","20pt");
a2.click(function(){this.select()})}isReady=T});
function cleanStructure(d){st.nl();
var e,c=st.gF(),f=[],b,a;
hZ();
if(c.gc()){f.push(st.dC())}else{f=c.mV()}for(b=0,a=bp(f);
b<a;
b++){e=f[b];
e.jG(d);
e.fd()}h2();
oC(3);
if(o8&&hh==aU){o_()}}function mf(e){var g=this,f=g.f8,b,d,a,c=0,h;
g.k2(F);
for(d=bp(g.kH)-1;
d>=0;
d--){g.k1(g.kH[d],T)}for(d=bp(f)-1;
d>=0;
d--){b=f[d];
if(!bp(b.d5)){b5(b,g.f8);
if(d<g.kJ){g.kJ--}}}h=g.kJ;
for(d=0,a=bp(f);
d<a;
d++){b=f[d];
b.jG(e);
if(d==h){g.lG(c,am,T);
c+=lq+ed}else{if(d>0){g.kZ(c,0,T);
c+=dH+ed}}b.d3();
b.jX(c);
c+=(b.dc.x-b.de.x)+ed}if(d==h){g.lG(c)}g.kJ=h;
oC(3);
nz()}function kF(d){if(!this.jS){this.iL()}for(var e=this,c=e.kC(),b=0,a=bp(e.jS);
b<a;
b++){e.jS[b].jG(d,c)}}function jH(c,b){var d=this,a=d.d6().cd();
new pz(d,c,b);
d.cv(a.cA(d.d6()))}function pA(){var e=this,c=e.ip,g,h,f=e.pB(),l=e.pC(),b=e.pD(),j,d,a,i=ps,k=c.jI();
while((e.pE=f+l+b)>pt){if(g==1||(!g&&b>f)){e.pF(i);
h=1}else{e.pG(i);
h=2}j=e.pB();
d=e.pC();
a=e.pD();
if(j+d+a<e.pE){f=j;
l=d;
b=a;
k=c.jI();
i*=0.98}else{c.jJ(k);
if(M.abs(i)<0.05){break}if(g){i*=0.5;
g=0}else{i*=-0.8;
if(h==1){g=2}else{g=1}}}}}function pH(){var d=this,b=!d.pI,c=d.ip,l,g,f,k,e,a,n,m,h,o=0;
d.pJ=[];
for(l=0,g=bp(c.d5);
l<g;
l++){k=c.d5[l];
if(!k.d1){for(f=0;
f<l;
f++){e=c.d5[f];
a=k.c_.cU(e.c_,b);
if((n=ks*(b?1:2)-a)>0){m=kt*n*n;
d.pJ.push(new pK(k,e,a,n,m));
o+=m}}if(b){o+=M.abs(k.c_.z)}}}for(l=0,g=bp(c.dv);
l<g;
l++){k=c.dv[l];
if(!k.d1){h=dd;
if(k.dw==0){h*=1.3}a=k.c9.c_.cU(k.da.c_,b);
if(a!=h){d.pJ.push(k)}k.pL=h;
k.bp=a;
n=M.abs(h-a);
m=(a>pp?n:n*pq);
k.pM=m;
o+=m}}return o}function pN(){var r=this,f=!r.pI,k=r.ip,n,l,m,p,b,c,u,t,a,v,e,h,g,q,o=0;
for(n=0,l=bp(k.dv);
n<l;
n++){c=k.dv[n];
if(!c.d1){u=c.c9;
t=c.da;
a=t.c_.cA(u.c_,f);
if(!a.x&&!a.y&&!a.z){o+=pr;
continue}e=a.cC();
g=am;
for(m=0,p=bp(k.d5);
m<p;
m++){b=k.d5[m];
if(!b.d1&&!b.bS(u)&&!b.bS(t)){v=b.c_.cA(u.c_,f);
if((q=pp-e.cr(v).bp())>0){if((h=a.co(v))>=0&&h<=(g||(g=a.co(a)))){o+=pr*q*q}}}}}}return o}function pO(){var e=this,b,a,d,f,c=0;
for(b=0,a=bp(e.pP);
b<a;
b++){d=e.pP[b];
d.pQ();
f=pn*(po*d.cU*d.cU+M.abs(d.cU));
d.pM=f;
c+=f}return c}function pR(){for(var f=this,d=0,c,a,e=[],b;

d<3;
d++){f.pS[d].pQ()}f.cU=0;
if(a=f.pT){for(d=0;
d<3;
d++){e[d]=[];
for(c=0;
c<3;
c++){e[d][c]=(f.pS[d].pU?M.abs(a[c]-f.pS[d].pT):0)}}b=pV(e);
for(d=0;
d<3;
d++){for(c=0;
c<3;
c++){if(f.pS[d].pU){if(c!=b[d]){e[d][c]=ar}}else{e[d][c]=M.abs(a[c]-f.pS[d].pT)}}}b=pV(e);
for(d=0;
d<3;
d++){f.cU+=(f.pS[d].pT=e[d][b[d]])}}}function pV(e){for(var g=0,b=bp(e),j=[],h=[],f,a,l,d;
g<b;
g++){h[g]=0;
j[g]=g}d=pW(e,j);
l=j.slice();
g=1;
while(d>0&&g<b){if(h[g]<g){f=g%2&&h[g];
a=j[g];
j[g]=j[f];
j[f]=a;
++h[g];
g=1;
if(pW(e,j)<d){l=j.slice()}}else{h[g]=0;
++g}}return l}function pW(e,d){for(var b=0,c=0,a=bp(d);
b<a;
b++){c+=e[b][d[b]]}return c}function pX(){var d=this,b=d.pY,c=d.pZ,a=d.gN;
d.p0=(d.p1.pI?ke(a,c,b):eB(a,c,b));
d.cU=d.p0-d.pT}function p2(){var c=this,b=c.gN,a=bp(b.dv);
if(a>3||a==b.gW()){if(a<5){c.pT=[aj,aj,aj]}else{if(a==5){c.pT=[ad,ad,ae]}else{if(a==6){c.pT=[ad,ad,ad]}else{if(a==7){c.pT=[72,ad,ad]}else{if(a==8){c.pT=[0.5*aj,ad,ad]}}}}}}else{c.pT=[ae,ae,ae]}}function p3(b){var h=this,a=h.p1,f=h.gN,d=bp(f.dv),e=f.gW(),c=f.dt,g;
if(e==4&&d==2){h.pT=af}else{if((a.pI?d==e:d==4)&&(c=="P"||c=="S")){h.pT=ad}else{if(a.pI&&(c=="P"||c=="S"||d==e)){h.pT=aj}else{if(d==6||(d>3&&h.p0<90)){h.pT=60}else{if((g=a.p4)&&bp(g)&&d==3&&(c=="N"||c=="P")){h.pT=(b?210:(a.pI?90:75))}else{if(d==2&&h.p0>af){h.pT=240}else{h.pT=ae}}}}}}}function p5(d,c){if(d.pM==c.pM){return 0}if(d.pM==undefined||d.pM<c.pM){return 1}return -1}function p6(l){var n=this.pJ,k=this.pI,j,g,h,f,e,a,c,b,r,q,p=0,d,o,m;
if(g=bp(n)){l=M.abs(l);
n.sort(p5);
for(j=0;
j<g;
j++){h=n[j];
if(h.pM<0.1){break}if(j/g<M.random()){a=h.bp;
c=h.c9;
b=h.da;
r=l*(b.c_.x-c.c_.x)*(h.pL-a)/a;
q=l*(b.c_.y-c.c_.y)*(h.pL-a)/a;
if(k){p=l*(b.c_.z-c.c_.z)*(h.pL-a)/a}o=bp(c.dv);
m=bp(b.dv);
d=o+m;
o/=d;
m/=d;
if(!(h instanceof gB)||bp(h.d4())==0){f=c.hs(b);
f.fH(h);
e=b.hs(c);
e.fH(h)}else{f=c.c_;
e=b.c_}f.cv(-r*m,-q*m,-p*m);
e.cv(r*o,q*o,p*o)}}if(!k){l=0.9-l;
for(n=this.ip.ft(),j=g-1;
j>=0;
j--){if(n[j]){n[j].z*=l}}}this.ip.cC()}}function p7(b,a){return(M.abs(b.cU)<31-M.abs(a)*50?0:(b.cU>0?-1:1))}function p8(w){var A=this.pP,x=this.p9,G,z,E,L,B,r,a,b,l,K,g=[],I,v,e,o,n,h,f,m=[],q=(w>0?1:0),t,J,u,N,d,p,y,O,c;
x.sort(p5);
for(G=0,z=bp(x);
G<z;
G++){f=F;
r=x[G];
b=r.gN;
a=b.c_;
u=d=p=0;
N=a.e1(r.p_[0].c_,r.p_[1].c_,r.p_[2].c_);
for(E=0;
E<3;
E++){l=r.dv[E];
N/=l.c9.c_.cU(l.da.c_)+Number.qa}if(t=(M.abs(N)<0.0001)){e=0;
for(E=0;
E<3;
E++){O=r.pS[E].p0;
e+=O;
if(O>u){u=r.pS[E].p0;
N=E}}e=(e<358);
u=p7(r.pS[N],w)}for(E=0;
E<3;
E++){d+=(K=p7(r.pS[E],w));
if(K==0){p++;
if(!t){N=E}}}if(p<3){y=[];
for(E=0;
E<3;
E++){l=r.dv[E];
if(bp(l.d4())){O=new gx(T);
O.f2(l);
O.fY(l.gS(b));
f=T}else{O=l.hs(b)}y.push(O)}if(t){c=r.pS[N];
if(M.abs(d)>1&&e){o=a.eX(c.pZ.c_,c.pY.c_);
n=a.cN(o);
l=0;
for(E=0;
E<3;
E++){l+=(E==N?1:-1)*r.pS[E].cU;
g[E]=0}for(E=0;
E<3;
E++){if(E!=N){J=r.pS[E].cU+0.3*l;
for(B=0;
B<3;
B++){if(E!=B){g[B]+=(a.e1(r.dv[B].gS(b).c_,r.dv[E].gS(b).c_,n)>0?1:-1)*J}}}}for(E=0;
E<3;
E++){y[E].cD(g[E]*ag,o,a)}}if(d<0||(e&&u<d-u)||(r.pS[N].p0>175&&r.pS[N].cU>0)){J=0;
for(B=0;

B<3;
B++){if(!e||N!=B){J-=r.pS[B].cU}}c=a.eX(c.pZ.c_,c.pY.c_,r.p_[N].c_);
for(B=0;
B<3;
B++){y[B].cD(bJ((B==N?0.5:-0.25)*J*w,-30,30)*ag,c,a)}}}if(M.abs(d)>(t?2:1)){J=0;
c=a.e2(r.p_[0].c_,r.p_[1].c_,r.p_[2].c_);
for(E=0;
E<3;
E++){for(B=0;
B<3;
B++){if(E!=B){J-=r.pS[B].cU}}y[E].cD(bJ(J*M.abs(w),-30,30)*ag,c[E],a)}}else{if(p==1&&(!t||u==0)){for(B=0;
B<3;
B++){if(N!=B){if((h=r.pS[B].cU)>0){o=B}else{n=B}J+=M.abs(h)}}if(o+n){c=a.eX(r.p_[n].c_,r.p_[o].c_);
y[N].cD(bJ(0.5*J*M.abs(w),-30,30)*ag,c,a)}}}}if(f){for(B=0;
B<3;
B++){c=this.qb[r.p_[B].bQ];
if(c){for(E=0,L=bp(c);
E<L;
E++){c[E].pQ()}}}}else{for(B=0;
B<3;
B++){r.pS[B].pQ()}}}if(bp(A)){A.sort(p5);
w=M.abs(w);
m=[];
for(G=0,z=bp(A);
G<z;
G++){r=A[G];
if(r.pM<1){break}if(G/z<M.random()&&(G+q)%2){b=r.gN;
a=b.c_;
o=r.pZ;
n=r.pY;
h=bp(o.dv);
f=bp(n.dv);
e=h+f;
c=a.eX(n.c_,o.c_);
if(L=bp(r.qc)){for(E=0;
E<L;
E++){I=r.qc[E];
v=I.hs(b);
v.cD(w/ps/L*r.cU*ag*(I.i5(n)?1:-1),c,a)}}else{if(!bY(m,b)&&!bY(m,o)&&!bY(m,n)){m.push(b,o,n);
o.c_.cD(r.cU*w*f/e*ag,c,a);
n.c_.cD(r.cU*-w*h/e*ag,c,a)}}}this.ip.cC()}}}function qd(p){var o=this.pP,h,f,e,c,g,k,b,t,d,r,q,m,l,a=[],n=(p>0?1:0);
p=M.abs(p);
if(f=bp(o)){o.sort(p5);
for(h=0;
h<f;
h++){g=o[h];
if(g.pM<1){break}if(h/f<M.random()&&(h+n)%2){k=g.gN.c_;
m=g.pZ;
l=g.pY;
r=bp(m.dv);
q=bp(l.dv);
d=r+q;
if(c=bp(g.qc)){for(e=0;
e<c;
e++){b=g.qc[e];
t=b.hs(g.gN);
t.eV(p/ps/c*g.cU*ag*(b.bS(g.dv[0])?1:-1),k)}}else{if(!bY(a,g.gN)&&!bY(a,m)&&!bY(a,l)){a.push(g.gN,m,l);
m.c_.eV(g.cU*p*q/d*ag,k);
l.c_.eV(g.cU*-p*r/d*ag,k)}}}}this.ip.cC()}}function pK(b,a,c,e,d){this.c9=b;
this.da=a;
this.pL=ks;
this.bp=c;
this.cU=e;
this.pM=d}function qe(a,d,c,b){var e=this;
bP.apply(e);
e.p1=a;
e.gN=d;
e.pZ=c;
e.pY=b;
e.dv=[d.hw(c),d.hw(b)];
e.qf=qg;
e.pQ=pX;
e.qh=p3;
e.pQ()}function qi(a,e,d,c,b){var f=this;
bP.apply(f);
f.gN=e;
f.p_=[d,c,b];
f.dv=[e.hw(d),e.hw(c),e.hw(b)];
f.pS=[a.qj(e,c,b),a.qj(e,d,b),a.qj(e,d,c)];
f.qf=qk;
f.pQ=pR;
f.qh=p2}function ql(g,f,d){for(var h=this,c=h.qb[g.bQ],b,e=0,a=bp(c);
e<a;
e++){b=c[e];
if((f.bS(b.pZ)&&d.bS(b.pY))||(f.bS(b.pY)&&d.bS(b.pZ))){break}}if(e==a){b=new qe(h,g,f,d)}return b}function qm(h,b,a,j){var e=this,c=e.qn[h.bQ],g,f,d;
if(c){for(g=0,f=bp(c);
g<f;
g++){d=c[g];
if(bY(d.p_,b)&&bY(d.p_,a)&&bY(d.p_,j)){break}}}else{c=[];
e.qn[h.bQ]=c}if(g==f){d=new qi(e,h,b,a,j);
c.push(d);
e.p9.push(d);
d.qf()}return d}function qk(){for(var a=0;
a<3;
a++){this.pS[a].qf()}this.qh()}function qg(k){var b=this,f=b.p1,g=b.dv,e=bp(g)-1,d,c,h,j,a=(b.p0<af||bp(b.gN.dv)>2);
if(!b.qc){if(a){b.qc=[];
for(;
e>=0;
e--){if(!bp(g[e].d4())){b.qc.push(g[e])}}f.qb[b.gN.bQ].push(b)}j=b8(f.hu,g[0].d4(),g[1].d4());
if(d=bp(j)){for(e=0;

e<d;
e++){c=j[e];
h=f.qo[c.bQ];
if(!h){h=[];
f.qo[c.bQ]=h}if(a){h.push(b)}if(!c.pT){k=bp(c.d5);
c.pT=(f.pI&&!c.jq()&&(k==8||(k==6&&c.jr()))?aj:qp(k))}}b.pT=(a?j[0].pT:ak-j[0].pT);
b.pU=T}else{b.qh(k)}}return !!d}function qp(a){return af-ak/a}function qq(d,c){if(d.p0<c.p0){return 1}if(d.p0>c.p0){return -1}return 0}function qr(){var p,l,h,b,g,f,d,e=this,c=e.ip,t,u,r,q,o,a,w,v;
for(p=0,l=bp(c.d5);
p<l;
p++){t=c.d5[p];
if(!t.d1){u=t.dv;
a=[];
e.qb[t.bQ]=[];
b=bp(u);
if(e.pI&&b>2){for(h=0;
h<b;
h++){r=u[h];
if(!r.d1){for(g=h+1;
g<b;
g++){q=u[g];
if(!q.d1){for(f=g+1;
f<b;
f++){o=u[f];
if(!o.d1){for(d=f+1;
d<b;
d++){if(u[d].i6().e4(r.i6(),q.i6(),o.i6())){d=-1;
break}}if(d>0){e.qs(t,r.gS(t),q.gS(t),o.gS(t))}}}}}}}}else{if(b>1){for(h=0;
h<b;
h++){a.push(new gM(t,u[h].gS(t)))}a.sort(gO);
v=T;
for(h=0;
h<b;
h++){g=(h+1)%b;
w=e.qj(t,a[h].gN,a[g].gN);
if(!w.qf(v)){v=F}}}}b_(e.pP,e.qb[t.bQ])}}}function qt(){for(var d,a,g=this.ip.d5,h,f,n,k,m,b,l,e=0,c=bp(g);
e<c;
e++){h=g[e];
n=this.qb[h.bQ];
if(n&&(a=bp(n))>2){m=0;
k=0;
if(!this.pI||a<4){b=ak}else{if(a<7){b=aj}else{if(a<11){b=96}else{if(a<16||a>21){b=ad}else{b=82.29}}}b*=a}for(d=0;
d<a;
d++){f=n[d];
if(f.pU){m+=f.pT}else{k+=f.pT}}k+=m;
if(this.pI?k>b:k!=b){if(m<b){l=(b-m)/(k-m);
for(d=0;
d<a;
d++){f=n[d];
if(!f.pU){f.pT*=l}}}else{l=b/k;
for(d=0;
d<a;
d++){f=n[d];
f.pT*=l}}}}}}function qu(){for(var d=this.ip.dv,c,b=0,a=bp(d);
b<a;
b++){c=d[b];
c.pL=am;
c.bp=am;
c.pM=am}d=this.hu;
a=bp(d);
for(b=0;
b<a;
b++){d[b].pT=am}}function qv(d){if(bp(d.d5)<10){var b=this,h=d.d5,k,f,a=d.pT,m=b.qo[d.bQ],g,e,p,n=0,o=0,j,c,l;
if(m){e=bp(m);
for(g=0;
g<e;
g++){p=m[g];
if(M.abs(p.pT-a)<pm){n++}else{o+=a-p.pT}}if(o){j=o/n;
for(g=0;
g<e;
g++){p=m[g];
if(M.abs(p.pT-a)<pm){p.pT+=j}}}d.jo();
e=bp(h);
if(b.pI){d.jf();
if(a==aj){a=qp(e);
if(e==8){k=[[p=15,p,-p,-p,p,p,-p,-p,3]]}else{k=[[p=(aj-ad)*0.5,p,-p,p,p,-p,2],[p,-p,p,-p,p,-p,1]]}}if(k){f=ar;
while(j=k.pop()){o=j.pop();
for(;
o>=0;
o--){c=0;
for(g=0;
g<e;
g++){c+=M.abs(d.jp(h[g])-j[g])}if(c<f){f=c;
n=j.slice()}if(f==0){break}if(o>0){b6(j)}}}j=n}a=af-a;
k=h[0];
n=k.c_;
n.cv(d.jc.cj(-d.jc.co(n.cA(d.fy))));
n.eU(0.5*dd/M.sin(0.5*a*ag)/n.cU(d.fy),d.fy);
for(g=1;
g<e;
g++){k=h[g];
k.c_=n.cd();
k.c_.cD(a*g*ag,d.jc,d.fy)}if(j){for(g=0;
g<e;
g++){k=h[g].c_;
k.cD(-j[g]*ag,d.jc.cr(k.cA(d.fy)).cC(),d.fy)}}}else{for(g=1;
g<e;
g++){k=h[g];
f=h[g-1];
if(g==1){c=eB(f,k);
k.c_=c3(f.c_,c,dd)}else{p=b8(m,b.qb[k.bQ]);
if(bp(p)==1){p=p[0];
if(!l){l=(h[2].c_.eR(h[0].c_,h[1].c_)?1:-1)}c+=(af-p.pT)*l;
k.c_=c3(f.c_,c,dd)}}}}}}}function qw(){for(var c=this,b=0,a=bp(c.hu);
b<a;
b++){c.qx(c.hu[b])}}function pz(a,j,e){var b=this,g=[],f,h,l,d,c,k=1;
b.ip=a;
b.pI=j;
b.pP=[];
b.p9=[];
b.qb={};
b.qn={};
b.qo={};
b.p4=e;
b.qy=qr;
b.pB=pH;
b.pC=pN;
b.pD=pO;
b.pG=p6;
b.pF=(j?p8:qd);
b.qz=qw;

b.qx=qv;
b.qA=qt;
b.jG=pA;
b.qB=qu;
b.qj=ql;
b.qs=qm;
for(d=bp(a.iq)-1;
d>=0;
d--){c=a.iq[d];
if(c.type==av){f=c.hJ.slice();
h=c.dv.slice();
l=c.hI.slice();
c.il(l,h);
g.push({dt:c.dt,d5:f,dv:h,hI:l})}}b.hu=i7(a.d4());
b.qy();
do{b.qz();
b.qA();
b.jG();
k--}while(k>0&&b.pE>pt);
b.qB();
for(d=bp(g)-1;
d>=0;
d--){c=g[d];
a.eq.h0(c.dt,c.d5,c.dv,c.hI)}a.fz(bg)}hideMenu=nR;
getMolRxnfile=l_;
setMolRxnfile=ma;
beforeChange=hZ;
afterChange=h2;
centerView=pu;
zoomFit=oC;
redrawChanged=oA;
delSelection=nE;
Point3D=ck;
Molecule=fJ;
Atom=gy;
Bond=gB;
Selection=gx;
